\subsection{Proofs for Theorem \ref{tv_mle}}\label{main1}

In the sequel, we prove Theorem \ref{tv_mle}.

\begin{proof}[Proof of Theorem \ref{tv_mle}]
For notation simplicity, we denote $\bm{x}:=(x,s)$.
Recall that we define $\mP_{\mathcal{X} \times \mathcal{S}}(\Phi):=\{p_{\phi}(x,s)\,|\,\phi\in\Phi\}$. Let $\mN_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)$ be the smallest $\epsilon$-bracket of $\mP_{\mathcal{X} \times \mathcal{S}}(\Phi)$. We have $|\mN_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)|=N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)$, where $N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)$ is the bracketing number of $\mP_{\mathcal{X} \times \mathcal{S}}(\Phi)$. By Markov inequality and Boole's inequality, it holds with probability at least $1-\delta$ that for all $\bar p_{\phi}(\bm{x})\in\mN_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)$
\%
\frac{1}{2}\sum^m_{i=1}\log\frac{\bar p_{\phi}(\bm{x}_i)}{p_{\phi^* }(\bm{x}_i)}\leq\log\E\Big[e^{\frac{1}{2}\sum^m_{i=1}\log\frac{\bar p_{\phi}(\bm{x}_i)}{p_{\phi^* }(\bm{x}_i)}}\Big]+\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta}.
\%
Note that $\hat\phi$ is the maximizer of the likelihood function, i.e.
\$
\hat\phi\leftarrow\argmax_{\phi\in\Phi}\sum^m_{i=1}\log p_{\phi}(\bm{x}_i),
\$
which implies 
\%
\frac{1}{2}\sum^m_{i=1}\log\frac{\bar p_{\hat\phi}(\bm{x}_i)}{p_{\phi^* }(\bm{x}_i)}\geq 0.
\%
Then we have with probability at least $1-\delta$ that
\%
0&\leq\log\E\Big[e^{\frac{1}{2}\sum^m_{i=1}\log\frac{\bar p_{\hat\phi}(\bm{x}_i)}{p_{\phi^* }(\bm{x}_i)}}\Big]+\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta},\notag\\
&=m\log\E\bigg[\sqrt{\frac{\bar p_{\hat\phi}(\bm{x})}{p_{\phi^* }(\bm{x})}}\bigg]+\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta},\notag\\
&=m\log\int \sqrt{\bar p_{\hat\phi}(\bm{x})p_{\phi^* }(\bm{x})} \,d\bm{x} +\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta},\notag\\
&\leq m\bigg(\int \sqrt{\bar p_{\hat\phi}(\bm{x})p_{\phi^* }(\bm{x})} \,d\bm{x} -1\bigg)+\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta},
\%
where the last inequality follows from the fact that $\log x\leq x-1$. By rearranging the terms, we have
\%\label{092101}
1-\int \sqrt{\bar p_{\hat\phi}(\bm{x})p_{\phi^* }(\bm{x})} \,d\bm{x} \leq \frac{1}{m}\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta}.
\% 

By the definition of bracket, we obtain
\$
\int \bar p_{\hat\phi}(\bm{x})d\bm{x}=\int (\bar p_{\hat\phi}(\bm{x})-p_{\hat\phi}(\bm{x}))d\bm{x}+\int  p_{\hat\phi}(\bm{x})d\bm{x}\leq \epsilon+1,
\$
which implies 
\%\label{092102}
&\int \Big(\sqrt{\bar p_{\hat\phi}(\bm{x})}-\sqrt{p_{\phi^* }(\bm{x})}\Big)^2\, d\bm{x}\leq 2\bigg(1-\int\sqrt{\bar p_{\hat\phi}(\bm{x})p_{\phi^* }(\bm{x})}d\bm{x}\bigg)+\epsilon
\%
and 
\%\label{092103}
\int\Big(\sqrt{\bar p_{\hat\phi}(\bm{x})}+\sqrt{p_{\phi^* }(\bm{x})}\Big)^2\, d\bm{x}\leq 2\int\bar p_{\hat\phi}(\bm{x})+p_{\phi^* }(\bm{x})\, d\bm{x}\leq 2\epsilon+4.
\%
Combining \eqref{092101} and \eqref{092102}, we show that
\%\label{092104}
\int\Big(\sqrt{\bar p_{\hat\phi}(\bm{x})}-\sqrt{p_{\phi^* }(\bm{x})}\Big)^2\, d\bm{x}\leq \frac{2}{m}\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta}+\epsilon.
\%
By Cauchy-Schwarz inequality, it then holds that
\%\label{092105}
\bigg(\int|\bar p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|\, d\bm{x}\bigg)^2&\leq \int\Big(\sqrt{\bar p_{\hat\phi}(\bm{x})}+\sqrt{p_{\phi^* }(\bm{x})}\Big)^2\, d\bm{x}\cdot\int\Big(\sqrt{\bar p_{\hat\phi}(\bm{x})}-\sqrt{p_{\phi^* }(\bm{x})}\Big)^2\, d\bm{x},\notag\\
&\leq (2\epsilon+4)\cdot\bigg(\frac{2}{m}\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta}+\epsilon\bigg),
\%
where the last inequality follows from \eqref{092103} and \eqref{092104}. Note that
\%\label{092106}
&\bigg(\int| p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|\, d\bm{x}\bigg)^2-\bigg(\int|\bar p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|\, d\bm{x}\bigg)^2\notag\\
&=\bigg(\int | p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|+| \bar p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|\,d\bm{x}\bigg)\cdot\bigg(\int | p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|-| \bar p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|\,d\bm{x}\bigg)\notag\\
&\leq\bigg(\int | p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|+| \bar p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|\,d\bm{x}\bigg)\cdot\int | p_{\hat\phi}(\bm{x})- \bar p_{\hat\phi}(\bm{x})|\,d\bm{x}\notag\\
&\leq (\epsilon+4)\cdot\epsilon.
\%
Adding \eqref{092105} and \eqref{092106} together, we have
\%
\bigg(\int| p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|\, d\bm{x}\bigg)^2\leq (2\epsilon+4)\cdot\bigg(\frac{2}{m}\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta}+\epsilon\bigg)+(\epsilon+4)\cdot\epsilon,
\%
which implies 
\%
\TV\big(\P_{\hat\phi}(\bm{x}),\P_{\phi^* }(\bm{x})\big)&=\frac{1}{2}\int| p_{\hat\phi}(\bm{x})-p_{\phi^* }(\bm{x})|\, d\bm{x}\notag\\
&\leq\frac{1}{2} \sqrt{(2\epsilon+4)\cdot\bigg(\frac{2}{m}\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),\epsilon)}{\delta}+\epsilon\bigg)+(\epsilon+4)\cdot\epsilon}.
\%
Setting $\epsilon=1/m$, we have with probability at least $1-\delta$ that
\%
\TV\big(\P_{\hat\phi}(\bm{x}),\P_{\phi^* }(\bm{x})\big)&\leq\frac{1}{2} \sqrt{\bigg(\frac{2}{m}+4\bigg)\cdot\bigg(\frac{2}{m}\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),1/m)}{\delta}+\frac{1}{m}\bigg)+\bigg(\frac{1}{m}+4\bigg)\cdot\frac{1}{m}}\notag\\
&\leq 3\cdot\sqrt{\frac{1}{m}\log\frac{N_{\b}(\mP_{\mathcal{X} \times \mathcal{S}}(\Phi),1/m)}{\delta}}.
\%
Thus, we prove Theorem \ref{tv_mle}.
\end{proof}