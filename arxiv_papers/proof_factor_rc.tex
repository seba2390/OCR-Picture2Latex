\subsection{Rademacher Complexity}\label{factor3}

% \subsection{Proofs for Lemma \ref{factor_rc}}\label{factor3}


Note that for fixed $B$ the prediction function class 
\$
\mathcal{G}_{B,\mathcal{C}}:=\big\{g_{B,\beta}(x)=\beta^{T}B^{T}(BB^T+\sigma^2 I_d)^{-1}x\,\big|\,\beta\in\mathcal{C}\big\}
\$
belongs to a linear hypothesis class. For a linear hypothesis class $\mathcal{H}$, we can bound its empirical Rademacher complexity as follows.

\begin{lemma}\label{factor_rc}
For a linear hypothesis class $\mathcal{H}=\{h_{\beta}(x)=\beta^{T}x\,|\,\beta\in\R^r, \|\beta\|_2\leq D\}$, where $x\in\R^r$ and $\|x\|_2\leq X$, the empirical Rademacher complexity can be bounded as follows,
\$
\hat R_n(\mathcal{H})\leq \frac{2DX}{\sqrt{n}}.
\$
\end{lemma}


\begin{proof}[Proof of Lemma \ref{factor_rc}]
Note that
\$
\hat R_n(\mathcal{H})&=\frac{2}{n}\E_{\sigma_i}\bigg[\sup_{\|\beta\|_2\leq D}\sum^n_{i=1}\sigma_i\cdot \beta^{T}x_i\bigg]=\frac{2}{n}\E_{\sigma_i}\bigg[\sup_{\|\beta\|_2\leq D}\beta^{T}\bigg(\sum^n_{i=1}\sigma_ix_i\bigg)\bigg]\\
&\leq \frac{2}{n}\E_{\sigma_i}\bigg[\sup_{\|\beta\|_2\leq D}\|\beta\|_2\bigg\|\sum^n_{i=1}\sigma_ix_i\bigg\|_2\bigg]\leq\frac{2D}{n}\E_{\sigma_i}\bigg[\sqrt{\sum_{i,j}\sigma_i\sigma_j x^T_ix_j}\bigg].
\$
By Jensen's inequality, we then have
\$
\hat R_n(\mathcal{H})\leq\frac{2D}{n}\E_{\sigma_i}\bigg[\sqrt{\sum_{i,j}\sigma_i\sigma_j x^T_ix_j}\bigg]\leq\frac{2D}{n}\sqrt{E_{\sigma_i}\bigg[\sum_{i,j}\sigma_i\sigma_j x^T_ix_j\bigg]}=\frac{2D}{n}\sqrt{\sum^n_{i=1} \|x_i\|^2}\leq \frac{2DX}{\sqrt{n}}.
\$





\end{proof}