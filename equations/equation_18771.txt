\begin{align}\text{Recurrent model: } & h_t = f_{\phi}(h_{t-1}, z_{t-1}, a_{t-1})\\ \text{Representation model: } & z_t \sim q_{\phi}(z_t | h_t, x_t)\\ \text{Transition model: } & \hat{z}_t \sim p_{\phi}(\hat{z}_t | h_t)\\ \text{Observation predictor: } & \hat{x}_t \sim p_{\phi}(\hat{x}_t | h_t, z_t)\\ \text{Reward predictor: } & \hat{r}_t \sim p_{\phi}(\hat{r}_t | h_t, z_t)\\ \text{Discount predictor: } & \hat{\gamma}_t \sim p_{\phi}(\hat{\gamma}_t | h_t, z_t) \\ \text{Actor: } & \hat{a_t} \sim p_{\psi}(\hat{a}_t | \hat{z_t})\\ \text{Critic: } & v_{\xi}(\hat{z}_t) \approx E_{p_{\phi}, p_{\psi}}\left[\sum_{i\geq t}\hat{\gamma}^{i-t}\hat{r}_i\right]\end{align}