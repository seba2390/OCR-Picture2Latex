\begin{align}\hat{\vh}^i_{d,j} & = (\weights^{i} \vh^{i-1}_d)_j && d=1,\ldots,D,\, j=1,\ldots,n \\ \vh^{i}_{d,j} & = \sigma(\hat{\vh}^i_{d,j}) && d=1,\ldots,D,\, j=1,\ldots,n.\end{align}