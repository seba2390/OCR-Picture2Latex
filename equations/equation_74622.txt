$O(nd +n\log n)$