$|I| = |J| = O(kn\log n)$