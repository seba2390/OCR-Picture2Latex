\begin{align}\begin{cases} \frac{1}{k} \lan \rho^{n+1} - \rho^n, v \ran - \lan \rho^{n+1} u^n, \frac{d}{dx} v \ran = 0 \\ \frac{1}{k} \lan u^{n+1} - u^n, q \ran + \lan u^{n+1} \frac{d}{dx} u^n, q \ran = \lan \frac{1}{(\rho^n)_{\phi}} (u^n \rho^n)_{\phi_h}, q \ran - \lan \frac{1}{(\rho^n)_{\phi}} u^{n+1} \rho^n_{\phi_h}, q \ran \end{cases}\end{align}