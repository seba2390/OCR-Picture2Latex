\begin{align}g_i^{t+1} &\leftarrow f_i^t - \lr_t d_i^t \rn_i, \\ f_i^{t+1} &\leftarrow g_i^{t+1} - \lrc \sum_{j\in\Neigh{i}}\(g_i^{t+1} - g_j^{t+1}\) \nonumber \\ f_i^{t+1} &= g_i^{t+1} - \lrc \NumNeigh_i \(g_i^{t+1} - \frac{1}{\NumNeigh_i}\sum_{j\in\Neigh{i}}g_j^{t+1}\),\end{align}