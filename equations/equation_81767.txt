\begin{align}\mathbf{Z}_{k+1}&= \mathbf{L}_k- \alpha_{\mathbf{L}}\bigg( 2 \Ob_i \odot (\mathbf{L}_k+\mathbf{S}_k-\mathbf{M}_k) +2 \mu_{\mathbf{L}} \mathbf{L}_k\bigg) + \nonumber \\ &\hspace{1.5cm}\alpha_{\mathbf{L}}\bigg(\bt^i_{\mathbf{L}} - \sum_{j=1}^N \frac{1}{N}\bt^j_{\mathbf{L}} \bigg) \nonumber \\ \mathbf{L}_{k+1}&=\D_{\lambda_{\mathbf{L}}}(\mathbf{Z}_{k+1}) \\ \mathbf{Y}_{k+1}&= \mathbf{S}_k- \alpha_{\mathbf{S}}\bigg( 2 \Ob_i \odot (\mathbf{L}_{k+1}+\mathbf{S}_k-\mathbf{M}_k) +2 \mu_{\mathbf{S}} \mathbf{S}_k\bigg) +\nonumber \\ & \hspace{1.5cm}\alpha_{\mathbf{S}}\bigg(\bt^i_{\mathbf{S}} - \sum_{j=1}^N \frac{1}{N}\bt^j_{\mathbf{S}} \bigg)\nonumber \\ \mathbf{S}_{k+1}&= \mathcal{S}_{\lambda_{\mathbf{S}}}(\mathbf{Y}_{k+1}) \text{Update memory} \bt_{\mathbf{L}} , \bt_{\mathbf{S}} \text{if K_0 iterations have passed since last memory update}\end{align}