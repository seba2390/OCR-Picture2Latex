\begin{equation}\begin{split} Loss =& \frac{1}{2}\bigg(\Vert \mathcal{G}_\Theta(\mathbf{\Phi}_{\varepsilon_{r}})-\varepsilon_{r}\Vert_{2}^{2} + \alpha_{1} \text{TV}(\mathcal{G}_\Theta(\mathbf{\Phi}_{\varepsilon_{r}})) + \alpha_{2}(1-\text{SSIM}(\mathcal{G}_\Theta(\mathbf{\Phi}_{\varepsilon_{r}}),\varepsilon_{r}))\\ &+\Vert \mathcal{G}_\Theta(\mathbf{\Phi}_{\mathcal{R}_{\pi}(\varepsilon_{r})})-\mathcal{R}_{\pi}(\varepsilon_{r})\Vert_{2}^{2} + \alpha_{1} \text{TV}(\mathcal{G}_\Theta(\mathbf{\Phi}_{\mathcal{R}_{\pi}(\varepsilon_{r})})) + \alpha_{2}(1-\text{SSIM}(\mathcal{G}_\Theta(\mathbf{\Phi}_{\mathcal{R}_{\pi}(\varepsilon_{r})}),\mathcal{R}_{\pi}(\varepsilon_{r})))\bigg) \end{split}\end{equation}