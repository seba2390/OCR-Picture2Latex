$\text{max}\left(O(np),O(ftp^2)\right)$