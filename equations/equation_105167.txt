\begin{align}L_{{\rm nce}} = \sum_{r\in\mathcal{R}} \sum_{(a, p)\in \mathcal{P}_r \times \mathcal{P}_r} \left( - \log \frac{ \exp{\left( \frac{{\rm cos}(\bm{x}_a, \bm{x}_p)}{\tau} \right)} }{\exp{\left( \frac{{\rm cos}(\bm{x}_a, \bm{x}_p)}{\tau} \right)} + \sum_{n \in \mathcal{N}_r} \exp{\left(\frac{{\rm cos}(\bm{x}_a, \bm{x}_n)}{\tau} \right)} } \right)\end{align}