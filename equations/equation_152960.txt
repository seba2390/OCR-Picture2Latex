$|I| = |J| = O(n\log n)$