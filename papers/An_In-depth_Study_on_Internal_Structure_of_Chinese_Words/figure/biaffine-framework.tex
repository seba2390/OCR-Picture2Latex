\begin{figure}[tb]
    \centering
    \begin{tikzpicture}[
        connect/.style={
                rounded corners=4pt,
                semithick,
                draw=black!80
            },
        arrow/.style={
                % >=latex,
                arrows = {-Straight Barb[length=0.5mm]},
                shorten >= 2pt,
                shorten <= 1.5pt,
                thin
            },
        inner arrow/.style={
                arrows = {-Straight Barb[length=0.4mm]},
                shorten >= 2pt,
                shorten <= 2pt,
                thin,
                draw=black!50
            },
        input/.style={
                rectangle,
                rounded corners=1mm,
                thin,
                dashed,
                draw=none,
                minimum width=3.5cm,
                minimum height=0.6cm,
            },
        share/.style={
                minimum height=0.5cm,
                fill={rgb,255:red,230; green,197; blue,180},
                % fill={rgb,255:red,240; green,245; blue,229},
                fill opacity=0.6,
                text opacity=1.0,
                draw=black,
                % thick,
                rounded corners=2mm,
            },
        task2/.style={
                minimum height=0.5cm,
                fill={rgb,255:red,251; green,153; blue,104},
                fill opacity=0.6,
                text opacity=1.0,
                draw=black,
                rounded corners=2mm,
            },
        label/.style={
                inner sep=0.5mm,
                fill=white,
                minimum height=0.5cm,
            },
        task1/.style={
                minimum height=0.5cm,
                fill={rgb,255:red,117; green,178; blue,231},
                draw=black,
                rounded corners=2mm
            },
        inner lstm/.style={
                fill=white,
                rectangle,
                rounded corners=1mm,
                semithick,
                % thin,
                draw=black!50,
                fill opacity=0.8
            },
        cell/.style={
                inner sep=2mm,
                rectangle,
                rounded corners=1mm,
                semithick,
                draw=black!50,
            },
        ocell/.style={
                solid,
                minimum height=0.5cm,
                rectangle,
                rounded corners=1mm,
                thick
            },
        dep arrow/.style={
        arrows = {-Latex[round,open,length=8pt,width=6pt]},
        shorten >= 2pt,
        shorten <= 1.5pt,
        thick
        }
        ]
        \centering
        \node [input, inner sep=1pt] [minimum width=4.8cm] (input) at (0, 0) {$\ldots\;\; \mathbf{x}_i \;\;\ldots\;\; \mathbf{x}_j \;\;\ldots$};
        % Concat
        \node [inner sep=0] (EmbedCat) at ($(input.north)$) {};
    
        %\scriptsize BiLSTM
        \node [share, ocell] [minimum width=7cm, minimum height=0.675cm, anchor=south] (lstm) at ($(input.north) + (0, 0.3cm)$) {\scriptsize $\mathrm{BiLSTM}\, \times \, 3$};
    

        \draw [arrow, connect] ($(EmbedCat.north) + (0cm, -0.15cm)$) -- ($(lstm.south) + (0cm, 0)$);


        % fisrt two mlps
        \node [share, fill={rgb,255:red,245; green,245; blue,245}, semithick, draw=gray] [minimum width=7cm, minimum height=0.775cm, anchor=south] (share-mlp) at ($(lstm.north) + (0cm, 0.455cm)$) {};
        

        \node [task2, ocell] [minimum width=1.625cm, minimum height=0.585cm, anchor=south west, fill opacity=0.85] (mlp-1-1-f) at ($(lstm.north west) + (0.1cm, 0.55cm)$) {};
        \node [task2, ocell] [minimum width=1.625cm, minimum height=0.585cm, anchor=south west, fill opacity=0.85] (mlp-1-1-b) at ($(lstm.north west) + (1.825cm, 0.55cm)$) {};
        \node [anchor=base] at  ($(mlp-1-1-f.south) + (0, 0.2cm)$)  {\scriptsize $\mathrm{MLP}^{h}$};
        \node [anchor=base] at  ($(mlp-1-1-b.south) + (0, 0.2cm)$)  {\scriptsize $\mathrm{MLP}^{d}$};
    
        \node [task2, ocell, fill=none, draw=none] [minimum width=1.75cm, minimum height=0.40cm, anchor=south east, fill opacity=0.5, draw opacity=0.6] (mlp-1-2-b) at ($(mlp-1-1-b.north east) + (0, 0.5cm)$) {};
    
        \node [task2, ocell, anchor=south, fill opacity=0.85, minimum height=1.29cm, minimum width=1.29cm, align=center] (arc-biaffine) at ($(mlp-1-1-f.north)!0.5!(mlp-1-1-b.north) + (0, 0.73cm)$) {\scriptsize $\mathrm{Biaffine}$};
    
        \draw [arrow, connect] ($(mlp-1-1-b.north) + (0, 0.06cm)$) -- ($(mlp-1-1-b.north) + (0, 0.35cm)$) -- ($(arc-biaffine.south) + (0.2, 0)$);
        \draw [arrow, connect] ($(mlp-1-1-f.north) + (0, 0.06cm)$) -- ($(mlp-1-1-f.north) + (0, 0.35cm)$) -- ($(arc-biaffine.south) + (-0.2, 0)$);
    
        % second two mlps
        \node [task1, ocell] [minimum width=1.625cm, minimum height=0.585cm, anchor=south east, fill opacity=0.85] (mlp-2-1-f) at ($(lstm.north east) + (-1.825cm, 0.55cm)$) {};
        \node [task1, ocell] [minimum width=1.625cm, minimum height=0.585cm, anchor=south east, fill opacity=0.85] (mlp-2-1-b) at ($(lstm.north east) + (-0.1cm, 0.55cm)$) {};
        \node [anchor=base] at  ($(mlp-2-1-f.south) + (0, 0.2cm)$)  {\scriptsize $\mathrm{MLP}^{h'}$};
        \node [anchor=base] at  ($(mlp-2-1-b.south) + (0, 0.2cm)$)  {\scriptsize $\mathrm{MLP}^{d'}$};
    
        \node [anchor=south, minimum height=1.29cm, minimum width=1.29cm, draw=none] (label-biaffine-invis) at ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (0, 0.73)$) {};
    
        \filldraw[task1, ocell, fill={rgb,255:red,235; green,235; blue,235}, draw=none, rounded corners=0.5mm] ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (-0.875, 0.5)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (0.415, 0.5)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (0.875, 0.96)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (0.875, 2.25)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (-0.415, 2.25)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (-0.875, 1.79)$) -- cycle;
    
        \draw [arrow, connect] ($(mlp-2-1-b.north) + (0, 0.06cm)$) -- ($(mlp-2-1-b.north) + (0, 0.35cm)$) -- ($(label-biaffine-invis.south) + (0.2, 0)$);
        \draw [arrow, connect] ($(mlp-2-1-f.north) + (0, 0.06cm)$) -- ($(mlp-2-1-f.north) + (0, 0.35cm)$) -- ($(label-biaffine-invis.south) + (-0.2, 0)$);
    
        \filldraw[task1, ocell, fill=none, draw=lightgray, rounded corners=0.5mm] ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (-0.875, 0.5)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (0.415, 0.5)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (0.875, 0.96)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (0.875, 2.25)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (-0.415, 2.25)$) -- ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (-0.875, 1.79)$) -- cycle;
    
        \node [anchor=south west, minimum height=1.29cm, minimum width=1.29cm, draw=none] (label-biaffine-f) at ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (-0.875, 0.5)$) {};

        \node [anchor=north east, minimum height=1.29cm, minimum width=1.29cm, draw=none] (label-biaffine-b) at ($(mlp-2-1-f.north)!0.5!(mlp-2-1-b.north) + (0.875, 2.25)$) {};  

        \node [fill={rgb,255:red,117; green,178; blue,231}, fill opacity=0.3, minimum height=1.21cm, minimum width=1.21cm, draw=black!80, rounded corners=0.5mm, align=center, inner sep=0.1mm] at ($(label-biaffine-f)!1.0!(label-biaffine-b)$) {};
    
        \node [fill={rgb,255:red,117; green,178; blue,231}, fill opacity=0.4, minimum height=1.21cm, minimum width=1.21cm, draw=black!80, rounded corners=0.5mm, align=center, inner sep=0.1mm] at ($(label-biaffine-f)!0.8!(label-biaffine-b)$) {};
    
        \node [fill={rgb,255:red,117; green,178; blue,231}, fill opacity=0.5, minimum height=1.21cm, minimum width=1.21cm, draw=black!80, rounded corners=0.5mm, align=center, inner sep=0.1mm] at ($(label-biaffine-f)!0.57!(label-biaffine-b)$) {};

        \node [fill={rgb,255:red,117; green,178; blue,231}, fill opacity=0.7, minimum height=1.21cm, minimum width=1.21cm, draw=black!80, rounded corners=0.5mm, align=center, inner sep=0.1mm] at ($(label-biaffine-f)!0.3!(label-biaffine-b)$) {};
        
        \node [fill={rgb,255:red,117; green,178; blue,231}, fill opacity=0.9, minimum height=1.21cm, minimum width=1.21cm, draw=black!80, rounded corners=0.5mm, align=center, inner sep=0.1mm] at ($(label-biaffine-f)!0.0!(label-biaffine-b)$) {\scriptsize $\mathrm{Biaffines}$};
    
        %  LSTM -> MLP
        \draw [arrow, connect, rounded corners=1.2pt, shorten >= 2pt] ($(lstm.north) + (-1.725cm, 0)$) -- ($(share-mlp.south) + (-1.725cm, 0)$);
        \draw [arrow, connect, rounded corners=1.2pt, shorten >= 2pt] ($(lstm.north) + (1.725cm, 0)$) -- ($(share-mlp.south) + (1.725cm, 0)$);
        \node[anchor=base] at ($(share-mlp.south) + (-2cm,-0.32cm) $) {$\mathbf{h}_{i}$};
        \node[anchor=base] at ($(share-mlp.south) + (1.45cm,-0.32cm) $) {$\mathbf{h}_{j}$};
    
    
        \node[anchor=base] at ($(share-mlp.north) + (-3.0cm,0.18cm) $) {$\mathbf{r}_{i}^{h}$};
        \node[anchor=base] at ($(share-mlp.north) + (-0.5cm,0.18cm) $) {$\mathbf{r}_{j}^{d}$};
        \node[anchor=base] at ($(share-mlp.north) + (0.5cm,0.18cm) $) {$\mathbf{r}_{i}^{h'}$};
        \node[anchor=base] at ($(share-mlp.north) + (3.0cm,0.18cm) $) {$\mathbf{r}_{j}^{d'}$};
    
    
        \node[anchor=base] at ($(arc-biaffine.north) + (0cm,0.5cm) $) (arc-biaffine-label) {$\mathrm{score}(i \rightarrow j)$};
        \node[anchor=base] at ($(label-biaffine-invis.north) + (0,0.5cm) $) (label-biaffine-label) {$\mathrm{score}(i \xrightarrow{l} j)$};
    
    
        \draw [arrow, connect, rounded corners=1.2pt, shorten >= 2pt] ($(arc-biaffine-label.south) + (0, -0.25cm) $) -- ($(arc-biaffine-label.south) + (0, 0.15cm) $);
        \draw [arrow, connect, rounded corners=1.2pt, shorten >= 2pt, line cap=round] ($(label-biaffine-label.south) + (0, -0.25cm) $) -- ($(label-biaffine-label.south) + (0, 0.15cm) $);
    
    \end{tikzpicture}
    
    \caption{
      The basic architecture of Biaffine Parser. 
    }
    \label{fig:biaffine-parser}
\end{figure}