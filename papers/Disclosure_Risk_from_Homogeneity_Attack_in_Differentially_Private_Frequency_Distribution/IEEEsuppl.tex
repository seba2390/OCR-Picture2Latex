\documentclass[10pt,journal,compsoc]{IEEEtran}
\IEEEoverridecommandlockouts

\usepackage{amsmath, amssymb, mathrsfs, amsthm}
\usepackage[autostyle]{csquotes}
\usepackage{graphicx, comment, url}
\usepackage{listings,wrapfig,enumitem}
\usepackage{float, parskip}
\usepackage{color, xcolor, cases}
\usepackage{subfig, fancyhdr}
\usepackage[numbers,sort, compress]{natbib}
\usepackage[english]{babel}
\usepackage[nodisplayskipstretch]{setspace}
\usepackage{bbm} 
\def\UrlBreaks{\do\/\do-}
\usepackage{breakurl}
\usepackage[breaklinks, colorlinks,
    linkcolor={red!70!black},
    citecolor={blue!20!green},
    urlcolor={blue!80}]{hyperref}
\usepackage[hang,flushmargin]{footmisc}

\makeatletter
\def\footnoterule{\kern-3\p@
  \hrule \@width 1.5in \kern 2.6\p@} 
\makeatother

\newtheorem{thm}{\vspace{-6pt}\\ Theorem}
\newtheorem{defn}{\vspace{-6pt}\\ Definition}
\newtheorem{lem}[thm]{\vspace{-6pt}\\ Lemma}
\newtheorem{cor}[thm]{\vspace{-6pt}\\ Corollary}
\newtheorem{pro}[thm]{\vspace{-6pt}\\ Proposition}
\newtheorem{alg}{\vspace{-6pt}\\ Algorithm}
\newtheorem{rem}{\vspace{-6pt}\\ Remark}
\newtheorem{problem}{\vspace{-6pt}\\ Problem}
\newtheorem{ps}{\vspace{-6pt}\\ Problem Setting}
\newcommand{\s}{\mathbf{s}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\p}{\mathbf{p}}
\newcommand{\n}{\mathbf{n}}
\newcommand{\X}{\mathbf{X}}
\newcommand{\x}{\mathbf{x}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\Z}{\mathbf{Z}}
\newcommand{\y}{\mathbf{y}}
\newcommand{\D}{\mathcal{D}}
\newcommand{\C}{\mathcal{C}}
\newcommand{\bs}{\boldsymbol}
\allowdisplaybreaks
\setlength{\parskip}{3pt}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
    

\begin{document}

\setcounter{page}{1}
\setcounter{figure}{0}
\setcounter{table}{0}
\setcounter{equation}{0}
\setcounter{section}{0}


\renewcommand{\thepage}{S\arabic{page}}
\renewcommand{\thesection}{S\arabic{section}}
\renewcommand{\thetable}{S\arabic{table}}
\renewcommand{\thefigure}{S\arabic{figure}}
\renewcommand{\theequation}{S\arabic{equation}}
\renewcommand{\thecor}{S\arabic{thm}}

\onecolumn

\begin{center} \LARGE\bf{Supplementary Materials to \\
``Disclosure Risk from Homogeneity Attack in Differentially Privately Sanitized Frequency Distribution''} \\
\vspace{12pt}
\large{\textbf{ Fang Liu,\footnote{\noindent Fang Liu (email: fang.liu.131@nd.edu) is Professor and Xingyuan Zhao is a doctoral student in the Department of Applied and Computational Mathematics and Statistics at the University of Notre Dame. This work was supported by NSF Award \#1717417.} Xingyuan Zhao}\\
\vspace{6pt}
\normalsize{Applied and Computational Mathematics and Statistics}\\
\vspace{3pt}
\normalsize{University of Notre Dame, Notre Dame, IN 46556}}
\end{center}

\normalsize


\normalsize
\section{\large  Proofs of Theorem 1 and Corollary 2}\label{rho.lap.proof}
\begin{proof}
We first examine the case of $K=2$, and then extend to the case of $K\ge2$. 
Per Definition 6, the homogeneity attack occurs in Scenarios 1 and 8. In Scenario 1, the local DR-HA on sensitive attribute $Y$ in cell $\C_i$ is
\begin{align*}
\rho^{\text{l}}_i&=(\Pr(n_{i,1}\!=\!n_i)\!+\!\Pr(n_{i,1}\!=\!0))\Pr(n_{i,0}+e_{i,0}<0.5|n_{i,1}\!=\!n_i)\Pr(n_{i,1}+e_{i,1}\geqslant0.5|n_{i,1}\!=\!n_i)\notag\\
&=(\Pr(n_{i,1}=n_{i})+\Pr(n_{i,1}\!=\!0))\Pr(e_{i,0}<0.5)\Pr(e_{i,1}\geqslant0.5-n_i)\notag\\
&=\left(p_i^{n_i}+(1-p_i)^{n_i}\right)\left(1-0.5\exp(-0.5\epsilon)\right)\left(1-0.5\exp((0.5-n_i)\epsilon)\right).
\end{align*}
WLOS, we examine $(n_{i,0},n_{i,1})=(1,n_i-1)$ for Scenario 8, where
\small\begin{align*}
&\rho^{\text{l}}_i\!<\!\mathbbm{1}(n_i\!\ge\!2)\Pr(n_{i,0},n_{i,1})\!\neq\!(0,n_i)\big\{\!\Pr(n_{i,1}\!+\!e_{i,1}\!\geq\!0.5|n_{i,1}\!=\!n_i\!-\!1)\Pr(n_{i,0}\!+\!e_{i,0}\!<\!0.5|n_{i,0}\!=\!1)\\
&+\Pr(n_{i,1}\!+\!e_{i,1}\!<\!0.5|n_{i,1}\!=\!n_i\!-\!1)\Pr(n_{i,0}\!+\!e_{i,0}\!\geq\!0.5|n_{i,0}\!=\!1)\big\}\\
=\;&\!\mathbbm{1}(n_i\!\ge\!2)(1\!-\!p_i^{n_i}\!-\!(1\!-\!p_i)^{n_i})\!\left(\Pr(e_{i,1}\!\!\geq\!\!1.5\!-\!n_i)\Pr(e_{i,0}\!\!<\!\!-0.5)\!+\!\Pr(e_{i,1}\!\!<\!\!1.5\!-\!n_i)\Pr(e_{i,0}\!\!\geq\!\!-0.5)\right)\\
=\;&\mathbbm{1}(n_i\!\ge\!2)\left(1\!-\!p_i^{n_i}\!-\!(1\!-\!p_i)^{n_i}\right)[\left(\!1\!-\!0.5\exp(\epsilon(1.5\!-\!n_i))\right)\left(0.5\exp(-0.5\epsilon)\right)+0.5\exp((1.5\!-\!n_i)\epsilon)(1\!-\!0.5\exp(-0.5\epsilon))].
\end{align*}
\normalsize The expected DR-HA of $Y$ in cell $\C_i$ in the sanitized data is thus given by
\begin{align*}
    \rho^{\text{e}}_i<&\left(p_i^{n_i}+(1-p_i)^{n_i}\right)\left(1-0.5\exp(-0.5\epsilon)\right)\left(1-0.5\exp((0.5-n_i)\epsilon)\right)+\\
    &\mathbbm{1}(n_i\!\ge\!2)\left(1-p_i^{n_i}-(1-p_i)^{n_i}\right)[\left(1-0.5\exp(\epsilon(1.5-n_i))\right)\left(0.5\exp(-0.5\epsilon)\right)+\\
&0.5\exp((1.5\!-\!n_i)\epsilon)(1\!-\!0.5\exp(-0.5\epsilon))].
\end{align*}
Assuming $p_i\sim\mbox{beta}(\alpha_1,\alpha_2)$, the shrinkage disclosure risk in cell $\C_i$ is
\begin{align*}
\rho^{\text{s}}_i\!<&\left(1\!-\!\frac{1}{2}e^{-0.5\epsilon}\!\right)\!\!\left(\!1\!-\!\frac{1}{2}e^{(0.5-n_i)\epsilon}\!\right)\int_0^1\!(p_i^{n_i}\!+\!(1\!-\!p_i)^{n_i})\frac{p_i^{\alpha_1-1}(1\!-\!p_i)^{\alpha_2-1}}{B(\alpha_1,\alpha_2)}dp_i+\!\mathbbm{1}(n_i\!\ge\!2)\\
&\times\![(1\!-\!0.5\exp(\epsilon(1.5-n_i)))(0.5\exp(-0.5\epsilon))\!+\!0.5\exp((1.5\!-\!n_i)\epsilon)(1\!-\!0.5\exp(-0.5\epsilon))]\\
&\times\!\int_0^1\!\!\!\left(1\!-\!p_i^{n_i}\!-\!(1\!-\!p_i)^{n_i}\right)\!\frac{p_i^{\alpha_1-1}(1\!-\!p_i)^{\alpha_2-1}}{B(\alpha_1,\alpha_2)}dp_i.\\
=&\frac{(1-\frac{1}{2}e^{-\frac{\epsilon}{2}})(1\!-\!\frac{1}{2}e^{(0.5-n_i)\epsilon})}{B(\alpha_1,\alpha_2)}\!\!\int_{0}^{1}(p_i^{n_i+\alpha_1-1}(1\!-\!p_i)^{\alpha_2-1}\!+\!p_i^{\alpha_1-1}(1\!-\!p_i)^{n_i+\alpha_2-1})dp_i+\\
&\mathbbm{1}(n_i\!\ge\!2)\left(1-\!\frac{1}{B(\alpha_1,\alpha_2)}\int_{0}^{1}(p_i^{n_i+\alpha_1-1}(1\!-\!p_i)^{\alpha_2-1}\!+\!p_i^{\alpha_1-1}(1\!-\!p_i)^{n_i+\alpha_2-1})dp_i\right)\times\\
&[\left(1-0.5\exp(\epsilon(1.5-n_i))\right)\left(0.5\exp(-0.5\epsilon)\right)+0.5\exp((1.5\!-\!n_i)\epsilon)(1\!-\!0.5\exp(-0.5\epsilon))].\\
=&\frac{(1\!-\!\frac{1}{2}e^{-\frac{\epsilon}{2}})\left(\!1\!-\!\frac{1}{2}e^{(0.5-n_i)\epsilon}\right)}{B(\alpha_1,\alpha_2)}(B(n_i\!+\!\alpha_1,\alpha_2)\!+\!B(\alpha_1,n_i\!+\!\alpha_2))+\mathbbm{1}(n_i\!\ge\!2)\left(1-\!\frac{B(n_i\!+\!\alpha_1,\alpha_2)\!+\!B(\alpha_1,n_i\!+\!\alpha_2)}{B(\alpha_1,\alpha_2)}\!\right)\\
&\times[\left(1-0.5\exp(\epsilon(1.5-n_i))\right)\left(0.5\exp(-0.5\epsilon)\right)+0.5\exp((1.5\!-\!n_i)\epsilon)(1\!-\!0.5\exp(-0.5\epsilon))].
\end{align*}

When $K\ge2$, the DR-HA of cell $\C_i$ after sanitization in Scenario 1 is
\begin{align*}
\rho^{\text{l}}_i&=\textstyle\sum_{k=1}^{K}\!\!\left(\Pr(n_{i,k}\!=\!n_i)\Pr(n_{i,k}\!+\!e_{i,k}\!\geqslant\!0.5|n_{i,k}\!=\!n_i)\!\prod_{k'\neq k}\Pr(n_{i,k'}\!+\!e_{i,k'}\!<\!0.5|n_{i,k}\!=\!n_i)\right)\\
&=\textstyle\sum_{k=1}^{K}\left(p_{i,k}^{n_i}\Pr(e_{i,k}\geqslant0.5-n_i)
\prod_{k'\neq k}\Pr(e_{i,k'}<0.5)\right)\\
&=\textstyle\sum_{k=1}^{K}p_{i,k}^{n_i}\left(1-0.5\exp(-0.5\epsilon)\right)^{K-1}\left(1-0.5\exp((0.5-n_i)\epsilon)\right);
\end{align*}
WLOS, let $\{n_{i,1},\dots,n_{i,K}\}=\{n_i-1,1,0,\dots,0\}$ in Scenario 8. Then\small
\begin{align*}
&\rho^{\text{l}}_i<\;\textstyle\!\mathbbm{1}(n_i\!\ge\!2)\!\left(1\!-\!\sum_{k=1}^{K}\!p_{i,k}^{n_i}\!\right)\![\Pr(n_{i,1}\!+\!e_{i,1}\!\geq\!0.5|n_{i,1}\!=\!n_i\!-\!1)\Pr(n_{i,2}\!+\!e_{i,2}\!<\!0.5|n_{i,2}\!=\!1)\times\\
&\prod_{t=3}^K\Pr(n_{i,t}\!+\!e_{i,t}\!<\!0.5|n_{i,t}\!=\!0)\!+\!\Pr(n_{i,1}\!\!+\!\!e_{i,1}\!<\!0.5|n_{i,1}\!=\!n_i\!-\!1)\Pr(n_{i,2}\!+\!e_{i,2}\!\geq\!0.5|n_{i,2}\!=\!1)\prod_{t=3}^K\Pr(n_{i,t}\!+\!e_{i,t}\!<\!0.5|n_{i,t}\!=\!0)\\
\textstyle=&\mathbbm{1}(n_i\!\ge\!2)\!\left(1\!-\!\sum_{k=1}^{K}\!p_{i,k}^{n_i}\right)\![\Pr(e_{i,1}\geq 1.5-n_i)\Pr(e_{i,2}<-0.5)\prod_{t=3}^K\Pr(e_{i,t}<0.5)\!+\!\Pr(e_{i,1}< 1.5-n_i)\Pr(e_{i,2}\geq-0.5)\prod_{t=3}^K\Pr(e_{i,t}<0.5)]\\
=&\mathbbm{1}(n_i\!\ge\!2)\!\left(\!1\!-\!\sum_{k=1}^{K}\!p_{i,k}^{n_i}\!\!\right)\!\!\bigg\{\left(\!1\!-\!\frac{1}{2}\exp((1.5\!-\!n_i)\epsilon)\!\right)\!\!\left(\!\frac{1}{2}\exp(-0.5\epsilon)\right)\!\!\left(\!1\!-\!\frac{1}{2}\exp(-0.5\epsilon)\!\right)^{\!K-2}\!\!\!\!+\!\left(\!\frac{1}{2}\exp((1.5\!-\!n_i)\epsilon)\right)\!\!\left(\!1\!-\!\frac{1}{2}\exp(-0.5\epsilon)\!\right)^{\!K\!-\!1}\bigg\}\\
=&\mathbbm{1}(n_i\!\ge\!2)\!\left(\!1\!-\!\sum_{k=1}^{K}p_{i,k}^{n_i}\!\right)\!(1\!-\!0.5e^{-0.5\epsilon})^{K-2}\times0.5(e^{-0.5\epsilon}+e^{(1.5-n_i)\epsilon}-e^{(1-n_i)\epsilon}).
\end{align*}
\normalsize The expected DR-HA of $Y$ in cell $\C_i$ in the sanitized data is thus
\begin{align*}
\rho^{\text{e}}_i<&\!\bigg(\!\sum_{k=1}^{K}p_{i,k}^{n_i}\!\bigg)\big(1\!-\!0.5e^{-0.5\epsilon}\big)^{K\!-\!1}\!(1\!-\!0.5e^{(0.5-n_i)\epsilon})\!+\!\bigg\{\! \mathbbm{1}(n_i\!\ge\!2)\!\left(\!1\!-\!\sum_{k=1}^{K}p_{i,k}^{n_i}\!\right)\!(1\!-\!0.5e^{-0.5\epsilon})^{K\!-\!2}\\
&\times0.5(e^{-0.5\epsilon}+e^{(1.5-n_i)\epsilon}-e^{(1-n_i)\epsilon})\bigg\}.
\end{align*}
Assuming $(p_{i,1},\ldots,p_{i,K})\overset{\text{ind}}{\sim}\mbox{Dirichlet}(\alpha_{1},\ldots,\alpha_{K})$, the shrinkage DR-HA in cell $\C_i$ is
\small
\begin{align*}
\rho^{\text{s}}_i\!<&\left(1\!-\!0.5e^{-0.5\epsilon}\right)^{K-1}\!\!\left(\!1\!-\!0.5e^{(0.5-n_i)\epsilon}\right)
\int\!\sum_{k=1}^{K}p_{i,k}^{n_i}\!\frac{\Gamma(\sum_{k=1}^K \alpha_{k})}{\prod_{k=1}^K\Gamma(\alpha_{k})}\!\prod_{k=1}^{K}p_{i,k}^{\alpha_k-1}d\mathbf{p}+\!\\
&\mathbbm{1}(n_i\!\ge\!2)(1\!-\!0.5e^{-0.5\epsilon})^{K\!-\!2}\times0.5(e^{-0.5\epsilon}\!+\!e^{(1.5-n_i)\epsilon}\!-\!e^{(1-n_i)\epsilon})\int\!\left(\!1\!-\!\sum_{k=1}^{K}p_{i,k}^{n_i}\!\right)\!\frac{\Gamma(\sum_{k=1}^K \alpha_{k})}{\prod_{k=1}^K\!\Gamma(\alpha_{k})}\prod_{k=1}^{K}p_{i,k}^{\alpha_k-1}d\mathbf{p}\\
=&\left[
\sum_{k=1}^{K}\!\left(\!\int\!p_{i,k}^{n_i}\!\!\prod_{k=1}^{K}p_{i,k}^{\alpha_k-1}\!\frac{\Gamma(\sum_{k}\alpha_{k}\!+\!n_i)}{\Gamma(\alpha_k\!+\!n_i)\!\prod_{k'\ne k}\! \Gamma(\alpha_{k'})}d\mathbf{p}\!\!\right) \!\frac{\Gamma(\sum_{k}\alpha_{k})\Gamma(\alpha_k\!+\!n_i)}{\Gamma(\sum_{k}\alpha_{k}+n_i)\Gamma(\alpha_k)}\!\right]\times\\
&\left(1\!-\!e^{-0.5\epsilon}/2\right)^{\!K-1}\!\left(1\!-\!e^{(0.5-n_i)\epsilon}/2\right)+\mathbbm{1}(n_i\!\ge\!2)\!(1\!-\!0.5e^{-0.5\epsilon})^{\!K\!-\!2}\times\\
&0.5(e^{-0.5\epsilon}\!+\!e^{(1.5-n_i)\epsilon}\!-\!e^{(1-n_i)\epsilon})\!\left(\!1-\!\int\!\!\left(\!\sum_{k=1}^{K}p_{i,k}^{n_i}\!\!\right)\!\!\frac{\Gamma(\sum_{k=1}^K \alpha_{k})}{\prod_{k=1}^K\Gamma(\alpha_{k})}\prod_{k=1}^{K}p_{i,k}^{\alpha_k-1}d\mathbf{p}\!\right)\\
=&\left(\sum_{k=1}^{K}\frac{\Gamma(\sum_k\alpha_k)\Gamma(\alpha_k+n_i)}{\Gamma(\sum_k\alpha_k+n_i)\Gamma(\alpha_k)}\right)\left(1-0.5e^{-0.5\epsilon}\right)^{K-1}\left(1-0.5e^{(0.5-n_i)\epsilon}\right)+\mathbbm{1}(n_i\!\ge\!2)\times\\
&(1\!-\!0.5e^{-0.5\epsilon})^{\!K\!-\!2}\times0.5(e^{-0.5\epsilon}\!+\!e^{(1.5-n_i)\epsilon}\!-\!e^{(1-n_i)\epsilon})\!\left(\!1\!-\!\sum_{k=1}^{K}\frac{\Gamma(\sum_k\alpha_k)\Gamma(\alpha_k\!+\!n_i)}{\Gamma(\sum_k\alpha_k\!+\!n_i)\Gamma(\alpha_k)}\right).
\end{align*}
\end{proof}


\vspace{-24pt}
\section{\large  EB estimation of hyperparameters in Dirichlet Prior} \label{MoM.proof}\vspace{-3pt}
We examine the case of $K=2$ first and then generalize it to the general case of $K\ge2$. When $K=2$,
\begin{align*}
n_{i,1}|p_{i,1}\sim\mbox{Binomial}(n_i,p_{i,1})\\
p_{i,1}\sim\mbox{Beta}(\alpha_1,\alpha_2)\mbox{ for }i=1,\dots,M.
\end{align*}
For each cell $\C_i$, 
$$f(n_{i,1}|\alpha_1,\alpha_2)=\binom{n_i}{n_{i,1}}\frac{B(n_{i,1}+\alpha_1,n_i-n_{i,1}+\alpha_2)}{B(\alpha_1,\alpha_2)},$$
from which we can get
$$E(n_{i,1})=\frac{n_i\alpha_1}{\alpha_1+\alpha_2}\mbox{ and }\mbox{Var}(n_{i,1})=\frac{n_i\alpha_1\alpha_2(\alpha_1+\alpha_2+n_i)}{(\alpha_1+\alpha_2)^2(\alpha_1+\alpha_2+1)}.$$
The variance can be rewritten as 
\begin{align*}
\mbox{Var}(n_{i,1})
=\frac{n_i\alpha_1\alpha_2}{(\alpha_1+\alpha_2)(\alpha_1+\alpha_2+1)}\!+\!\frac{n_i^2\alpha_1\alpha_2}{(\alpha_1+\alpha_2)^2(\alpha_1+\alpha_2+1)}.
\end{align*}
Let $\sum_{i=1}^N n_{i,1}=n_1$, $\sum_{i=1}^N n_i=n$. Assuming $n_{i,1}$ are independent, we have
$$E(n_1)=\frac{n\alpha_1}{\alpha_1+\alpha_2}\mbox{ and }\mbox{Var}(n_1)=\frac{n\alpha_1\alpha_2}{(\alpha_1+\alpha_2)(\alpha_1+\alpha_2+1)}\!+\!\frac{\sum n_i^2\alpha_1\alpha_2}{(\alpha_1+\alpha_2)^2(\alpha_1+\alpha_2+1)}.$$
Let $E(n_1)$ and $\mbox{Var}(n_1)$ equal to their empirical moments $n\hat{p}$ and $s^2=n\hat{p}(1-\hat{p})$, respectively,  where $\hat{p}=n_1/n$, we have
$$\hat{\alpha}_1/(\hat{\alpha}_1+\hat{\alpha}_2)= \hat{p}$$
$$\big(n\hat{p}\hat{\alpha}_2+\hat{p}(1-\hat{p})\sum n_i^2\big)/(\hat{\alpha}_1+\hat{\alpha}_2+1)=s^2,$$
from which we can solve for the MoM estimates of $\alpha_1$ and $\alpha_2$
$$\hat{\alpha}_1=\frac{\hat{p}^2(1-\hat{p})\sum n_i^2-\hat{p}s^2}{s^2-n\hat{p}(1-\hat{p})};\;\hat{\alpha}_2=\frac{\hat{p}(1-\hat{p})^2\sum n_i^2-(1-\hat{p})s^2}{s^2-n\hat{p}(1-\hat{p})}.$$

When $K\geq2$,
\begin{align*}
(n_{i,1},\dots,n_{i,K})|p_{i,1},\dots,p_{i,K}\sim\mbox{multinomial}(n_i,(p_{i,1},\dots,p_{i,K}))\\
(p_{i,1},\dots,p_{i,K})\sim\mbox{Dirichlet}(\alpha_1,\dots,\alpha_K)\mbox{ for }i=1,\dots,M
\end{align*}
Let $\alpha.=\sum_{k=1}^K\alpha_k$ and $p_k=\alpha_k/\alpha.$. For each cell $\C_i$, 
\begin{align*}
&f(n_{i,1},\dots,n_{i,K}|\alpha_1,\dots,\alpha_K)=\frac{\Gamma(\alpha.)}{\Gamma(n_i+\alpha.)}\prod_{k=1}^K\frac{\Gamma(n_{i,k}+\alpha_k)}{\Gamma(\alpha_k)}\\
&E(n_{i,k})=n_ip_k\\
&\mbox{Var}(n_{i,k})=n_ip_k(1-p_k)\left(\frac{n_i+\alpha.}{1+\alpha.}\right);\;
\mbox{Cov}(n_{i,k},n_{i,j})=-n_ip_kp_j\left(\frac{n_i+\alpha.}{1+\alpha.}\right),k\neq j,
\end{align*}
Let $\sum_{i=1}^N n_{i,k}=n_{\cdot k}$, $\sum_{i=1}^N n_i=n$ and assume $n_{i,k}$ is independent across $i$; we have
\begin{align*}
E(n_{\cdot k})=np_k, 
\mbox{Var}(n_{\cdot k})=p_k(1-p_k)\frac{\sum_in_i^2+\alpha.n}{1+\alpha.},\\
\mbox{Cov}(n_{\cdot k},n_{\cdot j})=\sum_i\mbox{Cov}(n_{i,k},n_{i,j})=-\frac{\alpha_k\alpha_j}{\alpha.^2}\left(\frac{\sum n_i^2+\alpha. n}{1+\alpha.}\right),k\neq j.
\end{align*}
Let $\Sigma$ be the covariance matrix of the frequencies $n_{.k}$; its elements can be estimated by
$\hat{\Sigma}_{kk}=(M-1)^{-1}\sum_{i=1}^N(n_{i,k}-\bar{n}_{\cdot k})^2$ and $\hat{\Sigma}_{kj}=(M-1)^{-1}\sum_{i=1}^N(n_{i,k}-\bar{n}_{\cdot k})(n_{i,j'}-\bar{n}_{\cdot j})$ for $k\ne j$,
where $\bar{n}_{\cdot k}=\sum_{i=1}^N n_{i,k}/M$. Set $E(n_{\cdot k})$ and $\mbox{Var}(n_{\cdot k})$ at their empirical moments $n_{\cdot k}$ and  $\hat{\Sigma}_{kk}$, respectively, we have $\hat{p}_k=\hat{\alpha}_k/\hat{\alpha}.= n_{\cdot k}/n$ and 
$\hat{p}_k\left(1-\hat{\theta}_k\right)(\sum n_i^2+\hat{\alpha}. n)/(1+\hat{\alpha}.)=\hat{\Sigma}_{kk}$, where $\hat{\alpha}.=\hat{\alpha}_1+\cdots+\hat{\alpha}_K$, from which we can obtain the MoM estimates of the hyperparameters $(\alpha_1,\dots,\alpha_K)$ 
$$\hat{\alpha}_k=\frac{\hat{p}_k^2(1-\hat{p}_k)\sum n_i^2-\hat{p}_k\hat{\Sigma}_{kk}}{\hat{\Sigma}_{kk}-\hat{p}_k(1-\hat{\theta}_k)n}.$$

\section{\large  Proofs of Theorem 3 and Corollary 4} \label{rho.gau.proof}
\begin{proof}
Similar to the proof in Section \ref{rho.lap.proof}, the DR-HA in Scenario 1
is 
$$\rho^{\text{l}}_i=[\Pr(n_{i,1}=n_i)+\Pr(n_{i,1}=0)]\Pr(e_{i,0}<0.5)\Pr(e_{i,1}\ge0.5-n_i),$$ 
where $e_{i,0}$ and $e_{i,1}$ follow $\mathcal{N}(0,\sigma^2)$. Plugging in  $\frac{1}{2}(1+\mbox{erf}(\frac{x}{\sigma\sqrt{2}}))$, the CDF of $\mathcal{N}(0,\sigma^2)$, we obtain the DR-HA in cell $\C_i$ $$\rho^{\text{l}}_i=\frac{1}{4}\left(p_i^{n_i}+(1-p_i)^{n_i}\right)\left(1+\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)\right)\left(1+\mbox{erf}\left(\frac{n_i-0.5}{\sqrt{2}\sigma}\right)\right).$$
In Scenario 8,
\begin{align*}
\rho^{\text{l}}_i<&\mathbbm{1}(n_i\!\ge\!2)(\Pr(\{n_{i,1}, n_{i,0}\}\!\neq\!\{n_i,0\})(\Pr(e_{i,1}\!\geq\!1.5\!-\!n_i)\Pr(e_{i,0}\!<\!-0.5)+\Pr(e_{i,1}\!<\!1.5\!-\!n_i)\Pr(e_{i,0}\!>\!-0.5))\\
=&\mathbbm{1}(n_i\!\ge\!2)\frac{1}{4}\left(1\!-\!p_i^{n_i}\!-\!(1\!-\!p_i)^{n_i}\!\right)\!\bigg\{\!\left(1\!-\!\mbox{erf}\!\left(\!\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\!\right)\!\right)\!\left(\!1\!+\!\mbox{erf}\!\left(\!\frac{-0.5}{\sqrt{2}\sigma}\!\right)\!\right)\!+\!\left(\!1\!+\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\!\right)\!\left(\!1\!+\!\mbox{erf}\!\left(\frac{0.5}{\sqrt{2}\sigma}\!\right)\!\right)\!\bigg\}.
\end{align*}
The expected DR-HA in cell $\C_i$ is thus
\begin{align*}
\rho^{\text{e}}_i&<\frac{1}{4}\left(p_i^{n_i}+(1-p_i)^{n_i}\right)\left(1+\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)\right)\left(1+\mbox{erf}\left(\frac{n_i-0.5}{\sqrt{2}\sigma}\right)\right)+\\
&\frac{1}{4}\mathbbm{1}(n_i\!\ge\!2)\left(1\!-\!p_i^{n_i}\!-\!(1\!-\!p_i)^{n_i}\!\right)\!\bigg\{\!\left(1\!-\!\mbox{erf}\!\left(\!\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\!\right)\!\right)\!\left(\!1\!+\!\mbox{erf}\!\left(\!\frac{-0.5}{\sqrt{2}\sigma}\!\right)\!\right)\!+\!\left(\!1\!+\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\!\right)\!\left(\!1\!+\!\mbox{erf}\!\left(\frac{0.5}{\sqrt{2}\sigma}\!\right)\!\right)\!\bigg\}.
\end{align*}
The shrinkage DR-HA in cell $\C_i$, assuming $p_i\sim\mbox{beta}(\alpha_1,\alpha_2)$, is 
\small \begin{align*}
\rho^{\text{s}}_i<&\frac{1}{4}\!\left(\!1\!+\!\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)\right)\!\left(\!1\!+\!\mbox{erf}\left(\frac{n_i-0.5}{\sqrt{2}\sigma}\right)\right)\int_{0}^{1}\!\!\left(p_i^{n_i}+(1-p_i)^{n_i}\right)\!\frac{p_i^{\alpha_1-1}(1-p_i)^{\alpha_2-1}}{B(\alpha_1,\alpha_2)}dp_i+\\
&\frac{1}{4}\mathbbm{1}(n_i\!\ge\!2)\!\bigg\{\!\!\left(1\!-\!\mbox{erf}\!\left(\!\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\!\right)\!\right)\!\left(\!1\!+\!\mbox{erf}\!\left(\!\frac{-0.5}{\sqrt{2}\sigma}\!\right)\!\right)\!+\!\left(\!1\!+\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\!\right)\!\left(\!1\!+\!\mbox{erf}\!\left(\frac{0.5}{\sqrt{2}\sigma}\!\right)\!\right)\!\!\bigg\}\\
&\times\int_0^1\!\!\left(1-p_i^{n_i}-(1-p_i)^{n_i}\right)\frac{p_i^{\alpha_1\!-\!1}(1\!-\!p_i)^{\alpha_2\!-\!1}}{B(\alpha_1,\alpha_2)}dp_i\!\\
=&\frac{1}{4B(\alpha_1,\alpha_2)}\left(B(n_i+\alpha_1,\alpha_2)+B(\alpha_1,n_i+\alpha_2)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{n_i\!-\!0.5}{\sqrt{2}\sigma}\right)\right)+\\
&\frac{1}{4}\mathbbm{1}(n_i\!\ge\!2)\!\bigg\{\!\!\left(1\!-\!\mbox{erf}\!\left(\!\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\!\right)\!\right)\!\left(\!1\!+\!\mbox{erf}\!\left(\!\frac{-0.5}{\sqrt{2}\sigma}\!\right)\!\right)\!+\!\left(\!1\!+\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\!\right)\!\left(\!1\!+\!\mbox{erf}\!\left(\frac{0.5}{\sqrt{2}\sigma}\!\right)\!\right)\!\!\bigg\}\!\left(\!1\!-\!\frac{B(n_i+\alpha_1,\alpha_2)\!+\!B(\alpha_1,n_i+\alpha_2)}{B(\alpha_1,\alpha_2)}\right).
\end{align*}
\normalsize

When $K\ge2$, DR-HA in cell $\C_i$ in the sanitized frequency distribution via the Gaussian mechanisms in Scenario 1 is 
\begin{align*}
\rho^{\text{l}}_i&=\sum_{k=1}^{K}\left(\Pr(n_{i,k}\!=\!n_i)\left(\prod_{t\neq k}\Pr(n_{i,t}\!+\!e_{i,t}\!<\!0.5|n_{i,k}\!=\!n_i)\right)\Pr(n_{i,k}\!+\!e_{i,k}\!\geqslant\!0.5|n_{i,k}\!=\!n_i)\!\right)\\
&=\sum_{k=1}^{K}\left(p_{i,k}^{n_i}\left(\prod_{t\neq k}\Pr(e_{i,t}<0.5)\right)P(e_{i,k}\geqslant0.5-n_i)\right)\\
&=\frac{1}{2^K}\left(\sum_{k=1}^{K}p_{i,k}^{n_i}\right)\left(1+\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)\right)^{K-1}\left(1+\mbox{erf}\left(\frac{n_i-0.5}{\sqrt{2}\sigma}\right)\right).
\end{align*}
The DR-HA in Scenario 8 is
\small 
\begin{align*}
\rho^{\text{l}}_i&<\mathbbm{1}(n_i\!\ge\!2)\!\left(1-\sum_{k=1}^K p_{i,k}^{n_i}\right)\bigg\{\!\Pr(e_{i,1}\geq 1.5-n_i)\Pr(e_{i,2}\geq-0.5)\prod_{t=3}^K\Pr(e_{i,t}<0.5)+\\
&\Pr(e_{i,1}< 1.5-n_i)\Pr(e_{i,2}>-0.5)\prod_{t=3}^K\Pr(e_{i,t}<0.5)\!\bigg\}\\
&=\!\mathbbm{1}(n_i\!\ge\!2)\!\left(\!1\!-\!\sum_{k=1}^K p_{i,k}^{n_i}\!\right)\!\frac{1}{2^K}\bigg\{\!\left(1\!-\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{-0.5}{\sqrt{2}\sigma}\right)\!\right)\!\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\right)^{K-2}\!\!\!\!\!+\!\left(\!1\!+\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\!\right)\!\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\!\right)^{K-1}\!\bigg\}\\
&=\!\mathbbm{1}(n_i\!\ge\!2)\!\left(\!1\!-\!\sum_{k=1}^K p_{i,k}^{n_i}\!\right)\!\frac{1}{2^K}\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\right)^{K-2}\bigg\{\!\left(1\!-\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{-0.5}{\sqrt{2}\sigma}\right)\!\right)\!+\!\left(1\!+\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\!\right)\!\bigg\}.
\end{align*}
The expected DR-HA in cell $\C_i$ is
\begin{align*}
\rho^{\text{e}}_i&<\frac{1}{2^K}\left(\sum_{k=1}^{K}p_{i,k}^{n_i}\right)\left(1+\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)\right)^{K-1}\left(1+\mbox{erf}\left(\frac{n_i-0.5}{\sqrt{2}\sigma}\right)\right)+\\
&\mathbbm{1}(n_i\!\ge\!2)\!\left(\!1\!-\!\sum_{k=1}^K p_{i,k}^{n_i}\!\right)\!\frac{1}{2^K}\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\right)^{K-2}\bigg\{\!\left(1\!-\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{-0.5}{\sqrt{2}\sigma}\right)\!\right)\\
&+\!\left(1\!+\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\!\right)\!\bigg\}.
\end{align*}
The shrinkage DR-HA for cell $\C_i$, assuming $\p_i\sim\mbox{Dirichlet}(\alpha_1,\dots,\alpha_K)$, is
\begin{align*}
\rho_i^{\text{s}}&<\left[
\sum_{k=1}^{K}\left(\int\!p_{i,k}^{n_i}\prod_{k=1}^{K}p_{i,k}^{\alpha_k-1}\frac{\Gamma(\sum_k\alpha_k+n_i)}{\Gamma(\alpha_1)\cdots\Gamma(\alpha_k+n_i)\cdots\Gamma(\alpha_K)}d\mathbf{p}\right)\!\frac{\Gamma(\sum_k\alpha_k)\Gamma(\alpha_k+n_i)}{\Gamma(\sum_k\alpha_k+n_i)\Gamma(\alpha_k)}\right]\!\times\\
&\frac{1}{2^{K}}\left(1\!+\!\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)\right)^{K-1}\left(1\!+\!\mbox{erf}\left(\frac{n_i\!-\!0.5}{\sqrt{2}\sigma}\right)\right)+\\
&\mathbbm{1}(n_i\!\ge\!2)\!\left(\!1\!-\!\left[
\sum_{k=1}^{K}\left(\int\!p_{i,k}^{n_i}\prod_{k=1}^{K}p_{i,k}^{\alpha_k-1}\frac{\Gamma(\sum_k\alpha_k\!+\!n_i)}{\Gamma(\alpha_1)\cdots\Gamma(\alpha_k\!+\!n_i)\cdots\Gamma(\alpha_K)}d\mathbf{p}\right)\!\frac{\Gamma(\sum_k\alpha_k)\Gamma(\alpha_k\!+\!n_i)}{\Gamma(\sum_k\alpha_k\!+\!n_i)\Gamma(\alpha_k)}\right]\!\right)\!\\
&\frac{1}{2^K}\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\right)^{K-2}\bigg\{\!\left(1\!-\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{-0.5}{\sqrt{2}\sigma}\right)\!\right)\!+\!\left(1\!+\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\!\right)\!\bigg\}\\
&=\frac{1}{2^{K}}\!\left(
\sum_{k=1}^{K}\frac{\Gamma(\sum_k\alpha_k)\Gamma(\alpha_k+n_i)}{\Gamma(\sum_k\alpha_k+n_i)\Gamma(\alpha_k)}\right)\!\left(1\!+\!\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)\right)^{\!K-1\!}\!\!\left(1\!+\!\mbox{erf}\left(\frac{n_i-0.5}{\sqrt{2}\sigma}\right)\right)+\\
&\mathbbm{1}(n_i\!\ge\!2)\!\left(\!1\!-\!
\sum_{k=1}^{K}\frac{\Gamma(\sum_k\alpha_k)\Gamma(\alpha_k+n_i)}{\Gamma(\sum_k\alpha_k+n_i)\Gamma(\alpha_k)}\!\right)\frac{1}{2^K}\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\right)^{K-2}\\
&\bigg\{\!\left(1\!-\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{-0.5}{\sqrt{2}\sigma}\right)\!\right)\!+\!\left(1\!+\!\mbox{erf}\left(\frac{1.5\!-\!n_i}{\sqrt{2}\sigma}\right)\right)\!\left(1\!+\!\mbox{erf}\left(\frac{0.5}{\sqrt{2}\sigma}\right)\!\right)\!\bigg\}.
\end{align*}
\end{proof}

\vspace{-24pt}
\section{\large special case of Theorems 1 and 3} \label{app:special}\vspace{-6pt}
\begin{cor}\label{cor:rho.lap}
When $K\!=\!2$,  the average local DR-HA in Theorem 1 becomes
\begin{align}
\bar{\rho}^{\text{l}}\!<&\big(1\!-\!\frac{1}{2}e^{-0.5\epsilon}\big)\frac{1}{N}\!\sum_{i=1}^N\!\bigg\{\! 
\mathbbm{1}(|\mathcal{Y}_i|\!=\!1)\big(1\!-\!\frac{1}{2}e^{(0.5-n_i)\epsilon}\big)+\mathbbm{1(|\mathcal{Y}_i|\!>\!1)}\left(e^{-0.5\epsilon}\!+\!e^{(1.5-n_i)\epsilon}\!-\!e^{(1-n_i)\epsilon}\!\right)\!\bigg\};\label{eqn:average.l}
\end{align}
the plug-in estimate of the average expected DR-HA is \vspace{-3pt}
\begin{align}
\bar{\hat{\rho}}^{\text{e}}
&\!<\!\left(1\!-\!\frac{1}{2}e^{-0.5\epsilon}\!\right)\!\frac{1}{N}\!\sum_{i=1}^N\!\left(\hat{p_i}^{n_i}\!\!+\!(1\!-\!\hat{p_i})^{n_i}\right)\!\left(1\!-\!\frac{1}{2}e^{(0.5-n_i)\epsilon}\right)\notag\\
&+\textstyle(2N)^{-1}\!\sum_{i=1}^N\!\big\{\! \mathbbm{1}(n_i\!\ge\!2)\!\left(1-\hat{p_i}^{n_i}\!-\!(1\!-\!\hat{p_i})^{n_i}\right)(e^{-0.5\epsilon}\!+\!e^{(1.5-n_i)\epsilon}\!-\!e^{(1-n_i)\epsilon})\!\big\};\label{eqn:average.e}\vspace{-3pt}
\end{align}
where $\hat{p}_i=n_{i1}/n_i$.  Assume $p_i\sim\mbox{beta}(\alpha_1,\alpha_2)$ for $i=1,\ldots,N$. The average shrinkage DR-HA  is
\begin{align}
\!\!\!\!\bar\rho^{\text{s}}&
<\!\frac{(1\!-\!\frac{1}{2}e^{-0.5\epsilon})}{B(\alpha_1,\alpha_2)N}\!
\sum_{i=1}^N\left(\!1\!-\!\frac{1}{2}e^{(0.5-n_i)\epsilon}\!\right)\!B_{1i}+\textstyle(2N)^{-1}\sum_{i=1}^{N}\big\{\mathbbm{1}(n_i\!\ge\!2)\big(1\!-\!\frac{B_{1i}}{B(\alpha_1,\alpha_2)}\big)(e^{-0.5\epsilon}\!+\!e^{(1.5-n_i)\epsilon}\!-\!e^{(1-n_i)\epsilon})\big\};\label{eqn:average.s}
\end{align}
where $B_{1i}=B(n_i+\alpha_1,\alpha_2)+B(\alpha_1,n_i+\alpha_2)$ and  $B( )$ is the beta function. The plug-in estimate of marginal DR-HA  is
\begin{align}
\bar{\hat{\rho}}^{\text{m}}
&\!<\!\left(1\!-\!\frac{1}{2}e^{-0.5\epsilon}\!\right)\!\frac{1}{N}\!\sum_{i=1}^N\!\big\{\!f(n_i;\bs\beta)\!\left(\hat{p_i}^{n_i}\!\!+\!(1\!-\!\hat{p_i})^{n_i}\right)\big(1\!-\!\frac{1}{2}e^{(0.5-n_i)\epsilon}\big)\!\big\}\notag\\
& +(2N)^{-1}\!\sum_{i=1}^N\!\big\{\! \mathbbm{1}(n_i\!\ge\!2)\!f(n_i;\bs\beta)\left(1-\hat{p_i}^{n_i}\!-\!(1\!-\!\hat{p_i})^{n_i}\right)(e^{-0.5\epsilon}\!+\!e^{(1.5-n_i)\epsilon}\!-\!e^{(1-n_i)\epsilon})\!\big\};\label{eqn:average.m}
\end{align}
and the marginal shrinkage DR-HA  is
\begin{align}
&\rho^{\text{ms}}\!<\!
\frac{(1\!-\!\frac{1}{2}e^{-0.5\epsilon})}{B(\alpha_1,\alpha_2)}\!\!\sum_{n_i=1}^{\infty}\!f(n_i;\bs\beta)\!\left(\!1\!-\!\frac{1}{2}e^{(0.5-n_i)\epsilon}\!\right)\!B_{1i}\!+\!\!\sum_{n_i=2}^{\infty}\!\frac{f(n_i;\bs\beta)}{2}\!\!\left(\!1\!-\!\frac{B_{1i}}{B(\alpha_1,\alpha_2)}\!\right)\!\! (e^{-0.5\epsilon}\!+\!e^{(1.5\!-\!n_i)\epsilon}\!-\!e^{(1\!-\!n_i)\epsilon}).\label{eqn:average.ms}
\end{align}
\end{cor}
\normalsize

\begin{cor}\label{cor:rho.gau}
In the same setting as Theorem 3, when $K=2$, the average local DR-HA  of the sanitized FD is \vspace{-4pt}
\begin{align}
\bar{\rho}^{\text{l}}<&\frac{1}{2^KN}\!\sum_{i=1}^N\!\bigg\{\! 
\mathbbm{1}(|\mathcal{Y}_i|\!=\!1)\!\left(\!1\!+\!\mbox{erf}\!\left(\!\frac{0.5}{\sqrt{2}\sigma}\!\right)\!\!\right)\!\!\left(\!1\!+\!\mbox{erf}\left(\!\frac{n_i\!-\!0.5}{\sqrt{2}\sigma}\!\right)\!\!\right)+\mathbbm{1}(|\mathcal{Y}_i|\!>\!1)E_i\big\};\label{eqn:averagel.gau.MC}
\end{align}
the plug-in estimate of the average expected DR-HA in the sanitized FD via the Gaussian mechanism is
\begin{align}
\bar{\hat{\rho}}^{\text{e}}\!<&\frac{1\!+\!\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)}{4N}\!\sum_{i=1}^N\!\left(\hat{p}_i^{n_i}\!+\!(1\!-\!\hat{p}_i)^{n_i}\right)\!\!\left(1\!+\!\mbox{erf}\left(\frac{n_i-0.5}{\sqrt{2}\sigma}\right)\right)+\!\frac{1}{4N}\!\sum_{i=1}^N\bigg\{
\!\mathbbm{1}(n_i\!\ge\!2)\!\left(1-\hat{p}_i^{n_i}\!-\!(1\!-\!\hat{p}_i)^{n_i}\right)E_i\bigg\};\label{eqn:averagee.gau.MC}
\end{align}
Assume $p_i\!\sim\!\mbox{beta}(\alpha_1,\alpha_2)$, the average shrinkage DR-HA is
\begin{align}
\bar\rho^{\text{s}}<&\frac{\!1\!+\!\mbox{erf}\left(\!\frac{1}{2\sqrt{2}\sigma}\!\right)}{4N\!\cdot\! B(\alpha_1,\alpha_2)}\!\sum_{i=1}^N\bigg\{\left(\!1\!+\!\mbox{erf}\left(\!\frac{n_i-0.5}{\sqrt{2}\sigma}\!\right)\!\right)B_{1i}\bigg\}+\frac{1}{4N}\!\sum_{i=1}^{N}\bigg\{\mathbbm{1}(n_i\!\ge\!2)\!\left(1-\frac{B_{1i}}{B(\alpha_1,\alpha_2)}\right)E_i\bigg\}\label{eqn:averages.gau.MC} ,
\end{align}
where $B_{1i}=B(n_i+\alpha_1,\alpha_2)\!+\!B(\alpha_1,n_i+\alpha_2)$. The plug-in estimate of the average marginal DR-HA is
\begin{align}
&\bar{\hat{\rho}}^{\text{m}}\!<\!\frac{1\!+\!\mbox{erf}\left(\frac{1}{2\sqrt{2}\sigma}\right)}{4N}\!\sum_{i=1}^N\!\!\bigg\{\!\!\left(\hat{p}_i^{n_i}\!+\!(1\!-\!\hat{p}_i)^{n_i}\right)\!\left(\!1\!+\!\mbox{erf} \left(\!\frac{n_i\!-\!0.5}{\sqrt{2}\sigma}\right)\!\!\right)f(n_i;\bs{\beta})\!\bigg\}\!+\!\frac{1}{4N}\!\sum_{i=1}^N\!\bigg\{\!\mathbbm{1}\!(n_i\!\ge\!2)\!\left(1\!-\!\hat{p}_i^{n_i}\!-\!(1\!-\!\hat{p}_i)^{n_i}\right)E_i\!\bigg\}\!\!\label{eqn:averagem.gau.MC}
\end{align}
and the marginal shrinkage DR-HA is
\begin{align}
\rho^{\text{ms}}\!<&\frac{\!1\!+\!\mbox{erf}\!\left(\!\frac{1}{2\sqrt{2}\sigma}\!\right)\!}{4B(\alpha_1,\alpha_2)}\!\sum_{n_i=1}^{\infty}\!\!\bigg\{\!f(n_i;\bs{\beta})\!\left(\!1\!+\!\mbox{erf}\!\left(\frac{n_i\!-\!0.5}{\sqrt{2}\sigma}\!\right)\!\!\right)\!B_{1i}\!\bigg\}\!+\!\frac{1}{4}\!\sum_{n_i=2}^{\infty}\bigg\{f(n_i;\bs{\beta})
\!\left(1-\frac{B_{1i}}{B(\alpha_1,\alpha_2)}\right)E_i\bigg\}.\label{eqn:averagems.gau.2}
\end{align}
\end{cor}


\section{\large Empirical DR-HA with Soft and Hard Thresholding of HR in  Heterogeneous Cells in Sanitized FD via the  Laplace Mechanism in the Adult Data}\label{app:thresholding}\vspace{-6pt}
\begin{figure}[!htb]
\centering\vspace{-6pt}
\includegraphics[width=0.4\textwidth]{figures/thresholding.png}
\vspace{-6pt}
\caption{Empirical evaluation of the disclosure risk in sanitized frequency distribution in the Adult data via the Laplace mechanism}\label{fig:thresholding}
\end{figure}




\end{document}  
 
  
  
  
  
  
  
  
    

