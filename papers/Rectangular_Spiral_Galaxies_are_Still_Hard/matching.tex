In this section, we prove an equivalence between Spiral Galaxies with
$1 \times 1$, $1 \times 3$, and $3 \times 1$ galaxies and
``noncrossing perfect matchings'' in ``distance-2 grid graphs''.
First we define the quoted terms.
A \defn{distance-2 grid graph} $G = (V, E)$ has vertices $V \subset \Z \times \Z$ at a finite subset of the integer lattice, and edges $E = \{(v,w) \mid v, w \in V, \|v-w\| = 2\}$ between all pairs of vertices at Euclidean distance exactly $2$.
A \defn{noncrossing perfect matching} in a distance-2 grid graph $G = (V, E)$
is a partition of the vertices $V$ into $|V|/2$ pairs
such that the length-$2$ segments connecting paired vertices
do not intersect (including at endpoints).

Next we observe that distance-2 grid graphs can always be decomposed into two independent components.
Call a vertex $v = (x,y) \in V$ \defn{even} if $x+y$ is even,
and \defn{odd} if $x+y$ is odd.
Because edges connect vertices of distance exactly $2$,
which is even, vertices of different parity cannot be connected together.
Thus even/odd forms a partition of any distance-2 grid graph.
In the remainder, we restrict to \defn{even} distance-2 grid graphs
whose vertices are all even.

Call a Spiral Galaxies puzzle \defn{even} if all centers are at cell centers and all \emph{empty} cells are at even positions.
We claim that there is a one-to-one correspondence between noncrossing perfect matchings in even distance-2 grid graphs and solutions to even Spiral Galaxies puzzles restricted to $1\times 1$, $1\times 3$, and $3\times 1$ galaxies:

\begin {lemma} \label {lem:equiv}
  Given an even distance-2 grid graph, we can efficiently construct an even Spiral Galaxies puzzle restricted to $1\times 1$, $1\times 3$, and $3\times 1$ galaxies and correspond one-to-one with noncrossing perfect matchings in the distance-2 grid graph. Vice versa, we can reduce from a restricted even Spiral Galaxies puzzle to noncrossing perfect matching in an even distance-2 grid graph.
\end {lemma}

\begin {proof}
  Given an even distance-2 grid graph $G = (V, E)$,
  we construct an even Spiral Galaxies puzzle as follows.
  The board is the bounding box of the vertices $V$ enlarged by $1\over2$ on all sides, aligned so that every vertex of $V$ is placed at the center of a board cell.
  %We assume for ease of exposition that the board has its bottom-left corner at the origin.
  For every \emph{even} cell $(x, y)$ of the board, we place a galaxy center at its center if and only if $(x, y) \notin V$; that is, the vertices of $G$ correspond to empty cells of the board.
  For every \emph{odd} cell $(x, y)$ of the board, we always place a galaxy center at its center.
  
  Similarly, from a given even Spiral Galaxies puzzle, we can construct an even distance-2 grid graph by creating a vertex for every empty board cell. (The edges are implied by the vertices by the definition of distance-2 grid graph.)
  
  We claim that noncrossing perfect matchings of $G$ correspond one-to-one with solutions to the Spiral Galaxies instance restricted to only $1\times1$, $1\times3$, and $3\times1$ galaxies.
  Indeed, all empty cells in the puzzle must be captured by a galaxy, and can be captured only in pairs on opposite sides of a galaxy center (in an odd cell), which in $G$ corresponds to an edge connecting two vertices.
  %\hspace*{2.2cm}$\square$
\end {proof}


Combining Lemma~\ref {lem:equiv} and Theorem~\ref{th:sgr13}
(or equivalently, interpreting the boxes in figures as graph vertices),
we obtain hardness for noncrossing perfect matching:
\begin{corollary}
Noncrossing perfect matching in distance-2 grid graphs
% where edges connect vertices of distance 2 %grid graphs with edge length 2 
is NP-complete and ASP-complete, and counting the number of solutions is \#P-complete.
\end{corollary}


