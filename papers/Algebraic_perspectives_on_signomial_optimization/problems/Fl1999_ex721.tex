\iffalse
    This appears as Problem 7.2.1 in Floudas et al, 1999.
    Floudas et al cite Dembo, 1976.
    
    This appears in Dembo, 1976 as Problem 3.
    Dembo states that the problem is taken from Bracken and McCormick ("Selected applications of nonlinear programming", 1968, pp. 37 -- 45) after eliminating equality constraints through substitution of variables.

    Bracken and McCormick dedicate Chapter 4 of their book to this problem. They state that the problem
    was described by Sauer, Colville, and Burwick [3]. That reference is not available online. Google Scholar
    can produce the citation:
    
        @article{sauer1964computer,
      title={Computer points way to more profits},
      author={Sauer, RN and Colville, AR and Burwick, CW},
      journal={Hydrocarbon Processing},
      volume={84},
      number={2},
      year={1964}
    }
\fi

%\begin{align}
%\min_{\vct{t} \in \R^7_{++}} 
 %           &~    c_1 t_1 + c_2 t_1 t_6 + c_3 t_3 + c_4 t_2 + c_5 - c_6 t_3 t_5                    \\
%&~ 1 \geq c_{7} t_{6}^{2}+c_{8} t_{1}^{-1} t_{3}-c_{9} t_{6} \nonumber \\
%&~ 1 \geq c_{10} t_{1} t_{3}^{-1}+c_{11} t_{1} t_{3}^{-1} t_{6}-c_{12} t_{1} t_{3}^{-1} t_{6}^{2} \nonumber \\
%&~ 1 \geq c_{13} t_{6}^{2}+c_{14} t_{5}-c_{15} t_{4}-c_{16} t_{6} \nonumber \\
%&~ 1 \geq c_{17} t_{5}^{-1}+c_{18} t_{5}^{-1} t_{6}+c_{19} t_{4} t_{5}^{-1}-c_{20} t_{5}^{-1} t_{6}^{2} \nonumber \\
%&~ 1 \geq c_{21} t_{7}+c_{22} t_{2} t_{3}^{-1} t_{4}^{-1}-c_{23} t_{2} t_{3}^{-1} \nonumber \\
%&~ 1 \geq c_{24} t_{7}^{-1}+c_{25} t_{2} t_{3}^{-1} t_{7}^{-1}-c_{26} t_{2} t_{3}^{-1} t_{4}^{-1} t_{7}^{-1} \nonumber \\
%&~ 1 \geq c_{27} t_{5}^{-1}+c_{28} t_{5}^{-1} t_{7} \nonumber \\
%&~ 1 \geq c_{29} t_{5}-c_{30} t_{7} \nonumber \\
%&~ 1 \geq c_{31} t_{3}-c_{32} t_{1} \nonumber \\
%&~ 1 \geq c_{33} t_{1} t_{3}^{-1}+c_{34} t_{3}^{-1} \nonumber \\
%&~ 1 \geq c_{35} t_{2} t_{3}^{-1} t_{4}^{-1}-c_{36} t_{2} t_{3}^{-1} \nonumber \\
%&~ 1 \geq c_{37} t_{4}+c_{38} t_{2}^{-1} t_{3} t_{4} \nonumber \\
%&~ 1 \geq c_{39} t_{1} t_{6}+c_{40} t_{1}-c_{41} t_{3} \nonumber \\
%&~ 1 \geq c_{42} t_{1}^{-1} t_{3}+c_{43} t_{1}^{-1}-c_{44} t_{6} \nonumber \\
%&~ (2000, 120, 3500, 93, 95, 12, 162) \geq \vct{t} \geq 1500, 1, 3000, 85, 90, 3, 145)  \nonumber
%\end{align}

%\begin{align}
%\min_{\vct{t} \in \R^7_{++}} 
%            &~    c_1 t_1 + c_2 t_1 t_6 + c_3 t_3 + c_4 t_2 + c_5 - c_6 t_3 t_5                    \\
%&~ 1 - c_{7} t_{6}^{2}- c_{8} t_{1}^{-1} t_{3} + c_{9} t_{6} \geq 0 \nonumber \\
%&~ 1 - c_{10} t_{1} t_{3}^{-1}- c_{11} t_{1} t_{3}^{-1} t_{6} + c_{12} t_{1} t_{3}^{-1} t_{6}^{2} \geq 0 \nonumber \\
%&~ 1 - c_{13} t_{6}^{2}- c_{14} t_{5} + c_{15} t_{4} + c_{16} t_{6} \geq 0 \nonumber \\
%&~ 1 - c_{17} t_{5}^{-1}- c_{18} t_{5}^{-1} t_{6}- c_{19} t_{4} t_{5}^{-1} + c_{20} t_{5}^{-1} t_{6}^{2} \geq 0 \nonumber \\
%&~ 1 - c_{21} t_{7}- c_{22} t_{2} t_{3}^{-1} t_{4}^{-1} + c_{23} t_{2} t_{3}^{-1} \geq 0 \nonumber \\
%&~ 1 - c_{24} t_{7}^{-1}- c_{25} t_{2} t_{3}^{-1} t_{7}^{-1} + c_{26} t_{2} t_{3}^{-1} t_{4}^{-1} t_{7}^{-1} \geq 0 \nonumber \\
%&~ 1 - c_{27} t_{5}^{-1}- c_{28} t_{5}^{-1} t_{7} \geq 0 \nonumber \\
%&~ 1 - c_{29} t_{5} + c_{30} t_{7} \geq 0 \nonumber \\
%&~ 1 - c_{31} t_{3} + c_{32} t_{1} \geq 0 \nonumber \\
%&~ 1 - c_{33} t_{1} t_{3}^{-1}- c_{34} t_{3}^{-1} \geq 0 \nonumber \\
%&~ 1 - c_{35} t_{2} t_{3}^{-1} t_{4}^{-1} + c_{36} t_{2} t_{3}^{-1} \geq 0 \nonumber \\
%&~ 1 - c_{37} t_{4}- c_{38} t_{2}^{-1} t_{3} t_{4} \geq 0 \nonumber \\
%&~ 1 - c_{39} t_{1} t_{6}- c_{40} t_{1} + c_{41} t_{3} \geq 0 \nonumber \\
%&~ 1 - c_{42} t_{1}^{-1} t_{3}- c_{43} t_{1}^{-1} + c_{44} t_{6} \geq 0 \nonumber \\
%&~ (2000, 120, 3500, 93, 95, 12, 162) \geq \vct{t} \geq (1500, 1, 3000, 85, 90, 3, 145)  \nonumber
%\end{align}

%\begin{align}
%\min_{\vct{t} \in \R^7_{++}} 
%            &~    c_1 t_1 + c_2 t_1 t_6 + c_3 t_3 + c_4 t_2 + c_5 - c_6 t_3 t_5                    \\
%&~ 1 - c_{7} t_{6}^{2}- c_{8} t_{1}^{-1} t_{3} + c_{9} t_{6} \geq 0 \nonumber \\
%&~ \textcolor{blue}{ t_1 - c_{7} t_1 t_{6}^{2}- c_{8} t_{3} + c_{9} t_1 t_{6} \geq 0 } \nonumber \\
%&~ 1 - c_{10} t_{1} t_{3}^{-1}- c_{11} t_{1} t_{3}^{-1} t_{6} + c_{12} t_{1} t_{3}^{-1} t_{6}^{2} \geq 0 \nonumber \\
%&~ \textcolor{blue}{t_3 - c_{10} t_{1} - c_{11} t_{1} t_{6} + c_{12} t_{1} t_{6}^{2} \geq 0} \nonumber \\
%&~ 1 - c_{13} t_{6}^{2}- c_{14} t_{5} + c_{15} t_{4} + c_{16} t_{6} \geq 0 \nonumber \\
%&~ \textcolor{blue}{1 - c_{13} t_{6}^{2}- c_{14} t_{5} + c_{15} t_{4} + c_{16} t_{6} \geq 0} \nonumber \\
%&~ 1 - c_{17} t_{5}^{-1}- c_{18} t_{5}^{-1} t_{6}- c_{19} t_{4} t_{5}^{-1} + c_{20} t_{5}^{-1} t_{6}^{2} \geq 0 \nonumber \\
%&~ \textcolor{blue}{t_5 - c_{17} - c_{18} t_{6}- c_{19} t_{4} + c_{20} t_{6}^{2} \geq 0} \nonumber \\
%&~ 1 - c_{21} t_{7}- c_{22} t_{2} t_{3}^{-1} t_{4}^{-1} + c_{23} t_{2} t_{3}^{-1} \geq 0 \nonumber \\
%&~ \textcolor{blue}{t_3 t_4 - c_{21} t_3 t_4 t_7 - c_{22} t_{2} + c_{23} t_{2} t_4 \geq 0} \nonumber \\
%&~ 1 - c_{24} t_{7}^{-1}- c_{25} t_{2} t_{3}^{-1} t_{7}^{-1} + c_{26} t_{2} t_{3}^{-1} t_{4}^{-1} t_{7}^{-1} \geq 0 \nonumber \\
%&~ \textcolor{blue}{t_3 t_4 t_7 - c_{24} t_3 t_4 - c_{25} t_{2} t_{4} + c_{26} t_{2} \geq 0} \nonumber \\
%&~ 1 - c_{27} t_{5}^{-1}- c_{28} t_{5}^{-1} t_{7} \geq 0 \nonumber \\
%&~ \textcolor{blue}{t_5 - c_{27} - c_{28} t_{7} \geq 0} \nonumber \\
%&~ 1 - c_{29} t_{5} + c_{30} t_{7} \geq 0 \nonumber \\
%&~ \textcolor{blue}{1 - c_{29} t_{5} + c_{30} t_{7} \geq 0} \nonumber \\
%&~ 1 - c_{31} t_{3} + c_{32} t_{1} \geq 0 \nonumber \\
%&~ \textcolor{blue}{1 - c_{31} t_{3} + c_{32} t_{1} \geq 0} \nonumber \\
%&~ 1 - c_{33} t_{1} t_{3}^{-1}- c_{34} t_{3}^{-1} \geq 0 \nonumber \\
%&~ \textcolor{blue}{t_3 - c_{33} t_{1} - c_{34} \geq 0} \nonumber \\
%&~ 1 - c_{35} t_{2} t_{3}^{-1} t_{4}^{-1} + c_{36} t_{2} t_{3}^{-1} \geq 0 \nonumber \\
%&~ \textcolor{blue}{t_3 t_4 - c_{35} t_{2} + c_{36} t_{2} t_4 \geq 0} \nonumber \\
%&~ 1 - c_{37} t_{4}- c_{38} t_{2}^{-1} t_{3} t_{4} \geq 0 \nonumber \\
%&~ \textcolor{blue}{t_2 - c_{37} t_2 t_{4} - c_{38} t_{3} t_{4} \geq 0} \nonumber \\
%&~ 1 - c_{39} t_{1} t_{6}- c_{40} t_{1} + c_{41} t_{3} \geq 0 \nonumber \\
%&~ \textcolor{blue}{1 - c_{39} t_{1} t_{6}- c_{40} t_{1} + c_{41} t_{3} \geq 0} \nonumber \\
%&~ 1 - c_{42} t_{1}^{-1} t_{3}- c_{43} t_{1}^{-1} + c_{44} t_{6} \geq 0 \nonumber \\
%&~ \textcolor{blue}{t_1 - c_{42} t_{3}- c_{43} + c_{44} t_1 t_{6} \geq 0} \nonumber \\
%&~ (2000,\, 120,\, 3500,\, 93,\, 95,\, 12,\, 162) - \vct{t} \geq \vct{0} \nonumber \\
%&~ \vct{t} - (1500,\, 1,\, 3000,\, 85,\, 90,\, 3,\, 145) \geq \vct{0}. \nonumber
%\end{align}

\subsection{A benchmark in alkylation process design}

Our next problem captures the design of an alkylation process in chemical engineering.
A detailed derivation of the original model (in ten variables) may be found in \cite{bracken1968selected} and the now-standard formulation (in seven variables) can be found in \cite[7.2.1]{Floudas1999}.
In order to make comparisons between SAGE relaxations and Moment-SOS relaxations we have cleared denominators in the signomial program \cite[7.2.1]{Floudas1999} to obtain a cubic polynomial optimization problem.
All coefficients in the formulation are positive and are given in the appendix.

\begin{align}
\min_{\vct{t} \in \R^7_{++}} 
            &~    c_1 t_1 + c_2 t_1 t_6 + c_3 t_3 + c_4 t_2 + c_5 - c_6 t_3 t_5                   \label{prob:ex2} \\
\text{s.t.} &~ t_1 - c_{7} t_1 t_{6}^{2}- c_{8} t_{3} + c_{9} t_1 t_{6} \geq 0 \nonumber \\
&~ t_3 - c_{10} t_{1} - c_{11} t_{1} t_{6} + c_{12} t_{1} t_{6}^{2} \geq 0 \nonumber \\
&~ 1 - c_{13} t_{6}^{2}- c_{14} t_{5} + c_{15} t_{4} + c_{16} t_{6} \geq 0 \nonumber \\
&~ t_5 - c_{17} - c_{18} t_{6}- c_{19} t_{4} + c_{20} t_{6}^{2} \geq 0 \nonumber \\
&~ t_3 t_4 - c_{21} t_3 t_4 t_7 - c_{22} t_{2} + c_{23} t_{2} t_4 \geq 0 \nonumber \\
&~ t_3 t_4 t_7 - c_{24} t_3 t_4 - c_{25} t_{2} t_{4} + c_{26} t_{2} \geq 0 \nonumber \\
&~ t_5 - c_{27} - c_{28} t_{7} \geq 0 \qquad 1 - c_{29} t_{5} + c_{30} t_{7} \geq 0 \nonumber \\
&~ 1 - c_{31} t_{3} + c_{32} t_{1} \geq 0 \qquad t_3 - c_{33} t_{1} - c_{34} \geq 0 \nonumber \\
&~ t_3 t_4 - c_{35} t_{2} + c_{36} t_{2} t_4 \geq 0 \qquad t_2 - c_{37} t_2 t_{4} - c_{38} t_{3} t_{4} \geq 0 \nonumber \\
&~ 1 - c_{39} t_{1} t_{6}- c_{40} t_{1} + c_{41} t_{3} \geq 0 \nonumber \\
&~ t_1 - c_{42} t_{3}- c_{43} + c_{44} t_1 t_{6} \geq 0 \nonumber \\
&~ (2000,\, 120,\, 3500,\, 93,\, 95,\, 12,\, 162) - \vct{t} \geq \vct{0} \nonumber \\
&~ \vct{t} - (1500,\, 1,\, 3000,\, 85,\, 90,\, 3,\, 145) \geq \vct{0}. \nonumber
\end{align}



In order to reflect the polynomial structure in \eqref{prob:ex2} we set $\cA = \{\vct{0},\vct{\delta}_1,\ldots,\vct{\delta}_7\}$.
We approach this problem first through conditional SAGE.
Let $X$ be the set defined by the seventeen signomial inequalities $g(\vct{x}) \geq 0$ where $g$ has exactly one positive term, and have $G$ include all twenty-eight constraints.
Table \ref{tab:ex2:original} shows the results of using MOSEK 9.2 to compute $f_K^{(3)}$ and $f_K^{(4)}$ for \eqref{prob:ex2}.
The reported solutions are feasible up to relative error at most $10^{-8}$, however the primal solutions exhibit substantial absolute constraint violation.


\begin{table}[ht!]
    \caption{MOSEK solution summary for SAGE relaxations to Problem \eqref{prob:ex2}. The primal and dual objectives agree to six significant digits. The four-tuples give a solution's $\ell_{\infty}$-norm, then violations of elementwise affine constraints, violations of bound constraints, and violations of conic constraints.}
    \centering
    \begin{tabular}{ccccc} % use \textcolor{white}{1} to get proper spacing.
    $d$ & objective & time & primal soln. norm \& viols. & dual soln. norm \& viols.  \\ \hline
      3 & 1224.52 & \textcolor{white}{00}8.64 & $(1\cdot 10^{8},\, 3\cdot 10^{-2},\, 3\cdot 10^{-3},\, 0)$ & $(3\cdot 10^{10},\, 0,\, 8\cdot 10^{-6},\, 0)$  \\
      4 & 1285.98 & 104.45 & $(8\cdot 10^{7},\, 2\cdot 10^{-1},\, 1\cdot 10^{-1},\, 0)$ & $(1\cdot 10^{10},\, 0,\, 2\cdot 10^{-6},\, 0)$ \\
    \end{tabular}
    \label{tab:ex2:original}
\end{table}

The solution quality data in Table \ref{tab:ex2:original} lead us to speculate that (1) the reported objective is larger than actually possible for a feasible primal solution and (2) the given dual solution is actually suboptimal.
We can validate this speculation by considering a rescaled version of the problem.
Specifically, we consider the change of variables
\[
    %\vct{t} \leftarrow 10\left(\frac{t_1}{2000},\, \frac{t_2}{120},\, \frac{t_3}{3500},\, \frac{t_4}{93},\, \frac{t_5}{95},\, \frac{t_6}{12},\, \frac{t_7}{162}\right)
    \vct{\hat{t}} \leftarrow (t_i u_i\,/\,10)_{i=1}^7 \quad \text{ for } \quad \vct{u} = (2000,\, 120,\, 3500,\, 93,\, 95,\, 12,\, 162)
\]
When considered in terms of exponential-form signomials this amounts to an affine shift $\vct{\hat{x}} \leftarrow \vct{x} - \log(10/\vct{u})$.
Table \ref{tab:ex2:rescaled} provides bounds and solver runtimes for this rescaled problem using both $X$-SAGE (conditional SAGE) and $\R^n$-SAGE (ordinary SAGE).
Applying solution recovery to the dual $X$-SAGE relaxation with $d=4$ produces a de-scaled solution
\[
    \vct{t}^\star \approx (1698.192,~  53.662,~ 3031.305,~   90.109,~   95.000,~   10.500,~  153.540)
    %\begin{cases}
        %array([1698.19,   53.66, 3031.31,   90.11,   95.  ,   10.5 ,  153.54])
    %    array([1698.19,   53.66, 3031.31,   90.11,   95.  ,   10.5 ,  153.54])
    %\end{cases}
\]
that is feasible within absolute error $3 \cdot 10^{-7}$ and satisfies $f(\log \vct{t}^\star) \approx 1227.23$.
The matching $X$-SAGE and $\R^n$-SAGE bounds show this is essentially optimal.
Note that in contrast to the runtime performance of $X$-SAGE and $\R^n$-SAGE relaxations for Problem \eqref{prob:ex1}, here the $X$-SAGE approach solves Problem \eqref{prob:ex2} over eight times faster than the $\R^n$-SAGE approach.

\begin{table}[ht!]
    \caption{SAGE bounds and solve times for the rescaled version of Problem \eqref{prob:ex2}.}
    \centering
    \begin{tabular}{c|cc|cc|} % use \textcolor{white}{2} to get proper spacing.
     & \multicolumn{2}{c}{$\cA$-degree $d$ SAGE bound} & \multicolumn{2}{|c|}{solver runtime} \\ 
    $d$ & conditional & ordinary & conditional & ordinary  \\ \hline
      3 & 1206.86 & 1125.12 & \textcolor{white}{2}3.83 & \textcolor{white}{22}2.83  \\
      4 & 1227.23 & 1224.98 & 50.56 & \textcolor{white}{2}84.12  \\
      %      4 & 1227.2265 & 1224.9820 & 50.5623 & \textcolor{white}{2}84.1217  \\
      5 & - & 1227.23 & - & 429.43 \\
      % 5 & - & 1227.2259 & - & 429.4254 \\
    \end{tabular}
    \label{tab:ex2:rescaled}
\end{table}