\section{Introduction}

In the previous chapter, it was considered that the payloads do not change during the flight. However, in many practical applications, payload mass varies abruptly: for example, dropping relief material, adding construction material during vertical movement (cf. Fig. \ref{fig:dyn}). Such abrupt changes give rise to switched dynamics: switched systems are an important class of hybrid systems that consists of subsystems with continuous dynamics, where at any given time instant, one subsystem remains active while others being inactive. Switching between active and inactive subsystems is governed by a switching law \cite{liberzon2003switching}.

In the quest to operate a quadrotor under various sources of parametric uncertainty, the control regime, after initial model based designs (cf. the survey paper \cite{rubisurvey} for the evolutions of various designs), has inevitably moved to some notable adaptive control works \cite{nicol2011robust, bialy2013lyapunov, dydek2012adaptive, ha2014passivity, mofid2018adaptive, tran2018adaptive, tian2019adaptive, zhao2014nonlinear, yang2019energy, roy2021artificial}. However, no adaptive design addresses the issue of switched dynamics as discussed earlier. On the other hand, extending these works to a switched dynamics scenario would rely on finding a common Lyapunov function, which again is difficult (if at all possible) to achieve in practical systems \cite{lai2018adaptive}. 

Therefore, a relevant question arises whether the existing switched adaptive control designs \cite{lai2018adaptive,yuan2018robust,yuan2017adaptive,lou2018immersion, chen2018global,8362915, 7782779, roy2019reduced, roy2019simultaneous, roy2020vanishing} (and references therein) can be applied to a switched quadrotor system while carrying an uncertain (and possibly unknown) payload. Unfortunately, existing literature does not present a positive answer to this: though \cite{roy2019reduced, roy2019simultaneous} do not rely on the structure of system dynamics in contrast to state of the art, they still require bound knowledge of the uncertain mass/inertia terms to design either control law \cite{roy2019simultaneous} or switching law \cite{roy2019reduced}. 

 %With applications in various domains ranging from networked control systems, intelligent transportation systems, power electronics to robotics, the switched systems framework has been very attractive to the control systems community over the past decades  \cite{zhang2010asynchronously,zhao2012stability,allerhand2011robust, zhao2015adaptive,wu2009stabilizing,yuan2018novel} (see also references therein). 

% In the quest to operate switched systems under various unknown scenarios and to adapt the control law so as to cope with various sources of parametric uncertainty, some notable adaptive control works are reported for linear (\cite{di2013hybrid,sang2012adaptive,yuan2018robust,yuan2017adaptive}) as well as nonlinear switched systems (\cite{lou2018immersion,lai2018adaptive,chiang2014adaptive,
% long2015switched,wang2015adaptive,aghababa2019finite}). However, only a few of the aforementioned control designs can tackle the unavoidable unmodelled dynamics and external disturbances (i.e., provide a robust adaptation in the sense of \cite{ioannou1996robust}). These works include \cite{yuan2018robust} for time-driven slow switching (e.g., dwell time or average dwell-time switching via multiple Lyapunov functions) and \cite{aghababa2019finite} for arbitrary switching (by assuming a common Lyapunov function). Slow switching is typically more relevant because, as observed by many researchers (e.g., \cite{lai2018adaptive,long2015switched}), obtaining a common Lyapunov function and a common robust adaptive law to attain arbitrary switching can be difficult and often not possible. %At the same time, robust adaptation via multiple Lyapunov functions has also limitations: the leakage action in \cite{yuan2018robust} requires to decrease the control gains of inactive subsystems exponentially leading to poor control performance for a subsystem that is activated after a long time. 
%
%Switched Euler-Lagrange (EL) systems is an extension to the standard EL systems that arises naturally in many electro-mechanical systems \cite{spong2008robot, liberzon2003switching}. Therefore, a relevant question arises: to which extent is the state-of-the-art adaptive control for switched systems applicable to switched EL systems? If not, then how much such an extension is possible with the state-of-the-art adaptive control for non-switched EL systems. 
%In this regard, the following observations are made:

%\begin{itemize}{
%\item Under the effects of commonly occuring static Coulomb friction, Stribeck friction etc. for an EL system \cite{annaswamy1998adaptive}, the smoothness property of the subsystem dynamics required in \cite{long2015switched, chiang2014adaptive, lai2018adaptive, zhai2017prescribed,wang2015adaptive} may be violated.

%\item The assumption of a constant upper bound on the unmodelled dynamics as in \cite{aghababa2019finite} restricts the applicability, as unmodelled dynamics are typically state-dependent. In addition to this, \cite{zhai2017prescribed} assumes a quite restrictive global Lipschitz property for the nonlinear subsystem dynamics.

%\item Most state-of-the-art adaptive control designs, irrespective of considering switched or non-switched dynamics, rely upon the system dynamics to be linear in parameters (LIP) \cite{lou2018immersion,lai2018adaptive,chiang2014adaptive,patre2011modular,feng2018distributed, patre2010composite,rosa2018adaptive,spong1990adaptive,ortega1989adaptive}. Also, LIP-based designs built upon the state-space model of the system \cite{lou2018immersion,lai2018adaptive,chiang2014adaptive} cannot be applied to a state-space model of EL system, which is always nonlinear in parameters (NLIP) due to inversion of the mass matrix.

%\item The designs capable to handle NLIP dynamics as in \cite{long2015switched,wang2015adaptive} demand detailed structural knowledge of the system in order to appropriately select the regressor terms in the adaptive law. As a result, the number of unknown parameters to be adapted increases with system complexity. 

%\item The adaptive control designs for switched \cite{zhai2017prescribed, chiang2014adaptive, lai2018adaptive, long2015switched,wang2015adaptive} and non-switched \cite{patre2011modular,patre2010composite,feng2018distributed} systems assume the dynamics terms to be at least continuously differentiable. when $\boldsymbol \tau_{\sigma} = \mathbf 0$. 
%However, such condition fails to hold for many practical systems due to commonly occuring friction effects, e.g. static Coulomb friction (e.g., robotic manipulators), Stribeck friction (high precision systems \cite{annaswamy1998adaptive}) etc.

%\item Stabilizing slow switching laws are designed based on multiple Lyapunov functions, exploiting the condition of exponential decrease in between switching instants and bounded jumps at switching instants. It turns out that, in the presence of uncertain dynamics, not all Lyapunov-based arguments proposed for non-switched EL systems  avoid acceleration measurement-based adaptive control design as in \cite{spong1990adaptive}, two categories of works are reported: one that utilizes filtering method but assumes LIP system structure 
%(cf. \cite{patre2010composite,rosa2018adaptive,spong1990adaptive,ortega1989adaptive,roy2018adaptive,patre2011modular,feng2018distributed} and references therein) can be directly extended to the slowly switching scenario (cf. Remark 4). Fundamental trade-offs arise from considering uncertain dynamics with unknown uncertainty bounds. Aside requirement of structural knowledge for the first category, the works in the second category cannot be extended to time-dependent switching when mass matrix of EL system is unknown (cf. Corollary 1 for details).
%}
%\end{itemize}
In light of the above discussions, an adaptive switched framework that can tackle completely unknown dynamics of quadrotor in a switched dynamics setting is still missing. Toward this direction, the proposed switched adaptive solution has the following major contributions:
\begin{itemize}
	\item A switched dynamics for quadrotor is formulated which suitably represents the changing dynamics during a vertical (lifting/dropping) operation under dynamic variation of payload.
	\item Compared to the state-of-the-art, the proposed adaptive law and switching law do not require any a priori knowledge of the system dynamics parameters and payload. Further, differently from \cite{nicol2011robust, mofid2018adaptive}, the effects of cross-coupling terms arising from the lateral motion are considered as state-dependent uncertainty. 
	
	
\end{itemize} 

The rest of the chapter is organized as follows: Section 3.2 describes the switched quadrotor systems and highlights various issues in the state of the art; Section 3.3 details the proposed control framework, while the corresponding stability analysis is carried out in Section 3.4 and a simulation study is provided in Section 3.5.
\section{System Dynamics and Problem Formulation}
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{LaTex/figures/exp_1.jpg}%{FIG5_16-TIE-3042.eps}
	\caption{{Schematic depicting vertical operation with dynamic payload.}}\label{fig:dyn} % (the response of link 1 is omitted due to the limited space)
\end{figure}

Let us consider the dynamics of quadrotor as given in Ch. 1:

\begin{align}\label{sw_pos_dyn}
    &m 
    \begin{bmatrix}
        \ddot{x}\\ 
        \ddot{y}\\ 
        \ddot{z}
    \end{bmatrix} + 
    \begin{bmatrix}
        0\\ 
        0\\ 
        mg
    \end{bmatrix} = \mathbf{R}^T 
    \begin{bmatrix}
        0\\ 
        0\\
        T_{th}
    \end{bmatrix}
\end{align}
\begin{align}
    &\frac{I_{xx}}{l}\ddot{\phi} + \frac{I_{zz}-I_{yy}}{l}\dot{\varphi}\dot{\psi} = \tau_\phi,\nonumber\\
&\frac{I_{yy}}{l}\ddot{\varphi} + \frac{I_{xx}-I_{zz}}{l}\dot{\phi}\dot{\psi}= \tau_\varphi, \nonumber\\
& I_{zz}\ddot{\psi} + (I_{yy}-I_{xx})\dot{\varphi}\dot{\phi}= \tau_\psi, 
\end{align} \label{sw_att_sub}
with the rotation matrix $\mathbf R$ is given by 
$$\mathbf{R} =\begin{bmatrix}
		c_\psi c_\varphi & s_\psi c_\varphi & -s_\varphi \\
		c_\psi s_\varphi s_\phi  - s_\psi c_\phi & s_\psi s_\varphi s_\phi  + c_\psi c_\phi & s_\phi  c_\varphi\\
		 c_\psi s_\varphi c_\phi + s_\psi s_\phi  &  s_\psi s_\varphi c_\phi - c_\psi s_\phi  & c_\varphi c_\phi
		\end{bmatrix}$$
where, $c_{(\cdot)},s_{(\cdot)}$ denote $\cos_{(\cdot)},\sin_{(\cdot)}$; $m$ is the mass of the overall system.

Multiplying both side of the position subsystem (\ref{sw_pos_dyn}) with the rotation matrix, $\mathbf{R}$ yields
\begin{subequations}\label{pos_dyn_mod}
	\begin{align}
	&	m\ddot{x}c_{\psi}c_{\varphi} + m\ddot{y}s_{\psi}c_{\varphi} - m\ddot{z}s_{\varphi} - mgs_{\varphi} = 0, \\
	&	m\ddot{x}(c_{\psi}s_{\varphi}s_{\phi} - s_{\psi}c_{\phi}) + m\ddot{y}(s_{\psi}s_{\varphi}s_{\phi} + c_{\psi}c_{\phi}) + m\ddot{z}s_{\phi}c_{\varphi} + mgs_{\phi}c_{\varphi} = 0 , \\
	&	m\ddot{x}(c_{\psi}s_{\varphi}c_{\phi} + s_{\psi}s_{\phi}) + m\ddot{y}(s_{\psi}s_{\varphi}c_{\phi} - c_{\psi}s_{\phi}) + m\ddot{z}c_{\varphi}c_{\phi} + mgc_{\varphi}c_{\phi} = T_{th}.
	\end{align}
\end{subequations}
%\begin{remark}
%	The above mathematical arrangement helps to avoid singularity while computing $T_{th}$ and consequently avoids any a priori boundedness assumption on $\phi$ and $\varphi$ as in \cite{bialy2013lyapunov}. 
%\end{remark} 
After such rearrangements of the dynamics, we are now ready to define the (non-switched) four degrees-of-freedom dynamics structure suitable for collocated design as
\begin{equation}\label{sys_non_sw}
\mathbf M( \mathbf q)\ddot{ \mathbf q}+\mathbf C(\mathbf q,\dot{\mathbf q})\dot{\mathbf q}+\mathbf G(\mathbf q)+\mathbf{H}( \mathbf q)\ddot{ \mathbf{q}}_{\mathbf u}=\boldsymbol \tau,
\end{equation} 
where
\begin{align}
&\mathbf M =
\begin{bmatrix}
m(c_{\varphi}c_{\phi}) & 0 & 0 & 0 \\
0 & \frac{I_{xx}}{l} & 0 & 0\\
0 & 0 & \frac{I_{yy}}{l} & 0\\
0 & 0 & 0 & I_{zz}\\	
\end{bmatrix},~
\mathbf G = 
\begin{bmatrix}
mg(c_{\varphi}c_{\phi}) \\ 0 \\ 0 \\ 0
\end{bmatrix} \\
& \mathbf C = 
\begin{bmatrix}
0 & 0 & 0 & 0 \\ 
0 & 0 & 0 & \frac{(I_{zz} - I_{yy})}{l}\dot{\varphi}\\
0 & \frac{(I_{xx} - I_{zz})}{l}\dot{\psi} & 0 & 0 \\ 
0 & 0 & {(I_{yy} - I_{xx})}\dot{\phi}& 0
\end{bmatrix}	,\\
& \mathbf{H}=
\begin{bmatrix}
m(c_{\psi}s_{\varphi}c_{\phi} + s_{\psi}s_{\phi})  & m(s_{\psi}s_{\varphi}c_{\phi} - c_{\psi} s_{\phi}) \\ 
0 & 0\\
0 & 0 \\ 
0 & 0 
\end{bmatrix},\\
& \boldsymbol \tau = 
\begin{bmatrix}
T_{th} \\ \tau_\phi \\ \tau_\varphi \\ \tau_\psi
\end{bmatrix}, ~\mathbf q = 
\begin{bmatrix}
z \\ \phi \\ \varphi \\ \psi
\end{bmatrix},~\mathbf{q_u} = 
\begin{bmatrix}
x \\ y
\end{bmatrix}.
\end{align}


During a vertical operation, a quadrotor needs to maintain a given (possibly time-varying) height ($z$) and attitude $(\phi, \varphi, \psi)$, at a fixed $(x,y)$ position. Under such scenario, and based on the underactuated dynamics model as in (\ref{sys_non_sw}), a switched quadrotor dynamics (cf. Fig. \ref{fig:dyn}) for vertical operations can be represented as 
\begin{equation}\label{sys_1}
\mathbf M_{\sigma}( \mathbf q)\ddot{ \mathbf q}+\mathbf C_{\sigma}(\mathbf q,\dot{\mathbf q})\dot{\mathbf q}+\mathbf G_{\sigma}(\mathbf q)+\mathbf{H}_\sigma( \mathbf q)\ddot{ \mathbf{q}}_{\mathbf u}+\mathbf{ d}_{\sigma}=\boldsymbol \tau_{\sigma},
\end{equation} 
where $\mathbf{q}=\lbrace z, \phi, \varphi, \psi \rbrace$ and $\mathbf{q_u}=\lbrace x,y \rbrace$; for each subsystem $\sigma$, $\mathbf{M_{\sigma}(q)}\in\mathbb{R}^{4\times 4}$ is the mass/inertia matrix; $\mathbf C_{\sigma}(\mathbf q,\dot{\mathbf q})\in\mathbb{R}^{4 \times 4}$ denote the Coriolis, centripetal terms; $\mathbf G_{\sigma}(\mathbf q)\in\mathbb{R}^{4}$ denotes the gravity vector; $\mathbf{H}_\sigma( \mathbf q)\ddot{ \mathbf{q}}_{\mathbf u}\in\mathbb{R}^{4}$ represents the vector of cross-coupling terms stemming from $(x,y)$ sub-dynamics; $\mathbf{ d_{\sigma}}(t) \in \mathbb{R}^4$ denotes bounded external disturbance and $\boldsymbol \tau_{\sigma} \in \mathbb{R}^4$ is the control input. The mapping from $\mathbf \tau$ to thrust and torques of individual motors are discussed in Sect. \ref{sec:asmc_sim}. %, where . % is a compact index set. %Further, let $N$ denotes the number of subsystems. %A large number of practical systems follow the EL dynamics (\ref{sys_1}) such as
%\begin{remark}
%It is considered that the number actuated states are not fewer than that of the unactuated states. Any two degrees of freedom system would satisfy this criterion (e.g., Acrobot \cite{spong1996energy}, Pendubot \cite{shoji2013throwing}, overhead crane system \cite{lu2018continuous}). Nevertheless, the majority of the practically relevant higher order EL systems reported in the literatures also satisfy the condition (e.g., aircraft, helicopters \cite{olfati2002normal}, quadrotors \cite{zhao2015}, crane systems \cite{lu2018antiswing, fang2012motion, qian2018switching, cheng1996controller, sun2015new}, communication satellite systems \cite{ashrafiuon2008sliding}, ships and underwater vehicles \cite{fossen1994guidance}, robotic system \cite{spong1996energy,huang2018disturbance} etc. ). %shoji2013throwing,
%\end{remark}

Here $\sigma(t) : [0~\infty) \mapsto \Omega$ is a piecewise constant function of time, called the switching signal, taking values in $\Omega=\lbrace 1,2, \cdots,N \rbrace $. The following class of slowly-switching signals is considered: %Let $\mathcal{N}(p)$ denote the set of inactive subsystems when $p$ denote an active subsystem.
\begin{mydef}
	Average Dwell Time (ADT) \cite{hespanha1999stability}: For a switching signal $\sigma(t)$ and each $t_2 \geq t_1 \geq 0$, let $N_{\sigma}(t_1,t_2)$ denote the number of discontinuities in the interval $[t_1,t_2)$. Then $\sigma(t)$ has an average dwell time $\vartheta$ if for a given scalar $N_0 >0$
	\begin{align*}
	N_{\sigma}(t_1,t_2) \leq N_0 + (t_2-t_1)/\vartheta,~~ \forall t_2 \geq t_1 \geq 0
	\end{align*}
	where $N_0$ is termed as chatter bound.
\end{mydef}

As the quadrotor dynamics (\ref{sys_1}) follows the celebrated Euler-Lagrange dynamics formulation \cite{tang2015mixed}, each subsystem in (\ref{sys_1}) presents a few interesting properties (cf. \cite{spong2008robot}), which are later exploited for control design as well as stability analysis:

%\noindent \textbf{Property 1:} %Let, $\hat{C}(q,\dot{q})$ denotes the nominal value of $C(q,\dot{q})$. Then, 
%The matrix $(\dot{\mathbf M}-2{\mathbf C})$ is skew symmetric. \\
\noindent \textbf{Property 1:} $\exists \overline c_{\sigma }, \overline g_{\sigma }, \overline h_{\sigma },\overline{d}_{\sigma} \in \mathbb{R}^{+}$ such that $||\mathbf C_{\sigma}(\mathbf q,\dot{\mathbf q})|| \leq \overline c_{\sigma } ||\dot{\mathbf q}||$, $||\mathbf{G_{\sigma}(q)}|| \leq \overline g_{\sigma }$, $||\mathbf{H}_\sigma( \mathbf q)|| \leq \overline h_{\sigma }$ and $||\mathbf{d_{\sigma}}(t)|| \leq \overline{d}_{\sigma}$.\\
\textbf{Property 2:} The matrix $\mathbf{M_{\sigma}(q)}$ is symmetric and uniformly positive definite $\forall \mathbf{q}$, implying that $\exists \underline m_{\sigma}, \overline m_{\sigma} \in \mathbb{R}^{+}$ such that
\begin{equation}\label{prop 3}
0 < \underline m_{ \sigma} \mathbf I \leq \mathbf{M_{\sigma}(q)} \leq \overline m_{ \sigma} \mathbf I .
\end{equation}
%\textbf{Property 3:} The matrix $(\dot{\mathbf M}_\sigma(\mathbf q) -2\mathbf{C_{\sigma}(q,\dot{q})})$ is skew symmetric, i.e., for any non-zero vector $\mathbf z$, we have $\mathbf z^T(\dot{\mathbf M}_\sigma(\mathbf q)\-2\mathbf{C_{\sigma}(q,\dot{q})})\mathbf{z}=0$.
%\textbf{Property 4:} $\exists C_b \in \mathbb{R}^{+}$ such that $||\mathbf{C(q,\dot{q})}|| \leq C_b ||\dot{\mathbf q}||$.

%
%Let us consider the tracking problem for a desired trajectory $\mathbf q_{\sigma}^d(t) $ satisfying the following assumption.
%\begin{assum}\label{assm2}
%The desired trajectories are selected such that $\mathbf{q}_{\sigma}^d,\dot{\mathbf q}_{\sigma}^d, \ddot{\mathbf q}_{\sigma}^d \in \mathcal{L}_{\infty}$. % and $\mathbf{q}, \dot{\mathbf{q}}$ are available as feedback.
%\end{assum}
%%Let $\mathbf q^d(t) \triangleq [ {\mathbf {q_a}^{d}}^T ~ {\mathbf {q_u}^{d}}^T]^T$ is the desired trajectory to be tracked and it is selected such that $\dot{\mathbf q}^d, \ddot{\mathbf q}^d \in \mathcal{L}_{\infty}$.
%%\end{assum}
%Let $\mathbf {e}(t) \triangleq \mathbf q(t)-\mathbf {q}_{\sigma(t)}^d(t)$ be the tracking error. We define a filtered tracking error variable $\mathbf r$ as
%\begin{equation}
%\mathbf r \triangleq \dot{\mathbf e}+ \boldsymbol \Phi\mathbf e , \label{r} %\Rightarrow r= \Gamma \xi
%\end{equation}
%where $\boldsymbol \Phi\in \mathbb{R}^{n \times n}$ is a positive definite matrix. In the following, let us omit the variable dependency of various matrices and vectors whenever convenient. 
%
%Multiplying the time derivative of (\ref{r}) by $\mathbf M_{\sigma}$ and using (\ref{sys_1}) yields the closed-loop system 
%\begin{align}
%\mathbf {M}_{\sigma}\dot{\mathbf r}&= \mathbf M_{\sigma}(\ddot{\mathbf q}-\ddot{\mathbf q}^d+ \boldsymbol \Phi\dot{\mathbf e})\nonumber\\
%&= \boldsymbol \tau_{\sigma}- \mathbf{C_{\sigma}r}+ \boldsymbol \varphi_{\sigma}, \label{r dot}
%\end{align}
%where $\boldsymbol \varphi_{\sigma} \triangleq -(\mathbf C_{\sigma} \dot{\mathbf q}+ \mathbf{g_{\sigma}+f_{\sigma}+d}_{\sigma}+ \mathbf M_{\sigma} \ddot{\mathbf q}^d - \mathbf M_{\sigma} \boldsymbol \Phi\dot{\mathbf e}-\mathbf{C_{\sigma}r})$ represents the overall uncertainty. 
%
%
%Further, let us define $\boldsymbol \xi=[\mathbf e^T ~ \dot{\mathbf e}^T]^T $. Then using the facts $||\boldsymbol \xi|| \geq || \mathbf e|| , || \boldsymbol \xi|| \geq || \dot{\mathbf e} || $, Assumption 1 and, Properties $1$ and $2$, 
%%\begin{equation}
%%|| \mathbf f_{\sigma}(\mathbf x) ||\leq \theta_{0 \sigma} + \theta_{1 \sigma} ||\mathbf x||+ \theta_{2 \sigma} ||\mathbf x||^2  \triangleq \mathbf{Y}^T_{\sigma}(|| \mathbf x ||) \boldsymbol \Theta_{\sigma}, \label{sigma_sys} 
%%\end{equation}
%%where $\mathbf{Y_{\sigma}(||x ||)=[1~||x||~||x||}^2]^T$, $\boldsymbol \Theta_{\sigma}=[\theta_{0\sigma} ~\theta_{1\sigma} ~\theta_{2\sigma}]^T$ and $\theta_{i \sigma} \in \mathbb{R}^{+}$ $i=0,1,2$ are finite but \emph{unknown scalars}, according to the available knowledge of system (\ref{sys_1}). 
%%Hence, using Assumptions 1 and 2, 
%one can verify the existence of $\theta_{i \sigma}^{*}  \in \mathbb{R}^{+}$ $i=0,1,2$ such that for all $\sigma \in \Omega$
%\begin{equation}
%|| \boldsymbol \varphi_{\sigma} ||\leq \theta_{0 \sigma}^{*} + \theta_{1 \sigma}^{*}  ||  \boldsymbol{ \xi} ||+  \theta_{2 \sigma}^{*}  ||  \boldsymbol{ \xi} ||^2 \triangleq \mathbf{Y}_{\sigma}^T(|| \boldsymbol{ \xi}||) \boldsymbol \Theta_{\sigma}^{*} , \label{psi_bound} 
%\end{equation}
%where $\theta_{i \sigma}^{*} $'s are \textit{unknown} finite scalars and $\boldsymbol \Theta_{\sigma}^{*}=[\theta_{0\sigma}^{*} ~\theta_{1\sigma}^{*} ~\theta_{2\sigma}^{*}]^T$.

A few remarks regarding system (\ref{sys_1}) follow, which aid in designing the proposed switching control. 
\begin{remark}[(Uncertainty)]
	As a design challenge, the switched system (\ref{sys_1}) is considered to be unknown in the sense that the knowledge of $\mathbf{M}_\sigma,\mathbf{C_\sigma,H_\sigma, G_\sigma, d}_{\sigma}$ and their corresponding bounds, i.e., $\underline{m}_{\sigma}, \overline{m}_{\sigma}, \overline c_{\sigma }, \overline g_{\sigma }, \overline h_{\sigma },\overline{d}_{\sigma}$ are \textit{completely unknown}. 
\end{remark}
\begin{remark}[(Collocated Design)]\label{remark_collocated}
	Note that a quadrotor dynamics is essentially underactuated, where $x$ and $y$ positions represent the non actuated coordinates. During a vertical operation (i.e., a near hovering condition), there exist time-scale separation between $(z, \phi, \varphi, \psi)$ and $(x,y)$ dynamics, where the former evolves faster than the later \cite{dydek2012adaptive}. Therefore, it is standard to track only the actuated coordinates $(z, \phi, \varphi, \psi )$ of a quadrotor during such operation \cite{mofid2018adaptive, nicol2011robust}. In the literature of underactuated systems, such control design, i.e., tracking of only actuated coordinates, is called \textit{collocated design} (cf. \cite{shkolnik2008high,spong1994partial}). %A simultaneous switched tracking controller for all the actuated and non-actuated coordinates, in line with \cite{roy2020towards}, can also be a challenging future work.
\end{remark}
%\begin{remark}[No structural knowledge]\label{remark_nlip}
%This work, in contrast to the conventional adaptive designs \cite{lou2018immersion,lai2018adaptive,chiang2014adaptive,patre2011modular,feng2018distributed, patre2010composite,rosa2018adaptive,spong1990adaptive,ortega1989adaptive,long2015switched,wang2015adaptive}, utilizes Properties 1 and 2 which do not require LIP structure and furthermore, do not impose structural knowledge of the system in order to appropriately select
%the regressor terms in the adaptive law. % structure (i.e., LIP or NLIP) of (\ref{sys_1}) to be unknown for control design.
%The state-of-the-art adaptive control designs (for swithced as well as non-switched systems) rely upon the uncertain system dynamics being in linear in parameters (LIP), as in \cite{lou2018immersion,lai2018adaptive,chiang2014adaptive,noghreian2018adaptive,patre2011modular,feng2018distributed, patre2010composite,rosa2018adaptive,spong1990adaptive,ortega1989adaptive}, or nonlinear in parameters (NLIP) form as in \cite{long2015switched,wang2015adaptive}. Such designs, however, demand structural knowledge of the system in order to appropriately select the regressor terms in the adaptive law: as a result, the number of unknown parameters to be adapted increases with system complexity. 
%It is noteworthy that the LIP-based designs \cite{lou2018immersion,lai2018adaptive,chiang2014adaptive,noghreian2018adaptive} are built upon the state-space model of the system. However, a state-space model of EL system (\ref{sys_1}) is always NLIP due to inversion of $\mathbf M_\sigma$.
% In this work, we aim to build a different adaptive control framework for EL systems, only relying on the upper bound structure (\ref{psi_bound}). The benefit is twofold: (i) any prerequisite of structural knowledge gets eliminated as (\ref{psi_bound}) is satisfied for any EL system (\ref{sys_1}) irrespective of its (LIP or NLIP) structure owing to its Properties 1-2; (ii) we only have to adapt three unknown parameters ($\theta_{0 \sigma}^{*}, \theta_{1 \sigma}^{*}$ and $\theta_{2 \sigma}^{*}$) for any subsystem, irrespective
%of the system structure or complexity. 
%\end{remark}
\begin{remark}[(Cross-coupling terms)]
	Notwithstanding slow evolution of the lateral (i.e., $(x,y)$) motion compared to the vertical ($z$) and attitude $( \phi, \varphi, \psi )$ motions due to time-scale separation, ignoring its effect is conservative: especially, variation in payload and perturbation in attitude may cause some lateral motion, affecting $\mathbf{q}$. Therefore, differently form \cite{mofid2018adaptive, nicol2011robust}, the cross-coupling term $\mathbf{H}_\sigma( \mathbf q)\ddot{ \mathbf{q}}_{\mathbf u}$ is considered in (\ref{sys_1}), where $\mathbf{H}_\sigma( \mathbf q)$ captures the effects of variations in payload and attitude (cf. Appendix).
\end{remark}
\textbf{Control Problem:} Under Properties 1 and 2, to design a switched adaptive control framework for a vertical operation of a quadrotor following the dynamics (\ref{sys_1}), without any knowledge of system parameters (in line with Remark 1). %(ii) without imposing any smoorthness proerty on system dynamics (as mentioned in Remark 3). %, that can tackle unmodelled dynamics without putting any \textit{a priori} constant upper bound on them. % while avoiding any monotonically increasing nature of control gains and without the need to update the gains for inactive subsystems while providing the necessary leakage action. 

The following section solves this control problem. 

\section{Switched Controller Design}
%Let us consider the tracking problem such that \cite{roy2017adaptive, spong1990adaptive}: 
\begin{assum}[\cite{roy2017adaptive, spong1990adaptive}]\label{assm2}
	The desired trajectories satisfy $\mathbf{q}^d,\dot{\mathbf q}^d, \ddot{\mathbf q}^d \in \mathcal{L}_{\infty}$. Furthermore, $\mathbf{q}, \dot{\mathbf{q}},\ddot{\mathbf q}$ are available for feedback.
\end{assum}
For control design purposes, the dynamics (\ref{sys_1}) is re-arranged as
\begin{equation}\label{sys_2}
\mathbf D_\sigma \ddot{ \mathbf q}+\mathbf E_{\sigma}(\mathbf q,\dot{\mathbf q}, \ddot{\mathbf q},\ddot{\mathbf q}_{\mathbf u},t)=\boldsymbol \tau_{\sigma},
\end{equation} 
which has been obtained by adding and subtracting $\mathbf{D}_\sigma \ddot{\mathbf q}$ to (\ref{sys_1}), where $\mathbf D_\sigma$ is a user-defined constant positive definite matrix and $\mathbf E_{\sigma} \triangleq (\mathbf M_{\sigma}-\mathbf D_\sigma)\ddot{ \mathbf q}+\mathbf C_{\sigma}\dot{\mathbf q}+\mathbf G_{\sigma}+ \mathbf{H}_\sigma\ddot{ \mathbf{q}}_{\mathbf u}+\mathbf{ d}_{\sigma}$. The selection of $\mathbf D_\sigma$ would be discussed later (cf. Remark \ref{select_d}). %for a desired trajectory $\mathbf q_{\sigma}^d(t) $ satisfying the following assumption:

%Let $\mathbf q^d(t) \triangleq [ {\mathbf {q_a}^{d}}^T ~ {\mathbf {q_u}^{d}}^T]^T$ is the desired trajectory to be tracked and it is selected such that $\dot{\mathbf q}^d, \ddot{\mathbf q}^d \in \mathcal{L}_{\infty}$.
%\end{assum}

Let $\mathbf {e}(t) \triangleq \mathbf q(t)-\mathbf {q}^d(t)$ be the tracking error, $\boldsymbol \xi (t) \triangleq [\mathbf e(t),~\dot{\mathbf {e}}(t)]$ and $\mathbf r_{\sigma}$ be the filtered tracking error variable defined as
\begin{align}
\mathbf{r}_{\sigma} \triangleq \mathbf{B}^T \mathbf{P}_{\sigma} \boldsymbol \xi, \qquad \sigma \in \Omega \label{r}
\end{align}
where $\mathbf{P}_{\sigma}  >\mathbf 0$ is the solution to the Lyapunov equation $\mathbf{A}_{\sigma}^T \mathbf P_{\sigma} + \mathbf {P_{\sigma} A_{\sigma}}= -\mathbf Q_{\sigma}$ for some $\mathbf{Q}_{\sigma} >\mathbf 0$, $\mathbf A_{\sigma} \triangleq \begin{bmatrix}
\mathbf 0 & \mathbf I\\ 
- \mathbf K_{1\sigma}&  - \mathbf K_{2\sigma}
\end{bmatrix}$ and $\mathbf B \triangleq \begin{bmatrix}
\mathbf 0 &
\mathbf I
\end{bmatrix}^T$. Here, $\mathbf K_{1\sigma}$ and $\mathbf K_{2\sigma}$, are two user-defined positive definite gain matrices and their positive definiteness guarantees that $\mathbf{A}_{\sigma}$ is Hurwitz.

The control law is designed as
\begin{subequations}\label{split_input}
	\begin{align} 
	\boldsymbol \tau_{\sigma} & = \mathbf D_\sigma (-\boldsymbol{\Lambda}_{\sigma} \boldsymbol{ \xi} -\Delta \boldsymbol \tau_{\sigma}+ \ddot{\mathbf{q}}^d),   \label{input}\\
	~ \Delta \boldsymbol \tau_{\sigma}&=\begin{cases}
	{\rho_\sigma}\frac{\mathbf r_\sigma}{|| \mathbf r_\sigma||}       & ~ \text{if } || \mathbf r_\sigma|| \geq \varpi\\
	{\rho_\sigma}\frac{\mathbf r_\sigma}{\varpi}        & ~ \text{if } || \mathbf r_\sigma || < \varpi\\
	\end{cases}, \label{rob}
	\end{align}
\end{subequations}
where $\boldsymbol \Lambda_{\sigma} \triangleq [\mathbf K_{1\sigma}~\mathbf K_{2\sigma}] $; $\varpi >0$ is a user-defined scalar to avoid chattering and the %gain $\rho_{\sigma}$ tackles the uncertainties. The 
design of $\rho_\sigma$ will be discussed later.
%\begin{remark}
%For the sake of a generalized approach, we have considered $n \neq m$ and hence the generalized inverse $(\cdot)^{\dagger}$ in (\ref{input}). Nevertheless, for practical systems like EL systems representing (\ref{sys}), $\mathbf{b}$ represents inverse of {mass matrix}, which is always positive definite and thus, invertible \cite{spong2008robot}. Therefore, $\hat{\mathbf b}$ for these class of systems can always be designed to be invertible.
%\end{remark}
%Let $\boldsymbol \eta_{\sigma} \triangleq (-\boldsymbol{\Lambda}_{\sigma} \boldsymbol{ \xi} -\rho_{\sigma}\mathbf r_{\sigma}+ \ddot{\mathbf{q}}_{\sigma}^d)$.
Substituting (\ref{input}) in (\ref{sys_2}) yields
\begin{align}
%\ddot{\mathbf e} & = \ddot{\mathbf q} -\ddot{\mathbf q}_{\sigma}^d \nonumber\\
%& = \mathbf f_{\sigma} + \mathbf{b}_{\sigma} \boldsymbol \tau_{\sigma} -\ddot{\mathbf q}_{\sigma}^d \nonumber\\
\ddot{\mathbf e}  = -\boldsymbol{\Lambda}_{\sigma} \boldsymbol{ \xi} - \Delta \boldsymbol \tau_{\sigma}+\boldsymbol \chi_{\sigma}, \label{e_ddot}
\end{align}
where $\boldsymbol \chi_{\sigma} \triangleq -\mathbf D_\sigma^{-1} \mathbf{E}_{\sigma}$ is defined as the \emph{overall uncertainty}. Using Properties 1, 2 and Assumption 1 one can verify that 
\begin{equation}
|| \boldsymbol \chi_{\sigma}||\leq \theta_{0 \sigma}^{*} + \theta_{1 \sigma}^{*}  ||  \boldsymbol{ \xi} ||+ \theta_{2\sigma}^{*}  ||  \boldsymbol{ \xi} ||^2+ \theta_{3\sigma}^{*}  ||  \ddot{\overline{\mathbf{ q}}} ||\triangleq \mathbf{Y}_{\sigma}^T \boldsymbol \Theta_{\sigma}^{*} , \label{psi_bound} 
\end{equation}
where $\overline{\mathbf{q}}=[\mathbf{q}^T~\mathbf{q}_{\mathbf u}^T]^T$; $\mathbf{Y}_{\sigma}=[1~||  \boldsymbol{ \xi} ||~ ||  \boldsymbol{ \xi} ||^2~||\ddot{\overline{\mathbf q}}||]^T $ and $\boldsymbol \Theta_{\sigma}^{*}=[\theta_{0\sigma}^{*} ~\theta_{1\sigma}^{*} ~\theta_{2\sigma}^{*}~ \theta_{3 \sigma}^{*}]^T$. The scalars $\theta_{i \sigma}^{*} \in \mathbb{R}^{+}$ $i=0,\cdots,3$ are unknown $\forall \sigma \in \Omega$ and they are defined as 
\begin{align*}
\theta_{0 \sigma}^{*} &= || \mathbf D_\sigma^{-1} || (\overline{g}_\sigma+\overline{d}_\sigma + \overline{c}_\sigma || \dot{\mathbf{q}}^d ||^2), \\
\theta_{1 \sigma}^{*} &= 2  \overline{c}_\sigma || \mathbf D_\sigma^{-1} |||| \dot{\mathbf{q}}^d ||,\\
\theta_{2 \sigma}^{*} &= \overline{c}_\sigma || \mathbf D_\sigma^{-1} ||,  \\
\theta_{3 \sigma}^{*} &= || \mathbf D_\sigma^{-1} \mathbf{M}_\sigma - \mathbf{I} || +  || \mathbf D_\sigma^{-1} || \overline{h}.
\end{align*}
The upper bound structure (\ref{psi_bound}) is obtained by using the following relations $\mathbf{q}=\mathbf{e}+\mathbf{q}^d$, $\dot{\mathbf{q}}=\dot{\mathbf{e}}+\dot{\mathbf{q}}^d$, $||\boldsymbol \xi || \geq || \mathbf{e} ||$ and $||\boldsymbol \xi || \geq || \dot{\mathbf{e}} ||$ (cf. \cite{roy2019adaptive,roy2020adaptive} for details). %After defining the upper bound structures of $|| \boldsymbol \Psi_\sigma ||$ in (\ref{psi_bound}), 

Based on the upper bound structure in (\ref{psi_bound}), the gain $\rho_{\sigma}$ in (\ref{input}) is designed as
\begin{align}
\rho_{\sigma} &= \hat{\theta}_{0 \sigma}+ \hat{\theta}_{1 \sigma} ||  \boldsymbol{ \xi} ||+ \hat{\theta}_{2\sigma}||  \boldsymbol{ \xi} ||^2 +\hat{\theta}_{3 \sigma} || \ddot{\overline{\mathbf{q}}}|| +\zeta_\sigma+ \gamma_\sigma \nonumber\\
&\triangleq \mathbf{Y}^T_{\sigma}\hat{\boldsymbol \Theta}_{\sigma}+ \zeta_\sigma+ \gamma_\sigma, \label{rho}
\end{align}
where $\hat{\boldsymbol \Theta}_{\sigma} \triangleq [\hat{\theta}_{0\sigma} ~ \hat{\theta}_{1\sigma} ~\hat{\theta}_{2\sigma}~ \hat{\theta}_{3 \sigma}]^T$ and $\zeta_\sigma, \gamma_\sigma$ are auxiliary gains needed for closed-loop stabilization. 
%Let $p$ denotes the index of the subsytem active for $t \in [t_l ~ t_{l+1})$. Then defining $\eta \triangleq \max_{p \in \Omega} \lambda_{\max}(\mathbf P_p)$, the gains $\hat{\theta}_{ip}, \gamma_{ip}$ are evaluated using the following laws:
%\begin{subequations}\label{split_adap}
%\begin{align}
%& \dot{\hat{\theta}}_{ip} =\eta || \boldsymbol \xi ||^{i+1} - \alpha_{ip}{\hat{\theta}}_{ip},~~\dot{\hat{\theta}}_{i \overline p} =\eta || \boldsymbol \xi ||^{i+1} - \alpha_{i \overline p}{\hat{\theta}}_{i \overline p},  \label{hat_theta} \\
%& \dot{\gamma}_{ip} = - \left(\beta_{ip}+ \epsilon_{ip}\eta{\hat{\theta}}_{ip}  || \boldsymbol \xi ||^{i+2} \right) {\gamma}_{ip} +  \beta_{ip}  \underline{\epsilon}_{ip} \label{gamma}, \\
%& \dot{\gamma}_{i \overline p} = - \left(\beta_{i \overline p}+ \epsilon_{i \overline p}\eta{\hat{\theta}}_{i \overline p}  || \boldsymbol \xi ||^{i+1} \right) {\gamma}_{i \overline p} +  \beta_{i \overline p}  \underline{\epsilon}_{i \overline p} \label{gamma1},\\
%& \text{with}~ \hat{\theta}_{ip} (t_0),~\hat{\theta}_{i \overline p} (t_0) > 0, ~ \gamma_{ip}(t_0) > \underline{\epsilon}_{ip},~ \gamma_{i \overline p}(t_0) > \underline{\epsilon}_{i \overline p},\label{init} 
%\end{align}
%\end{subequations}
Defining $\varrho_\sigma \triangleq ({\lambda_{\min}( \mathbf{Q}_{\sigma} )}/{\lambda_{\max}( \mathbf{P}_{\sigma} )})$, the gains $\hat{\theta}_{i\sigma}, \zeta_\sigma$ and $ \gamma_{\sigma}$ are adapted using the following laws:
\begin{subequations}\label{split_adap}
	\begin{align}
	& \dot{\hat{\theta}}_{jp} =|| \mathbf{r}_p|| || \boldsymbol \xi ||^{j} - \alpha_{jp}{\hat{\theta}}_{j p},~\dot{\hat{\theta}}_{j \overline p}=0,~j=0,1,2 \label{hat_theta1}\\
	&\dot{\hat{\theta}}_{3p} =|| \mathbf{r}_p|| || \ddot{\overline{\mathbf q}} || - \alpha_{3p }{\hat{\theta}}_{3 p},~\dot{\hat{\theta}}_{3 \overline p}=0 \label{hat_theta} \\
	& \dot{\zeta}_{p} = - \left(1 + \hat{\theta}_{3p} || \ddot{\overline{\mathbf q}} || | \mathbf{r}_p || \right) {\zeta}_{ p}+  \bar{\epsilon}_{ p},~ \dot{\zeta}_{\overline p} = 0 \label{zeta}, \\
	& \dot{\gamma}_{p} = 0,~ \dot{\gamma}_{\overline p} = - \left(1 + \frac{\varrho_{\overline{p}}}{2} \sum_{i=0}^{3}{\hat{\theta}}_{i \overline p}^2   \right) {\gamma}_{\overline p} +  {\epsilon}_{\overline p} \label{gamma}, \\
	&\text{with}~\alpha_{i\sigma}> \varrho_{\sigma}/2, ~i=0,1,2,3, \label{alpha}\\
	& \hat{\theta}_{i\sigma} (t_0)>0,~\zeta_{\sigma}(t_0)=\bar{\zeta}_{\sigma} > {\bar \epsilon}_{\sigma }, ~ \gamma_{\sigma}(t_0)=\bar{\gamma}_{\sigma} > {\epsilon}_{\sigma },\label{init} 
	\end{align}
\end{subequations}
where $p$ and $\overline{p} \in \Omega \backslash \lbrace p \rbrace$ denote the active and inactive subsystems respectively; $\alpha_{ip},\bar{\epsilon}_p,\epsilon_{\overline{p}} \in \mathbb{R}^{+}$ are static design scalars and $t_0$ is the initial time. 
%\begin{remark}

We define $\varrho_{M \sigma} \triangleq \lambda_{\max}( \mathbf{P}_{\sigma} ),~ \varrho_{m\sigma} \triangleq \lambda_{\min}( \mathbf{P}_{\sigma} )$, ${\bar{\varrho}_M} \triangleq \max_{\sigma \in \Omega}(\varrho_{M\sigma})$ and ${\underline{\varrho}_m} \triangleq \min_{\sigma \in \Omega} (\varrho_{m\sigma})$. Following Definition 1 of ADT \cite{hespanha1999stability}, the switching law is proposed as
\begin{align}
\vartheta > \vartheta^{*} =  \ln \mu/{\kappa},  \label{sw_law}
\end{align}
where $\mu \triangleq {\bar{\varrho}_M} / \underline{\varrho}_{m}$; $\kappa$ is a scalar defined as $0< \kappa < \varrho$ where $\varrho \triangleq \min_{\sigma \in \Omega}({\lambda_{\min}( \mathbf{Q}_{\sigma} )}/{\lambda_{\max}( \mathbf{P}_{\sigma} )})$.

%While \emph{not using knowledge of the system parameters and structure}, the proposed control and adaptive laws require acceleration measurements (cf. (\ref{rho}), (\ref{hat_theta}), (\ref{zeta})). The following remarks highlight that, in the presence of system uncertainty, the use of acceleration measurements seems unavoidable. %measurement in terms \textit{necessity} and \textit{availability} while achieving the design challenge outlined in Remark 1:
\begin{remark}[On the use of acceleration measurements]
	Being primarily intended for outdoor applications, use of inertial navigation
	systems with accelerometers are quite common for quadrotor systems \cite{ha2014passivity, lee2012experimental}. %Therefore, use of acceleration feedback in the proposed design is not a hindrance for practical implementation. 
	Intial pioneering adaptive control designs for (non-switched) systems made use of acceleration measurements \cite{spong1990adaptive}, which was later avoided due to want of sensors. Nevertheless, with the technological advancements and with cheaper prices, usage of acceleration feedback can be found nowadays in many (non-switched) robust and adaptive designs (cf. \cite{roy2019, roy2017adaptive, roy2020adaptive, cst_new} and references therein). 
	%A practical argumentation behind
	%the possibility to get acceleration measurements is that nowadays inertial navigation
	%systems with accelerometers are cheap and commonly used. One might wonder why not trying to estimate acceleration instead. Adaptive works have appeared \cite{nicosia1990robot,berghuis1993global,roy2019adaptive} where velocity and acceleration measurements are estimated for control design of (non-switched) EL systems. However, partial system dynamics knowledge is typically required, e.g., knowledge of $\mathbf{E}_\sigma$ as in \cite{nicosia1990robot,berghuis1993global} or upper bound knowledge of mass matrix as in \cite{roy2019adaptive}. These observations further substantiate the necessity of acceleration measurement in the presence of fully uncertain dynamics.
	
	%Pioneering adaptive control designs for (non-switched) EL systems made use of acceleration measurements \cite{spong1990adaptive}; later, the need for acceleration measurements was removed by introducing in the Lyapunov function a quadratic term depending on the mass matrix (cf. \cite[\S4]{ortega1989adaptive}). Therefore, the state-of-the-art adaptive %control methods for EL systems rely upon two categories of Lyapunov-based stability analysis: one that explicitly involves the mass matrix $\mathbf{M}_\sigma$ (cf. \cite{roy2018adaptive,patre2011modular,feng2018distributed} and references therein) and the one that does not (cf. the inverse-dynamics based designs \cite{patre2010composite,rosa2018adaptive,spong1990adaptive,ortega1989adaptive} and references therein). The designs in the first category typically do not require acceleration measurements. However, both categories %from a theory point of view, bring the difficulty %that stability is not based on Lyapunov arguments, but on swapping lemmas and input-output properties of time-varying systems. This might be the reason why many works appearing on EL systems, based on Lyapunov arguments, still rely on use of mass matrix in the Lyapunov function candidate and that one must 
	%impose LIP structure on the system. % mentioned in Remark \ref{remark_nlip}. % (a condition that we will be able to remove). %This is the case, for example of recent works \cite{patre2010composite,roy2018adaptive,patre2011modular}, and of most works on multi-agent EL systems \cite{rosa2018adaptive, feng2018distributed}. The underlying argument 
	%%A practical argumentation behind the use of acceleration is that nowadays inertial navigation systems with accelerometers are cheap and commonly used. %Because our approach is also based on Lyapunov arguments, we will also rely on acceleration measurements. However, we will avoid any LIP structural assumption. 
	%%), considering lack of suitable sensors for acceleration measurement. However, with present technological advancements, sensors not only have become precise but also haved reduced is size and cost. Moreover, in various important switched-systems applications where precsion as well as safety are of paramount interest (e.g., offshore constructuction vessels, sattelite, underwater vehicles), use of acceleration/inertial navigation sensors are of common practice. Under such present scenarios and given its benefits over the state-of-art with or without acceleration feedback, the proposed scheme is not only need of the hour but also viable/feasible.  
\end{remark}
%\begin{remark}[On the extension to switched systems]
%%Actually, it is to be remarked that Lyapunov-based methods have been proposed for EL systems without using acceleration measurements (in line with \cite[\S4]{ortega1989adaptive}). However, 
%Most important than the LIP assumption, the methods explicitly involving the mass matrix in the Lyapunov function cannot be easily extended to switched EL systems without introducing restrictions. Such designs may not need acceleration feedback, but unfortunately, when extended to slow switching, the resulting switching law will require lower and upper bound knowledge of mass matrix, i.e., $\underline{m}_\sigma$ and $\overline{m}_\sigma$ (cf. Corollary 1). %On the other hand, the designs in the second category necessarily require structural knowledge of the system (cf. Remark \ref{remark_nlip}). 
%This problem does not occur when adopting the control and adaptive laws (\ref{split_input}), (\ref{rho}) and (\ref{split_adap}), together with a multiple Lyapunov method appropriately defined in %an extension of the Lyapunov arguments in \cite{spong1990adaptive,ortega1989adaptive}, as clarified by 
%the next theorem. Consequently, the necessity of using acceleration measurements seems unavoidable in the presence of uncertainties. %A practical argumentation behind
%the possibility to get acceleration measurements is that nowadays inertial navigation
%systems with accelerometers are cheap and commonly used.
%%none of such scenarios are viable given the current control design challenge as outlined in Remark 1. Therefore, to the best of authors' knowledge, the proposed framework is the only one that can achieve the given task, albeit via use of acceleration measurement as a design trade-off. The following remark highlights whether such trade-off is viable/feasible in practice.
%\end{remark}
%\begin{remark}
%A practical argumentation behind
%the possibility to get acceleration measurements is that nowadays inertial navigation
%systems with accelerometers are cheap and commonly used. One might wonder why not trying to estimate acceleration instead. Adaptive works have appeared \cite{nicosia1990robot,berghuis1993global,roy2019adaptive} where velocity and acceleration measurements are estimated for control design of (non-switched) EL systems. However, partial system dynamics knowledge is typically required, e.g., knowledge of $\mathbf{E}_\sigma$ as in \cite{nicosia1990robot,berghuis1993global} or upper bound knowledge of mass matrix as in \cite{roy2019adaptive}. These observations further substantiate the necessity of acceleration measurement in the presence of fully uncertain dynamics.
%\end{remark}
\section{Stability Analysis of The Proposed Controller}
\begin{theorem}
	%Under Assumptions 1-2, the closed-loop trajectories of system (\ref{sys}) employing the control laws (\ref{input}) and (\ref{rho}) associated with adaptive law (\ref{split_adap}) and switching law (\ref{sw_law}) are Uniformly Ultimately Bounded (UUB).
	%\end{theorem}
	Under Assumption 1 and Properties 1-2, the closed-loop trajectories of system (\ref{e_ddot}) employing the control laws (\ref{split_input}) and (\ref{rho}) with adaptive law (\ref{split_adap}) and switching law (\ref{sw_law}) are Uniformly Ultimately Bounded (UUB). An ultimate bound $b$ on the tracking error $\boldsymbol \xi$ can be found as
	\begin{align}
	b = \sqrt{\frac{{2\bar{\varrho}_M^{(N_0+1)}} \left( \delta + \varpi \delta_1 \right ) }{ {{\underline{\varrho}_m^{(N_0+2)}\left( \varrho - \kappa \right)}} }}, \label{bound} 
	\end{align}
	where the scalars $\delta$ and $\delta_1$ are defined during the proof.
\end{theorem}
\begin{proof}
From (\ref{hat_theta1})-(\ref{gamma}) and the initial conditions (\ref{init}), it can be verified that %there exists a positive fixed scalar 
$\exists \underline{\zeta}_{\sigma}, \underline{\gamma}_{\sigma} \in \mathbb{R}^{+}$ such that
\begin{align}
&\hat{\theta}_{i\sigma} (t) \geq 0,~ 0<\underline{\zeta}_{\sigma} \leq \zeta_{ \sigma}(t) \leq \bar{\zeta}_{\sigma},\nonumber\\
\text{and}~&0<\underline{\gamma}_{\sigma} \leq \gamma_{ \sigma}(t) \leq \bar{\gamma}_{\sigma}~~\forall t\geq t_0. \label{low_bound}
\end{align}
	Stability analysis is carried out based on the multiple Lyapunov candidate:
	\begin{align}
	V& = \frac{1}{2} \boldsymbol{\xi}^T \mathbf{P}_{\sigma} \boldsymbol{\xi}  + \sum_{s=1}^{N} \sum_{i=0}^{3} \frac{(\hat{\theta}_{is} -{\theta}_{is}^{*})^2}{2} + \frac{\gamma_{s}}{\underline{\gamma}} + \frac{\zeta_{s}}{\underline{\zeta}} , \label{lyap}
	\end{align}
	where $\underline{\gamma}=\min_{s \in \Omega}( \underline{\gamma}_s )$ and $ \underline{\zeta}=\min_{s \in \Omega}( \underline{\zeta}_s )$. Observing that $\boldsymbol{\Lambda}_{\sigma} \boldsymbol{ \xi} =  \mathbf K_{1\sigma} \mathbf{e} + \mathbf K_{2\sigma} \dot{\mathbf e}$, the error dynamics obtained in (\ref{e_ddot}) becomes
	\begin{align}
	\dot{\boldsymbol \xi} = \mathbf{A}_{\sigma} \boldsymbol \xi + \mathbf{B} \left(\boldsymbol \chi_{\sigma} - \Delta \boldsymbol \tau_{\sigma}\right).  \label{error_dyn}
	\end{align}
	Note that $V(t)$ might be discontinuous at the switching instants and only remains continuous during the time interval between two consecutive switchings. Without loss of generality, the behaviour of $V$ is studied at the switching instant $t_{l+1},~ l \in \mathbb{N}^{+}$. Let an active subsystem be ${\sigma({t_{l+1}^{-}})}$ when $t \in [t_l~~t_{l+1})$ and ${\sigma({t_{l+1}})}$ when $t \in [t_{l+1}~~t_{l+2})$. We have before and after switching
	\begin{align*}
	V({t_{l+1}^{-}}) &= \frac{1}{2}\boldsymbol{\xi}^T({t_{l+1}^{-}}) \mathbf{P}_{\sigma({t_{l+1}^{-}})} \boldsymbol{\xi}({t_{l+1}^{-}})+  \sum_{s=1}^{N} \sum_{i=0}^{3} \left \lbrace \frac{(\hat{\theta}_{is}({t_{l+1}^{-}}) -{\theta}_{is}^{*})^2}{2} + \frac{ \gamma_{s}({t_{l+1}^{-}})}{ \underline{\gamma}}+ \frac{\zeta_{s}({t_{l+1}^{-}})}{ \underline{\zeta} } \right \rbrace ,\\
	%\end{align*}
	%and after switching
	%\begin{align*}
	V({t_{l+1}}) &= \frac{1}{2}  \boldsymbol{\xi}^T({t_{l+1}}) \mathbf{P}_{\sigma({t_{l+1}})} \boldsymbol{\xi}({t_{l+1}}) +  \sum_{s=1}^{N} \sum_{i=0}^{3} \left \lbrace \frac{ (\hat{\theta}_{is}({t_{l+1}}) -{\theta}_{is}^{*})^2}{2} + \frac{ \gamma_{s}({t_{l+1}})}{ \underline{\gamma}}+ \frac{\zeta_{s}({t_{l+1}})}{ \underline{\zeta}} \right \rbrace,
	\end{align*}
	respectively. Thanks to the continuity of the tracking error $\boldsymbol \xi$ in (\ref{error_dyn}) and of the gains $\hat{\theta}_{i\sigma},\zeta_\sigma$ and $\gamma_{\sigma}$ in (\ref{split_adap}), we have $\boldsymbol \xi({t_{l+1}^{-}}) = \boldsymbol \xi ({t_{l+1}})$, $(\hat{\theta}_{is}({t_{l+1}^{-}}) -{\theta}_{is}^{*})=(\hat{\theta}_{is}({t_{l+1}}) -{\theta}_{is}^{*})$, $\gamma_{s}({t_{l+1}^{-}}) = \gamma_{s}({t_{l+1}})$ and $\zeta_{s}({t_{l+1}^{-}}) = \zeta_{s}({t_{l+1}})$. Further, owing to the facts $ \boldsymbol{\xi}^T({t}) \mathbf{P}_{\sigma(t)} \boldsymbol{\xi}({t}) \leq {\bar{\varrho}_M} \boldsymbol{\xi}^T({t}) \boldsymbol{\xi}({t})$ and $ \boldsymbol{\xi}^T({t}) \mathbf{P}_{\sigma(t)} \boldsymbol{\xi}({t}) \geq {\underline{\varrho}_m}  \boldsymbol{\xi}^T({t}) \boldsymbol{\xi}({t})$, one has 
	\begin{align}
	 V({t_{l+1}}) - V({t_{l+1}^{-}})  &=  \frac{1}{2} \boldsymbol{\xi}^T({t_{l+1}}) ( \mathbf{P}_{\sigma({t_{l+1}})} -  \mathbf{P}_{\sigma({t_{l+1}^{-}})} ) \boldsymbol{\xi}({t_{l+1}}) \nonumber\\
	&\leq  \frac{{\bar{\varrho}_M} - {\underline{\varrho}_m} }{{2\underline{\varrho}_m} }  \boldsymbol{\xi}^T({t_{l+1}}) \mathbf{P}_{\sigma({t_{l+1}^{-}})} \boldsymbol{\xi}({t_{l+1}})  \nonumber\\
	&\leq \frac{{\bar{\varrho}_M} - {\underline{\varrho}_m} }{{\underline{\varrho}_m} } V(t_{l+1}^{-}) \nonumber \\
 \Rightarrow V({t_{l+1}})  &\leq \mu V(t_{l+1}^{-}), \label{mu}
	\end{align}
	with $\mu = {\bar{\varrho}_M} / {\underline{\varrho}_m} \geq 1$. At this point, the behaviour of $V(t)$ between two consecutive switching instants, i.e., when $t \in [t_l~~t_{l+1})$ can be studied. 
	
	We shall proceed the stability analysis for the two cases (i) $|| \mathbf{r}_\sigma || \geq \varpi$ and (ii) $|| \mathbf{r}_\sigma || < \varpi$ using the Lyapunov function (\ref{lyap}). For convenience of notation, let us denote the active subsystem ${\sigma({t_{l+1}^{-}})}$ with $p$ and any inactive subsystem with $\overline{p}$.
	
	\noindent\textbf{Case (i)} $|| \mathbf{r}_\sigma || \geq \varpi$
	
	Using (\ref{psi_bound}), (\ref{error_dyn}), (\ref{split_adap}) and the Lyapunov equation $\mathbf{A}_p^T \mathbf P_p + \mathbf {P}_p \mathbf A_p= -\mathbf Q_{p}$, the time derivative of (\ref{lyap}) yields
	\begin{align}
	\dot{V}  &= \frac{1}{2} \boldsymbol{\xi}^T(\mathbf{A}_p^T \mathbf P_p+ \mathbf {P}_p \mathbf A_p ) \boldsymbol{\xi}+ \boldsymbol \xi^T \mathbf {P}_p \mathbf B \left(\boldsymbol \chi_p -  {\rho_p}\frac{\mathbf r_p}{|| \mathbf r_p||}  \right) +\sum_{s=1}^{N} \sum_{i=0}^{3}\left \lbrace (\hat{\theta}_{is} -{\theta}_{is}^{*})\dot{\hat{\theta}}_{is}+ \frac{\dot{\gamma}_{s}}{ \underline{\gamma}} +\frac{\dot{\zeta}_{s}}{\underline{\zeta}} \right \rbrace \nonumber \\
	&\leq -\frac{1}{2} \boldsymbol{\xi}^T \mathbf Q_p\boldsymbol{\xi} + || \boldsymbol \chi_{p}  || || \mathbf{r}_p ||  - \rho_p{|| \mathbf r_p||} +\sum_{s=1}^{N} \sum_{i=0}^{3}\left \lbrace (\hat{\theta}_{is} -{\theta}_{is}^{*})\dot{\hat{\theta}}_{is}+ \frac{\dot{\gamma}_{s}}{ \underline{\gamma}} +\frac{\dot{\zeta}_{s}}{\underline{\zeta}}\right \rbrace \\%\label{part 1}
	& \leq  - \frac{1}{2} \boldsymbol{\xi}^T \mathbf Q_p\boldsymbol{\xi}  - \mathbf{Y}^T_p(\hat{\boldsymbol \Theta}_p-\boldsymbol \Theta_p^{*})  || \mathbf{r}_p || +\sum_{s=1}^{N} \sum_{i=0}^{3}\left \lbrace (\hat{\theta}_{is} -{\theta}_{is}^{*})\dot{\hat{\theta}}_{is}+ \frac{\dot{\gamma}_{s}}{ \underline{\gamma}} +\frac{\dot{\zeta}_{s}}{\underline{\zeta}} \right \rbrace. \label{part 2}
	\end{align}
	Using (\ref{hat_theta1})-(\ref{hat_theta})  we have 
	\begin{align}
	\sum_{i=0}^{3}(\hat{\theta}_{ip}-{\theta}_{ip}^{*})\dot{\hat{\theta}}_{ip} & =\sum_{j=0}^{2} (\hat{\theta}_{jp}-{\theta}_{jp}^{*})(|| \mathbf{r}_p || || \boldsymbol \xi ||^{j} - \alpha_{jp}{\hat{\theta}}_{j p})+ (\hat{\theta}_{3p}-{\theta}_{3p}^{*})(|| \mathbf{r}_p || || \ddot{\overline{\mathbf q}} || - \alpha_{3p}{\hat{\theta}}_{3p}) \nonumber\\
	&  = \mathbf{Y}^T_p(\hat{\boldsymbol \Theta}_p-\boldsymbol \Theta_p^{*})  || \mathbf{r}_p ||   + \sum_{i=0}^{3} \left \lbrace\alpha_{ip}{\hat{\theta}}_{ip}{\theta}_{ip}^{*} -\alpha_{ip}{\hat{\theta}}_{ip}^2 \right \rbrace. \label{part 3}
	\end{align}
	Similarly using the facts $\hat{\theta}_{is} \geq 0$, $0< \underline{\zeta}_{s} \leq \zeta_{s}(t),~0< \underline{\gamma}_{s} \leq \gamma_{s}(t)$ from (\ref{low_bound}) and $\underline{\zeta}=\min_{s \in \Omega} ( \underline{\zeta}_{s} ),~\underline{\gamma}=\min_{s \in \Omega} ( \underline{\gamma}_{s} )$, (\ref{zeta}) and (\ref{gamma}) lead to
	\begin{align}
	\frac{\dot{\zeta}_{ p}}{\underline{\zeta}} &=   - \left(1 + \hat{\theta}_{3p} || \ddot{\overline{\mathbf q}} || | \mathbf{r}_p || \right) \frac{{\zeta}_{p}}{\underline{\zeta} } +  \frac{\bar{\epsilon}_{ p}}{\underline{\zeta} }  \nonumber\\ 
	& \leq   - \hat{\theta}_{3p} || \ddot{\overline{\mathbf q}} || | \mathbf{r}_p ||  +  \frac{\bar{\epsilon}_{ p}}{\underline{\zeta} }, \label{part 4_1}\\
	\frac{\dot{\gamma}_{\overline p}}{\underline{\gamma}} &=   - \left(1 + (\varrho_{\overline{p}}/2) \sum_{i=0}^{3}{\hat{\theta}}_{i \overline p}^2   \right) \frac{{\gamma}_{\overline p}}{\underline{\gamma} } +  \frac{{\epsilon}_{\overline p}}{\underline{\gamma} } \nonumber\\ 
	& \leq   - \frac{\varrho_{\overline{p}}}{2} \sum_{i=0}^{3}{\hat{\theta}}_{i \overline p}^2  +  \frac{{\epsilon}_{\overline p}}{\underline{\gamma} }, \label{part 4} 
	\end{align}
	Substituting (\ref{part 3})-(\ref{part 4}) in (\ref{part 2}) yields
	\begin{align}
	\dot{V}\leq &   - \frac{1}{2} \lambda_{\min}(\mathbf Q_p) || \boldsymbol{\xi} ||^2  +\sum_{i=0}^{3} \left \lbrace\alpha_{ip}{\hat{\theta}}_{ip}{\theta}_{ip}^{*} -\bar{\alpha}_{ip}{\hat{\theta}}_{ip}^2 \right  \rbrace \nonumber\\
	&+\frac{\bar{\epsilon}_{ p}}{\underline{\zeta} }  - \left\lbrace \sum_{\forall \overline{p}\in \Omega \backslash \lbrace p \rbrace} \sum_{i=0}^{3} \varrho_{\overline{p}} {\hat{\theta}}_{i \overline p}^2  -  \frac{{\epsilon}_{\overline p}}{\underline{\gamma} } \right \rbrace. \label{part 5}
	\end{align}
	Since $\hat{\theta}_{is} \geq 0$, $\zeta_{s}(t) \leq \bar{\zeta}_{s}$ and $\gamma_{s}(t) \leq \bar{\gamma}_{s}$ by design (\ref{low_bound}), one obtains
	\begin{align}
	V \leq  \frac{1}{2} \lambda_{\max}( \mathbf{P}_{p} ) ||\boldsymbol{\xi}||^2  + \sum_{s=1}^{N} \sum_{i=0}^{3}\frac{(\hat{\theta}_{is}^2 + {\theta_{is}^{*}}^2)}{2}+ \frac{\bar{\gamma}_{s}}{ \underline{\gamma}}+ \frac{\bar{\zeta}_{s}}{ \underline{\zeta}}. \label{lyap_up_bound}
	\end{align}
	%We had earlier defined $\varrho = \min_{p \in \Omega}({\lambda_{\min}( \mathbf{Q}_{p} )}/{\lambda_{\max}( \mathbf{P}_{p} )})$. and $\varrho_{Mp} = \lambda_{\max}( \mathbf{P}_{p} )$. Further, by design $\alpha_{i} >\frac{1}{2\varrho_{Mp}}$ and $\beta_{i}>\frac{1}{2\varrho_{Mp}}$. 
	Hence, using (\ref{lyap_up_bound}), the condition (\ref{part 5}) is further simplified to
	\begin{align}
	\dot{V} \leq  &- \varrho V+ \frac{\bar{\epsilon}_{ p}}{\underline{\zeta}}  + \sum_{i=0}^{3} \left \lbrace\alpha_{ip}{\hat{\theta}}_{ip}{\theta}_{ip}^{*} -\bar{\alpha}_{ip}{\hat{\theta}}_{ip}^2 \right \rbrace +  \sum_{s=1}^{N} \sum_{i=0}^{3} \frac{\varrho_s{\theta_{is}^{*}}^2}{2}+ \varrho_s \left( \frac{\bar{\gamma}_{s}}{ \underline{\gamma}}+ \frac{\bar{\zeta}_{s}}{ \underline{\zeta}} \right)+\frac{{\epsilon}_{s}}{\underline{\gamma}} , \label{part 6}
	\end{align}
	where $\varrho=\min_{p\in \Omega} \lbrace \varrho_p \rbrace$; $\bar{\alpha}_{ip} =({\alpha}_{ip}-(\varrho_p/2)) >0$ by design from (\ref{alpha}). Again, the following rearrangement can be made
	\begin{align}
	\alpha_{ip}{\hat{\theta}}_{ip} {\theta}_{ip}^{*} -\bar{\alpha}_{ip} \hat{\theta}_{ip}^2 & = - \bar{\alpha}_{ip} \left(  \hat{\theta}_{ip} - \frac{ \alpha_{ip} {\theta}_{ip}^{*}}{2\bar{\alpha}_{ip}} \right)^2 +  \frac{\left( \alpha_{ip} {\theta}_{ip}^{*}\right)^2}{4\bar{\alpha}_{ip}}. \label{part 7_1}
	\end{align}
	We had defined earlier $0< \kappa < \varrho$. Then, using (\ref{part 7_1}), $ \dot{V}(t) $ from (\ref{part 6}) gets simplified to
	\begin{align}
	&\dot{V}(t) \leq - \kappa V(t) - (\varrho - \kappa)V(t) + \delta, \label{part 7}
	\end{align}
	where $\delta \triangleq \max_{p\in \Omega} \left( \sum_{i=0}^{3}\left ( \alpha_{ip} {\theta}_{ip}^{*}\right)^2/({4\bar{\alpha}_{ip}})+(\bar{\epsilon}_{ p}/\underline{\zeta} ) \right) +  \sum_{s=1}^{N} \sum_{i=0}^{3} (\varrho_s/2){\theta_{is}^{*}}^2+ (\varrho_s \bar{\gamma}_{s})/ \underline{\gamma}+(\varrho_s \bar{\zeta}_{s})/ \underline{\zeta}+({\epsilon}_{s}/\underline{\gamma} )$.
	%Further, define a scalar $\mathcal{B}$ as
	%\begin{align}
	%\mathcal{B} \triangleq \max \left \lbrace \frac{\sum_{p=1}^{N} \sum_{i=0}^{\nu}   \frac{\left( \alpha_{i} {\theta}_{ip}^{*}\right)^2}{4\bar{\alpha}_{ip}} +  \frac{\left( \beta_{i}  \underline{\epsilon}_{i} \right)^2 }{4\bar{\beta}_{ip}}}{ \left( \varrho - \kappa \right)}, \frac{\underline{\varrho}_m}{2\underline{\gamma}_{ip}^4 \epsilon_{i}^2 } \right \rbrace. \label{B}
	%\end{align}
	
	\noindent\textbf{Case (ii)} $|| \mathbf{r}_\sigma || < \varpi$
	
	In this case, the time derivative of (\ref{lyap}) yields
	\begin{align}
	%&\dot{V}  = ({1}/{2}) \boldsymbol{\xi}^T(\mathbf{A}_p^T \mathbf P_p+ \mathbf {P}_p \mathbf A_p ) \boldsymbol{\xi}+ \boldsymbol \xi^T \mathbf {P}_p \mathbf B \left(\boldsymbol \chi_p -  {\rho_p}\frac{\mathbf r_p}{\varpi}  \right)\nonumber\\
	%& +\sum_{s=1}^{N} \sum_{i=0}^{3}\left \lbrace (\hat{\theta}_{is} -{\theta}_{is}^{*})\dot{\hat{\theta}}_{is}+ \dot{\gamma}_{s}/ \underline{\gamma} \right \rbrace \nonumber \\
	\dot{V} &\leq -\frac{1}{2} \boldsymbol{\xi}^T \mathbf Q_p\boldsymbol{\xi} + || \boldsymbol \chi_{p}  || || \mathbf{r}_p ||  - \rho_p\frac{{|| \mathbf r_p||}^2}{\varpi}  +\sum_{s=1}^{N} \sum_{i=0}^{3}\left \lbrace (\hat{\theta}_{is} -{\theta}_{is}^{*})\dot{\hat{\theta}}_{is}+ \frac{\dot{\gamma}_{s}}{\underline{\gamma}}+\frac{\dot{\zeta}_{s}}{\underline{\zeta}} \right \rbrace \\%\label{part 1}
	& \leq  - \frac{1}{2} \boldsymbol{\xi}^T \mathbf Q_p\boldsymbol{\xi} + || \boldsymbol \chi_{p}  || || \mathbf{r}_p || +\sum_{s=1}^{N} \sum_{i=0}^{3}\left \lbrace (\hat{\theta}_{is} -{\theta}_{is}^{*})\dot{\hat{\theta}}_{is}+ \frac{\dot{\gamma}_{s}}{\underline{\gamma}}+\frac{\dot{\zeta}_{s}}{\underline{\zeta}}\right \rbrace. \label{part 8}
	\end{align}
	Following similar lines of proof as in Case (i) we have
	\begin{align}
	\dot{V} &\leq - \kappa V - (\varrho - \kappa)V + \delta + (\mathbf{Y}^T_p \hat{\boldsymbol \Theta}_p - \hat{\theta}_{3p} || \ddot{\overline{\mathbf q}} ||) || \mathbf{r}_p || \nonumber \\
	& = - \kappa V - (\varrho - \kappa)V + \delta + \sum_{j=0}^{2} \hat{\theta}_{jp}||\boldsymbol \xi ||^j || \mathbf{r}_p || . \label{part 9}
	\end{align}
	From (\ref{r}) one can verify $||\mathbf{r}|| < \varphi \Rightarrow || \boldsymbol \xi || \in \mathcal{L}_{\infty} $ and consequently, the adaptive law (\ref{hat_theta1}) implies $||\mathbf{r}|| , || \boldsymbol \xi || \in \mathcal{L}_{\infty} \Rightarrow \hat{\theta}_{jp} (t) \in \mathcal{L}_{\infty}$, $j=0,1,2$. Therefore, $\exists \delta_1 \in \mathbb{R}^{+}$ such that $\sum_{j=0}^{2} \hat{\theta}_{jp}||\boldsymbol \xi ||^j \leq \delta_1$ $\forall p \in \Omega$ when $||\mathbf r_{p}|| < \varphi$. Hence, replacing this relation in (\ref{part 9}) yields 
	\begin{align}
	&\dot{V}(t) \leq - \kappa V(t) - (\varrho - \kappa)V(t) + \delta + \varpi \delta_1 . \label{part 10}
	\end{align}
	Therefore, investigating the stability results of Cases (i) and (ii), it can be concluded that $\dot{V}(t) \leq - \varrho V(t) $ when
	\begin{align}
	V(t) \geq \mathcal{B} \triangleq \frac{\delta + \varpi \delta_1}{(\varrho - \kappa)}.
	\end{align}
	In light of this, further analysis is needed to observe the behaviour of $V(t)$ between the two consecutive switching instants, i.e., $t \in [t_{l}~t_{l+1})$, for two possible scenarios: 
	\begin{itemize}
		\item[\textbf{(i)}] when $V(t) \geq \mathcal{B}$, we have $\dot{V}(t) \leq - \varrho V(t) $ implying exponential decrease of $V(t)$;
		\item[\textbf{(ii)}] when $V(t) <\mathcal{B}$, no exponential decrease can be derived.
	\end{itemize}
	%Case (i) ; Case (ii)  %Thus, we further select two cases: Case (i) $V(t_l) \geq \mathcal{B}$ and Case (ii) $V(t_l) < \mathcal{B}$. 
	Behaviour of $V(t)$ is discussed below individually for these two scenarios.
	
	\textbf{Scenario (i):}
	There exists a time, call it $T_1$, when $V(t)$ enters into the bound $\mathcal{B}$ %Thus, $V(t)$ decreases exponentially for all $t \in [t_0 ~~t_0+T_1)$. Further, we denote $N_{1p}(t)$ 
	and $N_{\sigma}(t)$ denotes the number of all switching intervals for $t \in [t_0 ~~t_0+T_1)$. Accordingly, for $t \in [t_0 ~~t_0+T_1)$, using (\ref{mu}) and $N_{\sigma}(t_0,t)$ from Definition 1 we have
	\begin{align}
	V(t)   &\leq \exp \left( - \kappa (t-t_{N_\sigma(t)-1})\right) V(t_{N_\sigma(t)-1}) \nonumber\\
	& \leq \mu\exp \left( - \kappa (t-t_{N_\sigma(t)-1})\right) V(t_{N_\sigma(t)-1}^{-}) \nonumber\\
	& \leq \mu\exp \left( - \kappa (t-t_{N_\sigma(t)-1})\right) \nonumber\\
	&~~~\cdot \mu\exp \left( - \kappa (t_{N_\sigma(t)-1}-t_{N_\sigma(t)-2}) \right)V(t_{N_\sigma(t)-2}^{-}) \nonumber\\
	&\qquad \qquad \qquad \qquad \vdots \nonumber\\
	&\leq \mu\exp \left( - \kappa (t-t_{N_\sigma(t)-1})\right)  \mu\exp \left( - \kappa (t_{N_\sigma(t)-1}-t_{N_\sigma(t)-2}) \right) \nonumber\\
	&~~ ~~\cdots \mu \exp \left( - \kappa (t_1-t_0) \right) V(t_0) \nonumber\\
	&= \mu^{N_{\sigma}(t_0,t)} \exp \left(- \kappa (t-t_0) \right)V(t_0)  \nonumber \\
	& = c \left( \exp \left( -\kappa + ({\ln \mu}/{\vartheta}) \right) \right)V(t_0), \label{part 8}
	\end{align}
	where $c \triangleq \exp \left( N_0 \ln \mu \right) $ is a constant. Substituting the ADT condition $\vartheta > \ln\mu / \varrho $ in (\ref{part 8}) yields $V(t) < c V(t_0)$ for $t \in [t_0 ~~t_0+T_1)$. Moreover, as $V(t_0 +T_1) < \mathcal{B}$, one has $V(t_{N_\sigma(t)+1}) < \mu \mathcal{B}$ from (\ref{mu}) at the next switching instant $t_{N_\sigma(t)+1}$ after $t_0+T_1$. This implies that $V(t)$ may be larger than $\mathcal{B}$ from the instant $t_{N_\sigma(t)+1}$. This necessitates further analysis.
	
	We assume $V(t) \geq \mathcal{B}$ for $t \in [t_{ N_\sigma(t)+1}~~ t_0+T_2)$, where $T_2$ denotes the time before next switching. Let $\bar{{N}}_\sigma (t)$ represents the number of all switching intervals for $t \in [t_{N_\sigma(t)+1}~~ t_0+T_2)$. Then, substituting $V(t_0)$ with $V(t_{N_\sigma (t)+1})$ in (\ref{part 8}) and following the similar procedure for analysis as (\ref{part 8}), we have $V(t) \leq c V(t_{ N_\sigma(t)+1}) < c \mu \mathcal{B}$ for $t \in [t_{ N_\sigma (t)+1}~~ t_0+T_2)$. Since $V(t_0+T_2) < \mathcal{B}$, we have $V(t_{ N_\sigma(t)+\bar{ N}_\sigma(t)+2}) < \mu \mathcal{B}$ at the next switching instant $t_{ N_\sigma(t)+\bar{ N}_\sigma(t)+2}$ after $t_0+T_2$. If we follow similar lines of proof recursively, we can come to the conclusion that $V(t) < c \mu \mathcal{B} $ for $t \in [t_0+T_1~~ \infty )$. This confirms that once $V(t)$ enters the interval $[0,\mathcal{B}]$, it cannot exceed the bound $c\mu \mathcal{B}$ any time later with the ADT switching law (\ref{sw_law}).
	
	\textbf{Scenario (ii):} It can be verified that the same argument below (\ref{part 8}) also holds for Scenario (ii). 
	
	Thus, observing the stability arguments of the Scenarios (i) and (ii), it can be concluded that the closed-loop system remains UUB with the control laws (\ref{split_input}) and (\ref{rho}) with the adaptive law (\ref{split_adap}) and switching law (\ref{sw_law}) implying
	\begin{align}
	V(t) \leq \max \left( c V(t_0), c\mu \mathcal{B} \right), ~~\forall t\geq t_0. \label{ub_1}
	\end{align}
	Again, the definition of the Lyapunov function (\ref{lyap}) yields
	\begin{align}
	V(t) \geq ({1}/{2}) \lambda_{\min} (\mathbf P_{\sigma(t)}) || \boldsymbol \xi || ^2 \geq \left({\underline{\varrho}_m }/{2}\right) || \boldsymbol \xi || ^2. \label{ub_2}
	\end{align}
	Using (\ref{ub_1}) and (\ref{ub_2}) we have
	\begin{align}
	|| \boldsymbol \xi || ^2 \leq \left({2}/{\underline{\varrho}_m }\right) \max \left( c V(t_0), c \mu \mathcal{B} \right), ~~\forall t\geq t_0. \label{ub_3}
	\end{align}
	Therefore, using the expression of $\mathcal{B}$ from (\ref{lyap_up_bound}), an ultimate bound $b$ on the tracking error $\boldsymbol \xi$ can be found as (\ref{bound}).
\end{proof}
Note that in collocated design, it is standard to consider the internal dynamics to be stable/bounded a priori \cite{shkolnik2008high,spong1994partial}. In the following, a few design aspects of the proposed mechanism are highlighted. 


%The switching law (\ref{sw_law}) is independent from the unknown uncertainty bounds mentioned in Remark 1 (this is thanks to the uncertainty independent bound derived in (\ref{mu})). Using alternative multiple Lyapunov functions, a stabilizing switching law would exist but could not
%be determined as it would depend on an unknown uncertainty bound. This is clarified by the following corollary.

%\begin{corollary}
%When the mass matrix $\mathbf M_\sigma$ is completely unknown (cf. Remark 1), it is not possible to design a slow switching law using an extended version of the Lyapunov function explicitly
%involving the mass matrix. % candidate proposed in \cite{roy2018adaptive,patre2011modular,feng2018distributed}. 
%\end{corollary}
%\begin{proof}
%Similarly to
%\cite{roy2018adaptive,patre2011modular,feng2018distributed}, consider a multiple Lyapunov function candidate 
%\begin{align}
%V_1& = (1/2) \boldsymbol{\xi}^T \mathbf{M}_{\sigma} \boldsymbol{\xi}  +  V_2, \label{lyap_c}
%\end{align}
%where $V_2$ is a positive definite, continously differentiable function (usually consists of various unknown and estimated parameters: cf. \cite{roy2018adaptive,patre2011modular,feng2018distributed} for details). Then, following similar lines used to derive (\ref{mu}), one would get
%\begin{align}
%& V_1({t_{l+1}}) - V_1({t_{l+1}^{-}})  =  \frac{1}{2} \boldsymbol{\xi}^T({t_{l+1}}) ( \mathbf{M}_{\sigma({t_{l+1}})} -  \mathbf{M}_{\sigma({t_{l+1}^{-}})} ) \boldsymbol{\xi}({t_{l+1}}) \nonumber\\
%&\leq  \frac{{\overline{m}} - {\underline{m}} }{{2\underline{m}} }  \boldsymbol{\xi}^T({t_{l+1}}) \mathbf{M}_{\sigma({t_{l+1}^{-}})} \boldsymbol{\xi}({t_{l+1}})  \leq \frac{{\overline{m}} - {\underline{m}} }{{\underline{m}} } V_1(t_{l+1}^{-}) \nonumber \\
%&\qquad \qquad \qquad  \Rightarrow V_1({t_{l+1}})  \leq \mu_1 V_1(t_{l+1}^{-}), \label{mu_c}
%\end{align}
%where $\mu_1 = {\overline{m}} / {\underline{m}} \geq 1$, ${\overline{m}} \triangleq \max_{\sigma \in \Omega} (\overline{m}_\sigma)$ and ${\underline{m}} \triangleq \min_{\sigma \in \Omega} (\underline{m}_\sigma)$. As ${\overline{m}}$ and ${\underline{m}}$ are unknown according to Remark 1, it can be realized that one cannot design an ADT as in (\ref{sw_law}) while following the multiple  Lyapunov candidate (\ref{lyap_c}). This is because, after using the argument in (\ref{part 8}), a stabilizing ADT would exist, but it would end up depending on unknown parameters. %One can verify that such restriction would prevail for designing \emph{any time-dependent switching law} such as dwell time, mode-dependent dwell time etc. (cf. the procedures as in \cite{liberzon2003switching,yuan2018novel,yuan2018robust,lai2018adaptive,sang2012adaptive}). 
%\end{proof}
%\begin{align}
%b \in \left[0, \sqrt{\frac{{2\bar{\varrho}_M^{(N_0+1)}} \left( \delta + \varpi \delta_1 \right ) }{ {{\underline{\varrho}_m^{(N_0+2)}\left( \varrho - \kappa \right)}} }}\right ].
%\end{align}

%\begin{remark} 
%To realize the importance of auxiliary gain $\gamma_{ip}$, the following two observations are made: (i) the first term on the right hand side of (\ref{part 3}), i.e., $\nu \hat{\theta}_{ip}  || \boldsymbol \xi ||^{i+1} $ was specifically cancelled by the second term on the right side of (\ref{part 4}) to arrive at (\ref{part 5}). In absence of $\gamma_{ip}$ this would not have been achieved and, system stability could not be ensured. (ii) Further, the second term on the right side of (\ref{part 4}) could be achieved from the corresponding term of (\ref{part 4_1}), by utilizing the condition $\gamma_{ip} \geq \underline{\gamma}_{ip}$. This also validates the utility of condition (\ref{low_bound}), i.e., the selection of positive lower bound for $\gamma_{ip}$, while the lower bounds for the other gains $\hat{\theta}_i$ $i=0,1,2$ are selected as zero. % (condition (\ref{low_bound})). 
% %stability for the Cases (2.1) and (2.1a) could only be ensured due to the term $-\varsigma \beta ||\xi||^4$ introduced by $\dot{\hat{\theta}}_3$. 
%\end{remark}
%\begin{remark}
%The existence of $\bar{\alpha}_{i\sigma}>0$ and  $\bar{\beta}_{i\sigma} >0$ to establish (\ref{part 7_1}) justifies the reason for the selection of $\alpha_{i} >\max_{\sigma \in \Omega} \lbrace {1}/(2\varrho_{M \sigma} ) \rbrace$ and $\beta_{i}>\max_{\sigma \in \Omega}\lbrace {1}/(2\varrho_{M \sigma} )\rbrace$.
%\end{remark}
%\begin{remark}
%%It is noteworthy that the condition (\ref{low_bound}) is necessary for stability of the system. 
%Note that high values of the design scalars $\gamma_0, \gamma_{02}, \underline{\gamma}$ help to reduce $\iota,\iota'$. Similarly, high values of $\eta_i, \eta_{i1}, \beta$ help lead to higher values of $c_{j1}$ from higher $c_j$, which in turn help reducing $\iota_j, \iota_j'$ for $i=0,1,2$ and $j=0,1,2,3$. This consequently can improve controller accuracy. %Further, the scalar terms $z, \vartheta, \psi,\mu_2,\zeta,\bar{\theta}_i$ and $\bar{\gamma}$ are only used for the purpose of analysis and not used to design control law.
%\end{remark}
%\begin{remark}[The role of $\zeta$ and $\gamma$]\label{imp_gamma}
%The following two observations clarify the importance of the gains $\gamma$ and $\zeta$ in ensuring closed-loop stability: (i) the term $ - \frac{\varrho_{\overline{p}}}{2}$ in (\ref{part 4}), contributed by $\dot{\gamma}$,  cancels the similar term stemming from (\ref{lyap_up_bound}) leading to (\ref{part 6}); (ii) the term $- \hat{\theta}_{3p} || \ddot{\mathbf q} || | \mathbf{r}_p || $, contributed by $\dot{\zeta}$ in (\ref{part 4_1}), negates the similar term in the first inequality in (\ref{part 9}). Note that boundedness of $||\mathbf{r}_p||$ in Case (ii) implies boundedness of $||\boldsymbol \xi||$ but not of $||\ddot{\mathbf q}||$: therefore, canceling the term $- \hat{\theta}_{3p} || \ddot{\mathbf q} || | \mathbf{r}_p || $ through the auxiliary gain $\zeta$ is necessary for guaranteeing closed-loop stability. We are not aware of any similar design in literature.
%\end{remark}
\begin{remark}[The role of gain $\mathbf D_\sigma$ and its selection]\label{select_d}
	The control law (\ref{input}) relies on the inverse dynamics-type design: in its absence, $\mathbf D_\sigma$ would have been replaced by some nominal value of mass matrix following the conventional design (cf. \cite{roy2019simultaneous,roy2019overcoming}). However, according to Remark 1, such knowledge is unavailable. Again, avoiding inverse dynamics-type design and involving mass matrix in the Lyapunov function eventually lead to a switching law that relies on bound knowledge of mass matrix \cite{roy2019reduced}. These observations highlight the role of $\mathbf D_\sigma$ to realize a switched controller without any knowledge of mass matrix.
	
	Aside being positive definite, the proposed design does not put any restriction on the choice of $\mathbf{D}_\sigma$. It can be observed from (\ref{e_ddot}) that higher values of $\mathbf{D}_\sigma$ reduces the effect of uncertainty $\boldsymbol \chi_\sigma$ on the error dynamics, albeit at the cost of higher control input (cf. (\ref{input})). Therefore, $\mathbf{D}_\sigma$ needs to be designed according to the application requirements. 
	%One can realize from (\ref{e_ddot})-(\ref{psi_bound}) that $\theta_{3\sigma}^* \geq ||\mathbf D_\sigma^{-1}\mathbf M_\sigma - \mathbf I ||$. As $\theta_{3\sigma}^*$ is considered to be unknown, the proposed design does not put any restriction on the choice of $\mathbf{D}_\sigma$: this is a clear advantage compared to designs proposed in \cite{roy2017adaptive,jin2017model,roy2019} (and references therein) which utilize acceleration feedback and require the knowledge of $\theta_{3\sigma}^*$ (i.e., $\mathbf{D}_\sigma$ is to be designed based on the upper bound knowledge of $\mathbf M_\sigma$). %However, high values of $\mathbf{D}_\sigma$ might in practice lead to unnecessary high control input (cf. (\ref{input})) and thereby, possibly hit actuator limits and undermine system stability.  %undermine the adaptive structure as well as philosophy of the control design.
\end{remark}
\section{Simulation Results}
\begin{figure}[!t]
	\centering
	\includegraphics[width=\textwidth]{LaTex/figures/sigma.jpg}%{FIG5_16-TIE-3042.eps}
	\caption{{The switching signal.}}\label{fig:1} % (the response of link 1 is omitted due to the limited space)
\end{figure}
%\vspace{-0.5cm}

\begin{figure}[!t]
	\centering
	\includegraphics[width=\textwidth]{LaTex/figures/dist.jpg}%{FIG5_16-TIE-3042.eps}
	\caption{{Pulse type disturbance.}}\label{fig:dist} % (the response of link 1 is omitted due to the limited space)
\end{figure}

\begin{figure}[!t]
	\centering
	\includegraphics[width=\textwidth]{LaTex/figures/quad_per.jpg}%{FIG5_16-TIE-3042.eps}
	\caption{{Tracking performance of the proposed controller.}}\label{fig:2} % (the response of link 1 is omitted due to the limited space)
\end{figure}
We test the proposed controller for a switched dynamics scenario as in Fig. \ref{fig:dyn} having three phases (a.k.a subsystems), denoted by $\sigma=1,2,3$ as
\begin{itemize}
\item $\sigma=1$: the quadrotor rests on the ground without any payload;

\item $\sigma=2$: it starts to ascend with an initial payload;

\item $\sigma=3$: a new payload is attached to the quadrotor as it ascends to its desired height.
\end{itemize}



For fruitful verification and as found in many applications (cf. \cite{ye2019observer,roy2018analysis}), we verify the controller on the six degrees-of-freedom quadrotor model. % as in Appendix (cf. (\ref{quad_dyn})). 
The following parametric variations (due to addition of payload) are selected for different subsystems
\begin{align*}
\sigma=1: ~m & =1.5,~I_{xx}=I_{yy}=1.69\cdot10^{-5},~ I_{zz}=3.38\cdot10^{-5},\\
\sigma=2: ~m & =1.6,~I_{xx}=0.011,~ I_{yy}=0.010,~ I_{zz}=1.27\cdot10^{-4},\\
\sigma=3: ~m& =1.7,~I_{xx}=0.032,~ I_{yy}=0.030,~ I_{zz}=2.20\cdot{10}^{-4}.
\end{align*}
%with $l=0.13$m and $g=9.8 \text{m}/\text{sec}^2$ for all the subsystems. 

The objective for the quadrotor is to lift and drop various payloads at different heights while starting from the ground position. To achieve this task, the following desired trajectories are defined $x^d=y^d=0, z^d= 2+\sin(0.1t), \phi^d=\varphi^d=\psi^d=0$ with an initial position of $ x(0)=y(0)=0.1, z(0)= 0, \phi(0)=\varphi(0),\psi(0)=0.1$. % for $t < 20$, $25 \leq t <35$ and $\lbrace q_l^d,q_u^d \rbrace =\lbrace 2\sin(t), \sin(t) \rbrace$rad for $20 \leq t <25$, $t \geq 35$.}
Selection of $\mathbf K_{11}=120\mathbf{I}, \mathbf K_{21}=100\mathbf I, \mathbf K_{12}=150\mathbf{I}, \mathbf K_{22}=120\mathbf I,     \mathbf K_{13}=200\mathbf{I}, \mathbf K_{23}=140\mathbf I, \mathbf Q_1=\mathbf Q_2=\mathbf Q_3=2\mathbf I$, $\kappa=0.9\varrho$ yields the ADT $\vartheta^{*}=6.57$sec according to (\ref{sw_law}). Therefore, a switching law $\sigma(t)$ is designed as in Fig. \ref{fig:1} (note that the initial fast switchings are compensated by slower switchings later on). %Therein, it can be noticed that the dwell time is smaller than $\vartheta^{*}$ for $t=10-12$sec and $t=12-14$sec for subsystem $1$ and $2$, respectively. However, according to the basic notion of ADT \cite{hespanha1999stability}, the average dwell time is greater than $\vartheta^{*}$ for both the subsystems over the entire span of operation. 
%To have a $\hat{\mathbf b}_p$ in (\ref{input}), we select the nominal parameter as $m_{1_l}=m_{1_u}= 1.0$kg, $l_{1_l}=l_{1_u}=0.9$m and $m_{2_l}=m_{2_u}= 2.0$kg, $l_{2_l}=l_{2_u}=1.9$m, while $\mathbf{C_{\sigma},F_{\sigma},G_{\sigma}}$ and $\mathbf{ d_{\sigma}}$ are considered to be completely unknown. It is possible to show that (\ref{mass cond}) is satisfied with $\bar{E}_1=\bar{E}_2=0.3$. 



Other control parameters are designed as $$\mathbf D_\sigma=\begin{bmatrix}
2 & 0  & 0  & 0 \\ 
0& 1\cdot10^{-4}  & 0 & 0\\ 
0 & 0  & 1\cdot10^{-4}  & 0 \\ 
0 & 0  & 0  & 1\cdot10^{-4} 
\end{bmatrix},$$
$\alpha_{i\sigma}=0.6,\epsilon_{\sigma}=\bar{\epsilon}_{\sigma}=0.005 $ with $i=0,1,2,3$ for all $\sigma$. The initial conditions are selected as $\hat{\theta}_{0\sigma}(0)=1.2,\hat{\theta}_{1\sigma}(0)=1.3,\hat{\theta}_{2\sigma}(0)=1.4,\hat{\theta}_{3\sigma}(0)=1.5 $, $\zeta_\sigma(0)=\gamma_{\sigma}(0)=1$ $\forall \sigma$. The external disturbance is selected as $\mathbf{d}_{\sigma}= \lbrace 0.05\sin(0.5t),0,0,d_p \rbrace$ $\forall \sigma$, where $d_p$ represents a pulse type disturbance (cf. Fig. \ref{fig:dist}) emulating sudden disturbances like gust of wind. It is worth remarking here that, the proposed mechanism being a collocated one, external disturbances should be selected such that the nonactuated dynamics does not become unstable (cf. \cite{shkolnik2008high,spong1994partial}). Therefore, no external disturbances are considered in $(\phi,\varphi)$ as well as in $(x,y)$.

%\vspace{-0.5cm}
\begin{figure}[!h]
	\centering
	\includegraphics[width=\textwidth]{LaTex/figures/gain_sys1.jpg}%{FIG5_16-TIE-3042.eps}
	\caption{{Gains for subsystem 1.}}\label{fig:3} % (the response of link 1 is omitted due to the limited space)
\end{figure}
%\vspace{-0.5cm}
\begin{figure}[!h]
	\centering
	\includegraphics[width=\textwidth]{LaTex/figures/gain_sys2.jpg}%{FIG5_16-TIE-3042.eps}
	\caption{{Gains for subsystem 2.}}\label{fig:4} % (the response of link 1 is omitted due to the limited space)
\end{figure}
\begin{figure}[!h]
	\centering
	\includegraphics[width=\textwidth]{LaTex/figures/gain_sys3.jpg}%{FIG5_16-TIE-3042.eps}
	\caption{{Gains for subsystem 3.}}\label{fig:5} % (the response of link 1 is omitted due to the limited space)
\end{figure}

The performance of the proposed controller is depicted in Fig. \ref{fig:2} in terms of tracking errors, where the attitude errors are reported in degree for better comprehension. In line with the proposed adaptive law (\ref{hat_theta1})-(\ref{gamma}), Figs. \ref{fig:3}-\ref{fig:5} reveal that: (i) for an active subsystem, only the gains $\hat{\theta}_{i {p}}$ and $\zeta_p$ are updated while $\gamma_{p}$ remains constant; (ii) for an inactive subsystem, while $\gamma_{\overline{p}}$ is updated, $\hat{\theta}_{i \overline{p}}$ and $\zeta_{\overline p}$ remain constant. %of the inactive subsystems do not decrease exponentially for the entire switch-off period (e.g., for $t \in [15,~30)$ and $t \in [30,~40)$ for subsystems 1 and 2, respectively).