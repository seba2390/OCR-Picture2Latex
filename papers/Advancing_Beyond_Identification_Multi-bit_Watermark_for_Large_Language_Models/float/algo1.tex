\SetKwInput{KwInput}{Input}              
\SetKwInput{KwOutput}{Output}  
\maketitle
    \begin{algorithm}[H]
    \DontPrintSemicolon
        \KwInput{Watermarked text $X_{1:T}$, hash context width $h$, effective message length $\tilde b$}
        \KwOutput{Predicted message $\hat{\textbf{m}}$, number of colorlisted tokens $w$}
        \tcc{Initialize counter}
        {$\textbf{W}_{p}[m] = 0 \text{   } \forall p,m$}\; 
        \tcc{Count tokens in colored lists}
        \For{$t \texttt{ in } [h+1, T]$}
        {
            $s=f(X_{t-h:t-1})$\;
            $p=\texttt{sample}([\tilde b])$ \;
            \For{$m \texttt{ in }[r]$}
            {
                Permute $\mathcal{V}_t$ using $s$ as seed\;
                \If{$X_t \in \mathcal{G}_t^{m}$}
                    {
                    $\textbf{W}_{p}[m]$ += 1 \;
                    }
        
            }
            
        }
        \tcc{Predict message}
        $\hat{\textbf{m}}_r = \text{`` "}$\; 
        $w=0$\;
        \For{$p \texttt{ in } [\tilde b]$}
        {
            $w$ += $\texttt{max}(\textbf{W}_{p}[m])$\;
            $\hat{m}=\texttt{argmax}_m(\mathbf{W}_p[m])$\;
            $\hat{\textbf{m}}_r$ += $\texttt{str}(\hat{m}$) \; 
        }
        Get bit message $\hat{\textbf{m}}$ by converting $\hat{\textbf{m}}_r$ \;
        \Return $\hat{\textbf{m}}$, $w$
\caption{Message Decoding}
\label{alg:extraction}
\end{algorithm}