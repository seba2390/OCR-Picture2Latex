\documentclass[9pt,twocolumn,twoside]{pnas-new}
%\usepacakage{url}
%\graphicspath{{Figures/}}
% Use the lineno option to display guide line numbers if required.
% Note that the use of elements such as single-column equations
% may affect the guide line number alignment. 

\templatetype{pnasresearcharticle} % Choose template 
% {pnasresearcharticle} = Template for a two-column research article
% {pnasmathematics} = Template for a one-column mathematics article
% {pnasinvited} = Template for a PNAS invited submission

\title{Detecting abnormality in heart dynamics from multifractal analysis of ECG signals}

% Use letters for affiliations, numbers to show equal authorship (if applicable) and to indicate the corresponding author
\author[a]{Snehal M. Shekatkar}
\author[a]{Yamini Kotriwar} 
\author[b]{K.P. Harikrishnan}
\author[a,1]{G. Ambika}

\affil[a]{Indian Institute of Science Education and Research, Pune-411008, India}
\affil[b]{Department of Physics, The Cochin College, Cochin-682002, India}

% Please give the surname of the lead author for the running footer
\leadauthor{Shekatkar} 

% Please add here a significance statement to explain the relevance of your work
%\significancestatement{Authors must submit a 120-word maximum statement about the significance of their research paper written at a level understandable to an undergraduate educated scientist outside their field of speciality. The primary goal of the Significance Statement is to explain the relevance of the work in broad context to a broad readership. The Significance Statement appears in the paper itself and is required for all research papers.}
\significancestatement{We address an important topic in clinical sciences about extracting quantifiers from measured Electro Cardio Gram(ECG)data to distinguish normal heart rhythms from the abnormal ones. The computed multifractal measures derived from discretized ECG, combined with a machine learning approach, provide fairly accurate indications of abnormality in cardiac rhythms. Further the subtle variations in the shape of beats captured from the analysis of beat replicated data have relevance in detecting variations in the normal heart dynamics. The analysis can enhance our understanding of possible transitions in the nonlinear dynamics underlying ECG data.}

% Please include corresponding author, author contribution and author declaration information
\authorcontributions{G.A. and K.P.H. conceived the research. Y.K. downloaded and detrended the data. S.M.S. automated the codes, performed the analysis. G.A. and S.M.S. prepared the manuscript. All authors discussed and reviewed the manuscript.}
\authordeclaration{Authors declare no conflict of interest.}
%\equalauthors{\textsuperscript{1}A.O.(Author One) and A.T. (Author Two) contributed equally to this work (remove if not applicable).}
\correspondingauthor{\textsuperscript{1}To whom correspondence should be addressed. E-mail: g.ambika\@iiserpune.ac.in}

% Keywords are not mandatory, but authors are strongly encouraged to provide them. If provided, please include two to five keywords, separated by the pipe symbol, e.g:
\keywords{Nonlinear time series analysis $|$ Multifractals $|$ ECG data $|$ Machine learning} 

\begin{abstract}
The characterization of heart dynamics with a view to distinguish abnormal from normal behavior is an interesting topic in clinical sciences. Here we present an analysis of the Electro-cardiogram (ECG) signals obtained under controlled conditions from several healthy and unhealthy subjects using the framework of multifractal analysis. Our analysis differs from the conventional nonlinear analysis in that the information contained in the amplitude variations of the signal is being extracted and quantified. The results thus obtained reveal that the attractor underlying the dynamics of the heart has multifractal structure and the resultant multifractal spectra can clearly separate healthy subjects from unhealthy ones. We use supervised machine learning approach to build a model that predicts the group label of a new subject with very high accuracy on the basis of the multifractal parameters. By comparing the range of scaling indices in the multifractal spectra with that of beat replicated data from the same ECG, we show how each ECG can be checked for abnormality for variations within itself. 
\end{abstract}

\dates{This manuscript was compiled on \today}
\doi{\url{www.pnas.org/cgi/doi/10.1073/pnas.XXXXXXXXXX}}

\begin{document}

% Optional adjustment to line up main text (after abstract) of first page with line numbers, when using both lineno and twocolumn options.
% You should only change this length when you've finalized the article contents.
\verticaladjustment{-2pt}

\maketitle
\thispagestyle{firststyle}
\ifthenelse{\boolean{shortarticle}}{\ifthenelse{\boolean{singlecolumn}}{\abscontentformatted}{\abscontent}}{}

% If your first paragraph (i.e. with the \dropcap) contains a list environment (quote, quotation, theorem, definition, enumerate, itemize...), the line after the list may have some extra indentation. If this is the case, add \parshape=0 to the end of the list environment.
%\dropcap{T}his PNAS journal template is provided to help you write your work in the correct journal format.  Instructions for use are provided below.

\dropcap{T}he complexity of many physiological rhythms originate from the underlying complex nonlinear dynamical processes \cite{lewis1975phase, glass2001synchronization, karma2013physics, pijn1991chaos, qu2014nonlinear, webber1994dynamical, muller2016causality}. The various levels of this complexity and their variations, if properly discerned, will be useful in understanding the abnormalities that lead to many pathological cases\cite{mendis2011global, world2014global, go2014heart}. A mathematical representation of their complexity using dynamical equations is most often not realizable due to the many interacting variables and uncertain parameters involved \cite{bruggeman2007nature, lillacci2010parameter}. Hence the only possibility to study the dynamics in such situations to is to rely on information that can be deciphered from signals obtained from these systems\cite{kantz2004nonlinear, lehnertz1998can, richman2000physiological}. Over the last few decades, several such physiological signals like EEG, ECG, fMRI etc have been subjected to different techniques available under the broad area of nonlinear time series analysis \cite{kurths1995quantitative, marwan2002recurrence, kantz2004nonlinear}.

It is established that most of the cardiovascular diseases arise from the changes in the dynamics of the heart. A healthy heart is a complex system with fractal nature \cite{ivanov1999multifractality, yang2007multifractal, glass2012theory} but cardiac abnormalities or malfunctions can cause subtle changes or variations in its complexity. However, the complexity related quantifiers have not yet reached the clinics for effective diagnostics and therapy. For this, we have to develop a unique way of characterizing its complexity that will help to distinguish healthy and pathological cases. In the present work, we report how measures derived from the multi fractal spectrum of ECG signals can effectively be used as a promising tool in the diagnosis of abnormalities of the heart. 

There are a few reported research in related analysis using ECG signals \cite{kurths1995quantitative, voss1996application, ivanov1999multifractality, yang2007multifractal}. But most of them are on the peak to peak time intervals (also called as \textit{R-R} intervals) \cite{makowiec2011reading, cysarz2011unexpected} and hence do not include the possible information content in the amplitude variations in the signals. This motivates us to proceed with a detailed analysis that provides unique measures that characterize the actual amplitude variations also from the point of view of the multifractal analysis. Such analysis is also advantageous over \textit{R-R} interval analysis because the actual amount of time for which the signal needs to be recorded is smaller by orders of magnitude.

As already mentioned, dynamics underlying many natural processes are essentially deterministic but are highly nonlinear and complex. Since generally the dynamical equations or even the effective dimension of the system are not known, we have to rely on observational data of one of the variables or time series of the average responses like ECG to characterize its dynamics. The first step in the analysis is the reconstruction of the underlying attractor from the time series of a single variable \cite{kantz2004nonlinear} based on Taken's theorem \cite{takens1981dynamical, packard1980geometry}. Over the last few decades, this has become an extremely mature field and a wide variety of methods have been developed \cite{takens1981dynamical, packard1980geometry, theiler1992testing, schreiber2000surrogate, grassberger1983measuring, harikrishnan2006non, harikrishnan2009computing}. These methods have found successful applications in diverse fields like astrophysics \cite{misra2006nonlinear}, physiology \cite{voss1996application, perc2005nonlinear}, atmospheric sciences \cite{vautard1989singular, koccak2000nonlinear}, geology \cite{foufoula2014wavelets} and stock markets \cite{hafner2013nonlinear}. Among them, an important class of methods is related to the characterization of the complex dynamics using multifractal analysis \cite{kantz2004nonlinear, mandelbrot2013multifractals}.

We identify two such measures computed from the multi fractal spectrum with their ranges distinctly distinguishable for healthy and diseased cases. This makes the proposed analysis very effective and powerful for clinical purposes where better accuracy compared to visual inspection can be realized. We illustrate this by applying the analysis to ECG signals from a number of normal and pathological subjects and our conclusions are validated using supervised machine learning approach and comparisons with beat replicated data from individual ECG.

\section{Phase space reconstruction from ECG data}
The data of $97$ unhealthy and $32$ healthy subjects obtained from PhysioBank database \cite{goldberger2000physiobank} are pre-processed to make them suitable for the analysis (See Methods). Each dataset consists of ECG time series taken from six different chest electrodes or channels $v_1$ to $v_6$. As a preliminary analysis, we carry out the usual statistical and linear analysis and obtain the power spectra for all the data sets using the Fast Fourier Transform (FFT) algorithm. The frequency with the maximum power for each one of them and the distribution of these peak frequencies for all the subjects are summarized in Fig.~\ref{peak_freq} for data from six chest electrodes. It is clear that it is not possible to conclusively distinguish the two groups using the peak frequencies as they fall in similar ranges. 

\begin{figure}[h]
\begin{center}
\includegraphics[trim=50 0 100 0, clip=true,width=\columnwidth]{Peak_frequencies.pdf}
\caption{\label{peak_freq} Violin-plot showing the distributions of frequencies with highest power for healthy and unhealthy groups for different chest electrodes. }
\end{center}
\end{figure}

Hence we resort to methods of nonlinear analysis and reconstruct phase space structure of the system's dynamics from its discretely sampled time series $s(t_k)$. For a visual display of the resulting phase space structure or dynamical attractor, we use the technique of singular-value decomposition (SVD) \cite{broomhead1986extracting, albano1988singular}. (See Methods section for details about embedding). In Fig.~\ref{phase_space} we show a few representative embedded attractors from healthy and unhealthy groups. Each of the attractors is shown in the axes corresponding to statistically independent variables obtained from SVD. 

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.95\columnwidth, trim = 20 20 20 20, clip = true]{svd_phase_space_ecg2.pdf}
\caption{\label{phase_space} Two dimensional projections of embedded attractors for ECG signals for three healthy (top panel) and three unhealthy (bottom panel) cases. All the attractors are plotted using the SVD transformation.}
\end{center}
\end{figure}

Since the complex structure of the attractor inherently contains information about the complexity of its dynamics, it is important to characterize it quantitatively. Several quantifiers have been studied in this context over the years \cite{paladin1986intermittency}, the most effective among them being the set of fractal dimensions. In the following sections, we indicate how correlation dimension is used along with surrogate analysis to identify the nonlinear nature of the underlying dynamics and how the geometrical complexity of its structure is quantified using multifractal measures.

\section{Correlation dimension and Surrogate analysis}
We recreate the phase space structure of the underlying dynamics in an embedding space of dimension $M$ with delay vectors constructed by splitting the discretely sampled ECG data with delay time $\tau$. The dimension $M$ is chosen as the value at which any fractal measure, like correlation dimension $D_2$, saturates. The distributions of saturated $D_2$ values for healthy and unhealthy groups is shown in Fig.~\ref{D2}. Since all the $D_2$ values are less than $4$, for uniformity, we use $M = 4$ as the embedding dimension for all the signals. 

\begin{figure}[h]
\includegraphics[trim = 30 0 0 0, clip = true, width=\columnwidth]{D2_compression_hist2.pdf}
\caption{\label{D2} Distribution of correlation dimension ($D_2$) values for healthy subjects (Green) and unhealthy ones (Red). As can be seen, all the values are less than $4$ and so we choose $M = 4$ as the embedding dimension.}
\end{figure}

Before undertaking any type of nonlinear analysis, it is important to first verify that the observed time series indeed results from an underlying nonlinear process. We check the nonlinear and deterministic nature of the underlying dynamics using a statistically rigorous method of surrogate analysis\cite{theiler1992testing, schreiber2000surrogate}. For this, we generate surrogate data using TISEAN package \cite{hegger1999practical}. With correlation dimension as a measure, we plot in Fig.~\ref{D2_saturate} the values for the original signal and the generated surrogates as a function of embedding dimension $M$. Since the values of $D_2$ for surrogate data differ significantly from that of the original signal, we conclude that the signal comes from the underlying nonlinearity.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.8\columnwidth]{D2_saturate}
\caption{\label{D2_saturate}  $D_2$ values as a function of embedding dimension $M$ for four randomly chosen datasets (blue) and their surrogates (magenta). It can be seen that the $D_2$ values of surrogates sufficiently deviate from that of the original data.}
\end{center}
\end{figure}

\section{\label{multifractal_analysis}Multifractal analysis}
The reconstructed phase-space attractors for most of the complex systems like heart dynamics possess a multifractal structure which is characterized by a set of generalized dimensions $D_q$ so that the non-uniformity in the distribution of points on the attractor becomes evident through different values of $q$. However the local scaling properties on the attractor are captured by a spectrum of singularities related to the probability measure on the course-grained attractor. Thus, if the attractor is covered by boxes of size $r$, the probability of points in the $i^{\text{th}}$ box scales as $p_i(r) \sim r^{\alpha_i}$. For a multifractal, the range of scales $\alpha_i$ present is a measure of its complexity. The number of boxes with the same $\alpha$ scales as $N_{\alpha}(r) \sim r^{f(\alpha)}$. Both $(D_q, q)$ and $(f(\alpha), \alpha)$ provide analogous characterizations and are related by Legendre transformations as \cite{harikrishnan2009computing}:

\begin{equation}
\label{Dq_alpha1}
\alpha = \frac{d}{dq}[(q-1)D_q]
\end{equation}

\begin{equation}
\label{Dq_alpha2}
f(\alpha) = q\alpha - (q-1)D_q
\end{equation}

Thus, a convenient way of calculating the multifractal spectrum is to calculate the generalized dimensions $D_q$ and then use equations (\ref{Dq_alpha1}) and (\ref{Dq_alpha2}) to find out $f(\alpha)$ and $\alpha$. An algorithmic approach to perform this has been given by Harikrishnan et al \cite{harikrishnan2009computing} and here we follow the same method with suitable modifications for ECG signals with the following mathematical form for $f(\alpha)$ spectrum:

\begin{equation}
f(\alpha) = A(\alpha-\alpha_1)^{\gamma_1}(\alpha_2-\alpha)^{\gamma_2}
\end{equation}
in which, as described in \cite{harikrishnan2009computing}, only four of the five parameters $A, \alpha_1, \alpha_2, \gamma_1, \gamma_2$ are independent. These four parameters provide a unique characterization of $f(\alpha)$ spectrum of the multifractal.

In our numerical computations of the four parameters from the multifractal analysis of ECG data, we find that the errors in the values of $\alpha_{2}$ and $\gamma_2$ are considerable. This is because they are derived from $f(\alpha)$ curve obtained from the $D_q$ data with negative values of $q$ which in turn corresponds to sparse regions of the attractor. With only a finite length of data, the number of vectors in the sparse regions of the attractor tends to become too low in numbers resulting in larger error bars for the $D_q$ values. For this reason, while deriving conclusions from the results, we concentrate mostly on the $\alpha_1$ and $\gamma_1$ values that are associated with the dense regions of the attractor.

%\begin{figure}
%\begin{center}
%\includegraphics[width=0.8\columnwidth]{Dq_curves.pdf}
%\caption{\label{Dq_curves} Variation of the generalized dimension values $D_q$ as a function of $q$ for $5$ randomly chosen subjects from each group. The continuous green lines represent healthy subjects while the dashed red lines represent the patients. As explained in the text, the $D_q$ values on the negative side are not very reliable.}
%\end{center}
%\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.8\columnwidth]{falpha}
\caption{\label{falpha} Multifractal spectrum curves for $5$ randomly selected subjects from each group. The continuous green curves represent healthy subjects while the dashed red curves are for the non-healthy ones. }
\end{center}
\end{figure}

The difference $\alpha_2-\alpha_1$, that measures the width of the $f(\alpha)$ spectrum provides the range of scaling indices. In Fig.~\ref{alpha_diff_hist}, we show the distributions of this difference for healthy and unhealthy groups. It can be concluded that the complexity tends to be more for healthy hearts across all the channels.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.8\columnwidth]{alpha_diff_hist.pdf}
\caption{\label{alpha_diff_hist}  Distributions of the difference $\alpha_2-\alpha_1$ for healthy(green) and unhealthy(red) groups for different channels. This difference is a measure of the complexity of dynamics underlying the ECG, as described in the text and thus, healthy hearts seem to be more complex than the unhealthy ones.}
\end{center}
\end{figure}

\subsection{Parameter planes}
In Fig.~\ref{alpha_gamma}, we present the scatter plots of $\alpha_1$ and $\gamma_1$ values for electrodes $v_1$ to $v_6$. The green circles in these plots represent the subjects identified as healthy in the PhysioNet database and the red squares represent the unhealthy ones. A few cases, for which the good fit could not be obtained have been discarded while plotting these parameter planes. For the purpose of visualization, we also show estimated kernel densities for the two groups as a background. As can be seen from these plots, multifractal analysis seems to have picked up almost every case correctly by separating the healthy and unhealthy cases into different clusters in $\alpha_1$-$\gamma_1$ planes. 

\begin{figure}[h]
\includegraphics[width=1\columnwidth]{alpha1_gamma1_planes5.pdf}
\caption{\label{alpha_gamma}  Scatter plots for electrodes $v_1$ to $v_6$ in $\alpha_1$-$\gamma_1$ parameter planes. Green circles in the figure represent the healthy subjects and red squares represent patients. Overall, healthy cases are seen to be clustered whereas the patients are separated from healthy ones and are scattered.}
\end{figure}

\subsection{Blind data testing and success rate}
The separation of the two groups into two different clusters becomes useful only if it helps us to predict the group label (healthy or unhealthy) for a new unseen data. This is a standard problem in the theory of machine learning and we use a particular algorithm called a ``support vector clustering'' or SVC using RBF kernel \cite{bishop2006pattern} to find out the regions in $\alpha_1$-$\gamma_1$ planes corresponding to the two groups. The known group labels are used as a training data for the algorithm to identify healthy and unhealthy cases and then the algorithm is asked to divide the parameter plane into two regions. The regions so obtained for different channels are shown in Fig.~\ref{svc_rbf}.

\begin{figure}[h]
\begin{center}
\includegraphics[width=\columnwidth]{svc_rbf_clustering2.pdf}
\caption{\label{svc_rbf} Regions of the parameter plane $\alpha_1$-$\gamma_1$ that separate healthy and unhealthy regions obtained using SVC algorithm for electrodes $v_1$ to $v_6$. The actual data points are also shown for comparison with the regions.}
\end{center}
\end{figure}
As another set of quantifiers, we now consider the parameter plane $\alpha_1$-$\alpha_0$, where $\alpha_0$ is the $\alpha$ value corresponding to the maximum value of $f(\alpha)$ curve and perform a similar analysis. The resulting regions are shown in Fig.~\ref{svc_alpha}.

\begin{figure}[h]
\begin{center}
\includegraphics[width=\columnwidth]{svc_rbf_clustering_alpha1_alpha0.pdf}
\caption{\label{svc_alpha} Regions corresponding to healthy and unhealthy cases in $\alpha_1$-$\alpha_0$ plane found using SVC algorithm.}
\end{center}
\end{figure}

The regions shown in Fig.~\ref{svc_rbf} and Fig.~\ref{svc_alpha} are obtained by training the SVC algorithm by using the whole data. However, this doesn't tell us how well the algorithm would perform when given an unseen data. To check this, we split the whole data into two parts: training set and test set. We then train the algorithm on the training data and then ask it to predict the labels for the test data. To measure the success we calculate true positive rate ($t_p$) and true negative rate ($t_n$). True positive rate in this case is defined as the fraction of correctly identified healthy cases out of the actual healthy cases. Similarly, true negative rate is defined as the fraction of the correctly identified unhealthy cases out of the actual unhealthy cases. We then define the accuracy of the algorithm to be: $\text{Accuracy} = t_p \times t_n$.

This definition of the accuracy makes sure that both cases are predicted reasonably accurately since even if one of them is low the accuracy becomes low. In particular, if the algorithm labels all cases to be of the single group, the accuracy becomes zero. The value of the accuracy also depends on how the data is split and so, we average the value over ten random realizations of the splitting. These average accuracies, calculated for $\alpha_1$-$\gamma_1$ planes, as a function of size of the training set for different channels are shown in Fig.~\ref{svc_scores}. It can be seen that even for low amount of training data, the accuracy is quite high. 

\begin{figure}[h]
\begin{center}
\includegraphics[trim=50 0 20 0, clip = true, width=\columnwidth]{svc_scores.pdf}
\caption{\label{svc_scores}  Accuracy of the SVC algorithm as a function of fraction of training data set. It can be seen that even for the low sizes of the training sample, the algorithm predicts the class labels with extremely high accuracy ($>90\%$).}
\end{center}
\end{figure}

%\begin{figure} %\includegraphics[width=0.8\columnwidth]{k_means_col9.pdf}
%\caption{\label{k_means} Two groups (healthy and unhealthy) detected using K-means clustering (left) and the actual groups known groups (right) for electrode $v_3$. }
%\end{figure}

%As we have already said that the errors associated with the parameters $\alpha_2$ and $\gamma_2$ are high, they cannot be used to distinguish healthy and unhealthy classes. To support this, we apply the k-means clustering algorithm to various combinations of parameters $\alpha_{1, 2}$, $\gamma_{1, 2}$ and try to detect two clusters. The results are shown in Fig.~\ref{clustering}. The top panel in that figure shows clusters detected by applying k-means algorithm for various combinations of parameters and the bottom panel in the same figure shows the actual groupings in the corresponding planes. It is clear from these plots that only the parameter combinations $\alpha_1$-$\alpha_2$ and $\alpha_1$-$\gamma_1$ result into clusters which correspond to the actual healthy and unhealthy groups. Thus, we suggest that only the combination $\alpha_1$-$\gamma_1$ be used in the clinical practice. 


\section{Comparison with beat replicated data}
The results described in the previous section show that the multifractal analysis is extremely successful for separating healthy and unhealthy classes. Thus, given an ECG time series of a person that is not known to be in one or the other group a priori, we can calculate the corresponding $\alpha_1$-$\gamma_1$ values and then using its location in this parameter plane, we can predict the class the person belongs to with sufficient confidence. However, in general, definition of healthy and unhealthy can be quite subjective. For example, in the healthy class, ECG characteristics in general differ based on age, gender, habits, life styles etc. This makes comparing the measures of one set with that of another somewhat arbitrary unless both are with the same age, gender, habits etc, which is not always very practical. Therefore we introduce a finer method of analysis, by checking how the multifractal properties of a given data compare with that of the beat replicated data generated from a single beat in the same ECG. This would in a way compare each data within itself and the range of variations can be used effectively as a quantifier for normal and abnormal hearts.

We extract $10$ different randomly chosen beats from each signal (See Methods). Then we replicate each of these beats to get time series of approximately the same sizes as that of the original time series and perform multifractal analysis for each one of these to obtain the parameters $\alpha$ and $\gamma$. In Fig.~\ref{replicate_violin}, we show distributions of $\alpha_1$ values for $20$ randomly chosen subjects from each group. For comparison, we also show the original $\alpha_1$ value in each case (yellow circles). As can be seen, the actual $\alpha_1$ values in case of healthy subjects tend to coincide with the $\alpha_1$ values for beat replicated time series. On the other hand, the actual $\alpha_1$ values in case of unhealthy cases tend to be quite far from the mean of the replicated $\alpha_1$ values. To make this quantitative, we define $\delta\alpha_1$ to be the difference between the mean of the replicated $\alpha_1$ values and the $\alpha_1$ value for the full time series. The histograms of this quantity for two groups are shown in Fig.~\ref{diff_alpha1}. It can be seen that the distributions are quite separated from each other. This implies that one can distinguish the two classes solely on the basis of the comparison of values for the data with its own beat replicated data sets. 

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.9\columnwidth]{replicated_violin_plot_new_alpha1.pdf}
\caption{\label{replicate_violin} Violin-plot of $\alpha_1$ values calculated by replicating several randomly chosen beats for few healthy (top panel) and unhealthy (bottom panel) subjects. Each label on $x$-axis represents a subject and the $\alpha_1$ values for time series obtained by replicating different beats of that person are plotted along $y$-axis. The bigger yellow markers in the plots represent the $\alpha_1$ values obtained from the complete time series. It can be seen that the actual $\alpha_1$ values for patients tend to fall outside the replicated values.}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=\columnwidth]{diff_alpha1_hist.pdf}
\caption{\label{diff_alpha1}  Distributions of the difference between the mean of the replicated $\alpha_1$ values and the $\alpha_1$ value for the full time series for healthy and unhealthy groups.}
\end{center}
\end{figure}



%\subsubsection*{Appendices}

%PNAS prefers that authors submit individual source files to ensure readability. If this is not possible, supply a single PDF file that contains all of the SI associated with the paper. This file type will be published in raw format and will not be edited or composed.

\matmethods{

\subsection{Data acquisition}
%\subsection{Description of the data}
For our analysis presented here, we have used Data from ``PhysioNet'' Resource with its PhysioBank archive \cite{goldberger2000physiobank}. In total, we included data for $97$ abnormal subjects and $32$ healthy subjects. Each dataset consists of $15$ channels which correspond to different electrodes, the conventional $12$ leads ($i, ii, iii, avr, avl, avf, v_1, v_2, v_3, v_4, v_5, v_6$) together with the $3$ Frank leads ($v_x, v_y, v_z$). Out of these, in this work we concentrate only on six of the channels $v_1$ to $v_6$ that correspond to electrodes which are placed directly on the chest. Each signal corresponds to a real time of $60$ seconds and is digitized at $1000$ samples per second to obtain in total $60000$ points per signal.  

Among the $97$ patient data available to us, $79$ suffer from Myocardial Infraction (MI), $6$ suffer from Cardiomyopathy, $4$ suffer from Myocarditis, $2$ suffer from Dysrhythmia and $1$ from Hypertrophy while for the remaining $5$, the disease information is not available. The subjects in the healthy class have age values distributed between $24$ and $69$ whereas the age values in the unhealthy class are distributed between $41$ and $86$. 

\subsection{Detrending of the signals}
The ECG signals often contain global trends as shown for a typical data in the top panel of Fig.~\ref{ecg_detrended_ts}. As part of the pre processing, we first remove these trends as described below and the de-trended data thus obtained after removing the global trends is shown in Fig.~\ref{ecg_detrended_ts}.

To remove the undesirable trends, we fit a polynomial of a certain degree to the signal, which is then subtracted from the actual signal to get the de-trended signal. To choose the appropriate value of the degree $n$ to be used for the fitting polynomial, we define a deviation $\delta_{(n)}$ of the original signal from the detrended signal as:

\begin{equation}
\delta_{(n)} = \frac{1}{N}\sum\limits_{i=1}^{N}(x_o(i)-x_{(n)}(i))^2
\end{equation}

\begin{figure}
\begin{center}
\includegraphics[width=0.8\columnwidth]{ecg_detrended_ts}
\caption{\label{ecg_detrended_ts} Time series of a randomly chosen subject before detrending (top panel) and after detrending (bottom panel). As explained in the text, the global trend is removed by fitting a polynomial to the original data. }
\end{center}
\end{figure}
We find that $\delta_{(n)}$ saturates as we vary $n$ and hence we can choose $n$ after the saturation point for a given signal. Based on this, for all the datasets we use $n=20$ to detrend them. 

%Please describe your materials and methods here. This can be more than one paragraph, and may contain subsections and equations as required. Authors should include a statement in the methods section describing how readers will be able to access the data in the paper. 

\subsection*{Embedding and phase space reconstruction}
For uniformity, all the values in the time series $c(t_k)$ are first scaled between $0$ and $1$ by using a transformation of ``compression'':
\begin{equation}
s(t_k) = \frac{c(t_k)-c_{\text{min}}}{c_{\text{max}}-c_{\text{min}}}
\end{equation}
where $c_{\text{min}}$ and $c_{\text{max}}$ are minimum and maximum values in the time series $c(t_k)$ respectively. 
Each time series $s(t_k)$ is then embedded into an $M$ dimensional space, by constructing vectors as:
\begin{equation}
\vec{x}_i = [s(t_i), s(t_i + \tau), s(t_i + 2\tau), \cdots, s(t_i + (M-1)\tau)]
\end{equation}
Here a time delay $\tau$ is the time, measured in units of sampling rate $\triangle = t_{i+1}-t_i$, at which autocorrelation of the signal falls to $1/e$ of its original value \cite{harikrishnan2006non}. It is easy to see that there are in total $N-(M-1)\tau$ embedded vectors. Taken's embedding theorem dictates that the phase space trajectories or attractor obtained from these vectors have the same topological properties as that of the original system\cite{takens1981dynamical}.

\subsection{Extracting a single beat from an ECG time series}
Identifying a single beat in an ECG signal is tricky since a beat cannot be defined as a pattern that repeats with exact periodicity in the ECG signal. However, it is easy to see that ECG signals do have a certain approximate periodicity because of the presence of beats. For the data used, in units of milliseconds, the individual beats repeat with a period $T\in (600, 1500)$. We then calculate the autocorrelation of the time series and find out the highest peak in this range. The corresponding time value is then taken as the period of the signal and the same is used to extract a single beat from the time series. 

}

\section{Discussion}
We report the results of a detailed multifractal analysis of discretized ECG data for two sets of healthy and unhealthy subjects. Our study establishes the highly complex fractal nature of a healthy heart, which gets reduced due to any abnormality in its functions.  We could show that the measures derived from the multifractal spectrum can detect abnormalities in heart dynamics with a reasonable level of accuracy. The fact that this is achieved with short time ECG recordings of a significantly small amount of time enhances the scope for its applicability. Moreover the analysis is totally objective and the results are quantitative.

The novelty of our approach is that the subtle variations in the shapes of the beats are captured into readable quantities or values which will be much more reliable than conclusions derived from visual inspections. This information can be used to assess the status of health and risk level of the heart easily. The fluctuations of the beat-to-beat dynamics as revealed in the ECG exhibit a rich complexity that, as carefully characterized in this work, can give indications of cardiac malfunctions. Our analysis, using beat replicated data, helps in comparing quantifiers of one ECG with variations within itself. The study is thus an advancement both in the basic understanding of the fractal nature underlying a complex system like heart and its abnormal states as well as in designing clinically useful practical tools in effective diagnostics and therapy. 

\showmatmethods{} % Display the Materials and Methods section

%\acknow{Please include your acknowledgments here, set in a single paragraph. Please do not include any acknowledgments in the Supporting Information, or anywhere else in the manuscript.}
\acknow{The authors acknowledge the financial support from Dept. of Sci. and Tech., Govt. of India, through a Research Grant No.
EMR/2014/000876. We also acknowledge the Physiobank data base (www.physionet.org/physiobank/database/) for the ECG data used in the study reported here.}

\showacknow{} % Display the acknowledgments section

% \pnasbreak splits and balances the columns before the references.
% Uncomment \pnasbreak to view the references in the PNAS-style
% If you see unexpected formatting errors, try commenting out \pnasbreak
% as it can run into problems with floats and footnotes on the final page.
%\pnasbreak

% Bibliography
%\bibliography{ref_all2}
\begin{thebibliography}{10}

\bibitem{lewis1975phase}
Lewis~Jr WM (1975) Phase locking, period-doubling bifurcations, and irregular
  dynamics in periodically stimulated cardiac cells.
\newblock {\em Oecologia (Berlin)} 19:75.

\bibitem{glass2001synchronization}
Glass L (2001) Synchronization and rhythmic processes in physiology.
\newblock {\em Nature} 410(6825):277--284.

\bibitem{karma2013physics}
Karma A (2013) Physics of cardiac arrhythmogenesis.
\newblock {\em Annu. Rev. Condens. Matter Phys.} 4(1):313--337.

\bibitem{pijn1991chaos}
Pijn JP, Van~Neerven J, Noest A, da~Silva FHL (1991) Chaos or noise in eeg
  signals; dependence on state and brain site.
\newblock {\em Electroencephalography and clinical Neurophysiology}
  79(5):371--381.

\bibitem{qu2014nonlinear}
Qu Z, Hu G, Garfinkel A, Weiss JN (2014) Nonlinear and stochastic dynamics in
  the heart.
\newblock {\em Physics reports} 543(2):61--162.

\bibitem{webber1994dynamical}
Webber CL, Zbilut JP (1994) Dynamical assessment of physiological systems and
  states using recurrence plot strategies.
\newblock {\em Journal of applied physiology} 76(2):965--973.

\bibitem{muller2016causality}
M{\"u}ller A, et~al. (2016) Causality in physiological signals.
\newblock {\em Physiological measurement} 37(5):R46.

\bibitem{mendis2011global}
Mendis S, Puska P, Norrving B, , et~al. (2011) {\em Global atlas on
  cardiovascular disease prevention and control.}
\newblock (World Health Organization).

\bibitem{world2014global}
Organization WH, , et~al. (2014) {\em Global status report on noncommunicable
  diseases 2014.}
\newblock (World Health Organization).

\bibitem{go2014heart}
Go AS, et~al. (2014) Heart disease and stroke statistics-2014 update.
\newblock {\em Circulation} 129(3).

\bibitem{bruggeman2007nature}
Bruggeman FJ, Westerhoff HV (2007) The nature of systems biology.
\newblock {\em TRENDS in Microbiology} 15(1):45--50.

\bibitem{lillacci2010parameter}
Lillacci G, Khammash M (2010) Parameter estimation and model selection in
  computational biology.
\newblock {\em PLoS Comput Biol} 6(3):e1000696.

\bibitem{kantz2004nonlinear}
Kantz H, Schreiber T (2004) {\em Nonlinear time series analysis}.
\newblock (Cambridge university press) Vol.{}~7.

\bibitem{lehnertz1998can}
Lehnertz K, Elger CE (1998) Can epileptic seizures be predicted? evidence from
  nonlinear time series analysis of brain electrical activity.
\newblock {\em Physical review letters} 80(22):5019.

\bibitem{richman2000physiological}
Richman JS, Moorman JR (2000) Physiological time-series analysis using
  approximate entropy and sample entropy.
\newblock {\em American Journal of Physiology-Heart and Circulatory Physiology}
  278(6):H2039--H2049.

\bibitem{kurths1995quantitative}
Kurths J, et~al. (1995) Quantitative analysis of heart rate variability.
\newblock {\em Chaos: An Interdisciplinary Journal of Nonlinear Science}
  5(1):88--94.

\bibitem{marwan2002recurrence}
Marwan N, Wessel N, Meyerfeldt U, Schirdewan A, Kurths J (2002)
  Recurrence-plot-based measures of complexity and their application to
  heart-rate-variability data.
\newblock {\em Physical review E} 66(2):026702.

\bibitem{ivanov1999multifractality}
Ivanov PC, et~al. (1999) Multifractality in human heartbeat dynamics.
\newblock {\em Nature} 399(6735):461--465.

\bibitem{yang2007multifractal}
Yang X, Ning X, Wang J (2007) Multifractal analysis of human synchronous
  12-lead ecg signals using multiple scale factors.
\newblock {\em Physica A: Statistical Mechanics and its Applications}
  384(2):413--422.

\bibitem{glass2012theory}
Glass L, Hunter P, McCulloch A (2012) {\em Theory of heart: biomechanics,
  biophysics, and nonlinear dynamics of cardiac function}.
\newblock (Springer Science \& Business Media).

\bibitem{voss1996application}
Voss A, et~al. (1996) The application of methods of non-linear dynamics for the
  improved and predictive recognition of patients threatened by sudden cardiac
  death.
\newblock {\em Cardiovascular research} 31(3):419--433.

\bibitem{makowiec2011reading}
Makowiec D, Rynkiewicz A, Ga{\l}aska R, Wdowczyk-Szulc J,
  {\.Z}arczy{\'n}ska-Buchowiecka M (2011) Reading multifractal spectra: aging
  by multifractal analysis of heart rate.
\newblock {\em EPL (Europhysics Letters)} 94(6):68005.

\bibitem{cysarz2011unexpected}
Cysarz D, et~al. (2011) Unexpected course of nonlinear cardiac interbeat
  interval dynamics during childhood and adolescence.
\newblock {\em PloS one} 6(5):e19400.

\bibitem{takens1981dynamical}
Takens F, , et~al. (1981) Dynamical systems and turbulence.
\newblock {\em Lecture notes in mathematics} 898(9):366.

\bibitem{packard1980geometry}
Packard NH, Crutchfield JP, Farmer JD, Shaw RS (1980) Geometry from a time
  series.
\newblock {\em Phys. Rev. Lett.} 45(9):712.

\bibitem{theiler1992testing}
Theiler J, Eubank S, Longtin A, Galdrikian B, Farmer JD (1992) Testing for
  nonlinearity in time series: the method of surrogate data.
\newblock {\em Physica D: Nonlinear Phenomena} 58(1-4):77--94.

\bibitem{schreiber2000surrogate}
Schreiber T, Schmitz A (2000) Surrogate time series.
\newblock {\em Physica D: Nonlinear Phenomena} 142(3):346--382.

\bibitem{grassberger1983measuring}
Grassberger P, Procaccia I (1983) Measuring the strangeness of strange
  attractors.
\newblock {\em Physica D: Nonlinear Phenomena} 9(1-2):189--208.

\bibitem{harikrishnan2006non}
Harikrishnan KP, Misra R, Ambika G, Kembhavi AK (2006) A non-subjective
  approach to the gp algorithm for analysing noisy time series.
\newblock {\em Physica D: Nonlinear Phenomena} 215(2):137--145.

\bibitem{harikrishnan2009computing}
Harikrishnan KP, Misra R, Ambika G, Amritkar RE (2009) Computing the
  multifractal spectrum from time series: an algorithmic approach.
\newblock {\em Chaos: An Interdisciplinary Journal of Nonlinear Science}
  19(4):043129.

\bibitem{misra2006nonlinear}
Misra R, Harikrishnan KP, Ambika G, Kembhavi AK (2006) The nonlinear behavior
  of the black hole system grs 1915+ 105.
\newblock {\em The Astrophysical Journal} 643(2):1114.

\bibitem{perc2005nonlinear}
Perc M (2005) Nonlinear time series analysis of the human electrocardiogram.
\newblock {\em European Journal of Physics} 26(5):757.

\bibitem{vautard1989singular}
Vautard R, Ghil M (1989) Singular spectrum analysis in nonlinear dynamics, with
  applications to paleoclimatic time series.
\newblock {\em Physica D: Nonlinear Phenomena} 35(3):395--424.

\bibitem{koccak2000nonlinear}
Ko{\c{c}}ak K, {\c{S}}aylan L, {\c{S}}en O (2000) Nonlinear time series
  prediction of $\text{O}_3$ concentration in istanbul.
\newblock {\em Atmospheric Environment} 34(8):1267--1271.

\bibitem{foufoula2014wavelets}
Foufoula-Georgiou E, Kumar P (2014) {\em Wavelets in geophysics}.
\newblock (Academic Press) Vol.{}~4.

\bibitem{hafner2013nonlinear}
Hafner C (2013) {\em Nonlinear time series analysis with applications to
  foreign exchange rate volatility}.
\newblock (Springer Science \& Business Media).

\bibitem{mandelbrot2013multifractals}
Mandelbrot BB (2013) {\em Multifractals and 1/Æ’ Noise: Wild Self-Affinity in
  Physics (1963--1976)}.
\newblock (Springer).

\bibitem{goldberger2000physiobank}
Goldberger AL, et~al. (2000) Physiobank, physiotoolkit, and physionet.
\newblock {\em Circulation} 101(23):e215--e220.

\bibitem{broomhead1986extracting}
Broomhead DS, King GP (1986) Extracting qualitative dynamics from experimental
  data.
\newblock {\em Physica D: Nonlinear Phenomena} 20(2-3):217--236.

\bibitem{albano1988singular}
Albano AM, Muench J, Schwartz C, Mees AI, Rapp PE (1988) Singular-value
  decomposition and the grassberger-procaccia algorithm.
\newblock {\em Physical Review A} 38(6):3017.

\bibitem{paladin1986intermittency}
Paladin G, Peliti L, Vulpiani A (1986) Intermittency as multifractality in
  history space.
\newblock {\em Journal of Physics A: Mathematical and General} 19(16):L991.

\bibitem{hegger1999practical}
Hegger R, Kantz H, Schreiber T (1999) Practical implementation of nonlinear
  time series methods: The tisean package.
\newblock {\em Chaos: An Interdisciplinary Journal of Nonlinear Science}
  9(2):413--435.

\bibitem{bishop2006pattern}
Bishop CM (2006) Pattern recognition.
\newblock {\em Machine Learning} 128:1--58.

\end{thebibliography}

\end{document}
              
            
