% use option [preprint] to remove info line at bottom
% natbib option: authoryear
\documentclass[aoas,preprint]{imsart}

\usepackage{amsthm,amsmath}
\usepackage[authoryear]{natbib}
\RequirePackage[colorlinks,citecolor=blue,urlcolor=blue]{hyperref}

\usepackage{graphicx,psfrag,epsf}
\usepackage{enumerate}
\usepackage{url}
\usepackage{color}
\usepackage[T1]{fontenc}
\usepackage{subcaption}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{booktabs}
\usepackage{color}
\usepackage{multicol}
\usepackage{floatrow}
\usepackage{todonotes}
\usepackage{placeins}


\addtolength{\textheight}{0.5cm}

\sloppy

\presetkeys{todonotes}{color=blue!30,size=\small}{}

% Table float box with bottom caption, box width adjusted to content
\newfloatcommand{capbtabbox}{table}[][\FBwidth]

\graphicspath{{figures/}}
\DeclareGraphicsExtensions{.pdf,.jpeg,.jpg,.png}

\usepackage{pgfplots}
\pgfplotsset{compat=1.13}
\usepgfplotslibrary{colorbrewer}
\pgfplotsset{cycle list/Set1-4}


% provide arXiv number if available:
\arxiv{1803.00113}

% put your definitions there:
\startlocaldefs

\hyphenation{Bayes-i-an}
\hyphenation{La-place}

\endlocaldefs


\makeatletter

% line breaks for long urls at hyphens
\g@addto@macro{\UrlBreaks}{\UrlOrds}


\begin{document}

\begin{frontmatter}

\title{Approximate Inference for Constructing Astronomical Catalogs from Images}
\runtitle{Astronomical Cataloging}

\author{\fnms{Jeffrey} \snm{Regier}\corref{}\texorpdfstring{$^1$}{1}\ead[label=e1]{jregier@eecs.berkeley.edu}},
\address{
Jeffrey Regier\\
Department of Electrical Engineering\\and Computer Sciences\\
University of California, Berkeley\\
465 Soda Hall\\
Berkeley, CA 94720\\
USA\\
\printead{e1}}
\author{\fnms{Andrew C.} \snm{Miller}\texorpdfstring{$^2$}{2}\ead[label=e2]{am5171@columbia.edu}},
\address{
Andrew C. Miller\\
Data Science Institute \\
Columbia University \\
3227 Broadway \\
New York, NY 10027 \\
USA\\
\printead{e2}}
\author{\fnms{David} \snm{Schlegel}\texorpdfstring{$^3$}{3}\ead[label=e3]{djschlegel@lbl.gov}},
\address{
David Schlegel\\
Lawrence Berkeley National Laboratory\\
1 Cyclotron Road\\
Berkeley, CA 94720\\
USA\\
\printead{e3}}
\author{\fnms{Ryan P.} \snm{Adams}\texorpdfstring{$^{4}$}{4}\ead[label=e4]{rpa@princeton.edu}},
\address{
Ryan P. Adams\\
Princeton University\\
Department of Computer Science\\
35 Olden Street\\
Princeton, NJ 08540\\
USA\\
\printead{e4}}
\author{\fnms{Jon D.} \snm{McAuliffe}\texorpdfstring{$^{1,5}$}{1,5}\ead[label=e5]{jon@stat.berkeley.edu}},
\address{
Jon D. McAuliffe\\
Department of Statistics\\
University of California, Berkeley\\
367 Evans Hall\\
Berkeley, CA 94720\\
USA\\
\printead{e5}}
\and
\author{\snm{Prabhat}\texorpdfstring{$^3$}{3}\ead[label=e6]{prabhat@lbl.gov}}
\address{
Prabhat\\
Lawrence Berkeley National Laboratory\\
1 Cyclotron Road\\
Berkeley, CA 94720\\
USA\\
\printead{e6}}
\\


\affiliation{%
University of California -- Berkeley\texorpdfstring{$^1$}{1},
Columbia University\texorpdfstring{$^2$}{2},\\
Lawrence Berkeley National Laboratory\texorpdfstring{$^3$}{3},\\
Princeton University\texorpdfstring{$^4$}{4}, and
The Voleon Group\texorpdfstring{$^5$}{5}.
}

\runauthor{J. Regier et al.}

\begin{abstract}
We present a new, fully generative model for constructing astronomical catalogs from optical telescope image sets. Each pixel intensity is treated as a random variable with parameters that depend on the latent properties of stars and galaxies. These latent properties are themselves modeled as random. We compare two procedures for posterior inference. One procedure is based on Markov chain Monte Carlo (MCMC) while the other is based on variational inference (VI). The MCMC procedure excels at quantifying uncertainty, while the VI procedure is 1000 times faster. 
On a supercomputer, the VI procedure efficiently uses 665,000 CPU cores to construct an astronomical catalog from 50 terabytes of images in 14.6 minutes, demonstrating the scaling characteristics necessary to construct catalogs for upcoming astronomical surveys.
\end{abstract}


\begin{keyword}[class=MSC]
\kwd[Primary ]{62P35}
\kwd[; secondary ]{85A35}
\end{keyword}

\begin{keyword}
\kwd{astronomy}
\kwd{graphical model}
\kwd{MCMC}
\kwd{variational inference}
\kwd{high performance computing}
\end{keyword}

\end{frontmatter}


\include{1_introduction}
\include{2_statistical_model}
\include{3_mcmc}
\include{4_vi}
\include{5_experiments}
\include{6_petascale}
\include{7_discussion}


% AOS,AOAS: If there are supplements please fill:
\begin{supplement}[id=suppA]
  \sname{Supplement A}
  \stitle{Kullback-Leibler divergences}
%  \slink[doi]{10.1214/00-AOASXXXXSUPP}
  \sdatatype{kl.pdf}
  \sdescription{Formulas for KL divergences between common distributions that appear in the derivation of the variational lower bound.}
  \label{kl}
\end{supplement}

\bibliographystyle{imsart-nameyear}
\bibliographystyle{agsm}
\bibliography{references}

%\newpage
\include{8_vi_details}

\end{document}
