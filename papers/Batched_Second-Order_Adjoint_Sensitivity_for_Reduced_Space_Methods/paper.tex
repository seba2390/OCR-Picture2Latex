% Arxiv wants this to force pdflatex
\pdfoutput=1 
% %%%%%%%%%%%%%%%%%%%%%%%%%  ltexpprt_twocolumn.tex  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% This is ltexpprt_twocolumn.tex, an example file for use with the SIAM LaTeX2E
% Preprint Series macros. It is designed to provide two-column output.
% Please take the time to read the following comments, as they document
% how to use these macros. This file can be composed and printed out for
% use as sample output.

% Any comments or questions regarding these macros should be directed to:
%
%                 Donna Witzleben
%                 SIAM
%                 3600 University City Science Center
%                 Philadelphia, PA 19104-2688
%                 USA
%                 Telephone: (215) 382-9800
%                 Fax: (215) 386-7999
%                 e-mail: witzleben@siam.org


% This file is to be used as an example for style only. It should not be read
% for content.

%%%%%%%%%%%%%%% PLEASE NOTE THE FOLLOWING STYLE RESTRICTIONS %%%%%%%%%%%%%%%

%%  1. There are no new tags.  Existing LaTeX tags have been formatted to match
%%     the Preprint series style.
%%
%%  2. Do not change the margins or page size!  Do not change from the default
%%     text font!
%%
%%  3. You must use \cite in the text to mark your reference citations and
%%     \bibitem in the listing of references at the end of your chapter. See
%%     the examples in the following file. If you are using BibTeX, please
%%     supply the bst file with the manuscript file.
%%
%%  4. This macro is set up for two levels of headings (\section and
%%     \subsection). The macro will automatically number the headings for you.
%%
%%  5. No running heads are to be used for this volume.
%%
%%  6. Theorems, Lemmas, Definitions, Equations, etc. are to be double numbered,
%%     indicating the section and the occurrence of that element
%%     within that section. (For example, the first theorem in the second
%%     section would be numbered 2.1. The macro will
%%     automatically do the numbering for you.
%%
%%  7. Figures and Tables must be single-numbered.
%%     Use existing LaTeX tags for these elements.
%%     Numbering will be done automatically.
%%
%%  8. Page numbering is no longer included in this macro.
%%     Pagination will be set by the program committee.
%%
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\documentclass[twoside,leqno,twocolumn]{article}


% Comment out the line below if using A4 paper size
\usepackage[letterpaper]{geometry}

\usepackage{ltexpprt}
\usepackage{hyperref}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[ruled,vlined,algo2e]{algorithm2e}
\usepackage[usebox=true]{jlcode}
\usepackage{bm}
\usepackage{tikz}
\usepackage[numbers]{natbib}
\usepackage{pgfplotstable}
\usepackage{xcolor}
\usepackage[normalem]{ulem}
\usepackage{multirow}
\usepackage{listings}
\pgfplotsset{compat=1.16}
\usetikzlibrary{arrows,shadows,positioning}
\definecolor{mygreen}{RGB}{80,200,120}

\tikzset{
  connection/.style={
    inner sep=0, outer sep=0,
  },
  frame/.style={
    rectangle, draw,
    text width=10em, text centered,
    minimum height=2.5em,
  },
  parallel/.style={
    rectangle, draw,
    text width=2em, text centered,
    minimum height=1.5em,drop shadow,fill=mygreen!100,
  },
  hframe/.style={
    rectangle, draw,
    text width=10em, text centered,fill=red!20,
    minimum height=2.5em,
  },
  input/.style={
    rectangle, draw,
    text width=2em, text centered,
    minimum height=1em,drop shadow,fill=red!20,
    rounded corners,
  },
  line/.style={
    draw, -latex',rounded corners=3mm,
  },
  seq/.style={
    rectangle, draw,
    minimum width=2em, text centered,
    minimum height=2em,drop shadow,fill=blue!20,
    rounded corners,
  },
  n/.style={circle, fill, minimum size=4pt,inner sep=0pt, outer sep=0pt},
}

% \usepackage{listing}
\newcommand{\REAL}{\mathbb{R}}

\newcommand{\dpart}[2]{\dfrac{\partial #1}{\partial #2}}
\newcommand{\deriv}[2]{\dfrac{d #1}{d #2}}
\newcommand{\grad}[2]{\nabla_{#2}{#1}}
\newcommand{\hess}[2]{\dfrac{d^2 #1}{d #2}}
\newcommand{\dhess}[2]{\dfrac{\partial^2 #1}{\partial #2}}
\newcommand{\hhess}[2]{\nabla^2_{#2}{#1}}

\newcommand{\CUDAjl}{{\tt CUDA.jl}}
\newcommand{\cusolver}{{\tt cuSOLVER}}
\newcommand{\cusolverrf}{{\tt cuSOLVER\_RF}}
\newcommand{\krylovjl}{{\tt Krylov.jl}}
\newcommand{\KA}{{\tt KernelAbstractions.jl}}
\newcommand{\bigo}[1]{\mathcal{O}\left( #1 \right)}

% various reference macros
\newcommand{\refalg}[1]{Algorithm~\ref{#1}}
\newcommand{\refsec}[1]{Section~\ref{#1}}
\newcommand{\reffig}[1]{Figure~\ref{#1}}
\newcommand{\refsubfig}[1]{Figure~\subref{#1}}
\newcommand{\reftab}[1]{Table~\ref{#1}}
\newcommand{\refeqn}[1]{(\ref{#1})}
\newcommand{\reflst}[1]{Listing~(\ref{#1})}

\newcommand{\ms}[1]{\textcolor{blue}{#1}}
\newcommand{\stms}[1]{\sout{\textcolor{blue}{#1}}}

\newcommand{\am}[1]{\textcolor{blue}{#1}}
\newcommand{\stam}[1]{\sout{\textcolor{blue}{#1}}}

\newcommand{\fp}[1]{\textcolor{blue}{#1}}
\newcommand{\stfp}[1]{\sout{\textcolor{blue}{#1}}}

\pgfplotstableread{data/J.dat}\matrixJ
\pgfplotstableread{data/Jc.dat}\matrixJc
\def\nrows{52}
\def\ncols{52}
\def\ncolors{14}

% to avoid overfull hbox due to \tt etc.
\tolerance=5000

\begin{document}
\newcommand\relatedversion{}

% \renewcommand\relatedversion{\thanks{The full version of the paper can be accessed at \protect\url{https://arxiv.org/abs/1902.09310}}} % Replace URL with link to full paper or comment out this line

%%
%% The "title" command has an optional parameter,
%% allowing the author to define a "short title" to be used in page headers.
% \title{\Large Revisiting Reduced Space Hessian Accumulation for SIMD Architectures \relatedversion}
% \title{\Large Batched Hessian Contractions of Nonlinear Systems of Equations for Reduced Space Methods\relatedversion}
\title{\Large Batched Second-Order Adjoint Sensitivity for Reduced Space Methods\relatedversion}

%%
%% The "author" command and its associated commands are used to define
%% the authors and their affiliations.
%% Of note is the shared affiliation of the first two authors, and the
%% "authornote" and "authornotemark" commands
%% used to denote shared contribution to the research.
\author{François Pacaud \thanks{Argonne National Laboratory}
  \and Michel Schanen \footnotemark[1]
  \and Daniel Adrian Maldonado \footnotemark[1]
\and Alexis Montoison \thanks{$GERAD$ and Polytechnique Montréal}
\and Valentin Churavy \thanks{Massachusetts Institute of Technology}
\and Julian Samaroo \footnotemark[3]
\and Mihai Anitescu \footnotemark[1]
}

\date{}
\maketitle

% Copyright Statement
% When submitting your final paper to a SIAM proceedings, it is requested that you include
% the appropriate copyright in the footer of the paper.  The copyright added should be
% consistent with the copyright selected on the copyright form submitted with the paper.
% Please note that "20XX" should be changed to the year of the meeting.

% Default Copyright Statement
\fancyfoot[R]{\scriptsize{Copyright \textcopyright\ 2021 by SIAM\\
Unauthorized reproduction of this article is prohibited}}

% Depending on which copyright you agree to when you sign the copyright form, the copyright
% can be changed to one of the following after commenting out the default copyright statement
% above.

%\fancyfoot[R]{\scriptsize{Copyright \textcopyright\ 20XX\\
%Copyright for this paper is retained by authors}}

%\fancyfoot[R]{\scriptsize{Copyright \textcopyright\ 20XX\\
%Copyright retained by principal author's organization}}

%\pagenumbering{arabic}
%\setcounter{page}{1}%Leve this line commented out.


\begin{abstract} \small\baselineskip=9pt
  This paper presents an efficient method for extracting the second-order
  sensitivities from a system of implicit nonlinear equations on upcoming graphical processing units (GPU) dominated computer systems.
  We design a custom automatic differentiation (AutoDiff) backend that
  targets highly parallel architectures by
  extracting the second-order information in batch. When the nonlinear
  equations are associated to a reduced space optimization problem, we leverage the
  parallel reverse-mode accumulation in a batched adjoint-adjoint algorithm
  to compute efficiently the reduced Hessian of the problem.
  We apply the method to extract the reduced Hessian associated to the balance equations
  of a power network, and show on the largest instances that a parallel GPU implementation is 30 times faster than a sequential CPU reference based on UMFPACK
\end{abstract}


\input{introduction}
\input{problem}
\input{reduction}
\input{implementation}
\input{results}
\input{conclusion}


\section*{Acknowledgments}
This research was supported by the Exascale Computing Project (17-SC-20-SC),
a joint project of the U.S. Department of Energy’s Office of Science and
National Nuclear Security Administration, responsible for delivering a
capable exascale ecosystem, including software, applications, and hardware
technology, to support the nation’s exascale computing imperative.

\small
\bibliographystyle{abbrv}
\bibliography{abbrv,paper.bib}


% Argonne Licence.
\vfill
\begin{flushright}
%
{\footnotesize
  \framebox{\parbox{0.5\textwidth}{
The submitted manuscript has been created by UChicago Argonne, LLC,
Operator of Argonne National Laboratory (``Argonne"). Argonne, a
U.S. Department of Energy Office of Science laboratory, is operated
under Contract No. DE-AC02-06CH11357. The U.S. Government retains for
itself, and others acting on its behalf, a paid-up nonexclusive,
irrevocable worldwide license in said article to reproduce, prepare
derivative works, distribute copies to the public, and perform
publicly and display publicly, by or on behalf of the Government.
The Department of
Energy will provide public access to these results of federally sponsored research in accordance
with the DOE Public Access Plan. http://energy.gov/downloads/doe-public-access-plan. }}
\normalsize
}
\end{flushright}

\end{document}
