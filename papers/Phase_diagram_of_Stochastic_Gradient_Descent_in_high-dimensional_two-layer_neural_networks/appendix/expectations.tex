\section{Expectations over the local fields}\label{app:expec}

In this appendix we present the explicit expressions from the expectations of the local fields used to compute the population risk and the ODE terms.

\subsection{Population risk}

We write the population risk~\eqref{eq:pop_risk} as
\begin{equation}
\begin{split}
      \risk ( \Om  )  &= \Explf \Expnoise 
    \left[ \left( \hat{\f}( \bm{\lf} ) - \f ( \bm{\lf}^* )  \right)^{2}   \right]   \\
    &=  \riskt ( \P  ) + \risks ( \Q  ) + \riskst (\P , \Q, \M )   \;,
\end{split}
\end{equation}
with
\begin{subequations}
\label{eq:pop_risk_3}
\begin{equation}
    \riskt \equiv \Explft \left[ \f ( \bm{\lf}^* )^2   \right] =\frac{1}{\hidt^2} \sum_{r, s =1}^\hidt \Explft\left[ \act(\lf_{r}^*) \act(\lf_{s}^*)  \right] 
\end{equation}
\begin{equation}
    \risks \equiv \Explfs \left[\hat{\f}( \bm{\lf} )^2   \right] = 
    \frac{1}{\hids^2} \sum_{j, l =1}^\hidt \Explfs\left[ \act(\lf_{j}) \act(\lf_{l}) \right] \;,
\end{equation}
\begin{equation}
    \riskst \equiv \Explf \left[ \hat{\f}( \bm{\lf} ) \f ( \bm{\lf}^* )   \right] =  - \frac{2}{\hids\hidt}  \sum_{j=1}^\hids \sum_{r=1}^\hidt \Explf\left[ \act(\lf_{j}) \act(\lf_{r}^*) \right]
\end{equation}
\end{subequations}


Define the vector $ \bm{\lf}^{\alpha\beta} \equiv \left(  \lf^\alpha , \lf^\beta  \right)^\top \in \R^2  $, where the upper indices on the components indicate they may refer to student or teacher local fields. Consider the covariance matrix on the subspace spanned by $ \bm{\lf}^{\alpha\beta}$:
\begin{equation}
\label{eq:covE2}
\LambER \equiv \Explf \left[  \bm{\lf}^{\alpha\beta}  \left(\bm{\lf}^{\alpha\beta} \right)^\top  \right] \in \R^{2 \times 2} \;.
\end{equation}

For $\act(x) = \erf ( x / \sqrt{2} ) $ the expectations in Eqs.~\eqref{eq:pop_risk_3} are in general given by \cite{saad_1995}
\begin{equation}
    \Explf  \left[\act (\lf^\alpha ) \act( \lf^\beta )  \right] = 
    \frac{1}{\pi} \arcsin \left( \frac{   \LambERscal_{12}  }{\sqrt{\left( 1+ \LambERscal_{11}\right) \left( 1+ \LambERscal_{22} \right)}}    \right)   \;.
\end{equation}
where $   \LambERscal_{jl} \equiv (\LambER)_{jl} $ is an element of the covariance matrix given by Eq.~\eqref{eq:covE2}. 

Explicitly, the population risk contributions are
\begin{subequations}
\label{eq:pop_risk_3_exp}
\begin{equation}
    \riskt ( \P  ) =\frac{1}{\hidt^2} \sum_{r, s =1}^\hidt  \frac{1}{\pi} \arcsin \left( \frac{   \p_{r s}  }{\sqrt{\left( 1+ \p_{r r} \right) \left( 1+ \p_{s s} \right)}}    \right) \;,
\end{equation}
\begin{equation}
    \risks ( \Q  ) =    \frac{1}{\hids^2} \sum_{j,l  =1}^\hidt  \frac{1}{\pi} \arcsin \left( \frac{   \q_{j l}  }{\sqrt{\left( 1+ \q_{j j} \right) \left( 1+ \q_{ll} \right)}}    \right)  \;,
\end{equation}
\begin{equation}
    \riskst (\P,  \Q , \M )  =  - \frac{2}{\hids\hidt}  \sum_{j=1}^\hids \sum_{r=1}^\hidt  \frac{1}{\pi} \arcsin \left( \frac{   \m_{j r}  }{\sqrt{\left( 1+ \q_{j j} \right) \left( 1+ \p_{rr} \right)}}    \right)  \;.
\end{equation}
\end{subequations}

\subsection{ODE contributions}

From the update equations, we first consider the expectations linear in $\Er_j$:
\begin{subequations}
\label{eq:expE}
\begin{equation}
\begin{split}
  \Explf \Expnoise \left[  \Er_{j} \lf_{l}  \right]  =&  
  \frac{1}{\hidt} \sum_{r' =1}^{\hidt} \Explf  \left[\act' (\lf_{j}) \lf_l \act( \lf_{r'}^{*}  )  \right]
   \\
   &  -  \frac{1}{\hids} \sum_{l' = 1}^{\hids} \Explf \left[ \act' (\lf_{j}) \lf_l   \act ( \lf_{l'}  ) \right] \;, 
\end{split}
\end{equation}
\begin{equation}
\begin{split}
   \Explf \Expnoise   \left[  \Er_{j} \lf_{r}^*  \right]  =&    \frac{1}{\hidt} \sum_{r'=1}^{\hidt}   \Explf   \left[\act' (\lf_{j}) \lf_{r}^* \act( \lf_{r'}^{*}  )  \right]
   \\
   &   -   \frac{1}{\hids} \sum_{l' = 1}^{\hids} \Explf \left[ \act' (\lf_{j}) \lf_{r}^*   \act ( \lf_{l'}  ) \right]  \;.
\end{split}
\end{equation}
\end{subequations}
Define the vector $ \bm{\lf}^{\alpha\beta\gamma} \equiv \left(  \lf^\alpha , \lf^\beta , \lf^\gamma  \right)^\top \in \R^3  $, where the upper indices on the components indicate they may refer to student or teacher local fields. Consider the covariance matrix on the subspace spanned by $ \bm{\lf}^{\alpha\beta\gamma}$:
\begin{equation}
\label{eq:covE}
\LambEM \equiv \Explf \left[  \bm{\lf}^{\alpha\beta\gamma}  \left(\bm{\lf}^{\alpha\beta\gamma} \right)^\top  \right] \in \R^{3\times3} \;.
\end{equation}

%\begin{equation}
%\label{eq:covE_2}
%\LambEM \equiv \Explf \left[ \left( \bm{\lf}^{\alpha\beta\gamma} - \Explf \left[ \bm{\lf}^{\alpha\beta\gamma} \right] \right) \left(\bm{\lf}^{\alpha\beta\gamma} - \Explf \left[ \bm{\lf}^{\alpha\beta\gamma} \right]  \right)^\top \right]  \in \R^{3\times3} \;.
%\end{equation}


For $\act(x) = \erf ( x / \sqrt{2} ) $ the expectations in Eqs.~\eqref{eq:expE} are given by \cite{saad_1995}
\begin{equation}
    \Explf  \left[\act' (\lf^\alpha ) \lf^\beta \act( \lf^\gamma )  \right] = 
    \frac{2}{\pi} \frac{ \LambE_{23} \left( 1+ \LambE_{11}\right) - \LambE_{12}\LambE_{13} }{ \left( 1+\LambE_{11} \right) \sqrt{\left( 1+\LambE_{11} \right) \left( 1+\LambE_{33} \right) - \left( \LambE_{13} \right)^2   }} \;,
\end{equation}
where $  \LambE_{jl} \equiv (\LambEM)_{jl} $ is an element of the covariance matrix given by Eq.~\eqref{eq:covE}. As examples, we write explicitly:
\begin{equation}
\bm{\Om}^{jl r'} = \begin{bmatrix}
\q_{jj} & \q_{jl} & \m_{j r'} \\
\q_{jl} & \q_{ll} & \m_{l r'} \\
\m_{j r'} & \m_{l r'} & \p_{r' r'}
\end{bmatrix} \; \; \; , \; \; \; 
\bm{\Om}^{j r r'} = \begin{bmatrix}
\q_{jj} & \m_{jr} & \m_{j r'} \\
\m_{jr} & \p_{rr} & \p_{r r'} \\
\m_{j r'} & \p_{r r'} & \p_{r' r'}
\end{bmatrix}  \;.
\end{equation}

The quadratic contribution in $\Er_j$ is given by
\begin{equation}
\label{eq:expEE}
\begin{split}
     \Explf \Expnoise \left[  \Er_{j} \Er_{l}  \right]  =&  
     \frac{1}{\hidt^2} \sum_{ r ,  r' =1}^{\hidt} \Explf  \left[\act' (\lf_{j}) 
     \act' (\lf_{l}) \act (\lf_{r}^*  ) \act ( \lf_{r'}^{*}  )  \right]  \\
     & + \frac{1}{\hids^2} \sum_{ j' ,  l' =1}^{\hids} \Explf  \left[\act' (\lf_{j}) 
     \act' (\lf_{l}) \act (\lf_{j'}  ) \act ( \lf_{l'}  )  \right]  \\ 
     & - \frac{2}{\hids\hidt} \sum_{ l' =1}^{\hids} \sum_{ r =1}^{\hidt} \Explf  \left[\act' (\lf_{j}) 
     \act' (\lf_{l}) \act (\lf_{r}^*  ) \act ( \lf_{l'}  )  \right]  \\
     & + \noise   \Explf  \left[\act' (\lf_{j}) 
     \act' (\lf_{l})  \right]
\end{split}
\end{equation}

The solution of the noise-dependent term can be constructed with the covariance matrix \eqref{eq:covE2} and is given by \cite{goldt_2019}
\begin{equation}
    \Explf  \left[\act' (\lf^\alpha)  \act' (\lf^\beta)  \right] =  \frac{2}{\pi} 
    \frac{1}{\sqrt{ 1+ \LambERscal_{11} + \LambERscal_{22} +
    \LambERscal_{11}\LambERscal_{22} - \left( \LambERscal_{12} \right)^2   }}    
\end{equation}

Similarly, one can define the vector $ \bm{\lf}^{\alpha\beta\gamma\delta} \equiv \left(  \lf^\alpha , \lf^\beta , \lf^\gamma , \lf^\delta  \right)^\top \in \R^4  $ and write the covariance matrix on the subspace spanned by $ \bm{\lf}^{\alpha\beta\gamma\delta}$:
%
\begin{equation}
    \LambEEM  \equiv \Explf \left[  \bm{\lf}^{\alpha\beta\gamma\delta}  \left( \bm{\lf}^{\alpha\beta\gamma\delta} \right)^\top \right]  \in \R^{4\times 4} \;.
\end{equation}

For $\act(x) = \erf ( x / \sqrt{2} ) $ the expectations in Eqs.~\eqref{eq:expEE} are given by \cite{saad_1995}
%
\begin{equation}
    \Explf  \left[\act' (\lf^\alpha ) \act' (\lf^\beta )  \act (\lf^\gamma ) \act( \lf^\delta  )  \right] = 
    \frac{4}{\pi^2} \frac{1}{ \sqrt{\LambEEbar_0} } \arcsin \left( \frac{ \LambEEbar_1 }{\sqrt{\LambEEbar_2 \LambEEbar_3}}   \right) \;,
\end{equation}
with
\begin{subequations}
\begin{equation}
    \LambEEbar_0 \equiv \left( 1+\LambEE_{11} \right) \left( 1+\LambEE_{22} \right) - \left( \LambEE_{12} \right)^2 \;,
\end{equation}
\begin{equation}
\begin{split}
   \LambEEbar_1 \equiv &  \LambEEbar_0 \LambEE_{34} - \LambEE_{23} \LambEE_{24} \left( 1+\LambEE_{11} \right) - \LambEE_{13} \LambEE_{14} \left(1 + \LambEE_{22} \right) \\
   & + \LambEE_{12} \LambEE_{13} \LambEE_{24} + \LambEE_{12}\LambEE_{14}\LambEE_{23} \;,
\end{split}
\end{equation}
\begin{equation}
\begin{split}
   \LambEEbar_2 \equiv & \LambEEbar_0 \left( 1 + \LambEE_{44} \right)  - \left(\LambEE_{24}\right)^2 \left(1+ \LambEE_{11} \right)   - \left(\LambEE_{13}\right)^2 \left(1+ \LambEE_{22} \right) \\
   & + 2
   \LambEE_{12} \LambEE_{13} \LambEE_{23} \;, \;.    
\end{split}
\end{equation}
\begin{equation}
\begin{split}
  \LambEEbar_3 \equiv & \LambEEbar_0 \left( 1 + \LambEE_{44} \right)  - \left(\LambEE_{24}\right)^2 \left(1+ \LambEE_{11} \right)   - \left(\LambEE_{14}\right)^2 \left(1+ \LambEE_{22} \right)  \\
  & + 2    \LambEE_{12} \LambEE_{14} \LambEE_{24} \;.    
\end{split}
\end{equation}
\end{subequations}

\subsection{From gradient flow to local fields}
\label{app:c:flow}
Consider the gradient flow approximation
\begin{align*}
    \dv{\w_j}{t}  &= -\nabla_{\w_j}\risk(\W, \W^*)\\
    &= - \frac1{p\sqrt{d}}\Expxgauss\left[ \x \act'(\lf_j ) \Er \right].
\end{align*}

Now, since for any $\bm{x}^{\top}\bm{y}$, we have
\begin{equation}
    \nonumber
    \dv{\left(\bm{x}^{\top}\bm{y}\right)}{t}  =  \bm{x}^{\top} \dv{\bm{y}}{t} + \bm{y}^{\top} \dv{\x}{t} \;,
\end{equation}
we find
\begin{equation}
    \nonumber
\dv{\q_{jl}}{t}   = -\frac{1}{pd} \Expxgauss\left[ \left(\act'(\lf_j)  \lf_l + \act'(\lf_l) \lf_j \right) \Er \right] \;.
\end{equation}
Recalling the definition $\Er_j = \act'(\lf_j)\Er$, the terms present inside the expectation are exactly those in the learning term of Eq.~\eqref{eq:qm_up}. 

