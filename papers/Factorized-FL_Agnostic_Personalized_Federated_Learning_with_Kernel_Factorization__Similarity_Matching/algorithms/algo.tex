\begin{figure*}[h!]
    \begin{minipage}[t]{.5\linewidth}
        \begin{algorithm}[H]
            \small
            \caption{\textbf{\texttt{Factorized-FL} Algorithm}}
        	\begin{algorithmic}[1]
        	    \label{algo:factorized_fl}
        	    \STATE  $R$: number of communication rounds, $E$: number of epochs, $K$: number of clients, $\mathcal{F}$: a set of clients, $f_k$: a $k$th client, $\Omega(\cdot)$: our similarity matching function, $\epsilon$: hyper-parameter for scaling similarity score $\sigma$, $L$: number of layers in neural networks. $\mathcal{U}_{k}$, $\mathcal{V}_{k}$, and $\mathcal{M}_{k}$: factorized parameters of our  \texttt{Factorized-FL}.\\
                \STATE   \textbf{Function} RunServer()
                    \STATE initialize $\mathcal{F} $
                    \FOR{each round $r=1,2,\dots, R$}
                        \STATE $\mathcal{F}^{(r)} \leftarrow$ select $K^{(r)}$ clients from $\mathcal{F}$
                        \FOR{each client $f^{(r)}_k \in \mathcal{F}^{(r)}~\textbf{\mbox{in parallel}}$}
                            \IF{$r>1$} 
                                \STATE $\{\sigma_i \}_{i \neq k}^{K^{(r)}} \leftarrow \Omega(\textbf{v}_{f_k}^{L-1}, \textbf{v}_{f_{i\neq k:K^{(r)}}}^{L-1})$
                                \STATE $\mathcal{U}_{k}^{(r)} \leftarrow \frac{\text{exp}({\epsilon \cdot \sigma_i})}{\sum_{i=1}^{K^{(r)}} \text{exp}(\epsilon \cdot \sigma_i)} \sum_{i=1}^{K^{(r)}} \mathcal{U}_i^{(r)}$
                            \ENDIF 
                            \STATE $\mathcal{U}_k^{(r+1)}, \textbf{v}_{f_k}^{L-1}\leftarrow \text{RunClient} (\mathcal{U}_{k}^{(r)})$
                    	\ENDFOR
                    \ENDFOR 
                \STATE   \textbf{Function} RunClient($\mathcal{U}^{(r)}_k$)
                    \STATE $\mathcal{U}_{k}^{(r+1)} \leftarrow \mathcal{U}^{(r)}_k$  
                    \FOR{each local epoch $e$ from $1$ to $E$}
                        \FOR{minibatch $\mathcal{B} \in \mathcal{D}_{k}$}
                            \STATE $\theta_{\mathcal{U} \times \mathcal{V} \oplus \mathcal{M}} \leftarrow \theta_{\mathcal{U} \times \mathcal{V} \oplus \mathcal{M}}-\eta\nabla\mathcal{L}(\mathcal{B}; \theta_{\mathcal{U} \times \mathcal{V} \oplus \mathcal{M}})$
                        \ENDFOR
                    \ENDFOR
                    \STATE \textbf{return} $\mathcal{U}_{k}^{(r+1)}, \textbf{v}_{f_k}^{L-1}$
        	\end{algorithmic}
    	\end{algorithm}
    \end{minipage}
    \begin{minipage}[t]{.5\linewidth}
        \begin{algorithm}[H]
        \small
        \label{algo:factorized_fl_beta}
    	\caption{\textbf{\texttt{Factorized-FL $\beta$} Algorithm}}
    	    \begin{algorithmic}[1]
    	        \label{algo:factorized_fl_beta}
                \STATE   \textbf{Function} RunServer()
                    \STATE initialize $\mathcal{F} $
                    \FOR{each round $r=1,2,\dots, R$}
                        \STATE $\mathcal{F}^{(r)} \leftarrow$ select $K^{(r)}$ clients from $\mathcal{F}$
                        \FOR{each client $f^{(r)}_k \in \mathcal{F}^{(r)}~\textbf{\mbox{in parallel}}$}
                            \IF{$r>1$} 
                                \STATE $\{\sigma_i \}_{i \neq k}^{K^{(r)}} \leftarrow \Omega(\textbf{v}_{f_k}^{L-1}, \textbf{v}_{f_{i\neq k:K^{(r)}}}^{L-1})$
                                \STATE $\mathcal{U}_{k}^{(r)} \leftarrow \frac{\text{exp}({\epsilon \cdot \sigma_i})}{\sum_{i=1}^{K^{(r)}} \text{exp}(\epsilon \cdot \sigma_i)} \sum_{i=1}^{K^{(r)}} \mathcal{U}_i^{(r)}$
                                \STATE $\mathcal{V}_{k}^{(r)} \leftarrow \frac{\text{exp}({\epsilon \cdot \sigma_i})}{\sum_{i=1}^{K^{(r)}} \text{exp}(\epsilon \cdot \sigma_i)} \sum_{i=1}^{K^{(r)}} \mathcal{V}_i^{(r)}$
                                \STATE $\mathcal{M}_{k}^{(r)} \leftarrow \frac{\text{exp}({\epsilon \cdot \sigma_i})}{\sum_{i=1}^{K^{(r)}} \text{exp}(\epsilon \cdot \sigma_i)} \sum_{i=1}^{K^{(r)}} \mathcal{M}_i^{(r)}$
                            \ENDIF 
                            \STATE $\mathcal{U}_k^{(r+1)},  \mathcal{V}_k^{(r+1)}, \mathcal{M}_k^{(r+1)}$
                            \STATE \hspace{7em} $\leftarrow \text{RunClient} (\mathcal{U}_{k}^{(r)}, \mathcal{V}_{k}^{(r)}, \mathcal{M}_{k}^{(r)})$
                    	\ENDFOR
                    \ENDFOR 
                \STATE   \textbf{Function} RunClient($\mathcal{U}^{(r)}_k, \mathcal{V}_{k}^{(r)}, \mathcal{M}_{k}^{(r)})$)
                    \STATE $\mathcal{U}_{k}^{(r+1)} \leftarrow \mathcal{U}^{(r)}_k$, $\mathcal{V}_{k}^{(r+1)} \leftarrow \mathcal{V}^{(r)}_k$, $\mathcal{M}_{k}^{(r+1)} \leftarrow \mathcal{M}^{(r)}_k$  
                    \FOR{each local epoch $e$ from $1$ to $E$}
                        \FOR{minibatch $\mathcal{B} \in \mathcal{D}_{k}$}
                            \STATE $\theta_{\mathcal{U} \times \mathcal{V} \oplus \mathcal{M}} \leftarrow \theta_{\mathcal{U} \times \mathcal{V} \oplus \mathcal{M}}-\eta\nabla\mathcal{L}(\mathcal{B}; \theta_{\mathcal{U} \times \mathcal{V} \oplus \mathcal{M}})$
                        \ENDFOR
                    \ENDFOR
                    \STATE \textbf{return} $\mathcal{U}_{k}^{(r+1)},\mathcal{V}_{k}^{(r+1)},\mathcal{M}_{k}^{(r+1)}$
                    
        	\end{algorithmic}
    	\end{algorithm}
    \end{minipage}
\end{figure*}