\begin{figure*}[t]
\small
\centering
\begin{minipage}{0.71\textwidth}
    \resizebox{\linewidth}{!}{
        \begin{tabular}{ccccc}
            \includegraphics[width=0.24\linewidth]{figures/images/1_uu.pdf} &
            \includegraphics[width=0.24\linewidth]{figures/images/25_uu.pdf} &
            \includegraphics[width=0.24\linewidth]{figures/images/50_uu.pdf} &
            \includegraphics[width=0.24\linewidth]{figures/images/75_uu.pdf} &
            \includegraphics[width=0.24\linewidth]{figures/images/100_uu.pdf} 
            \\
            \includegraphics[width=0.24\textwidth]{figures/images/1_w.pdf} &
            \includegraphics[width=0.24\textwidth]{figures/images/25_w.pdf} &
            \includegraphics[width=0.24\textwidth]{figures/images/50_w.pdf} &
            \includegraphics[width=0.24\textwidth]{figures/images/75_w.pdf} &
            \includegraphics[width=0.24\textwidth]{figures/images/100_w.pdf} 
        \end{tabular}
    }
\end{minipage}
\begin{minipage}{0.28\textwidth}
    \includegraphics[width=0.95\textwidth]{figures/images/freq.pdf} 
\end{minipage}
\\
(a) $r$=$1$ 
\hfil \hspace{0.05in} (b) $r$=$25$ 
\hfil \hspace{0.05in} (c) $r$=$50$ 
\hfil \hspace{0.05in} (d) $r$=$75$ 
\hfil \hspace{0.05in} (e) $r$=$100$
\hfil \hspace{0.05in} (f) Freq. of Client Matching
\\

\hspace{-0.15in}
\begin{minipage}{0.24\textwidth}
\includegraphics[width=0.98\textwidth]{figures/images/matching.pdf} 
\end{minipage}
% \includegraphics[width=0.24\textwidth]{figures/images/factorization.png} 
% \includegraphics[width=0.24\textwidth]{figures/images/f_perf.png} 
% \includegraphics[width=0.24\textwidth]{figures/images/model_size.png} 
\begin{minipage}{0.45\textwidth}
    \resizebox{0.99\textwidth}{!}{
        \begin{tabular}{cccccc}
            \toprule 
    	    \midrule
    	    \centering
    	    \multirow{2}{*}{Backbone} & Num. & Head & Regular & $I \cdot F \times O \cdot F$  & $F \cdot F \times I \cdot O$  \\
    	     & FC & BN & Kernel & Factorization & Factorization (Ours) \\
    	    \midrule
    	    \multirow{3}{*}{ResNet-9} & 1 & - & $61.29\%$ & $60.96\%$ & $\textbf{62.34\%}$ \\
    	    & 2 & \cmark & $56.08\%$ & $60.81\%$ & $\textbf{62.65\%}$ \\
     	    & 2 & \xmark & $50.01\%$ & $63.42\%$ & $\textbf{64.39\%}$ \\
     	    \midrule
            \multirow{3}{*}{ResNet-18} & 1 & - & $63.06\%$ & $55.72\%$ & $\textbf{66.23\%}$ \\
    	     & 2 & \cmark & $58.36\%$ & $61.39\%$ & $\textbf{68.78\%}$ \\
    	     & 2 & \xmark  & $51.26\%$ & $63.32\%$ & $\textbf{67.93\%}$ \\
    	    \midrule
    	    \bottomrule 
        \end{tabular}
        \label{tbl:analysis_factorization_3}
    }
\end{minipage}
\begin{minipage}{0.29\textwidth}
    \resizebox{0.99\textwidth}{!}{
        \begin{tabular}{ccccc}
            \toprule 
    	    \midrule
    	    \centering
    	    \multirow{2}{*}{Backbone} & \multirow{2}{*}{$\lambda_\text{sparse}$} & Num. & Acc. \\
    	    & & Params. & (\%) \\
    	    \midrule
    	     ResNet-9 & - & 2.574 M (100\%) & $61.95\%$ \\
    	     \midrule
    	     \multirow{5}{*}{\shortstack{Factorized \\ ResNet-9}} &  1e-4 & 2.731 M (106\%) & $63.31\%$ \\
    	      &  3e-4 & 2.515 M (97\%) & $63.74\%$ \\
    	      &  5e-4 & 2.283 M (88\%) & $63.12\%$ \\
    	      &  7e-4 & 2.068 M (80\%) & $62.69\%$ \\
    	      &  1e-3 & 1.784 M (69\%) & $62.67\%$ \\
    	    \midrule
    	    \bottomrule
        \end{tabular}
        \label{tbl:analysis_factorization_4}
    }
\end{minipage}\hfill
\\
\hspace{-0.4in} (g) Ablation Study 
\hfil \hspace{-0.35in} (h) Factorization of Different Architectures
\hfil \hspace{0.05in} (i) Sparsity Analysis

\vspace{-0.05in}
\caption{\small{\textbf{In-depth analysis on \texttt{Factorized-FL} algorithms.} \textbf{Top:} While $\textbf{u}^{L-1}$ learns task-general knowledge (upper row), $\textbf{v}^{L-1}$ captures task-specific knowledge and can be utilized for clustering relevant clients (bottom row). We show cosine similarity from round (a) $r$=$1$ to (e) $r$=$100$. (f) shows the frequency of client matching after $100$ rounds. Darker colors indicate higher scores. (g) ablation study, (h) applicability of our factorization methods, and (i) sparsity analysis of the hyperparameter $\lambda_{\textbf{sparsity}}$. }}
\label{fig:analysis}
\vspace{-0.2in}
\end{figure*}


