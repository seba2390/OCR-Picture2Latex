\section{Introduction}
\label{sec:intro}


%% \emph{Cyber-Physical Systems} (CPSs), which integrate computation, networking, and 
%% physical processes, are tightly coupled with our physical world.  Consequently, a
%% cyber-attack on a CPS can have serious \emph{physical} consequences, in particular to our 
%% physical infrastructure.  Examples include a 2015 malware attack on Ukraineâ€™s power 
%% grid~\cite{ukraine}; the 2009 Stuxnet worm, which led to the destruction of nearly one 
%% fifth of Iran's nuclear centrifuges~\cite{stuxnet}; and a 2016 demonstration of the 
%% remote hacking of a Tesla Model~S~\cite{tesla}.  In contrast, traditional cyber-attacks 
%% have been more purely cyber-oriented, focusing for example on identity theft, financial 
%% gain, and the spread of propaganda.

Many Cyber-Physical Systems (CPSs) are highly distributed in nature, comprising a multitude of computing agents that can collectively exhibit \emph{emergent behavior}. A compelling example of such a distributed CPS is the \emph{drone swarm}, which are beginning to see increasing application in battlefield surveillance and reconnaisance~\cite{droneswarm}.  The emergent behavior they exhibit is that of \emph{flight formation}.

A particularly interesting form of flight formation is \emph{V-formation}, especially for long-range missions where energy conservation is key.  V-formation is emblematic of migratory birds such as Canada geese, where a bird flying in the \emph{upwash region} of the bird in front of it can enjoy significant energy savings.  The V-formation also offers a \emph{clear view} benefit, as no bird's field of vision is obstructed by another bird in the formation.  Because of the V-formation's intrinsic appeal, it is important to quantify the resiliency of the control algorithms underlying this class of multi-agent CPSs to various kinds of cyber-attacks.  This question provides the motivation for the investigation put forth in this paper.

%% From Ashish: In my opinion, here are the main messages of the paper:
%% 1. AMPC > MPC.  I.e. Adaptively changing length of horizon is a new and powerful idea to improve performance and resilience of MPC.
%% 2. Traditional feedback control is, by design,  resilient against noise, and consequently against certain kinds of attacks, but it may not 
%%    be resilient against smart attacks.  Adaptive control helps to guard against a larger class of attacks, but it can still falter due to 
%%    limited resources.
%% 3. Stochastic model checking is a promising approach to evaluate resilience of CPSs against classes of attacks.

\paragraph{Problem Statement and Summary of Results.}  We introduce the concept of \emph{V-formation games}, where the goal of the controller is to maneuver the plant (a simple model of flocking dynamics) into a V-formation, and the goal of the attacker is to prevent the controller from doing so.
%% The specific class of C-A games we consider is that of \emph{V-formation games}, where the 
%% controller can attain its goal by minimizing a certain flock-wide fitness function $J$, 
%% which is (almost) zero exactly when V-formation has been reached.  Conversely, the 
%% attacker seeks to maximize $J$.  We formalize V-formation games in terms of a Markov 
%% Decision Process (MDP) in which the controller and attacker jointly determine the 
%% transition probabilities.
Controllers in V-formation games utilize a new formulation of model-predictive control we call \emph{Adaptive Receding-Horizon MPC} (AMPC), giving them extraordinary power: we prove that under certain controllability conditions, an AMPC controller can attain V-formation with probability~1.

We define several classes of attackers, including those that in one move can remove a small number $R$ of birds from the flock, or introduce random displacement (perturbation) into the flock dynamics, again by selecting a small number of victim agents.  We consider both \emph{naive attackers}, whose strategies are purely probabilistic, and \emph{AMPC-enabled attackers}, putting them on par strategically with the controllers.  The architecture of a V-formation game with an AMPC-enabled attacker is shown in Figure~\ref{fig:ampc}.
While an AMPC-enabled controller is expected to win every game with probability~1, in practice, it is \emph{resource-constrained}: its maximum prediction horizon and the maximum number of game execution steps are fixed in advance.  Under these conditions, an attacker has a much better chance of winning a V-formation game.

AMPC is a key contribution of the work presented in this paper.  Traditional MPC uses a fixed finite \emph{prediction horizon} to determine the optimal control action.  Hence, it may get stuck in local minima. The AMPC procedure chooses it dynamically.  Thus, AMPC can adapt to the severity of the action played by its adversary by choosing its own horizon accordingly. The AMPC procedure is inspired by an adaptive optimization procedure recently presented in~\cite{lukina2016arxiv}.

Our extensive performance evaluation of V-formation games uses statistical model checking to estimate the probability that an attacker can thwart the controller.  Our results show that for the bird-removal game with $R\,{=}\,1$, the controller almost always wins (restores the flock to a V-formation). For $R\,{=}\,2$, the game outcome critically depends on which two birds are removed.
%% : as long as the two removed birds are not adjacent to one another, the controller 
%% wins (is resilient).  
For the displacement game, our results again demonstrate that an intelligent attacker, i.e.~one that uses AMPC in this case, significantly outperforms its naive counterpart
%% that simply and uniformly at random
that randomly executes its attack.

Traditional feedback control is, by design, resilient to noise, and also certain kinds of attacks; as our results show, however, it may not be resilient against smart attacks.  Adaptive-horizon control helps to guard against a larger class of attacks, but it can still falter due to limited resources.
Our results also demonstrate that statistical model checking represents a promising approach toward the evaluation CPS resilience against a wide range of attacks.

The rest of the paper is organized as follows.  Section~\ref{sec:background} introduces our dynamic model of V-formation in a flock of autonomous agents, and Section~\ref{sec:problem} defines our controller-attacker stochastic games. Section~\ref{sec:ampc} presents AMPC, and Section~\ref{sec:sgv} shows how AMPC is used in the V-formation games we consider. Section~\ref{sec:results} gives a critical analysis of our results, and Section~\ref{sec:related} discusses related work. Section~\ref{sec:conclusion} offers our concluding remarks and directions for future work.

%A potential point of such an cyber-physical attack is the controller of the system. Such real-world controller are prone to failure. This might be due to noisy information or uncertainty in actions. However, this error proneness also allows an attacker to conceal the attack and remain undetected.
 
%The control problem can be modeled as Markov Decision Processes where the controller tries to transit from an initial state towards a specific desired state. Given an MDP and one of its initial states, generating an optimal plan (action sequence) to reach a state whose cost is below a desired threshold is not a simple task. Keeping the MDP in such a state is becoming more difficult if something or someone is purposefully interfering with the system. In this case, the system is swaying from its desired state and needs to be re-adjusted accordingly in order to remain in this state. 

%In this paper we consider different types of attacks on deterministic \todo{should we keep deterministic as it has been frowned upon in the TACAS submission?} MDPs and consider. Specifically we want to control individual birds in order to get a flock of random birds to fly in a v-formations. Therefore we present a novel controller approach based on levels and using receding horizons to find optimal next actions. Furthermore, we are interested in how such an controller and the controlled flocks could be attacked. 
%We then use this controller to ensure our system remains in the desired state, i.e. in a v-formation in the presence of an ongoing attack. In order to show the resilience of our controller, we look towards game theory and study different interference models as different games. Here the attacker and the controller act as adversarial players trying to diverge from or remain in a specific state, respectively. However, proofing the best strategies for the players of each individual game is not feasible due to the games infinite state space, i.e. potential moves to be performed by each player. Therefore, we show the resilience of our controller by playing fair-games, where both players have the same capabilities. 

%First we model a game with very simple attacks where an attacker removes a varying \todo{should we show the implications of removing $x$ of our $n$ birds where $x \leq (n-1)$?} number of birds in order to disrupt the desired v-formation. Additionally we investigate the magnitude of noise our approach is able to deal with. The reason for this noise can be manifold such as sensor or actuator inaccuracies or environmental aspects like wind.
%Second, we extend this to sequential games with more sophisticated attacks. Here, the attacker introduces a malicious bird to the flock. The attacker is able to control this bird and tries to perturb the flock in staying in a v-formation. Since the controller might be able to detect the attacker, the attacker uses only attacks which might seem to the controller like simple noise. Only if this is not successful for the attacker, it will try to perform a bigger attack using noise with a much higher magnitude. While this big attack will give away the ongoing attack, we expect the attacker to be successful.
%Third, the attacker uses the same approach as in the second game. However, when the opportune moment arrives, the attacker chooses between adding a large noise or removing a certain number of birds from the flock.
%Second, we extend this to sequential games with more sophisticated attacks. Here, the attacker has the same access to the flock as the planner. We show how greedy approaches will lead to an oscillating effect in the achieved performance of the system when using our proposed planner.
%Third, the attacker will only have access to a limited set of birds. Since the planner might be able to detect the attacker, the attacker uses only simple attacks which might seem to the planner like simple noise. Only if this is not successful for the attacker, it will try to perform a bigger attack. While this big attack will give away the ongoing attack, we expect the attacker to be successful.

%In this paper we postulate that our approach is able to always find a potential attack strategy of an adversarial player, given such a strategy exists. We present and proof various theorems on whether an attacker can be successful on a sophisticated planning approach for cyber-physical systems.  Additionally, we show extensive simulations of game plays substantiating our claims and demonstrating the robustness of our control approach. 
% \todo[inline]{SAS: I think the latter, given as one or more theorems that we prove, is going
% to be out main results.  Simulations will be used to provide interesting
% evidence/illustrations of the theorems.}






