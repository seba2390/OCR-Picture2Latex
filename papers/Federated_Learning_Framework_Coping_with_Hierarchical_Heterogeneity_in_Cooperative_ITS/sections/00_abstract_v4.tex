\begin{abstract}

Deep learning is a key approach for the environment perception function of Cooperative Intelligent Transportation Systems (C-ITS) with autonomous vehicles and smart traffic infrastructure. %
The performance of the object recognition and detection strongly depends on the data volume in the model training, which is usually not sufficient due to the limited data collected by a typically small fleet of test vehicles. %
In today's C-ITS, smart traffic participants are capable of timely generating and transmitting a large amount of data. However, these data can not be used for model training directly due to privacy constraints. %
In this paper, we introduce a federated learning framework coping with Hierarchical Heterogeneity (\myHFed), which can notably enhance the conventional %OEM 
pre-trained deep learning model. The framework exploits data from connected public traffic agents in vehicular networks without affecting user data privacy. 
By coordinating existing traffic infrastructure, including roadside units and road traffic clouds, the model parameters are efficiently disseminated by vehicular communications and hierarchically aggregated.
Considering the individual heterogeneity of data distribution, computational and communication capabilities across traffic agents and roadside units, we employ a novel method that addresses the heterogeneity in different aggregation layers of the framework architecture, i.e., aggregation in layers of roadside units and cloud. 
The experimental results indicate that our method can well balance the learning accuracy and stability according to the knowledge of heterogeneity in current communication networks. Comparing to other baseline approaches, the evaluation on federated datasets shows that our framework is more general and capable especially in application scenarios with low communication quality. Even when 90\% of the agents are timely disconnected, the pre-trained deep learning model can still be forced to converge stably, and its accuracy can be enhanced from 68\% to over 90\% after convergence.  
\end{abstract}

%\begin{IEEEkeywords}
%federated learning, deep learning model enhancement, cooperative ITS, road environmental perception, image processing
%\end{IEEEkeywords}