\begin{table}[!ht]
    \centering
    \begin{tabular}{|c|c c c|c c c|}
    \hline
    \multicolumn{7}{|c|}{$Q^5$ spectral element method (SEM)}\\
    \hline
    \multirow{2}{*}{FEM Mesh} &  \multicolumn{3}{c|}{Dirichlet boundary} &  \multicolumn{3}{c|}{Neumann boundary}\\
     & {Total DoFs}  & $\ell^2$ error & order & {Total DoFs}  & $\ell^2$ error & order\\
    \hline
    $2^3$ &$9^3$ &  $2.27$E-$1$ & - & $11^3$ & $4.76$E-$1$ & - \\
    \hline
    $4^3$ & $19^3$ &  $3.91$E-$3$ & $5.86$ & $21^3$ & $5.49$E-$3$ & $6.44$\\
    \hline
    $8^3$ & $39^3$ &  $4.12$E-$5$ & $6.57$ & $41^3$ & $4.32$E-$5$ & $6.99$\\
    \hline
    $16^3$ & $79^3$ & $3.34$E-$7$ & $6.95$ & $81^3$ & $3.42$E-$7$ & $6.98$\\
    \hline
    $32^3$ & $159^3$ & $2.63$E-$9$ & $6.99$ & $161$ & $2.67$E-$9$ & $7.00$\\
    % \hline
    % $319\times 319\times 319$ & $64\times 64 \times 64$ & $2.09$E-$11$ & $6.97$\\
    \hline
    \hline
    \multicolumn{7}{|c|}{$Q^6$ spectral element method (SEM)}\\
    \hline
    \multirow{2}{*}{FEM Mesh} &  \multicolumn{3}{c|}{Dirichlet boundary} & \multicolumn{3}{c|}{Neumann boundary}\\
     & {Total DoFs}  & $\ell^2$ error & order & {Total DoFs}  & $\ell^2$ error & order\\
    \hline
    $2^3$ & $11^3$ &  $9.68$E-$2$ & - & $13^3$ & $1.18$E-$1$ & - \\
    \hline
    $4^3$ & $23^3$ &  $6.05$E-$4$ & $7.32$ & $25^3$ & $8.42$E-$4$ & $7.13$\\
    \hline
     $8^3$ & $47^3$ & $3.11$E-$6$ & $7.60$ & $49^3$ & $3.24$E-$6$ & $8.02$\\
    \hline
    $16^3$ & $95^3$ & $1.26$E-$8$ & $7.95$ & $97^3$ & $1.28$E-$8$ & $7.98$\\
    \hline
    $32^3$ & $191^3$ & $4.96$E-$11$ & $7.98$ & $193^3$ & $5.09$E-$11$ & $7.98$\\
    % \hline
    % $383\times 383\times 383$ & $64\times 64 \times 64$ & $4.25$E-$12$ & $3.54$\\
    \hline
    \end{tabular}
    \caption{Accuracy tests for discrete Laplacian for a 3D problem with Dirichlet boundary conditions and a 3D problem with Neumann boundary conditions.}
    \label{tab1:accuracy test dirichlet/neumann}
\end{table}


@article{li2022accuracy,
  title={{Accuracy of Spectral Element Method for Wave, Parabolic, and Schrödinger Equations}},
  author={Li, Hao and Appelö, Daniel and Zhang, Xiangxiong},
  journal={SIAM Journal on Numerical Analysis},
  volume={60},
  number={1},
  pages={339--363},
  year={2022},
  publisher={SIAM}
}
\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
         Total DoFs & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         12700 & $2.29$E$1$ & $4.86$E$1$ & $1.08$E$2$ & $1.81$E$2$ & $3.36$E$2$ &
         $2.25$E$2$\\
    \hline
         Quadro & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ &
         $2.25$E$2$\\

    \hline
         A100 & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
    \hline
         Total DoFs & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         12700 & $4.98$E$2$ & $7.13$E$2$ & - & - & - & - \\
    \hline
         Quadro & $2.96$E$2$ & $4.46$E$2$ & $6.40$E$2$ & $9.09$E$2$ & $1.11$E$3$ &
         $1.48$E$3$\\
    \hline
         A100 & $1.11$E$1$ & $1.71$E$1$ & $2.35$E$1$ & $3.37$E$1$ & $4.07$E$1$ &
         $5.31$E$1$\\
    \hline
    \hline
         Total DoFs & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
         Quadro & $1.97$E$3$ & $2.55$E$3$ & $3.27$E$3$ & $3.77$E$3$ & $4.656$E$3$ & $5.79$E$3$\\
    \hline
         A100  & $6.86$E$1$ & $8.97$E$1$ & $1.14$E$2$ & $1.34$E$2$ & $1.59$E$2$ &
         $2.01$E$2$\\
    \hline
    \hline
         Total DoFs & $1100^3$ & $1150^3$ & $1200^3$ & $1250^3$ & $1300^3$ & $1350^3$\\
    \hline
         A100 & $2.46$E$2$ & $2.85$E$2$ & $3.27$E$2$ & $4.06$E$2$ & - & -\\
    \hline
    \end{tabular}
    \caption{Poisson equation: $Q^5$ SEM computation time comparison on different hardware (unit in seconds)}
    \label{tab3: poisson_CPU_GPU}
\end{table}
\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
         Total DoFs & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         12700 & $2.29$E$1$ & $4.86$E$1$ & $1.08$E$2$ & $1.81$E$2$ & $3.36$E$2$ &
         $2.25$E$2$\\
    \hline
         Quadro & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ &
         $2.25$E$2$\\

    \hline
         A100 & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
    \hline
         Total DoFs & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         12700 & $4.98$E$2$ & $7.13$E$2$ & - & - & - & - \\
    \hline
         Quadro & $2.96$E$2$ & $4.46$E$2$ & $6.40$E$2$ & $9.09$E$2$ & $1.11$E$3$ &
         $1.48$E$3$\\
    \hline
         A100 & $1.11$E$1$ & $1.71$E$1$ & $2.35$E$1$ & $3.37$E$1$ & $4.07$E$1$ &
         $5.31$E$1$\\
    \hline
    \hline
         Total DoFs & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
         Quadro & $1.97$E$3$ & $2.55$E$3$ & $3.27$E$3$ & $3.77$E$3$ & $4.656$E$3$ & $5.79$E$3$\\
    \hline
         A100  & $6.86$E$1$ & $8.97$E$1$ & $1.14$E$2$ & $1.34$E$2$ & $1.59$E$2$ &
         $2.01$E$2$\\
    \hline
    \hline
         Total DoFs & $1100^3$ & $1150^3$ & $1200^3$ & $1250^3$ & $1300^3$ & $1350^3$\\
    \hline
         A100 & $2.46$E$2$ & $2.85$E$2$ & $3.27$E$2$ & $4.06$E$2$ & - & -\\
    \hline
    \end{tabular}
    \caption{Poisson equation: $Q^5$ SEM computation time comparison on different hardware (unit in seconds)}
    \label{tab3: poisson_CPU_GPU}
\end{table}

\begin{table}[!ht]
    \centering
    \begin{tabular}{|c|c|c c|}
    \hline
    \multicolumn{4}{|c|}{$Q^5$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & $\ell^2$ error & order\\
    \hline
    $9\times 9\times 9$ & $2\times 2 \times 2$ & $2.27$E-$1$ & - \\
    \hline
    $19\times 19\times 19$ & $4\times 4 \times 4$ & $3.91$E-$3$ & $5.86$\\
    \hline
    $39\times 39\times 39$ & $8\times 8 \times 8$ & $4.12$E-$5$ & $6.57$ \\
    \hline
    $79\times 79\times 79$ & $16\times 16 \times 16$ & $3.34$E-$7$ & $6.95$ \\
    \hline
    $159\times 159\times 159$ & $32\times 32 \times 32$ & $2.63$E-$9$ & $6.99$ \\
    % \hline
    % $319\times 319\times 319$ & $64\times 64 \times 64$ & $2.09$E-$11$ & $6.97$\\
    \hline
    \multicolumn{4}{|c|}{$Q^6$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & $\ell^2$ error & order\\
    \hline
    $11\times 11\times 11$ & $2\times 2 \times 2$ & $9.68$E-$2$ & - \\
    \hline
    $23\times 23\times 23$ & $4\times 4 \times 4$ & $6.05$E-$4$ & $7.32$ \\
    \hline
    $47\times 47\times 47$ & $8\times 8 \times 8$ & $3.11$E-$6$ & $7.60$ \\
    \hline
    $95\times 95\times 95$ & $16\times 16 \times 16$ & $1.26$E-$8$ & $7.95$ \\
    \hline
    $191\times 191\times 191$ & $32\times 32 \times 32$ & $4.96$E-$11$ & $7.98$ \\
    % \hline
    % $383\times 383\times 383$ & $64\times 64 \times 64$ & $4.25$E-$12$ & $3.54$\\
    \hline
    \end{tabular}
    \caption{Accuracy test for discrete Laplacian for a 3D problem with Dirichlet boundary condition}
    \label{tab1:accuracy test dirichlet}
\end{table}
\begin{table}[!ht]
    \centering
    \begin{tabular}{|c|c|c c|}
    \hline
    \multicolumn{4}{|c|}{$Q^5$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & $\ell^2$ error & order\\
    \hline
    $11\times 11\times 11$ & $2\times 2 \times 2$ & $4.76$E-$1$ & - \\
    \hline
    $21\times 21\times 21$ & $4\times 4 \times 4$ & $5.49$E-$3$ & $6.44$\\
    \hline
    $41\times 41\times 41$ & $8\times 8 \times 8$ & $4.32$E-$5$ & $6.99$ \\
    \hline
    $81\times 81\times 81$ & $16\times 16 \times 16$ & $3.42$E-$7$ & $6.98$ \\
    \hline
    $161\times 161\times 161$ & $32\times 32 \times 32$ & $2.67$E-$9$ & $7.00$ \\
    \hline
    % $321\times 321\times 321$ & $64\times 64 \times 64$ & $3.06$E-$11$ & $6.45$\\
    % \hline
    \multicolumn{4}{|c|}{$Q^6$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & $\ell^2$ error & order\\
    \hline
    $13\times 13\times 13$ & $2\times 2 \times 2$ & $1.18$E-$1$ & - \\
    \hline
    $25\times 25\times 25$ & $4\times 4 \times 4$ & $8.42$E-$4$ & $7.13$ \\
    \hline
    $49\times 49\times 49$ & $8\times 8 \times 8$ & $3.24$E-$6$ & $8.02$ \\
    \hline
    $97\times 97\times 97$ & $16\times 16 \times 16$ & $1.28$E-$8$ & $7.98$ \\
    \hline
    $193\times 193\times 193$ & $32\times 32 \times 32$ & $5.09$E-$11$ & $7.98$ \\
    \hline
    % $385\times 385\times 385$ & $64\times 64 \times 64$ & $1.03$E-$11$ & $2.30$\\
    % \hline
    \end{tabular}
    \caption{Accuracy test for discrete Laplacian for a 3D problem with Neumann boundary condition}
    \label{tab2:accuracy test neumann}
\end{table}
\begin{table}[!ht]
    \centering
    \begin{tabular}{|c|c|c c|}
    \hline
    \multicolumn{4}{|c|}{$Q^5$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & $\ell^2$ error & order\\
    \hline
    $11\times 11\times 11$ & $2\times 2 \times 2$ & $4.76$E-$1$ & - \\
    \hline
    $21\times 21\times 21$ & $4\times 4 \times 4$ & $5.49$E-$3$ & $6.44$\\
    \hline
    $41\times 41\times 41$ & $8\times 8 \times 8$ & $4.32$E-$5$ & $6.99$ \\
    \hline
    $81\times 81\times 81$ & $16\times 16 \times 16$ & $3.42$E-$7$ & $6.98$ \\
    \hline
    $161\times 161\times 161$ & $32\times 32 \times 32$ & $2.67$E-$9$ & $7.00$ \\
    \hline
    % $321\times 321\times 321$ & $64\times 64 \times 64$ & $3.06$E-$11$ & $6.45$\\
    % \hline
    \multicolumn{4}{|c|}{$Q^6$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & $\ell^2$ error & order\\
    \hline
    $13\times 13\times 13$ & $2\times 2 \times 2$ & $1.18$E-$1$ & - \\
    \hline
    $25\times 25\times 25$ & $4\times 4 \times 4$ & $8.42$E-$4$ & $7.13$ \\
    \hline
    $49\times 49\times 49$ & $8\times 8 \times 8$ & $3.24$E-$6$ & $8.02$ \\
    \hline
    $97\times 97\times 97$ & $16\times 16 \times 16$ & $1.28$E-$8$ & $7.98$ \\
    \hline
    $193\times 193\times 193$ & $32\times 32 \times 32$ & $5.09$E-$11$ & $7.98$ \\
    \hline
    % $385\times 385\times 385$ & $64\times 64 \times 64$ & $1.03$E-$11$ & $2.30$\\
    % \hline
    \end{tabular}
    \caption{Accuracy test for discrete Laplacian for a 3D problem with Neumann boundary condition}
    \label{tab2:accuracy test neumann}
\end{table}

\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
         Total DoFs & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         Quadro (SEM) & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ &
         $2.25$E$2$\\
    \hline
         Quadro (FFT) & $2.06$E$0$ & $4.61$E$0$ & $7.82$E$0$ & $1.33$E$1$ & $1.83$E$1$ &
         $2.70$E$1$\\
    \hline
         A100 (SEM) & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
         A100 (FFT) & $4.58$E-$1$ & $7.50$E-$1$ & $1.49$E$0$ & $2.44$E$0$ & $3.37$E$0$ &
         $4.52$E$0$\\
    \hline
    \hline
         Total DoFs & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         Quadro (SEM) & $2.96$E$2$ & $4.46$E$2$ & $6.40$E$2$ & $9.09$E$2$ & $1.11$E$3$ &
         $1.48$E$3$\\
    \hline
         Quadro (FFT) & $5.19$E$1$ & $6.89$E$1$ & $9.12$E$1$ & $1.64$E$2$ & $1.57$E$2$ &
         $1.31$E$2$\\
    \hline
         A100 (SEM) & $1.11$E$1$ & $1.71$E$1$ & $2.35$E$1$ & $3.37$E$1$ & $4.07$E$1$ &
         $5.31$E$1$\\
    \hline
         A100 (FFT) & $8.22$E$0$ & $1.21$E$1$ & $1.56$E$1$ & $2.55$E$1$ & $3.02$E$1$ & $2.17$E$1$\\
    \hline
    \hline
         Total DoFs & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
         Quadro (SEM) & $1.97$E$3$ & $2.55$E$3$ & $3.27$E$3$ & $3.77$E$3$ & $4.656$E$3$ & $5.79$E$3$\\
    \hline
         Quadro (FFT) & $1.52$E$2$ & $3.82$E$2$ & $2.13$E$2$ & - & - & -\\
    \hline
         A100 (SEM) & $6.86$E$1$ & $8.97$E$1$ & $1.14$E$2$ & $1.34$E$2$ & $1.59$E$2$ &
         $2.01$E$2$\\
    \hline
         A100 (FFT) & $3.38$E$1$ & $5.76$E$1$ & $3.32$E$1$ & $8.43$E$1$ & $7.97$E$1$ & -\\
    \hline
    \hline
         Total DoFs & $1100^3$ & $1150^3$ & $1200^3$ & $1250^3$ & $1300^3$ & $1350^3$\\
    \hline
         A100 (SEM) & $2.46$E$2$ & $2.85$E$2$ & $3.27$E$2$ & $4.06$E$2$ & - & -\\
    \hline
    \end{tabular}
    \caption{Poisson equation: computation time comparison between $Q^5$ SEM and FFT(unit in seconds)}
    \label{tab4: poisson_FFT_SEM}
\end{table}

\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
         Total DoFs & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         12700 & $2.29$E$1$ & $4.86$E$1$ & $1.08$E$2$ & $1.81$E$2$ & $3.36$E$2$ &
         $2.25$E$2$\\
    \hline
         Quadro & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ &
         $2.25$E$2$\\

    \hline
         A100 & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
    \hline
         Total DoFs & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         12700 & $4.98$E$2$ & $7.13$E$2$ & - & - & - & - \\
    \hline
         Quadro & $2.96$E$2$ & $4.46$E$2$ & $6.40$E$2$ & $9.09$E$2$ & $1.11$E$3$ &
         $1.48$E$3$\\
    \hline
         A100 & $1.11$E$1$ & $1.71$E$1$ & $2.35$E$1$ & $3.37$E$1$ & $4.07$E$1$ &
         $5.31$E$1$\\
    \hline
    \hline
         Total DoFs & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
         Quadro & $1.97$E$3$ & $2.55$E$3$ & $3.27$E$3$ & $3.77$E$3$ & $4.656$E$3$ & $5.79$E$3$\\
    \hline
         A100  & $6.86$E$1$ & $8.97$E$1$ & $1.14$E$2$ & $1.34$E$2$ & $1.59$E$2$ &
         $2.01$E$2$\\
    \hline
    \hline
         Total DoFs & $1100^3$ & $1150^3$ & $1200^3$ & $1250^3$ & $1300^3$ & $1350^3$\\
    \hline
         A100 & $2.46$E$2$ & $2.85$E$2$ & $3.27$E$2$ & $4.06$E$2$ & - & -\\
    \hline
    \end{tabular}
    \caption{Poisson equation: $Q^5$ SEM computation time comparison on different hardware (unit in seconds)}
    \label{tab3: poisson_CPU_GPU}
\end{table}
Before we goes to the details of the implementation, we first define some operations from Matlab that\\
\textbf{Inner Product}:
The inner product of two tensors is a generalization of the dot product operation for vectors. A dot product operation (multiply and sum) is performed on all corresponding dimensions in the tensors, so the operation returns a scalar value. For this operation, the tensors must have the same size. For example, if tensors $U$ and $V$ have the same $n$ dimensions $(i_1, i_2,\ldots, i_n)$, then the inner product \mcode{w = tensorprod(U,V,"all")} is a scalar given by the summation:
\begin{equation*}
    w = \sum_{i_n}\cdots\sum_{i_2}\sum_{i_1}U_{i_1,i_2,\ldots,i_n}V_{i_1,i_2,\ldots,i_n}
\end{equation*}
\textbf{Outer Product}: 
The outer product for tensors is a generalization of the Kronecker product for 2-D matrices. The outer product of two tensors multiplies all combinations of their elements. Because no dimensions in the tensors are contracted, the output is a large tensor.
For example, if tensor $U$ has $n$ dimensions $(i_1, i_2,\ldots,i_n)$ and tensor $V$ has $m$ dimensions $(j_1, j_2,\ldots,j_m)$, then the outer product \mcode{W = tensorprod(U,V)} is a tensor with $n+m$ dimensions $(i_1, i_2,\ldots,i_n,j_1, j_2,\ldots,j_m)$ given by:
\begin{equation*}
    W_{i_1,i_2,\ldots,i_n,j_1,j_2,\ldots,j_m} = U_{i_1,i_2,\ldots,i_n}\cdot V_{j_1,j_2,\ldots,j_m}
\end{equation*}
\textbf{Tensor Product}: The tensor product combines the inner and outer product operations. You can specify pairs of dimensions with the same size in each tensor to be contracted with each other by means of an inner product, and these dimensions are multiplied and summed to reduce the dimension size to one. After all specified dimensions are contracted, the remaining dimensions have an outer product operation performed, multiplying all combinations of their elements.

For example, if tensor $U$ has dimensions $(i, j, n)$ and tensor $V$ has dimensions $(i, j, m)$, then the tensor product \mcode{W = tensorprod(U,V,[1 2])} contracts the first two dimensions of each tensor with each other and the result has dimensions $(n, m)$:
\begin{equation*}
    W_{n,m} = \sum_{j}\sum_{i}U_{i,j,n}\cdot V_{i,j,m}
\end{equation*}

For simple notation, we use $A_{i}$ instead of $A^{x_i}$ and can do the tensor matrix multiplication in following way:\\
(i) $H = M^{-1}S$ ,  and we can rewrite the first matrix term of equation \eqref{matvec-3d} as
\begin{align*}
    & T_{1}\Lambda_{1}T_{1}^{-1}\otimes I_2\otimes I_3 + I_1\otimes T_{2}\Lambda_{2}T_{2}^{-1}\otimes  I_3 + I_1\otimes  I_2\otimes T_{3}\Lambda_{3}T_{3}^{-1}\\
    =& \left(T_1\otimes T_2\otimes T_3\right)\left(\Lambda_1\otimes I_2\otimes I_3 + I_1\otimes \Lambda_2\otimes I_3 + I_1\otimes I_2\otimes \Lambda_3\right)\left(T^{-1}_1\otimes T^{-1}_2\otimes T^{-1}_3\right)
\end{align*}
Then, the next question is how to implement following tensor matrix multiplication that
\begin{equation}\label{basic}
    vec(Y) = (A_1\otimes A_2 \otimes A_3)vec(X).
\end{equation}

Let us back to the basic problem \eqref{basic} with $A_i$ is $N_i$ size square matrix. To understand what the result is, we start from the kron product that 
\begin{align*}
    vec(Y) &= \left((A_1\otimes A_2)\otimes A_3\right)vec(X)\\
    &= \left((A_1\otimes A_2)\otimes A_3\right)[vec(x_1)]
\end{align*}

% \section{Numerics for Fractional Laplacian}
% Consider following fractional Laplacian equation that
% \begin{equation*}
%     \begin{cases}
%         (-\Delta)^s u(\bx) = f(\bx), \quad \bx = (x_1,x_2,\ldots,x_d)\in\Omega,\\
%         u\vert_{\partial \Omega} = 0,
%     \end{cases}
% \end{equation*}
% where $0<s<1$, $\Omega$ is the domain and $(-\Delta)^{s}$ is the spectral Laplacian operator. An extension way to solve this problem is provided in the paper \cite{chen2020efficient} that
% \begin{equation*}
%     \begin{cases}
%         \nabla\cdot\left(y^\alpha \nabla U(\bx,y)\right) = 0,\\
%         \mathcal{N} U := -\lim_{y\rightarrow 0 }y^\alpha U_{y}(\bx,y) = d_s f(\bx),\\
%         U\vert_{\partial_{L}\mathcal{D}} = 0, 
%     \end{cases}
% \end{equation*}
% where $\alpha = 1-2s$, $d_s = 2^{1-2s}\Gamma(1-s)/\Gamma(s)$, and $\mathcal{D} = \Omega\times(0,\infty)$.
% \subsection{Matrix Representation}
% For the Galerkin approximation, we denote the approximation space in $\Omega$ as 
% $$X_h:= span\{\phi^{\bx}_{m}(x), 1\leq m \leq M\},$$ and
% $$Y_{N}:= span\{\phi_{n}^{y}(y) = \mathcal{L}_{n-2}^{(\alpha)}(y) - \mathcal{L}_{n-1}^{(\alpha)}(y), 1\leq n \leq N\}.$$
% Then, the Galerkin method for the system is to find $U^h_N\in X_h\times Y_N$ as
% \begin{equation*}
%     U^h_N(\bx,y) = \sum_{m=1}^{M}\sum_{n=1}^{N}u_{mn}\phi^x_m(\bx)\phi_n^y(y),
% \end{equation*}
% such that
% \begin{equation*}
%     \bm{S}^x\bm{U}\bm{M}^y + \bm{M}^x\bm{U}\bm{S}^y=\bm{F},
% \end{equation*}
% where $\bm{M}^x$ and $\bm{S}^x$ are the mass and stiffness matrices in $\bx$-direction(s), $\bm{M}^y$ and $\bm{S}^y$ are the mass and stiffness matrices in the extended $y$-direction, and $\bm{F} = (f_{mn})_{M\times N}$, $f_{mn} = d_s\phi^y_n(0)(f,\phi_m^x)_{\Omega}$.

% \subsection{1D example}
% \subsection{2D example}

\begin{table}[!ht]
    \centering
    \begin{tabular}{|c|c|c|c|}
    \hline
    \multicolumn{4}{|c|}{Second order central difference (CD)}\\
    \hline
    CD grid& Mesh Size & Error & GPU time \\
    \hline
    $9\times 9\times 9$ & $h=0.2$ &$3.24$E-$2$ & -\\
    \hline
    $19\times 19\times 19$ & $h=0.1$ &$7.99$E-$3$ &\\
    \hline
    $39\times 39\times 39$ & $h=0.05$ &$1.99$E-$3$ &\\
    \hline
    $79\times 79\times 79$ & $h=0.025$ &$4.97$E-$4$ &\\
    \hline
    \multicolumn{4}{|c|}{$Q^5$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & Error & GPU time \\
    \hline
    $9\times 9\times 9$ & $2\times 2 \times 2$ & $1.31$E-$4$ & \\
    \hline
    $19\times 19\times 19$ & $4\times 4 \times 4$ & $4.12$E-$6$ & \\
    \hline
    $39\times 39\times 39$ & $8\times 8 \times 8$ & $3.37$E-$8$ & \\
    \hline
    $79\times 79\times 79$ & $16\times 16 \times 16$ & $2.66$E-$10$ & \\
    \hline
    \multicolumn{4}{|c|}{$Q^6$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & Error & GPU time \\
    \hline
    $11\times 11\times 11$ & $2\times 2 \times 2$ & $4.85$E-$5$ & \\
    \hline
    $23\times 23\times 23$ & $4\times 4 \times 4$ & $2.10$E-$7$ & \\
    \hline
    $47\times 47\times 47$ & $8\times 8 \times 8$ & $8.49$E-$10$ & \\
    \hline
    $95\times 95\times 95$ & $16\times 16 \times 16$ & $3.40$E-$12$ & \\
    \hline
    % \multicolumn{4}{|c|}{Fast Fourier Transform (FFT)}\\
    % \hline
    % Total DoFs & Number of Points & Error & GPU time \\
    % \hline
    %      &  & &\\
    % \hline
    \end{tabular}
    \caption{Poisson euqation: GPU computation time with $200$ times implementations}
    \label{tab2:Poisson}
\end{table}

\begin{table}[!ht]
    \centering
    \begin{tabular}{|c|c|c c|c c|}
    \hline
    % \multicolumn{4}{|c|}{Second order finite difference (FD)}\\
    % \hline
    % FD grid& Mesh Size & Error & order \\
    % \hline
    % $9\times 9\times 9$ & $h=0.2$ &$3.24$E-$2$ & -\\
    % \hline
    % $19\times 19\times 19$ & $h=0.1$ &$7.99$E-$3$ &\\
    % \hline
    % $39\times 39\times 39$ & $h=0.05$ &$1.99$E-$3$ &\\
    % \hline
    % $79\times 79\times 79$ & $h=0.025$ &$4.97$E-$4$ &\\
    % \hline
    \multicolumn{6}{|c|}{$Q^5$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & \multicolumn{2}{c|}{\begin{tabular}{cc} \multicolumn{2}{c}{Dirichlet b.c.} \\ $l^2$ error & order\end{tabular}} & \multicolumn{2}{c|}{\begin{tabular}{cc} \multicolumn{2}{c}{Neumann b.c.} \\ $l^2$ error & order\end{tabular}}\\
    \hline
    $9\times 9\times 9$ & $2\times 2 \times 2$ & $2.27$E-$1$ & - & &\\
    \hline
    $19\times 19\times 19$ & $4\times 4 \times 4$ & $3.91$E-$3$ & $5.86$ & &\\
    \hline
    $39\times 39\times 39$ & $8\times 8 \times 8$ & $4.12$E-$5$ & $6.57$ & &\\
    \hline
    $79\times 79\times 79$ & $16\times 16 \times 16$ & $3.34$E-$7$ & $6.95$ & &\\
    \hline
    $159\times 159\times 159$ & $32\times 32 \times 32$ & $2.63$E-$9$ & $6.99$ & &\\
    \hline
    $319\times 319\times 319$ & $64\times 64 \times 64$ & $2.09$E-$11$ & $6.97$& &\\
    \hline
    \multicolumn{6}{|c|}{$Q^6$ spectral element method (SEM)}\\
    \hline
    Total DoFs & FEM Mesh & \multicolumn{2}{c|}{\begin{tabular}{cc} \multicolumn{2}{c}{Dirichlet b.c.} \\ $l^2$ error & order\end{tabular}} & \multicolumn{2}{c|}{\begin{tabular}{cc} \multicolumn{2}{c}{Neumann b.c.} \\ $l^2$ error & order\end{tabular}}\\
    \hline
    $11\times 11\times 11$ & $2\times 2 \times 2$ & $9.68$E-$2$ & - & &\\
    \hline
    $23\times 23\times 23$ & $4\times 4 \times 4$ & $6.05$E-$4$ & $7.32$ & &\\
    \hline
    $47\times 47\times 47$ & $8\times 8 \times 8$ & $3.11$E-$6$ & $7.60$ & &\\
    \hline
    $95\times 95\times 95$ & $16\times 16 \times 16$ & $1.26$E-$8$ & $7.95$ & &\\
    \hline
    $191\times 191\times 191$ & $32\times 32 \times 32$ & $4.96$E-$11$ & $7.98$ & &\\
    \hline
    $383\times 383\times 383$ & $64\times 64 \times 64$ & $4.25$E-$12$ & $3.54$& &\\
    \hline
    % \multicolumn{4}{|c|}{Fast Fourier Transform (FFT)}\\
    % \hline
    % Total DoFs & Number of Points & Error & order \\
    % \hline
    %      &  & &\\
    % \hline
    \end{tabular}
    \caption{Accuracy test for discrete Laplacian for a 3D problem with Dirichlet b.c. and Neumman}
    \label{tab1:accuracy test}
\end{table}

% \subsection{Matrix exponential}

% Another possible application to include: for solving heat equation $u_t=\Delta u$, consider semi-discrete scheme
% $u_t=\Delta_h u$. The exact solution to the semi-discrete scheme is the ODE solution $u_t=\exp{(\Delta_h}) u$,
% where the matrix exponential is defined and computed by eigen-decomposition of $\Delta_h=T\Lambda T^{-1}\rightarrow
% \exp{(\Delta_h)}=T\exp{(\Lambda)} T^{-1}$ which is a positivity-preserving scheme. Cite Lili Ju's paper. 

\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|c|}
    \hline
          Mesh & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
          $\beta = 1$ & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ & $2.25$E$2$\\
    \hline
          $\beta = 10$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
         $\beta = 100$ & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ & $2.25$E$2$\\
    \hline
          $\beta = 200$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
         $\beta = 400$ & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ & $2.25$E$2$\\
    \hline
          $\beta = 800$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
          $\beta = 1000$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
    \hline
         Mesh & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
            $\beta = 1$ & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ & $2.25$E$2$\\
    \hline
          $\beta = 10$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
         $\beta = 100$ & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ & $2.25$E$2$\\
    \hline
          $\beta = 200$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
         $\beta = 400$ & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ & $2.25$E$2$\\
    \hline
          $\beta = 800$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
          $\beta = 1000$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
         Mesh & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
        $\beta = 1$ & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ & $2.25$E$2$\\
    \hline
          $\beta = 10$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
         $\beta = 100$ & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ & $2.25$E$2$\\
    \hline
          $\beta = 200$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
         $\beta = 400$ & $1.03$E$1$ & $1.91$E$1$ & $4.10$E$1$ & $7.82$E$1$ & $1.36$E$2$ & $2.25$E$2$\\
    \hline
          $\beta = 800$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
          $\beta = 1000$ & $9.00$E-$1$ & $1.15$E$0$ & $2.05$E$0$ & $3.31$E$0$ & $5.41$E$0$ &
         $8.52$E$0$\\
    \hline
    \end{tabular}
    \caption{Schr{\"o}dinger equation: number of iteration used with varied $\beta$}
    \label{tab11: GPU_schrodinger_iter}
\end{table}

    $200^3$ & $11$ & $30$ & $97$ & $361$& $395$ & $542$ & $421$ & $2151$& $7311$& $21006$\\
    \hline


    
\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
          Mesh & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         A100 (SEM) & $1.79$E-$1$ & $2.54$E-$1$ & $3.85$E-$1$ & $6.35$E-$1$ & $9.78$E-$1$ & $1.53$E$0$\\
    \hline
    \hline
         Mesh & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         A100 (SEM) & $2.02$E$0$ & $3.03$E$0$ & $3.92$E$0$ & $5.51$E$0$ & $6.70$E$0$ & $8.70$E$0$\\
    \hline
    \hline
         Mesh & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
         A100 (SEM) & $1.12$E$1$ & $1.52$E$1$ & $1.84$E$1$ & $3.25$E$1$ & - & -\\
    \hline
    \end{tabular}
    \caption{Schr{\"o}dinger equation: computation time in seconds with $\beta = 10$}
    \label{tab5: GPU_schrodinger_beta10}
\end{table}

\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
          Mesh & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         A100 (SEM) & $5.29$E-$1$ & $6.81$E-$1$ & $1.13$E$0$ & $1.86$E$0$ & $2.89$E$0$ & $4.45$E$0$\\
    \hline
    \hline
         Mesh & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         A100 (SEM) & $5.45$E$0$ & $8.46$E$0$ & $1.13$E$1$ & $1.58$E$1$ & $1.85$E$1$ & $2.45$E$1$\\
    \hline
    \hline
         Mesh & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
         A100 (SEM) & $3.14$E$1$ & $4.10$E$1$ & $5.12$E$1$ & $9.40$E$1$ & - & -\\
    \hline
    \end{tabular}
    \caption{Schr{\"o}dinger equation: computation time in seconds with $\beta = 100$}
    \label{tab6: GPU_schrodinger_beta100}
\end{table}

\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
          Mesh & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         A100 (SEM) & $1.91$E$0$ & $9.24$E-$1$ & $1.59$E$0$ & $2.61$E$0$ & $4.37$E$0$ & $6.39$E$0$\\
    \hline
    \hline
         Mesh & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         A100 (SEM) & $7.82$E$0$ & $1.21$E$1$ & $1.64$E$1$ & $2.25$E$1$ & $2.63$E$1$ & $3.51$E$1$\\
    \hline
    \hline
         Mesh & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
         A100 (SEM) & $4.52$E$1$ & $5.73$E$1$ & $7.31$E$1$ & $1.35$E$2$ & - & -\\
    \hline
    \end{tabular}
    \caption{Schr{\"o}dinger equation: computation time in seconds with $\beta = 200$}
    \label{tab7: GPU_schrodinger_beta200}
\end{table}
\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
          Mesh & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         A100 (SEM) & $2.10$E$0$ & $1.30$E$0$ & $2.18$E$0$ & $3.75$E$0$ & $6.03$E$0$ & $8.91$E$0$\\
    \hline
    \hline
         Mesh & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         A100 (SEM) & $1.10$E$1$ & $1.71$E$1$ & $2.36$E$1$ & $3.30$E$1$ & $3.85$E$1$ & $5.07$E$1$\\
    \hline
    \hline
         Mesh & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
         A100 (SEM) & $6.52$E$1$ & $8.37$E$1$ & $1.04$E$2$ & $1.96$E$2$ & - & -\\
    \hline
    \end{tabular}
    \caption{Schr{\"o}dinger equation: computation time in seconds with $\beta = 400$}
    \label{tab8: GPU_schrodinger_beta400}
\end{table}

\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
          Mesh & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         A100 (SEM) & $2.89$E$0$ & $2.20$E$0$ & $3.33$E$0$ & $5.45$E$0$ & $9.07$E$0$ & $1.29$E$1$\\
    \hline
    \hline
         Mesh & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         A100 (SEM) & $1.61$E$1$ & $2.52$E$1$ & $3.37$E$1$ & $4.75$E$1$ & $5.54$E$1$ & $7.33$E$1$\\
    \hline
    \hline
         Mesh & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$ \\
    \hline
         A100 (SEM) & $9.40$E$1$ & $1.21$E$2$ & $1.49$E$2$ & $2.84$E$2$ & - & - \\
    \hline
    \end{tabular}
    \caption{Schr{\"o}dinger equation: computation time in seconds with $\beta = 800$}
    \label{tab9: GPU_schrodinger_beta800}
\end{table}


\begin{table}[ht!]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
         Mesh         & $200^3$ & $250^3$ & $300^3$ & $350^3$ & $400^3$ & $450^3$\\
    \hline
         12700 & $9.48$E-$1$ & $1.58$E$0$ & $3.32$E$0$ & $6.30$E$0$ & $1.10$E$1$ & $1.80$E$1$\\
    \hline
         Quadro & $9.48$E-$1$ & $1.58$E$0$ & $3.32$E$0$ & $6.30$E$0$ & $1.10$E$1$ & $1.80$E$1$\\
    \hline
         A100    & $1.04$E-$1$ & $1.23$E-$1$ & $2.21$E-$1$ & $3.61$E-$1$ & $5.75$E-$1$ & $8.86$E-$1$\\
    \hline
    \hline
         Mesh & $500^3$ & $550^3$ & $600^3$ & $650^3$ & $700^3$ & $750^3$\\
    \hline
         Quadro & $2.38$E$1$ & $3.55$E$1$ & $5.11$E$1$ & $7.23$E$1$ & $8.78$E$1$ & $1.18$E$2$\\
    \hline
         A100 & $1.18$E$0$ & $1.75$E$0$ & $2.38$E$0$ & $3.35$E$0$ & $4.10$E$0$ & $5.30$E$0$\\
    \hline
    \hline
         Mesh & $800^3$ & $850^3$ & $900^3$ & $950^3$ & $1000^3$ & $1050^3$\\
    \hline
         A100 (SEM) & $6.79$E$0$ & $8.71$E$0$ & $1.11$E$1$ & $1.88$E$1$ & - & -
    \hline
         A100 (FFT) & $6.79$E$0$ & $8.71$E$0$ & $1.11$E$1$ & $1.88$E$1$ & - & -\\
    \hline
    \end{tabular}
    \caption{Schr{\"o}dinger equation: $Q^5$ SEM computation time (unit in seconds) on different hardware with $\beta = 1$}
    \label{tab5: GPU_schrodinger_beta1}
\end{table}