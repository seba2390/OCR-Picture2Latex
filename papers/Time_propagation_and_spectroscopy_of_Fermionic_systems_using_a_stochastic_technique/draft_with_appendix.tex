
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 

%\documentclass[12pt,a4paper]{article}
\documentclass[aps,prl,twocolumn,showpacs,superscriptaddress,floatfix]{revtex4-1}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{braket}
\usepackage{dsfont}
\usepackage{color}
\usepackage{sidecap}
\usepackage[dvipsnames]{xcolor}
%\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}

\setcounter{secnumdepth}{0}

\def \beq {\begin{eqnarray}}
\def \eeq {\end{eqnarray}}
\def \Schrodinger {{Schr\"{o}dinger }}

\begin{document}
\title{Time propagation and spectroscopy of Fermionic systems using a stochastic technique} 
\author{Kai Guther}
\email{k.guther@fkf.mpg.de}
\affiliation{Max Planck Institute for Solid State Research, Heisenbergstra{\ss}e 1, 70569 Stuttgart, Germany}
\author{Werner Dobrautz}
\email{w.dobrautz@fkf.mpg.de}
\affiliation{Max Planck Institute for Solid State Research, Heisenbergstra{\ss}e 1, 70569 Stuttgart, Germany}
\author{Olle Gunnarsson}
\email{o.gunnarsson@fkf.mpg.de}
\affiliation{Max Planck Institute for Solid State Research, Heisenbergstra{\ss}e 1, 70569 Stuttgart, Germany}
\author{Ali Alavi}
\email{a.alavi@fkf.mpg.de}
\affiliation{Max Planck Institute for Solid State Research, Heisenbergstra{\ss}e 1, 70569 Stuttgart, Germany}
\affiliation{University Chemical Laboratory, Lensfield Road, Cambridge, CB2 1EW, U.K.}


\begin{abstract}
We present a stochastic method for solving the time-dependent Schr\"odinger equation,
generalizing a ground state full configuration interaction Quantum Monte Carlo method. 
By performing the time-integration in the complex plane close to the real time axis, the numerical
effort is kept manageable and the analytic continuation to real frequencies is efficient.
This allows us to perform {\it ab initio} calculation of electron spectra for
strongly correlated systems. The method can be used as cluster solver for embedding schemes.
\end{abstract}
\pacs{02.70.Ss, 71.15.Qe, 79.60.-i}
\maketitle
{\it Introduction.}
The time evolution of a closed interacting electronic system, having been prepared in a well-defined but entangled non-stationary 
state, is of considerable interest to a broad range of fields. This includes many types of electronic 
spectroscopy such as photoemission (PE) and inverse photoemission (IPE) \cite{HL1969,T1970,
  HF1984} , core-level \cite{PSBM1976, MS1983} and optical spectroscopies, as well as the field of 
non-equilibrium dynamics \cite{PSAM2011}, including dynamics in driven, time-dependent, external fields.
In solid-state physics, such electronic spectroscopies play a leading role in providing information on the 
electronic structure of the material. In weakly-correlated materials, the
GW-approximation provides a viable theoretical tool for calculating excitation
energies \cite{HL1969, ORR2002}. In strongly-correlated materials, however,  
theoretical studies are often limited to model systems such as the Hubbard \cite{Hubbard} or 
Anderson \cite{Anderson} models. 
Efficient methods have been developed for studying such models.\cite{dca,continuoustime}
However, it is not clear how these methods can be generalized to {\it ab
  initio} calculations. Here we show how this can be achieved using a time evolution method stochastically applied to {\em ab initio} Hamiltonians.  

Time evolution of quantum systems is a notoriously difficult problem owing to the existence of a severe dynamical 
sign problem. For electronic systems there is another difficult sign-problem due to its fermionic nature. Fundamentally, we are required to integrate 
the time-dependent \Schrodinger equation for a many-electron system for long times. 
Methods based on deterministic wavefunction propagation, such as the Crank-Nicolson method \cite{CrankNicolson1947}, or 
Lanczos recursion \cite{Parlett,ParkLight1986}, suffer from severe memory requirements. 
Quantum Monte Carlo methods (especially quantum lattice methods)   
typically work in imaginary frequency space \cite{dca, continuoustime}, followed by analytic continuation to to real frequencies. The analytic continuation 
is numerically highly ill-conditioned, and maximum entropy (MaxEnt) methods \cite{maxent,Jarrell} are usually employed.
Although spectral features close to the Fermi energy can be obtained rather accurately, features 
further away, e.g., satellites, are smeared out (see appendix \cite{supplement}).
Such satellites, however, can contain a wealth of information about the dynamics of the system.
In ab initio models these problems are further exacerbated by the large range of energies spanned by the basis set 
(over numerous Hartrees) and the huge Hilbert spaces owing to the large number
of virtual orbitals.    

In this letter we present an approach to this problem. We present a real-time generalization of an algorithm for  
calculating  fermionic ground states using imaginary-time propagation. This involves the introduction of a second-order 
time propagator, which is implemented in a stochastic manner.
This approach yields accurate time-correlation functions, but 
the computational cost increases exponentially, as the undamped time-evolving wave functions explores the available (exponentially large) 
Hilbert space. To ameliorate this problem, we introduce an adaptive  
variable-phase time-step into the propagator, which leads to a propagation in
the complex plane close to the real time axis. This results in a slow damping, which keeps the computational cost essentially fixed (similar
to a ground state calculation). Nevertheless, this gives phase information about the wave function and yields oscillatory time-correlation functions. 
We have developed a MaxEnt scheme, which performs analytic continuation from an arbitrary path in complex time space
to real frequencies. This provides spectral functions over a broad energy range. 
We apply the method to benchmark systems for which numerically exact results are available, and show that these 
are reproduced to high accuracy at a fraction of the cost. Then we apply the algorithm to ab initio (atomic and molecular)
systems, where comparison is made with experiment. 

In {\it ab initio} calculations for solids, this method could be used as a
cluster solver in embedding schemes like dynamical cluster approximation\cite{dca}.

{\it Real-time evolution.}
\label{sec:rneci}
Given a Hamiltonian $\hat{H}$ and an initial wave function $\Ket{\Psi(0)}$, we wish to solve                          
the time-dependent \Schrodinger equation: 
\begin{equation}\label{eq:1}
\mathrm{i}{\partial \over \partial t}|\Psi(t)\rangle  =  \hat{H}|\Psi(t)\rangle
\end{equation}
$|\Psi(t)\rangle$ gives information about various spectroscopic properties. We can see this by considering the
inverse photoemission spectrum $A_{ii}(\omega)$ 
\begin{equation}\label{eq:2}
A_{ii}(\omega)=\sum_n|\langle\Psi_n^{N+1}|c_{i\sigma}^{\dagger}|\Psi_0^N\rangle|^2\delta(\omega-E_n^{N+1}+E_0^{N}+\mu),
\end{equation}
where $c_{i\sigma}^{\dagger}$ adds an electron with spin $\sigma$ to  orbital $i$ in the ground state $|\Psi_0^N\rangle$ with $N$ electrons. Here $|\Psi_n^{N+1}\rangle$
is the $n$th excited state of the $(N+1)$-electron system.  $E_0^{N}$ and $E_n^{N+1}$ are the corresponding
energies and $\mu$ is the chemical potential. The formal solution of Eq.~(\ref{eq:1}) is $|\Psi(t)\rangle =
{\rm exp}(-i\hat H t)|\Psi(0)\rangle\equiv \hat U(t)|\Psi(0)\rangle$.
The spectrum is then given by
\begin{equation}\label{eq:3}
A_{ii}(\omega)={1\over \pi}{\rm Im} \left[-\mathrm{i}\int_0^{\infty}dt e^{i[\omega+i0^{+}+E_0(N)+\mu]t}\langle \Psi(0)|\Psi(t)\rangle\right],
\end{equation}
where we have used the initial condition
$\Ket{\Psi(0)}=c_{i\sigma}^{\dagger}|\Psi_0^N\rangle$ and $0^{+}$ is a positive
infinitesimal quantity and the calculated object is the Green's function $\Braket{\Psi(0)|\Psi(t)}$.
In a similar way the photoemission spectrum can be calculated. These formulas
are discussed in detail in the appendix \cite{supplement}.

{\it Methods.} To compute $|\Psi(t) \rangle$ accurately for long propagation times,   
we have adapted the Full Configuration Interaction Quantum Monte Carlo (FCIQMC) method \cite{BAT2009,BA2010,CBA2010,BGKA2012}.
This method was originally designed to stochastically project the wave function,
expressed in a full Slater determinant basis $\{\ket{D_i}\}$,  towards the ground state. 
The ground state algorithm uses a stochastic representation of the full CI wave function $\Psi=\sum_i C_i \ket{D_i}$ using 
signed walkers, $C_i$, together with the repeated stochastic application of a short-time propagator $\hat{P}(\Delta \tau) 
= \mathds{1} - \Delta \tau \hat{H}$ to the population of walkers, followed by walker annihilation at the end of each iteration. 
More details are given in the appendix \cite{supplement}.  

\begin{SCfigure*}
\centering
\caption{(a) Time evolution of Re $\langle \Psi(0)|\Psi(t)\rangle $ and
  contour in complex time and (b) 
corresponding photoemission spectra (for $\mu=0$) for 
 the time-evolution using 70000, $1.6\times 10^6$  and $1.7\times10^7$  walkers for the 18-site Hubbard model at
  $U/t=2$, $k=(0,0)$ and half-filling. All calculations start from the same initial state with 350000
walkers, and three different time contours were used leading to 70000,
$1.6\times 10^6$  and $1.7\times10^7$ walkers for
longer times. The utilized time-step is $10^{-3}$. Both the Lanczos and FCIQMC spectra were convoluted with a Lorentzian of
full width at half maximum (FWHM) of $0.02$ to simplify visual comparison of  the FCIQMC spectrum to the discrete
eigenvalues obtained in the Lanczos method. The integrated weights of the
peaks of the FCIQMC spectra are indicated and agree well with the weights of
the discrete Lanczos spectrum, which are given in the first graph of b). The
bracketed numbers indicate the weights of not fully resolved peaks.
(c) Photoemission and inverse photoemission spectra for a 24-site
cluster with lattice vectors (3,3) and (-5,3) with 22 electrons at $U/t=4$ for
$k=(0,0)$ obtained using $\sim 1.5\times 10^8$ and $\sim 3\times 10^7$ walkers respectively. The inverse photoemission part carries very low weight and is also
shown in the inset. For comparison, the same spectrum
computed by means of the Hirsch-Fye\cite{HF} auxiliary-field quantum Monte Carlo (AFQMC) is
displayed.
}
\includegraphics[width=0.9\columnwidth]{wn_compare_100k.pdf}
\label{fig:panelHubWn}
\end{SCfigure*}

Generalizing to the time dependent problem, the wave function $\Psi(t)=\sum_i C_i(t) \ket{D_i}$ is represented by a collection 
of complex walkers, the time evolution of which is realized through the  
successive application of a {\em second-order} propagator: 
\begin{equation}
\hat{U}_2(\Delta t) = \mathds{1} - \mathrm{i}\Delta t\hat{H} -
\frac{1}{2}\left(\Delta t\right)^2 \hat{H}^2  \,.
\end{equation}
where $\Delta t$ is a small time-step. Thus $\Psi(t+\Delta t) = \hat{U}_2(\Delta t) \Psi(t)$. 
This approach preserves the norm of the wave function to 
order ${\cal O}(\Delta t^4)$ per step and ${\cal O}(\Delta t^3)$ in total,
which is found to be sufficient to allow for stable propagation for a long
time, without significant norm-conservation errors. In contrast, propagation 
using  a first-order propagator only leads to norm-conservation of order 
$\Delta t$, which leads to a severe violation of unitarity over relevant 
time-scales. The time evolution is implemented using a second-order Runge-Kutta
algorithm. Numerical examples are provided in the appendix
\cite{supplement}. 

Although this method remains unitary to a good approximation, 
stochastic errors lead to a growth of the norm over time
(see appendix \cite{supplement}), which becomes 
unmanageable for large Hilbert spaces.
We therefore allow the time step $\Delta t$ to acquire a phase $\alpha$ 
\begin{equation}
\Delta t \mapsto \,\mathrm{e}^{-\mathrm{i}\alpha}\Delta t\,,
\end{equation}
thereby introducing a damping in the propagator. The phase is varied
dynamically to keep the number of walkers approximately constant. 
A small number of walkers requires a large $\alpha$, and increasing the 
number of walkers reduces $\alpha$. The pure real-time propagation  
($\alpha=0$) is achieved in the large walker limit. Since $\alpha\ne 0$ 
results in complex-time Green's functions,  we have generalized the 
(imaginary time) MaxEnt method \cite{maxent,Jarrell} to compute $A(\omega)$ 
(see appendix \cite{supplement}). The analytic continuation is 
more accurate for small $\alpha$, and robustness of the calculated spectra can be 
checked by comparing results for different numbers of walkers. To obtain 
the statistics needed for the MaxEnt method, we run several independent calculations.

Compared with the finite temperature Matsubara (imaginary time) formalism, 
this leads to three advantages. i) The MaxEnt method gives a more
detailed spectrum, since the time path is rather close to the real axis,
rather than along the imaginary axis. ii) In each spectral calculation we shift $\mu$ so that the peak closest to $\mu$ is located at $\mu$. Since MaxEnt  is most accurate close to
$\mu$, this improves the accuracy. iii) For a given ${\bf k}$, the weight of the 
PE and IPE spectra may be very different. By performing the PE and IPE
calculations separately, we obtain a comparable relative standard deviation 
in both cases, in contrast to the Matsubara formulation. These aspects are 
discussed in the appendix \cite{supplement} and illustrated in
Fig.~\ref{fig:panelHubWn}c below. 



{\it Application to the Hubbard model.}
As a first example, we consider the fermionic Hubbard model \cite{Hubbard}. It is defined by the Hamiltonian 
$               
  H = -t\sum_{\langle i,j\rangle \sigma}         c^{\dagger}_{i\sigma} c^{}_{j \sigma} + U \sum_i
  n_{i\uparrow} n_{i\downarrow} \,.
$
We consider a two-dimensional square-lattice with periodic boundary conditions.  

We apply the method to an 18-site cluster (18A in Betts' notation\cite{Bett}) at half-filling, 
which is among the largest Hubbard systems whose Green's function can be calculated 
numerically exactly using Lanczos recursion \cite{Parlett,Gunnarsson1986} 
(with a Hilbert space  consisting of $\sim 2.4\times 10^9$ determinants).
To compute the Green's function, we first converge the ground state using 
imaginary-time FCIQMC, and then perform a complex time calculation with
a ${\bf k}=(0,0)$ electron removed from the ground state. A plane waves basis set is  used
here.

\begin{figure}[t!]
\centering
\includegraphics[width=0.9\columnwidth]{carbon_stats_shifted.pdf}
\caption{Atomic multiplet of the carbon atom, obtained from two distinct initial states created by
  adding a 2p electron to the cation ground state. One of the states is
  prepared as a singlet (red), the second state (blue) is a mixture of singlet and
  triplet but with $L_z\neq 0$. The time-evolution is carried out
  for 1600 a.u. of time and the zero of the frequency axis corresponds
to $-37.3706\,\mathrm{H}$ which is the ground state energy of the cation
computed using the projective FCIQMC algorithm. The VTZ basis is used in this example. 
The experimental values are
according to \cite{KW1966}. The frequency resolution is $3.9\,\mathrm{mH}$. The inset shows a portion of the computed Green's function in real time. 
}
\label{fig:panelCarbonStats}
\end{figure}

\begin{figure}[t!]
\centering
\includegraphics[width=\columnwidth]{c2_specs_panel.pdf}
\caption{Photoabsorption spectra for the carbon dimer for a single excitation
  from the $2\sigma_u$ to the $3\sigma_g$ (blue) and from the $1\pi_u$ to the
  $3\sigma_g$ (red) orbital using V$X$Z basis sets. Also 
  shown is spectral decomposition of the FCIQMC ground state (green) as a
  reference . The spectra are not normalized for better display. For the VTZ basis
  set, we also computed $\Sigma_u$-photoemission (PE) and inverse photoemission (IPE) spectra for
  the C$_2^-$ and  C$_2^+$ respectively. All energies and spectra are
  obtained with MaxEnt analytic continuation from 44-48 independent calculations. The experimental values are taken from\cite{M1992}, these are also used to
  attribute singlet and triplet states and the $\pm$-symmetry of the $\Sigma$-states. The zero of the frequency axis is set to
$-75.649\,\mathrm{H}$. The time-step used is $\Delta
t=10^{-3}$ for the VTZ basis set, and
$\Delta t= 10^{-3}$ (green) and $\Delta t = 5\times 10^{-4}$ (red,blue) for the VQZ basis set.
}
\label{fig:panelCarbonDimer}
\end{figure}

Three calculations are shown in Fig.~\ref{fig:panelHubWn} for $U/t=2$, employing 70000, $1.6\times 10^6$ and $17\times10^6$ walkers, with the 
corresponding time contours in the complex plane shown in the inset.  Even
though the resulting spectrum forthe smallest walker number is qualitatively correct, it is
broadened and shifted versus the Lanczos spectrum. Increasing the walker number to $1.6\times 10^6$ gives less severe damping. The 
peaks are still slightly displaced compared to the exact result. For $17\times10^6$ walkers, $\alpha$ is small ($\approx 0.12$) and the spectrum is
 fully resolved with the peaks in their correct positions. The
agreement in the weight distribution also serves as an indicator of the impact
of the walker number. The memory used here is
 270 Mb per processor. This already involves significant performance-memory
 tradeoffs, such that a single replica of this calculation can be run with
 less than 800 Mb total memory, more than a factor of 70 smaller than for 
the exact diagonalization.

Fig.~\ref{fig:panelHubWn}c) shows the PE and IPE spectra for a 24-site cluster with 
22 electrons (24E in Betts' notation\cite{Bett}). This illustrates that 
calculations can be performed for doped systems and for much larger Hilbert spaces 
($\sim 6 \times 10^{12}$) than exact diagonalization. For
the IPE spectrum, the main
quasi-particle peak and the main satellite peak at higher energies are
well-resolved. This spectrum is highly difficult to compute since the initial wave function is highly
multiconfigurational, as it is obtained by eliminating the Hartree-Fock
determinant keeping a very high number of leading determinants with similar
weight. For the PE spectrum, both the main quasi-particle peak as
well as two satellite peaks can be clearly identified. As a comparison, we show 
results using the Hirsch-Fye (HF) method,\cite{HF} based on the Matsubara
formalism for $T=0.2t$.
The HF PE spectrum is consistent with the FCIQMC spectrum, but the peaks are not 
resolved. This is due factors i) and ii) above (performing analytical
continuation from imaginary times and not being able to shift the peak at
-2.5t to 0). The weight
of the IPE spectrum is only $~0.035$ and the relative standard deviation 
about a factor of 25 larger for the part of the Green's function relevant for IPE 
than for the PE relevant part [iii) above].

{\it Application to {\it ab-initio} systems.}
We employ the scheme for {\it ab-initio} systems, namely the carbon atom and the carbon dimer at equilibrium distance. Here, the Hamiltonian is the
molecular Hamiltonian in the Born-Oppenheimer approximation
\begin{equation}
H = \sum_{p,q,\sigma} h^p_{q} c_{p\sigma}^\dagger c^{}_{q\sigma} + \sum_{p,q,r,s,\sigma\tau} V^{rs}_{qp}
c^\dagger_{r\sigma} c^\dagger_{s\tau} c^{}_{p\tau} c^{}_{q\sigma}\,,
\end{equation}
where $h^p_q$ contains the one-body integrals of the \Schrodinger Hamiltonian, and
$V^{rs}_{pq}$ the two-body Coulomb integrals of the
electron-electron interaction. We used the cc-pV$X$Z basis sets with $X$=T,Q (referred to as V$X$Z in the following), 
containing 28 and 54 functions per atom respectively, in the frozen-core approximation. The required Hamiltonian integrals 
were computed over restricted Hartree-Fock orbitals using MOLPRO \cite{MOLPRO-WIREs}. 

For the carbon atom, we show the multiplet structure of the ground state in
Fig.~\ref{fig:panelCarbonStats}, obtained over a trajectory of 1600 a.u. of
time.  

Due to the small system size, we performed the
propagation in pure real-time, with a time-step of $\Delta t = 5\times 10^{-3}$. A small constant
damping with a decay constant of
$3\,\mathrm{mH}$ is applied that has negligible influence on the spectral function, but
reduces the growth of walkers and allows for longer propagation times.
The cation ground state
energy from the ground state computation for the preparation of the initial
state is $E^{N-1}_0=-37.3706\,\mathrm{H}$, which gives an ionization energy of
$420\,\mathrm{mH}$, agreeing reasonably well with the experimental finding of
$413.8\,\mathrm{mH}$ \cite{KW1966}. The inset of Fig.~\ref{fig:panelCarbonStats} shows the
oscillations of the overlap $\Braket{\Psi(0)|\Psi(t)}$ and corresponding
spectra. The resulting excitation energies agree fairly well with experiment.

Next, we consider spectral functions of a prototypical strongly correlated molecule, the carbon dimer  
at equilibrium distance.
To target specific states, we simulate photoabsorption (PA) spectroscopy. 
To do so, the initial $^1\Sigma_g^+$ state is prepared by performing a ground state calculation 
on the neutral carbon dimer using FCIQMC, and then applying the single excitation
operator $c^\dagger_ic^{}_j$ on the resulting walker population. Specifically,
we consider the excitations from $1\pi_u$ to the $3\sigma_g$ and the
excitation from $2\sigma_u$ to $3\sigma_g$. The former couple to $\Pi_u$ states, whilst the latter 
couple to $\Sigma^+_u$ states. Since the excitations generate open-shell determinants, the resulting 
spectra couple to both singlet and triplet states.                                                    

The resulting spectra for the two basis sets                 
are shown in Fig.~\ref{fig:panelCarbonDimer}, we additionally compare to
projector QMC values computed using the excited-state i-FCIQMC method \cite{excited_state_neci} and
using the ground state energies calculated in \cite{BTCA2012} as references. The involved Hilbert spaces contain respectively 
$10^{10}, 10^{12}$ Slater determinants. 
Sharply resolved peaks which correspond to $^3\Pi_u, ^3\Sigma^+_u, 
 ^1\Pi_u, ^1\Sigma^+_u$ could be identified. We also performed photoemission
 and inverse photoemission calculations for the C$_2^-$ and C$_2^+$
 respectively, the resulting energies for the excited states of the neutral
 C$_2$ are listed in Fig.~\ref{fig:panelCarbonDimer}. We find that the inverse
 photoemission spectra feature the lowest stochastic error while the
 photoemission results have a higher error. A rotation of time in the complex plane by an angle of $\alpha$ in the range [0.1,0.2] 
 is applied.
 The dependence of the spectra on the basis set is in line with the known basis-set dependence of 
 relative energies in molecular systems, for example ionisation energies and electron affinities
 from FCIQMC quantum chemical studies  \cite{BA2010,CBA2011,BCTA2011}. The vertical transition energies 
obtained here are larger than the experimentally observed values.  A previous analysis by Holmes et al. \cite{HUS2017} 
of the excited state  potential energy curves shows a significant effect of bond-length variation for the states considered here, 
indicating the likely non-vertical character of the experimental transitions. 

{\it Conclusions.} We have presented an efficient method for solving the time-dependent Schr\"odinger 
equation. We generalize a full configuration interaction Quantum Monte Carlo method to calculations 
for complex times close to the real axis. We then develop a maximum entropy method for analytic
continuation from complex times to real frequency. The method can be used to calculate 
electron spectra. The imaginary component of time strongly limits the numerical effort without 
a strong negative impact on the analytic continuation. We demonstrated that spectra of the Hubbard model 
can be obtained in good agreement with exact Lanczos calculations. We then applied the method to 
{\it ab initio} systems, the C atom and the C$_2$ molecule, and obtained good agreement 
with experiment for excitation energies. The method can be used as cluster solver in embedding 
schemes for solids. It  can also be used to study small systems in strong external 
fields without any assumptions about linear response.
 
\input{manuscript_refs.bbl}
%\bibliography{refs}
\clearpage
\input{appendix.tex}

\end{document}
