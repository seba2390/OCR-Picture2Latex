
\begin{figure*}\footnotesize
\begin{tabular}{l}
% BASIC  EVAL
Multiparty Binary Operation	\\ 
\inferrule{\begin{array}{l l}
	\begin{array}{l}
		\qquad((\pidA, \gamma^{\pidA}, \sigma^{\pidA}, \DMap^{\pidA}, \Acc, \Expr_{1}) \Mid ...\Mid (\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}, \DMap^{\pidZ}, \Acc, \Expr_{1})) 
			\crcr\Deval{\locLL_1}{\codeLL_1} 
			((\pidA, \gamma^{\pidA}, \sigma^{\pidA}_{1}, \DMap^{\pidA}_{1}, \Acc, \n^{\pidA}_{1}) \Mid ...\Mid (\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}_{1}, \DMap^{\pidZ}_{1}, \Acc, \n^{\pidZ}_{1}))
		\crcr
		\qquad((\pidA, \gamma^{\pidA}, \sigma^{\pidA}_{1}, \DMap^{\pidA}_{1}, \Acc, \Expr_{2}) \Mid ...\Mid (\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}_{1}, \DMap^{\pidZ}_{1}, \Acc, \Expr_{2})) 
			\crcr\Deval{\locLL_2}{\codeLL_2} 
			((\pidA, \gamma^{\pidA}, \sigma^{\pidA}_{2}, \DMap^{\pidA}_{2}, \Acc, \n^{\pidA}_{2})\Mid ...\Mid (\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}_{2}, \DMap^{\pidZ}_{2}, \Acc, \n^{\pidZ}_{2}))
		\crcr
		\MPC{b}(\binop, [\n^\pidA_1, ..., \n^\pidZ_1], [\n^\pidA_2, ..., \n^\pidZ_2]) = (\n^{\pidA}_{3}, ..., \n^{\pidZ}_{3})
	\end{array}
	&\begin{array}{l}
		\{(\Expr_{1}, \Expr_{2}) \isPriv \gamma^\pid\}^{\pidZ}_{\pid = \pidA}
		\crcr \binop\in\{\cdot, +, -, \div\}
	\end{array}\end{array}}
	{\begin{array}{l}
	((\pidA, \gamma^{\pidA}, \sigma^{\pidA}, \DMap^{\pidA}, \Acc, {\Expr_{1}\ \binop\ \Expr_{2}})\Mid ...\Mid (\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}, \DMap^{\pidZ},\Acc, {\Expr_{1}\ \binop\ \Expr_{2}})) 
		\Deval{\locLL_1 \addL \locLL_2}{\codeLL_1 \addC \codeLL_2 \addC \codeMP{mpb}} 
		\crcr((\pidA, \gamma^{\pidA}, \sigma^{\pidA}_{2}, \DMap^{\pidA}_{2}, \Acc, \n^{\pidA}_{3}) 
			\qquad\-\ \-\ \-\ \Mid ...\Mid 
		(\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}, \DMap^{\pidZ}_{2}, \Acc, \n^{\pidZ}_{3})) \end{array}}
\\ \\
Write Private Variable Public Value		\\
\inferrule{\begin{array}{l l}
		\begin{array}{l}
		(\Expr) \isPub \gamma \crcr
		\crcr \gamma(\x) = (\loc, {\Priv\ \btype})  
		\end{array}
		& \begin{array}{l}
		((\pid, \gamma, \sigma, {\DMap}, \Acc, \Expr) \Mid  \Config)  
			\Deval{\locLL_1}{\codeLL_1}  ((\pid, \gamma, \sigma{_1}, {\DMap_1}, \Acc, \n) \Mid  \Config_1) 
		\crcr 
		\Update(\sigma{_1}, \loc, \Encrypt(\n), \Acc, \Priv\ \btype) = \sigma{_2}
	\end{array}\end{array}}
	{((\pid, \gamma,\ \sigma,\ {\DMap},\ \Acc,\ {\x = \Expr}) \Mid  \Config)\ 
		\Deval{\locLL_1 \addL (\pid, [(\loc, 0)])}{\codeLL_1 \addC \codeSP{w2}}  
		((\pid, \gamma,\ \sigma{_2},\ {\DMap_1},\ \Acc,\ \Skip) \Mid  \Config_1)}
\\ \\
Private Malloc \\
\inferrule{\begin{array}{l}
		(\Expr) \isPub \gamma \qq
		\Acc = \AccZ \qq
		(\Type = {\Priv\ \btype*}) \lor (\Type = {\Priv\ \btype}) \crcr
		\loc = \phi()	\qq
		((\pid, \gamma,\ \sigma,\ {\DMap},\ \Acc,\ \Expr) \Mid  \Config)\ 
			\Deval{\locLL_1}{\codeLL_1}  ((\pid, \gamma,\ \sigma{_1},\ {\DMap},\ \Acc,\ {n}) \Mid  \Config_1) 
		\crcr \sigma_2 = \sigma{_1} \big[\loc \to \big(\Null,\ \Void*,\ {n\cdot\tau(\Type)},\ \PermL(\PermF, \Void*, \Priv, \n\cdot\tau(\Type))\big)\big]	
	\end{array}}
	{\begin{array}{l}
	((\pid, \gamma,\ \sigma,\ {\DMap},\ \Acc,\ {\PMalloc (\Expr,\ \Type)}) \Mid  \Config) 
		\Deval{\locLL_1 \addL (\pid, [(\loc, 0)])}{\codeLL_1 \addC \codeSP{malp}} 
		((\pid, \gamma,\ \sigma{_2},\ {\DMap},\ \Acc,\ (\loc, 0)) \Mid  \Config_1)
	\end{array} }
\\ \\
% ALLOC / DEALLOC
Multiparty Private Free	\\
\inferrule{ \begin{array}{l}
		\{\gamma^\pid(\x) = (\loc^\pid,\ {\Priv\ \btype*})\}^{\pidZ}_{\pid = \pidA}  
		\qq \Acc = \AccZ  \qq
		(\btype = \Int) \lor (\btype = \Float) \crcr
		\{\sigma^\pid(\loc^\pid) = (\byte^\pid, \Priv\ \btype*, \nl, \PtrPermL(\PermF, \Priv\ \btype*, \Priv, \nl))\}^{\pidZ}_{\pid = \pidA} \crcr
		\{[\nl,\ \locL^\pid\ \tagbL^\pid,\ \indir] = \DecodePtr({\Priv\ \btype*},\ \nl,\ \byte^\pid)\}^{\pidZ}_{\pid = \pidA}
		\qq \{\nl > 1\}^{\pidZ}_{\pid = \pidA}  \crcr
		\If(\indir>1) \{\Type = \Priv\ \btype* \}\ \Else\ \{ \Type = \Priv\ \btype \}
		\crcr
		\{\SelectFreeable(\gamma^\pid, \locL^\pid, \tagbL^\pid, \sigma^\pid) = 1\}^{\pidZ}_{\pid = \pidA} 
		\crcr
		\{\forall (\loc^\pid_m, 0) \in \locL.\quad \sigma^\pid(\loc^\pid_m) = (\byte^\pid_m, \Type, n, \PermL(\PermF, \Type, \Priv, n))\}^{\pidZ}_{\pid = \pidA}
		\crcr
		\PFree([[\byte^\pidA_0, ..., \byte^\pidA_{\nl-1}], ..., [\byte^\pidZ_0, ..., \byte^\pidZ_{\nl-1}]], [\tagbL^\pidA, ...\tagbL^\pidZ]) 
			\crcr\qq= ([[\byte'^\pidA_0, ..., \byte'^\pidA_{\nl-1}], ..., [\byte'^\pidZ_0, ..., \byte'^\pidZ_{\nl-1}]], [\tagbL'^\pidA, ..., \tagbL'^\pidZ])
		\crcr
		\{\UpdateBytesFree(\sigma^\pid, \locL^\pid, [\byte'^\pid_0, ..., \byte'^\pid_{\nl-1}]) = \sigma^\pid_1\}^{\pidZ}_{\pid = \pidA}
		\crcr
		\{\sigma^\pid_2 = \UpdatePtrLocs(\sigma^\pid_1, \locL^\pid[1:\nl-1], \tagbL^\pid[1:\nl-1], \locL^\pid[0], \tagbL^\pid[0])\}^{\pidZ}_{\pid = \pidA}
	\end{array}}
	{\begin{array}{l}((\pidA, \gamma^{\pidA}, \sigma^{\pidA}, \DMap^\pidA, \Acc, {\pfree (\x)})\Mid ...\Mid (\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}, \DMap^\pidZ, \Acc, {\pfree (\x)})) 
		\Deval{(\pidA, \locL^\pidA) \Mid ... \Mid (\pidZ, \locL^\pidZ)}{\codeMP{mpfre}} 
		\crcr((\pidA, \gamma^{\pidA}, \sigma^{\pidA}_2, \DMap^\pidA, \Acc, \Skip)\quad\-\ \ \Mid ...\Mid 
		(\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}_2, \DMap^\pidZ, \Acc, \Skip)) \end{array}}
\\ \\ 
% PTR  EVAL
Private Pointer Declaration \\ 
\inferrule{\begin{array}{l}\begin{array}{l l}
		\getIndirection(*) = \indir\qq
		&((\Type = {\btype *}) \lor (\Type = {\Priv\ \btype*})) \land ((\btype = \Int) \lor (\btype = \Float))
		\end{array}\crcr \begin{array}{l l l} 
		\loc = \phi() \qq
		& \gamma{_1} = \gamma[\x \to (\loc, \Priv\ \btype*)] 	
		\end{array}\crcr\begin{array}{l}
		\byte = \EncodePtr(\Priv\ \btype*, [1, [(\locDefault, 0)], [1], \indir])	\crcr
		\sigma{_1} = \sigma[\loc \to (\byte, \Priv\ \btype*, 1, \PtrPermL(\PermF, \Priv\ \btype*, \Priv, 1))]
	\end{array}\end{array}}					
	{((\pid, \gamma,\ \sigma,\ {\DMap},\ \Acc,\ {\Type\ \x}) \Mid  \Config)\ 
		\Deval{(\pid, [(\loc, 0)])}{\codeSP{dp1}}  ((\pid, \gamma{_1},\ \sigma{_1},\ {\DMap},\ \Acc,\ \Skip) \Mid  \Config)}
% ARR  EVAL
\\ \\
Multiparty Array Read Private Index \\
	\inferrule{\begin{array}{l}
		\qquad((\pidA, \gamma^{\pidA}, \sigma^{\pidA}, \DMap^\pidA, \Acc, \Expr)\ \Mid ...\Mid (\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}, \DMap^\pidZ, \Acc, \Expr)) 
		\qquad\ \
		\{(\Expr) \isPriv \gamma^\pid\}^{\pidZ}_{\pid = \pidA} 
		\crcr		
			\crcr\Deval{\locLL_1}{\codeLL_1} ((\pidA, \gamma^{\pidA}_{}, \sigma^{\pidA}_{1}, \DMap^{\pidA}_{1}, \Acc, \ind^{\pidA})\Mid ...\Mid (\pidZ, \gamma^{\pidZ}_{}, \sigma^{\pidZ}_{1}, \DMap^{\pidZ}_{1}, \Acc, \ind^{\pidZ}))
		\qquad\ \{\gamma^\pid(\x) = (\loc^\pid, \Const\ \llabel\ \btype*)\}^{\pidZ}_{\pid = \pidA}
		\crcr
		\{\sigma^\pid_1(\loc^\pid) = (\byte^\pid,\ {\llabel\ \Const\ \btype*}, 1, 
			\PtrPermL(\PermF, {\llabel\ \Const\ \btype*}, \llabel, 1))\}^{\pidZ}_{\pid = \pidA} 
		\crcr \{\DecodePtr({\llabel\ \Const\ \btype*},\ 1,\ \byte^\pid) 
			= [1,\ [({\loc^\pid_1}, 0)],\ [1],\ 1]\}^{\pidZ}_{\pid = \pidA}  
		\crcr \{\sigma^\pid_1({\loc^\pid_1}) = ({\byte^\pid_1}, {\llabel\ \btype}, {\nl}, 
									\ArrPermL(\PermF, \llabel\ \btype, \llabel, {\nl}))\}^{\pidZ}_{\pid = \pidA}
		\crcr 
			\{\forall \ind \in \{0...\nl-1\} \quad \DecodeArr({\llabel\ \btype}, \ind, {\byte^\pid_1}) =  \n^\pid_\ind\}^{\pidZ}_{\pid = \pidA}
		\crcr
		\MPC{ar}((\ind^\pidA, [\n^{\pidA}_{0}, ..., \n^{\pidA}_{\nl-1}]), ..., (\ind^\pidZ, [\n^{\pidZ}_{0}, ..., \n^{\pidZ}_{\nl-1}])) = (\n^{\pidA}, ..., \n^{\pidZ})
		\qq \{(\n^\pid) \isPriv \gamma^\pid\}^{\pidZ}_{\pid = \pidA} 
		\crcr \locLL_2 = (\pidA, [(\loc^\pidA, 0), (\loc^\pidA_1, 0), ..., (\loc^\pidA_1, \nl-1)])\Mid ... \Mid (\pidZ, [(\loc^\pidZ, 0), (\loc^\pidZ_1, 0), ..., (\loc^\pidZ_1, \nl-1)])
	\end{array}}
	{\begin{array}{l}
		((\pidA, \gamma^{\pidA}, \sigma^{\pidA}, \DMap^\pidA, \Acc, \x[\Expr])\Mid ...\Mid (\pidZ, \gamma^{\pidZ}, \sigma^{\pidZ}, \DMap^\pidZ, \Acc, \x[\Expr])) 
			\Deval{\locLL_1 \addL \locLL_2}{\codeLL_1\addC \codeMP{mpra}} 
			\crcr((\pidA, \gamma^{\pidA}_{}, \sigma^{\pidA}_{1}, \DMap^{\pidA}_{1}, \Acc, \n^{\pidA})\-\ \Mid ...\Mid (\pidZ, \gamma^{\pidZ}_{}, \sigma^{\pidZ}_{1}, \DMap^{\pidZ}_{1}, \Acc, \n^{\pidZ})) \end{array}}
\end{tabular}
\caption{\piccoC\ semantic rules.}
\label{Fig: \piccoC sem rules}
\end{figure*}























