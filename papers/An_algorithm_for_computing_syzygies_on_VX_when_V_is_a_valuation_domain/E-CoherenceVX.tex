%!TEX encoding =  UTF-8 Unicode
%!TEX root =  mainVX.tex


\begingroup

\input{EnglishMacrosVX.tex}
\input{EnglishTheoremsVX.tex}

\def\proofname{\textsl{Proof}}




%: titre
\title{An algorithm for computing syzygies on $\mathbf{V}[X]$\\
when $\mathbf{V}$ is a valuation domain}
\author{
Henri Lombardi,
Claude Quitté \& Ihsen Yengui
}

\date{2014, translation 2023}



\def\thefootnote{\arabic{footnote}}

\startcontents[english]







\newcommand\hum[1]{}
%\newcommand\hum[1]{{\begin{flushleft}\tt\small Hors Texte: #1












\maketitle



\selectlanguage{english}
\begin{abstract}
\smallskip
We give an algorithm for computing the $\V$-saturation of any finitely
generated submodule of $\V[X]^n$ ($n \in \mathbb{N}^*$),
where $\V$ is a valuation domain. This allows us to compute a finite
system of generators for the syzygy module of any finitely generated
submodule of $\V[X]^k$.
\end{abstract}

\sni {\small\textbf{Key words:}  Saturation, Coherence, Syzygies, Valuation domains, Computer algebra, Constructive Algebra.}


\setcounter{tocdepth}{4}
\markboth{Contents}{Contents}
\small

\printcontents[english]{}{1}{}
\normalsize


%: myheadings
\pagestyle{myheadings} \markboth{An algorithm for computing syzygies on $\mathbf{V}[X]$}{H. Lombardi, C. Quitté and I. Yengui}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Introduction} \label{sec Introduction}
\addcontentsline{toc}{section}{Introduction}


It is folklore (see e.g. \cite[Glaz, Th. 7.3.3]{Glaz}) that for a valuation domain~$\V$, the ring $\V[X]$ is coherent, (i.e., the syzygy module of a \itf of $\VX$ is \tf).
The proof given in \cite{Glaz} uses a difficult result in a deep paper  \cite{GR}.
There is nevertheless no known  general  algorithm  for this remarkable result.

For a \noe \coh ring $\R$ (not \ncrt a \ddv),
it is known that the \pol \ri $\R[X_1,\dots,X_n]$ is also \noe \coh.
A \prco is given in \cite{ric74}
and carefully explained in the book \citealt*{MRR}.
In this case it is also possible to use Gröbner bases which were introduced by  Buchberger for \pol rings over fields
(see e.g.\ \cite{Lou,HY,Y}).

Nevertheless,  \noet is not really used in the case of fields since the coherence result
is also easily proved for \zedr rings
(also called Von Neumann regular rings, or absolutely flat rings).



In \citealt*{LSY}, an \algo is given for the computation of a Gröbner basis for a \itf of $\VX$ if the \ddv is of dimension~1
(not \ncrt \noe).
From this  follows an \algo for the \cohc of a \itf of~$\VX$.

Let us recall (see e.g.\ \citealt*{MRR}) that if a ring is \coh then any \mpf $M$ is a \coh module
(i.e., the syzygy module of any \tf sub-module of $M$ is \tf).


In this paper, we give an \algo with no \noe hypothesis, and no hypothesis about the Krull dimension,
for the computation of a finite generating set for the syzygy module of a finite family of vectors in $\VX^k$.
We think that we give in this way the first \prco of the result
(our \algo is \cot proved).

For a sub-$\R$-module $M$ of an  \Rmo $N$, where  $\R$
is an integral domain, the \textsl{saturation of $M$ in $N$} is the \Rmo
\[\Sat_{\R,N}(M)=\sotq{x\in N}{\exists a\in \R^*,\,ax\in M}.
\]
When there are several possible rings, we will precise ``the $\R$-saturation of $M$ in $N$''.
If  $N$
is a free module ($\R^n $, $n\in \NN$ or $\R^{(I)}$, $I$ infinite)
we get by scalar extension a \Kev $\K\otimes N\simeq\K^n $ or $\K^{(I)}$, where $\K$ is the quotient field of $\R$. We get also  $\Sat_{\R,N}(M)=\K.M\cap N$,
where  $\K.M$ is the sub-$\K$-\evc of $\K\otimes N$  generated by $M$.
%: rem1
The module $M$ is said to be  $\R$-saturated when it is equal to its $\R$-saturation.
In \gnl, the $\R$-saturation of a \tf $\RX$-module in $N=\RX^n $ is not itself a \tf $\RX$-module,
but this happens when $\R$ is a \ddv $\V$.

In Section \ref{satVmotf} we give an incremental \algo for calulating a basis of the $\V$-saturation of a
\tf sub-module of a free \Vmo (with a basis possibly infinite).
This \algo is not a scoop, but we give it in a form such that we are able to
use it, in Section \ref{satVXmotf}, for calculating a finite generating set of the $\VX$-module we get by  $\V$-saturating a \tf sub-$\VX$-module of
 $\VX^n$ ($n\in \NN^*$).

This proves that the $\V$-saturation of a \tf $\VX$-module inside
 $\VX^n$ is indeed a \tf $\VX$-module.

Finally, as an immediate corollary we obtain in
Section \ref{VXsysygies} the computation of a finite generating set for the syzygy module over $\VX$ of a finite family of vectors in $\VX^k$.



\medskip
In this paper, all rings are commutative and unitary.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Saturation of a \tf \Vmo in a free \Vmo} \label{satVmotf}

\noindent  {\bf Terminology.}
In this paper we use the \cov terminology found in
 \citealt*{MRR}, which is well suited for Computer Algebra.


\smallskip For an arbitrary ring $\R$ we denote by $\R\eti$ the multiplicative group of units in $\R$.
The ring~$\R$ is \textsl{discrete} when we have an \algo deciding if  $x=0$ or $x\neq 0$ for an arbitrary \elt of~$\R$.
A ring~$\R$ is \textsl{local} when we have explicitly the implication
\[
\forall x,y\in\R,\,x+y\in\R\eti\; \Longrightarrow\;(x \in\R\eti\;\vu \;y\in\R\eti)
\]
It is equivalent to ask
$$
\forall x\in\R,(x \in\R\eti\;\vu \;1+x\in\R\eti)
$$
A nontrivial local ring $\R$ has a unique maximal ideal which is its \textsl{Jacobson radical}
\[\Rad(\R)=\sotq{x\in\R}{1+x\R\subseteq \R\eti}
\]
(for any ring, in \clama, this ideal is the intersection of \idemas).

The quotient ring $\k=\R/\Rad(\R)$ is a field, called \textsl{residual field} of $\R$.
The local ring $\R$ is said to be  \textsl{residually discrete} when we have explicitly the disjunction
\[\forall x\in\R,\,(x\in\R\eti\;\vu\;x\in\Rad(\R)) .
\] 
In this case, the residual field is a \cdi; we have an \algo deciding the disjunction
``$x=0$ or $x$ invertible'' for $x\in\k$.


\medskip Let $I$ be a set, finite or infinite, with a  ``discrete'' linear order, i.e. we have an \algo deciding the disjunction
\[i<j \quad \vu\quad  i=j \quad \vu\quad  i>j\]
for $i,j\in I$. In this case, for any ring $\R$, we have the free module $\R^{(I)}$ with the natural basis $(\e_i)_{i\in I}$. If $\R$ is discrete
 any vector $a=\sum_{i\in J} a_i\e_i$ in  $\R^{(I)}$
($J$ is a finite part of $I$) can be tested zero or nonzero, and if it is nonzero, we can find the minimal
$i$ for which $a_i\neq 0$.

In order to determine a saturated sub-\Rmo of a free module $\R^{(I)}$
we shall use  Lemmas~\ref{lemSat1} and~\ref{lemSat2}.

%:     Lemma{lemSat1}
\begin{lemma} \label{lemSat1}
Let $\R$ be a domain and $N$ a torsion-free \Rmo. If $N=M\oplus P$
then $M$ is saturated in $N$.
\end{lemma}
%--------- fin lemma ----------------------------------------------

 We now assume in this section that $\R$ is an integral residually discrete local ring with \hbox{$\k=\R/\Rad(\R)$}.
%:     Notation{notaPiv}
\begin{definota} \label{notaPiv}
{\rm  ~
%
\begin{enumerate}
%
\item A vector $C=\sum_i c_i \e_i$ of $\R^{(I)}$
 (seen as a column vector)
 is said to be \textsl{primitive} if it is \rdt nonzero, i.e., one \coe
 is a unit. In this case we denote by $\piv(C)$ the smallest index
 $i$ for which $c_i$ is \rdt nonzero. We call it \textsl{the pivot index of $C$}. We denote by $\cq(C)$
 (the \textsl{pivot coefficient of $C$}) the corresponding scalar $c_i$.
%
\item A finite family $(C^k)_{k\in K}$ of primitive vectors is said to be \textsl{in a $\k$-echelon form}
if the pivot indices $\piv(C^k)$ are distinct. A family in a $\k$-echelon form is also simply called \textsl{in an echelon form}.
In this case we denote
\[
  \piv(C)=\sotq{\piv(C^k)}{k\in K}.
\]
A matrix with \coes in $\R$ is said to be in an echelon form if its column vectors are primitive and form a  family in an echelon form.
%
\item When $K$ is linearly ordered, the family $(C^k)_{k\in K}$ is said to be \textsl{in a strict $\k$-echelon form} if it is in an echelon form and if moreover, for $j<k$ in $K$ the \coe of index $\piv(C^j)$ in $C^k$ is zero.
%
\end{enumerate}
  }
\end{definota}
%--------- fin notation ----------------------------------------------

\hum{Pour définir, and pour construire dans le cas d'un \ddv, une forme  $\k$-staggered
stricte, il n'y a pas besoin de supposer que l'anneau local est \dcd.
L'important est que chaque column soit affectée d'un indice pivot avec le \coe correspondant invertible, and que en suivant l'ordre de $K$, les \coes d'une column pour les indices pivots de columns précédentes soient nuls.
}

%:     Lemma{lemSat2}
\begin{lemma} \label{lemSat2}\label{lemEchStrict}
If a finite family $C=(C^k)_{k\in K}$ of vectors of $\R^{(I)}$
is in a $\k$-echelon form, then it is~a basis of the \Rmo $M$ generated by itself  and $M$ has the following free \Rmo
as direct summand
\[
 P= \bigoplus\nolimits_{j\in J}\R\,\e_j\quad \hbox{avec } J=\sotq{j\in I}{j\notin \piv(C)}.
 \]
Moreover the set $\piv(C)$ does not depend on the module $M$. Indeed, an index $j$ belongs to $\piv(C)$ \ssi there exists a primitive vector $U$
in $M$ such that $\piv(U)=j$.
\end{lemma}
%--------- fin lemma ----------------------------------------------
NB. The two free \Rmos in the lemma are always $\R$-saturated, a consequence of  Lemma~\ref{lemSat1}.
%
\begin{proof}
We give the proof when $I$ is finite, the \gnl case is similar.
We linearly order the family  $(\e_j)_{j\in J} \cup (C^{k})_{k\in K}$ using increasing pivot indices.
The  matrix we obtain is \rdt triangular with invertible \coes on the diagonal, so it is \rdt invertible, and it is invertible. This shows that  $M$ and $P$ are direct summands and admit the desired bases. The reader can finish the proof.
\end{proof}
%

\subsection*{The saturation \algo}

%:     context
\begin{context} \label{context1}

\noindent Let $\V$ be a \ddv, i.e.\ a domain in which for all  $a,b$
either $a\mid b$ or~$b\mid a$, i.e.\ more precisely we have an algorithm deciding   (for $a,b$ given in $\V$) the disjunction
\[
\exists x\in\V,\,a=xb\quad \vu\quad \exists x\in\V,\,b=xa
\]
and gives the element  $x$.
We know that $\V$ is a local ring (supposing that $a+b$ is invertible, if~$a$ divides~$b$ then it divides  $a+b$ and thus it is invertible, if $b$ divides $a$ then it divides $a+b$ and is invertible).
We denote by $\K$ its quotient field and $\k$ its residual field.
As $\V$ is supposed to be integral in an explicit way, the field $\K$
is a discrete field.
Furthermore we suppose that $\V$ is  \textsl{residually discrete}, that is we have an algorithm deciding whether an element in  $\V$
is a unit. In particular Lemmas \ref{lemSat1} and \ref{lemSat2} hold with the ring   $\V$.
\end{context}

\medskip  \noindent \textsl{Remark.}
In a residually discrete valuation domain, we have a  test answering the question
 \gui{$a\mid b$?}. Indeed, for $a,b$ nonzero, if $a=bx$, then $a\mid b$ if and only if $x$ is a unit.



\medskip
We consider a sub-\Vmo $M=\V \,a^1+\cdots+\V \, a^m$ of $\V^{(I)}$.
The goal of this section is to give an algorithm for computing a basis for the  $\V$-saturation of $M$ in $\V^{(I)}$, a $\V$-module denoted, in short, by
$\Sat(M)$.
In fact, since only a finite number of indices are at stake, we can suppose that $I$ is finite and that $M$ is generated by the columns of a matrix $F$.
In order to visualise this we can write the  rows of the matrix accordingly to a nonincreasing order for the indices.

A rough way to  calculate $\Sat(M)$ could be to reduce  $F$
to the  Smith form by elementary operations. We thus see that after a suitable basis change, the module $M$
is generated by   vectors $v_if_i$ (where the $f_i$ are part of a basis and the $v_i$ are nonzero). In these conditions, the module $\Sat(M)$
is simply the module generated by these  $f_i$.
This tells us that $\Sat(M)$  is a free $\V$-module having as  direct summand another
free $\V$-module.

\smallskip
 In fact, we prefer to proceed in a softer way and obtain a basis for   $\Sat(M)$ as the columns vectors of a matrix $G$ in a
 $\k$-echelon form that we compute from   $F$ by means of very simple operations.

A first operation, of a reduction of a vector, that we denote by
$\RedPrim$ is to replace a vector~$a$, supposed nonzero, with
$a/u$, where $u$ is a gcd of its coefficients, for example $u$ is the coefficient with minimal index among those dividing all the others, in which case the  pivot coefficient of the reduced  vector is $1$.


The operations that we perform on the  matrix $F$ to put it in a strict
$\k$-echelon form $G$
such that $\Sat(\Im(F))= \Im(G)$  is the following. We proceed by dealing, one by one, with the columns of the initial matrix.
Note that at the beginning, the  empty matrix vide is in a strict $\k$-echelon form.

Suppose that we have treated some initial columns of the matrix and that we have obtained a matrix in a strict $\k$-echelon form with columns
$C^1,\dots,C^r$.

We want to treat a new  column, that we call $C=\sum_i c_i\e_i$.
We proceed as follows.
%
\begin{enumerate}
%
\item  Gaussian elimination:  we perform classical elementary operations on  columns
  $$
  C\leftarrow C- \frac{c_s}{c_{j,s}}\,C^j,
  $$
here $s=\piv(C^j)$
and $c_{j,s}=\cq(C^j)$.
This operation is made  successively with the columns $C^1,\dots,C^r$.
We then obtain a column $C'$.
%
\item If $C'=0$, we don't add it.
The matrix remains in a strict   $\k$-echelon form.
The \Kev generated by the columns $C^1,\dots,C^r,C$ has $(C^1,\dots,C^r)$ as basis.
%
\item If $C'\neq 0$, we replace $C'$ with its reduced primitive form
$C''=\RedPrim(C')$. We then add $C''$ as last  column $C^{r+1}$ of the matrix.
And the new matrix is in a strict  $\k$-echelon form.
The  \Kev generated by the columns $C^1,\dots,C^r,C$ has
$(C^1,\dots,C^r,C'')$ as basis.
%
\end{enumerate}

By construction $\Im(G)$ is contained in  $\Sat(\Im(F))$ and the \Vmo $\Im(G)$ is saturated since $G$ is in a strict $\k$-echelon form.
In fact, in both case 2. and case 3., we see by \recu that we have constructed  a basis for the $\V$-saturation generated by the first  columns (until the column $C$). At the end of this procedure we  have  $\Sat(\Im(G))=\Sat(\Im(F))$.
Thus our \algo achieves its goal.

%:     Theorem{thAlgoSat}
\begin{theorem} \label{thAlgoSat}~

\noindent The saturation algorithm described above computes, from a matrix   $F$ with coefficients in $\V$, a matrix~$G$  in a strict $\k$-echelon form such that  $\Im(G)=\Sat(\Im(F))$.
\\
This algorithm is  \gui{incremental} in the following sense. If we treat a matrix
$[\,F_1\mid F_2\,]$, we obtain~a  matrix $[\,G_1\mid G_2\,]$ where $G_1$
is a matrix obtained by treating the  matrix $F_1$.
\end{theorem}
%--------- fin theorem ----------------------------------------------



\medskip
The following lemma will be useful for the next section.

%:     Lemma{lemPivG}
\begin{lemma} \label{lemPivG}
In the procedure ``Gaussian elimination'' described above, if $C$ is primitive and if the index $\piv(C)$ is distinct from the  $\piv(C^j)$
for $j=1,\dots,r$, then the obtained vector $C'$ is primitive with $\piv(C)=\piv(C')$.
\end{lemma}
%--------- fin lemma ----------------------------------------------
%
\begin{proof}{}
We consider the affectation $C\leftarrow C- \frac{c_s}{c_{j,s}} C^j$ where $s=\piv(C^j)$
and $c_s$ is the coefficient of $C$ on the row $s$.
Set $\ell=\piv(C)$. The \coe $c_\ell$ on the row $\ell$ of $C$ is  replaced with  $c_\ell - \frac{c_s}{c_{j,s}}\cdot c_{j,\ell}$, where $c_{j,\ell}$ is the \coe  on the row $\ell $ of $C^j$.
If $\ell >s$, $c_s$
is \rdt null, if $\ell <s$ then $c_{j,\ell}$ is \rdt null, in both cases the \coe $c_\ell$ remains \rdt
unchanged.
\end{proof}
%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The $\V$-saturation of a finitely generated  $\VX$-module} \label{satVXmotf}

The work we are doing  in this section is a little bit more delicate and seems, strangely, completely new.
It  achieves in Computer Algebra a simple theoretical result which is apparently new, and which  a fortiori lacks a constructive proof.

%:     Theorem{thSat}
\begin{theorem} \label{thSat} We are in the context \ref{context1}.
If $M$ is a finitely generated sub-$\VX$-module of $\VX^n$ then the $\V$-saturation of
$M$ in  $\VX^n$ is a finitely generated  $\VX$-module.
\end{theorem}
%--------- fin theorem ----------------------------------------------

\noindent {\it Remark.} Note that in classical mathematics, every \ddv satisfies the hypotheses of context~\ref{context1} by making use of the law of the excluded middle.
Hence, our constructive proof of \tho~\ref{thSat}  gives also a proof in
classical mathematics with the only hypothesis that $\V$
is a \ddv. The same remark applies for all the results of this  article.

\medskip The \dem of the \tho follows from the correctness
of the \algo computing  a finite generating set for the $\V$-saturation.


Seen as a $\VX$-module,  we have the natural basis of   $\VX^n$
denoted by $(\f_1,\dots,\f_n)$.
We are then interesed in  a natural basis of  $\VX^n$ as \Vmo, which is made up of $\e_{i,k}=X^k\,\f_i$ with the indices set  $I=\intervalle{1..n}\times \NN$.
We equip $I$ with the  lexicographic order for which
 $$
X^h\, \f_i < X^k\,\f_j \,\hbox{ if }\, i<j \;\hbox{ or } \;i=j \hbox{ and } h<k.
%  (1,0)<(1,1)<\cdots(1,k)<\cdots<(2,0)<(2,1)
%  <\cdots<\cdots<(n,0)<(n,1)<\cdots<\cdots
 $$

When the module $\VX^{n}$ is seen as a \Vmo with the natural basis given by the $X^k\,\f_j$’s, we are talking about the \gui{\coos} on this basis.
When it is seen as a  \VXmo  with the natural basis given by the~$\f_j$’s,
we are talking about the \gui{\coes} on this basis.

We start with a  list $S=[s^1,\dots,s^m]$ of vectors in
 $\VX^n$ which forms a  generating set of $M$.
We suppose \spdg that $m\geq 1$ and that the $s^k$ are nonzero.
We denote
$$
E=\V\,s^1+\cdots+\V\,s^m,\quad E_j=X^j\,E,\quad F'_k=\som_{j=0}^kE_j \quad\hbox{ and }\quad G'_k=\Sat_{\V,\VX^n}(F'_k).
$$

We can describe   $F'_k$ and $G'_k$ as the modules which are the images of the two matrices
$F_k$ and $G_k$. The matrix $F_k$ is given, it is treated with the saturation \algo
from the previous section, giving the matrix~$G_k$.

The question then arises as to  certify that from  some $k$,
there is no need to continue, because the \elts added in the basis of $G'_k$
 leave unchanged  the generated $\VX$-module (note that the \Vmo $G'_k=\Im(G_k)$ grows at each step as  $E\neq 0$).

\medskip We need to specify some  notation.
We call \gui{degree of $E$} and we denote it by $d$ the highest degree of one of the coordinates of one of the  $s^{k}$.
In the same way, $d+k$ will be the  degree of
$E_k$ or that of~$F_k$. the matrix $F_k$ can then be seen as a matrix
with $n(1+d+k)$ rows and $m(1+k)$ columns.

If $a$ is a $\V$-primitive  vector of $\VX^n$, and if $\piv(a)=(j,r)\in I$ we denote
$$
\idx(a) := j \hbox{ and } \PrimMon(a) :=r.
$$
The integer $\idx(a)$ is called the  \textsl{index of $a$}, the integer $\PrimMon(a)$
its \textsl{first residual exponent} and the couple  $\piv(a)$ is \textsl{the pivot index of  $a$}. Every couple $(j,r)\in I$ serves as an index for a vector  $X^{r}\,\f_{j}$ of the $\V$-natural basis of $\VX^n$.

We denote by $H_k$ the  matrix made by the columns that we add to  $G_{k-1}$
in order to obtain the   matrix $G_k$.


%:     Fact{factHksuffit}
\begin{fact} \label{factHksuffit}
In order to  calculate the  matrix $G_{k+1}$ from the matrix $G_k$, instead of treating the  \gtrs of $E_{k+1}$ (i.e.\ the list $X^{k+1}S$), we can simply treat the
column vectors of $XH_k$.
\end{fact}
%--------- fin fact ----------------------------------------------
%
\begin{proof}{}
Let us consider the simplified procedure described above. \\
We denote by $\ov{G_k}$ the successive matrices obtained with this  simplified procedure.
\\
We easily check by  \recu on $k$ that the \Kev generated by  the columns
of $\ov{G_k}$ is the  sub-espace $\K F'_k$ of $\KX^{m}$.
Indeed, every column reduced to $0$ is in the  \Kev generated by he previous columns. And every  column which is not reduced to  $0$, generates, modulo the previous columns, once reduced, the same \Kev as the
column that initially formed it.
\\
The columns of $\ov{G_k}$ form a basis of a saturated
sub-\Vmo of $\VX^{m}$, which is then equal to   $\K F'_k\cap\VX^{m}$. This shows that $\ov{G_k}=G_k$
\end{proof}
%

In the sequel, we refer to the simplified procedure, but we denote $H_k$ and $G_k$ instead of $\ov{H_k}$ and $\ov{G_k}$.


To the matrices $H_k$ and $G_k$ we associate several integers:
\begin{itemize}
%
\item The integer $r_k$ is the number of columns of $G_k$, that is the rank of the free \Vmo  $\Im(G_k)$.
%
\item The integer $n_k$, \textsl{number of index pivots  present in $H_k$}, is the cardinality of the set of the  $i\in\intervalle{1..n}$ such that there exists a   column $C$ of $H_k$ with $\idx(C)=i$.
By Lemma~\ref{lemEchStrict}, all the index pivots present
in $H_{k-1}$ are present in $H_k$, thus, by \recu,
 $n_k$ is also the number of index pivots present in $G_k$. Therefore the sequence  $n_k$ is nondecreasing.
%
\item The integer $u_k$, \textsl{number of  \coos which are available for  $G_k$ in view of $n_k$}, is equal to  $n_k(1+d+k)$. If $n_{k+1}=n_k$
we have $u_{k+1}=u_k+n_k$.
%
\item The integer $\delta_k$, \textsl{defect of $H_k$}, is the number of  columns $C$
of $H_k$ such that there exists another column  $C'$ of $H_k$
with $\idx(C)=\idx(C')$
and $\PrimMon(C)<\PrimMon(C')$. Such a column $C$ will be called \textsl{supernumerary}.  We thus have $r_k\leq u_k$ and $r_k=r_{k-1}+n_k+\delta_k$.
%
\item The integer $\Delta_k=u_{k+1}-r_k$ is the \textsl{available place (or position) to occupy at step $k+1$
if $n_k=n_{k+1}$}.\\ If $n_k=n_{k+1}$, we have $\Delta_k=u_{k+1}-r_k=(u_k+n_k)-(r_{k-1}+n_k+\delta_k)=u_k-r_{k-1}-\delta_k=\Delta_{k-1}-\delta_k$.
\end{itemize}

\medskip
In order to visualize the defect $\delta_k$ of $H_k$ and  the way  it evolves
when $k$ increases we will use, after the proof, some
 figures illustrating what may happen. The reading of the proof shall be facilitated by the comments coming with the figures.

The essential point is the following.

From Lemma~\ref{lemPivG}, we are certain  that when we will treat the successive columns of $H_{k+1}=XH_k$ by means of $G_k$,
every pivot  $(j,r)$ of a column of $H_k$ will be shifted a place further,
i.e.\ in position $(j,r+1)$, as a pivot
of a column  of $H_{k+1}$, except  the case where the index
$(j,r+1)$ is already present in   $G_0$.
In this latter case, either the collision reduces to $0$ the column
of~$XH_k$ (which reduces the defect), or a new pivot  is occupied by the reduced   column 
(and made primitive). This new pivot  may have different effects.
Either it occurs on an  index which is already occupied, and does not reduce the defect, or occurs on an unoccupied  index, in which case,
the defect decreases by $1$ and the number $n_k$ increases in between   $n_k$ and $n_{k+1}$.
Thus, the first  claim of the following lemma is established.


%:     Lemma{lemFinDeLalgoCertaine}
\begin{lemma} \label{lemFinDeLalgoCertaine}
The sequence $\delta_k$ is nonincreasing. It certainly reaches  $0$ for $k$ sufficiently large.
\end{lemma}
%--------- fin lemma ----------------------------------------------
%
\begin{proof}{}
We have already pointed out that if $n_{k+1}=n_k$ and $\delta_k>0$ then $\Delta_{k+1}<\Delta_k$. For a sufficiently large $k$ we thus get  $\delta_k=0$
or $n_{k+1}>n_k$. In the second case, we reproduce the previous  situation.
Since the sequence $n_k$ is bounded by $n$, this may happen only finitely many times.
\end{proof}
%

%:     Lemma{lemFinDeLalgoCorrect}
\begin{lemma} \label{lemFinDeLalgoCorrect}
If $\delta_k=0$ then the $\VX$-module generated by $G_k$ is the $\V$-saturation of the
$\VX$-module generated by the $s^j$’s given at the beginning. We can then stop the \algo.
\end{lemma}
%--------- fin lemma ----------------------------------------------
%
\begin{proof}{}
Since the sequence $\delta_k$ is now null, it suffices to prove that
the columns of $H_{k+1}$ are in the $\VX$-module generated by the 
columns of $G_k$. But, by virtue of  Lemma~\ref{lemPivG}, the columns of~$H_{k+1}$
are in the  \Vmo $\Im(G_k)+X\Im(H_k)$.
\end{proof}
%

\medskip \noindent {\bf An example with figures.}

\smallskip
The figure 1 represents the index pivots of $G_0=H_0$.
The six white circles are the \elts of $\piv(H_0)$.

The black (full) circles or squares correspond to 
  \elts of the $\V$-basis where no  index pivot of $G_0$ is present.
The black squares are put for the indices of pivots which are still unoccupied: when a whole row is black we put squares to  emphasize further.
\\
In the present case we have then  $n=5$, $d=4$, $n_0=4$, $r_0=6$, $u_0=20$,
$\Delta_0=14$, $\delta_0=2$.

We represent by double white circles the \elts $\piv(H_0)$ of supernumerary columns,  corresponding to $\delta_0=2$.

%: figure  {fig1}
\begin{figure}[ht]
%
\begin{center}
\includegraphics*[width=9cm]{indexnew-1}

\caption[figure 1]
{\label{fig1} }

\end{center}
\end{figure}


The broken black line joins the
$\piv(C)$’s of nonsupernumerary columns of $H_0$. \\
By Lemma~\ref{lemPivG}, we are certain that when we will treat the successive  columns of $H_1=XH_0$ by means of $G_0$,
every pivot  $(j,r)$ of a column of $H_0$ will be shifted a place further
i.e.\ in position $(j,r+1)$ as a  pivot of a 
column  of $H_1$, except the case where the index
$(j,r+1)$  is already present in  $G_0$.



In the case of figure 1, all the pivots of $H_0$ except the pivot $(4,1)$ are shifted a place further in~$H_1$. In particular the pivot $(5,1)$ will appear in $H_1$,
and we see that this will be for a supernumerary column (thus $\delta_1\geq 1$).
\\
When we will treat the 
column $XC$ such that $\piv(C)=(4,1)$, a \textsl{collision} occurs:
a Gaussian elimination will be performed in order to reduce to  $0$ the \coe in position $(4,2)$ of $XC$
and the  saturation procedure will produce, either a null vector
(in which case  $\delta_1=1$ and $H_1$ will have only $5$ columns, $r_1=11$), or a vector $C''$ such that $\piv(C'')$ occupies an unoccupied position in the  a priori available 
space (vectors of degree $\leq 5$)
with \ncrt  $\piv(C'')\notin \piv(G_0)$.
In this case we will have $r_1=12$.

%\newpage

Let us examine three  possibilities for this $\piv(C'')$, and give the corresponding three figures for~$H_1$.
The pivots of $H_0$ will be grey (empty) circles  and those of $H_1$ black (empty) circles.
The black (full) circles or squares correspond again to empty positions which could  a priori
be filled in the next steps.



In the case of  figure 2 we have  $n_1=4$, $\delta_1=2$, $u_1=24$,
$\Delta_1=12$.
When we will treat  $XH_1$ by means of $G_1$,
 pivots at positions $(1,5)$, $(2,4)$, $(4,4)$ and $(5,4)$
will be produced in  $H_2$. And two collisions, respectively at $(2,1)$ and $(5,2)$, will give  more difficult 
to predict results.
We can have $r_2=16$ with $\delta_2=0$, or  $r_2=17$ (with $\delta_2=1$ if $n_2=4$, or $\delta_2=0$ if $n_2=5$),
or also  $r_2=18$.

%: figure  {fig2}
\begin{figure}[ht]
%
\begin{center}
\includegraphics*[width=9cm]{indexnew-2}

\caption[figure 2]
{\label{fig2} If the collision at $(4,2)$ produces a pivot at position $(2,0)$ }

\end{center}
\end{figure}
	
%: figure  {fig3}
\begin{figure}[ht]
%
\begin{center}
\includegraphics*[width=9cm]{indexnew-3}

\caption[figure 3]
{\label{fig3} If the collision at $(4,2)$ produces a pivot at $(3,3)$}

\end{center}
\end{figure}

%\vspace{-2mm}

In the case of figure 3  we have  $n_1=5$, $\delta_1=1$, $u_1=30$, $\Delta_1=18$.
When we will treat $XH_1$ by means of   $G_1$,
 pivots at positions $(1,5)$, $(2,3)$, $(3,4)$, $(4,4)$ and $(5,4)$
will be produced in $H_2$. And a collision, at $(5,2)$, will give a more difficult to predict result.
This could reduce the vector to $0$, in which case $\delta_2=0$, or produce a new  
vector, in which case $\delta_2=1$, because now all the  indices are occupied by the pivots.  The new vector will have a priori as pivot any of the black squares indicated in the figure, or also a
 pivot with degree $6$.

%: figure  {fig4}
\begin{figure}[ht]
%
\begin{center}
\includegraphics*[width=9cm]{indexnew-4}

\caption[figure 4]
{\label{fig4} If the collision at $(4,2)$ produces a pivot at $(2,5)$}

\end{center}
\end{figure}

%\vspace{-2mm}

In the case of figure 4 we have  $n_1=4$ and $\delta_1=2$.
When we will treat  $XH_1$ by means of $G_1$,
 pivots at positions $(1,5)$, $(2,4)$, $(4,4)$ and $(5,4)$
will be  produced in $H_2$. And a collision, at $(5,2)$, will give a more difficult to predict result.
The supernumerary column with pivot $(2,2)$ will not  a priori produce any collision,
except when the certain  collision, previously mentioned, is treated before and gives a reduced vector with pivot $(2,3)$.

%\hum {Ce cernier morceau de phrase: sauf dans le cas ...
%montre qu'il peut se passer des choses un peu subtiles, qui n'ont pas vraiment été annoncées au départ lorsqu'on a dit que tous les pivots de $XH_0$ non présents dans $G_0$ se retrouvaient à coup s\^ur dans $H_1$.}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Syzygy module for a finitely generated  $\VX$-module} \label{VXsysygies}

%:     Theorem{thsyzygies}
\begin{theorem} \label{thsyzygies}
We keep the context \ref{context1}.
Let $u_1,\dots,u_n\in\VX^k$ and $s^1,\dots,s^m\in\KX^n$ be \gtrs of the syzygy
module of $(u_1,\dots,u_n)$ over $\KX$. We can suppose that
the $s^j$’s are in $\VX^n$. Then the syzygy  module of $(u_1,\dots,u_n)$ over $\VX$ is equal to the $\V$-saturation  in $\VX^n$ of the $\VX$-module generated by
$s^1,\dots,s^m$. As a consequence, by virtue of  \tho \ref{thSat}, this
 module is \tf.

\noindent In particular $\VX$ is a \coh ring.
\end{theorem}
%--------- fin theorem ----------------------------------------------

%
\begin{proof}
A vector $f=(f_1,\dots,f_n)\in\VX^n$ such that $\sum_jf_ju_j=0$
can be written in the form
  $$
  f=a_1s^1+\cdots+a_ms^m
  $$
with some $a_j\in\KX$.
Multiplying this relation by a suitable $\alpha\neq 0$ in $\V$,
we obtain that~$\alpha\, a_i\in\VX$. This shows that $\alpha\,f$ is in the $\VX$-module generated by the $s^j$. And thus $f$ is in the 
$\V$-saturation of the $\VX$-module generated by the $s^j$.
The converse is straightforward.
\end{proof}
%

This leads to  the following \algo that computes a finite  generating set for the syzygy module of $u_1,\dots,u_n\in\VX^k$ over $\VX$:
%
\begin{enumerate}
%
\item Calculate vectors  $v^1,\dots,v^m\in\KX^n$ which form a finite generating set for the syzygy module of $(u_1,\dots,u_n)$ over $\KX$.
%
\item By multiplying each $v^j$ by a suitable $\alpha_j\in\K$, replace it with an $s^j\in\VX^n$ primitive.
%
\item Calculate by means of the \algo given in section \ref{satVXmotf} a finite generating set for 
the $\V$-saturation of the $\VX$-module  $\gen{s^1,\dots,s^m}$ dans $\VX^n$.
%
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Annex:  Magma codes} \label{code}


We present in this annex some  magma codes for computing  the
 $\V$-saturation of a \tf $\VX$-sub-module of $\VX^{n}$
 (if $\V$ is a residually discrete \ddv) following the method described in the present article.

\smallskip Comments are  either on  a single line, preceded by {\tt //},
or on several lines, in between the signs {\tt /*} and {\tt */}.
\newpage
{\small \verbatiminput {EchelonStrict.magma}
}

%:biblio

\markboth{References}{References}

\addcontentsline{toc}{section}{References}
\small
\bibliographystyle{plainnat}
%\bibliography{Coherencebib}
\begin{thebibliography}{8}
\providecommand{\natexlab}[1]{#1}
\providecommand{\url}[1]{\texttt{#1}}
\expandafter\ifx\csname urlstyle\endcsname\relax
  \providecommand{\doi}[1]{doi: #1}\else
  \providecommand{\doi}{doi: \begingroup \urlstyle{rm}\Url}\fi

\bibitem[{Adams} and {Loustaunau}(1994)]{Lou}
William~W. {Adams} and Philippe {Loustaunau}.
\newblock \emph{{An introduction to Gr\"obner bases.}}
\newblock American Mathematical Society, Providence, 1994.
\newblock ISBN 0-8218-3804-0/hbk.

\bibitem[Glaz(1989)]{Glaz}
Sarah Glaz.
\newblock \emph{Commutative coherent rings}, volume 1371 of \emph{Lecture Notes
  in Mathematics}.
\newblock Springer-Verlag, Berlin, 1989.
\newblock ISBN 3-540-51115-6.
\newblock \doi{10.1007/BFb0084570}.
\newblock URL \url{https://doi.org/10.1007/BFb0084570}.

\bibitem[{Hadj Kacem} and {Yengui}(2010)]{HY}
Amina {Hadj Kacem} and Ihsen {Yengui}.
\newblock {Dynamical Gr\"obner bases over Dedekind rings.}
\newblock \emph{{J. Algebra}}, 324\penalty0 (1):\penalty0 12--24, 2010.
\newblock ISSN 0021-8693.
\newblock \doi{10.1016/j.jalgebra.2010.04.014}.

\bibitem[{Lombardi} et~al.(2012){Lombardi}, {Schuster}, and {Yengui}]{LSY}
Henri {Lombardi}, Peter {Schuster}, and Ihsen {Yengui}.
\newblock {The Gr\"obner ring conjecture in one variable.}
\newblock \emph{{Math. Z.}}, 270\penalty0 (3-4):\penalty0 1181--1185, 2012.
\newblock ISSN 0025-5874; 1432-1823/e.
\newblock \doi{10.1007/s00209-011-0847-1}.

\bibitem[Mines et~al.(1988)Mines, Richman, and Ruitenburg]{MRR}
Ray Mines, Fred Richman, and Wim Ruitenburg.
\newblock \emph{A course in constructive algebra}.
\newblock Universitext. Springer-Verlag, New York, 1988.
\newblock ISBN 0-387-96640-4.
\newblock \doi{10.1007/978-1-4419-8640-5}.

\bibitem[Raynaud and Gruson(1971)]{GR}
Michel Raynaud and Laurent Gruson.
\newblock Crit\`eres de platitude et de projectivit\'{e}. {T}echniques de
  ``platification'' d'un module.
\newblock \emph{Invent. Math.}, 13:\penalty0 1--89, 1971.
\newblock ISSN 0020-9910.
\newblock \doi{10.1007/BF01390094}.
%\newblock URL \url{https://doi-org/10.1007/BFb01390094}.

\bibitem[Richman(1974)]{ric74}
Fred Richman.
\newblock Constructive aspects of {N}oetherian rings.
\newblock \emph{Proc. Amer. Math. Soc.}, 44:\penalty0 436--441, 1974.

\bibitem[Yengui(2006)]{Y}
Ihsen Yengui.
\newblock Dynamical {G}r\"obner bases.
\newblock \emph{J. Algebra}, 301\penalty0 (2):\penalty0 447--458, 2006.
\newblock ISSN 0021-8693.
\newblock \doi{10.1016/j.jalgebra.2006.01.051}.

\end{thebibliography}

\normalsize

\endgroup
\stopcontents[english]



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
