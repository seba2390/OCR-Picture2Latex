%% Commands requiring trailing spaces
\newcommand{\ie}{i.e.\@\xspace}
\newcommand{\wrt}{w.r.t.\@\xspace}
\newcommand{\eg}{e.g.\@\xspace}
\newcommand{\cf}{cf.\@\xspace}
\newcommand{\etal}{\emph{et al.}\@\xspace}
\newcommand{\prophesy}{\textrm{PROPhESY}\xspace}
\newcommand{\prism}{\textrm{PRISM}\xspace}
\newcommand{\storm}{\textrm{Storm}\xspace}
\newcommand{\tool}[1]{\textrm{#1}\xspace}


%%new commands
\newcommand{\dtmc}{\mathcal{D}}
\newcommand{\dtmcInit}[1][]{\ensuremath{\dtmc{#1}=(S{#1},\sinit{#1},P{#1})}}
\newcommand{\pDtmcInit}[1][]{\ensuremath{\dtmc{#1}=(S{#1},\sinit{#1},\Paramvar,P{#1})}}
\newcommand{\p}{\ensuremath{\mathbb{P}}}
\newcommand{\pr}{\ensuremath{\mathrm{Pr}}}
\newcommand{\reachPr}[2]{\ensuremath{\pr^{#1}(\finally #2)}}
\newcommand{\reachPrT}[1][]{\ensuremath{\reachPr{#1}{T}}}
\newcommand{\reachProp}[2]{\ensuremath{\p_{\leq #1}(\finally #2)}}
\newcommand{\reachProplT}{\ensuremath{\reachProp{\lambda}{T}}}
\newcommand{\reachPrs}[3]{\ensuremath{\pr^{#1}_{#2}(\finally #3)}}
%\newcommand{\reachPrsT}[2]{\ensuremath{\reachPrs{#1}{#2}{T}}}
\newcommand{\reachPropSymbol}{\varphi}
\newcommand{\ereachPropSymbol}{\psi}

\newcommand{\rew}{\ensuremath{r}}
\newcommand{\er}{\ensuremath{\mathrm{EC}}}
\newcommand{\expRew}[2]{\ensuremath{\er^{#1}(\finally #2)}}
\newcommand{\expRewT}[1][]{\ensuremath{\expRew{#1}{T}}}
\newcommand{\expRewProp}[2]{\ensuremath{\er_{\leq #1}(\finally #2)}}
\newcommand{\expRewPropkT}{\ensuremath{\expRewProp{\kappa}{T}}}
\newcommand{\rewFunction}{\ensuremath{{c}}}
\newcommand{\costFunction}{\ensuremath{\rewFunction}}
\newcommand{\finally}{\lozenge}


\newcommand{\creachPr}[3]{\ensuremath{\pr^{#1}(\finally #2 \mathrel{|} \neg \finally #3)}}
\newcommand{\creachPrT}[1][]{\ensuremath{\creachPr{#1}{T}{U}}}
\newcommand{\creachProp}[3]{\ensuremath{\p_{\leq #1}(\finally #2 \mathrel{|} \neg \finally #3)}}
\newcommand{\creachProplT}{\ensuremath{\creachProp{\lambda}{T}{U}}}
\newcommand{\creachPrs}[4]{\ensuremath{\pr^{#1}_{#2}(\finally #3 \mathrel{|} #4)}}

\newcommand{\cexpRew}[3]{\ensuremath{\er^{#1}(\finally #2 \mathrel{|} \neg \finally #3)}}
\newcommand{\cexpRewT}[1][]{\ensuremath{\cexpRew{#1}{T}{U}}}

\newcommand{\cexpRewProp}[3]{\ensuremath{\rew_{\leq #1}(\finally #2 \mathrel{|} \neg \finally #3)}}
\newcommand{\cexpRewPropkT}{\ensuremath{\cexpRewProp{\kappa}{T}{U}}}



%% Comments
\newcommand{\colorpar}[3]{\colorbox{#1}{\parbox{#2}{#3}}}
\newcommand{\marginremark}[3]{\marginpar{\colorpar{#2}{\linewidth}{\color{#1}#3}}}
\newcommand{\commentside}[2]{\marginpar{\color{#1}\tiny#2}}
\newcommand{\TODO}[1]{\commentside{teal}{\textsc{Todo:} #1}}
\newcommand{\REMARK}[1]{\commentside{teal}{\textsc{Remark:} #1}}
\newcommand{\nj}[1]{\marginremark{yellow}{black}{\scriptsize{[NJ]~#1}}}
%\newcommand{\sj}[1]{\marginremark{black}{orange}{\scriptsize{[SJ]~ #1}}}
\newcommand{\ut}[1]{\marginremark{white}{blue}{\scriptsize{[UT]~ #1}}}
\newcommand{\jpk}[1]{\marginremark{white}{green}{\scriptsize{[JPK]~ #1}}}
\newcommand{\lmc}[1]{\marginremark{white}{black}{\scriptsize{[LMC]~ #1}}}
\newcommand{\hp}[1]{\marginremark{brown}{white}{\scriptsize{[HP]~ #1}}}
\newcommand{\ip}[1]{\marginremark{white}{red}{\scriptsize{[IP]~ #1}}}
%\newcommand{\nj}[1]{}
\newcommand{\sj}[1]{}


%\newcommand{\lmc}[1]{\todo[inline,color=green!50]{\color{blue}MC: #1}\color{black}}
%
%\newcommand{\hp}[1]{\todo[inline,color=blue!40]{\color{black}hp: #1}\color{black}}
%\newcommand{\ip}[1]{\todo[inline,color=orange]{\color{white}IP: #1}\color{black}}




%% Sets
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}

\newcommand{\Reals}{\ensuremath{\mathbb{R}}\xspace}    % Real numbers
\newcommand{\Rationals}{\ensuremath{\mathbb{Q}}\xspace}    %Rational numbers
\newcommand{\Integers}{\ensuremath{\mathbb{Z}}\xspace}    %Integer numbers
\newcommand{\Naturals}{\ensuremath{\mathbb{N}}}
\newcommand{\Ireal}{[0,\, 1]\subseteq\mathbb{R}}  % real interval [0,1]
\newcommand{\Irat}{[0,\, 1]\subseteq\mathbb{Q}}  % rational interval [0,1]
\newcommand{\Ex}{\ensuremath{\mathbb{E}}\xspace}        % Expectations
\newcommand{\BEx}{\ensuremath{\mathbb{E}_{\scriptscriptstyle \leq 1}}\xspace}        % Expectations
\newcommand{\ExCPO}{\ensuremath{\mathcal{E}}\xspace}              % Cpo of unbounded expectations
\newcommand{\BExCPO}{\ensuremath{\mathcal{E}_{\leq 1}}\xspace}        % Cpo of bounded expectations
\newcommand{\EV}{\ensuremath{\mathbf{E}}}

\newcommand{\Distr}{\mathit{Distr}}
\newcommand{\subDistr}{\mathit{subDistr}}
\newcommand{\distDom}{X}
\newcommand{\distDomFin}{\DistDom=\{x_1,\, \ldots,\, x_n}
\newcommand{\distFunc}{\mu}
\newcommand{\distDomElem}{x}
\newcommand{\supp}{\mathit{supp}}
\newcommand{\bigland}{\ensuremath{\bigwedge}}
\newcommand{\biglor}{\ensuremath{\bigvee}}


%% Constants
\newcommand{\true}{\ensuremath{\mathsf{true}}\xspace}
\newcommand{\false}{\ensuremath{\mathsf{false}}\xspace}
\newcommand{\ExpZero}{\CteFun{0}\xspace}
\newcommand{\ExpOne}{\CteFun{1}\xspace}


%% Math operators
\newcommand{\dual}[1]{{#1}^{\mathcal{D}}\xspace}               % Dual 
\newcommand{\eqdef}{\triangleq}                              % Equality used for definitions
\DeclareMathOperator*{\lfp}{\boldsymbol \mu}            % Least fixed point
\DeclareMathOperator*{\gfp}{\boldsymbol \nu}            % Greatest fixed point
\newcommand{\suchthat}{\mydot}
\newcommand{\dom}{\ensuremath{\mathit{dom}}}

\newcommand{\mydot}{\ensuremath                         % Scope delimiter (eg forall, lambda abstractions)
  \raisebox{0pt}{${\scriptscriptstyle \bullet}~$}}
\newcommand{\CteFun}[1]{\ensuremath{\boldsymbol{#1}}\xspace}    % Constant function


%% Linear temporal logic
\newcommand{\Always}{\Box \, }
\newcommand{\Finally}{\lozenge \, }
\newcommand{\Ever}{\Diamond \, }
\newcommand{\Next}{\bigcirc \, }
\newcommand{\Until}{\mbox{$\, {\sf U}\,$}}
\newcommand{\Unless}{\mbox{$\, {\sf W}\,$}}


%% Program Semantics
\renewcommand{\wp}{{\sf wp}\xspace}
\newcommand{\wlp}{{\sf wlp}\xspace}
\newcommand{\wllp}{{\textsf{w}(\textsf{l})\textsf{p}}\xspace}
\newcommand{\cwp}{{\sf cwp}\xspace}
\newcommand{\cwlp}{{\sf cwlp}\xspace}
\newcommand{\cwllp}{{\textsf{cw}(\textsf{l})\textsf{p}}\xspace}
\newcommand{\qcwp}{\ensuremath{\mathsf{\ushortw{cw}p}}\xspace}
\newcommand{\qcwlp}{\ensuremath{\mathsf{\ushortw{cwl}p}}\xspace}
%\newcommand{\qcwllp}{\ensuremath{\mathsf{\ushortw{cw\textnormal{(}l\textnormal{)}}p}}\xspace}
\newcommand{\sem}[1]{\llbracket #1 \rrbracket}
\newcommand{\ToExp}[1]{\ensuremath{ \chi_{#1} }\xspace}    % Lifting of predicates into expectations
%\newcommand{\ToExp}[1]{\ensuremath{\left[ #1 \right]}\xspace}    % Lifting of predicat
 \newcommand{\Pre}{\Psi}
 \newcommand{\Post}{\Phi}
% \newcommand{\Inv}{\Theta}


%% pGCL LANGUAGE
\newcommand{\GCL}{\textnormal{\textsf{GCL}}\xspace}
\newcommand{\pGCL}{\textnormal{\textsf{pGCL}}\xspace}
\newcommand{\fpGCL}{\textnormal{$\textsf{pGCL}^{\boxtimes}$}\xspace}
\newcommand{\cpGCL}{\textnormal{\textsf{cpGCL}}\xspace}
\newcommand{\cfpGCL}{\textnormal{$\textsf{cpGCL}^{\boxtimes}$}\xspace}
%%% Set of variables,states,expressions,etc  
\newcommand{\Cmd}{\ensuremath{\mathcal{P}}\xspace}        % Set of programs
\newcommand{\Var}{\ensuremath{\mathcal{V}}\xspace}        % Set of program variables 
\newcommand{\Paramvar}{\ensuremath{{V}}\xspace}        % Set of program variables 

\newcommand{\RExpr}{\ensuremath{\mathcal{E}}\xspace}      % Set of arithmetical expressions   
\newcommand{\BExpr}{\ensuremath{\mathcal{B}}\xspace}      % Set of boolean expressions
\newcommand{\PDom}{\ensuremath{\mathfrak{P}}\xspace}
\newcommand{\State}{\ensuremath{\mathbb{S}}\xspace}      
\newcommand{\Loop}{\textsf{loop}\xspace} % shorthand to talk about loops
\newcommand{\Body}{\textsf{body}\xspace}
\newcommand{\Init}{\textsf{init}\xspace}
\newcommand{\counter}{\textit{cntr}\xspace}
\newcommand{\intercepted}{\textit{int}\xspace}
\newcommand{\delivered}{\textit{del}\xspace}
\newcommand{\continue}{\textit{rerun}\xspace}
%%% Language constructs
\newcommand{\Skip}{{\tt skip}\xspace}
\newcommand{\Abort}{{\tt abort}\xspace}
\newcommand{\Ass}[2]{#1 \coloneqq #2}
\newcommand{\Observe}{\textnormal{\texttt{observe}}\xspace}
\newcommand{\PChoice}[3]{\{#1\} \, \left[#2 \right] \, \{#3\}}
\newcommand{\NDChoice}[2]{\{#1\} \, \Box \, \{#2\}}
\newcommand{\If}{{\tt if}\xspace}
\newcommand{\Then}{{\tt then}\xspace}
\newcommand{\Else}{{\tt else}\xspace}
\newcommand{\While}{{\tt while}\xspace}
\newcommand{\Do}{{\tt do}\xspace}
\newcommand{\Ite}{{\tt ite}\xspace}
\newcommand{\Cond}[3]{{\Ite} \, (#1) \allowbreak\, \{#2\} \allowbreak\, \{#3\}}
\newcommand{\WhileDo}[2]{{\While} \,\allowbreak (#1) \,\allowbreak \{#2\}}
\newcommand{\WhileDok}[3]{{\While}^{{}< #1} \,\allowbreak (#2) \,\allowbreak \{#3\}}
\newcommand{\Assert}{{\sf assert}\xspace}


%% Miscellania 
\newcommand{\Tr}{\ensuremath{\mathcal{T}}}    % Program transformation
\newcommand{\To}{\rightarrow}                          % Function space constructor
\newcommand{\subst}[2]{[#1 / #2]}
\newcommand{\ourunderscore}{\rule{1.5ex}{0.4pt}}


%% Operational Semantics
\newcommand{\sinit}{s_{\mathit{I}}} % initial state of DTMC/MDP
\newcommand{\mdp}{\mathcal{M}}
%\newcommand{\Mdp}[1][]{\ensuremath{\mdp{#1}=(S{#1},I{#1},\Act,\pmdp{#1})}}
\newcommand{\MdpInit}[1][]{\ensuremath{\mdp{#1}=(S{#1},\sinit{#1},\Act,\probmdp{#1})}}
\newcommand{\pMdpInit}[1][]{\ensuremath{\mdp{#1}=(S{#1},\,\sinit{#1},\Act,\Paramvar,\probmdp{#1})}}
\newcommand{\probmdp}{\mathcal{P}}
\newcommand{\functions}[1][]{\ensuremath{\mathbb{Q}_{#1}}}
%\newcommand{\poly}[1][]{\ensuremath{\mathbb{Q}[#1]}}
\newcommand{\posy}{\ensuremath{f}}
\newcommand{\mono}{\ensuremath{g}}

\newcommand{\monos}[1][]{\ensuremath{\mathit{Mon_{#1}}}}
\newcommand{\posys}[1][]{\ensuremath{\mathit{Pos_{#1}}}}
\newcommand{\signomis}[1][]{\ensuremath{\mathit{Sig_{#1}}}}


%\newcommand{\rew}{\ensuremath{\mathbb{E}}}
%\newcommand{\er}{\ensuremath{\mathrm{ER}}}
%\newcommand{\expRew}[2]{\ensuremath{\er^{#1}(\finally #2)}}
%\newcommand{\expRewT}[1][]{\ensuremath{\expRew{#1}{T}}}
%\newcommand{\expRewProp}[2]{\ensuremath{\rew_{\leq #1}(\finally #2)}}
%\newcommand{\expRewPropkT}{\ensuremath{\expRewProp{\kappa}{T}}}
%\newcommand{\rewFunction}{\ensuremath{\mathrm{rew}}}


%\newcommand{\ratfunceval}{\ensuremath{\ratfunc[{V\setminus\dom(u)}]}}
%\newcommand{\evalratfunc}[2]{\ensuremath{#1[{#2}/u]}}
%\newcommand{\Rloop}{\ensuremath{R_{\mathit{loop}}}}
%\newcommand{\Rout}{\ensuremath{R_{\mathit{out}}}}
\newcommand{\valuations}{\ensuremath{\mathit{Val}}}
\newcommand{\pol}{\ensuremath{g}}
\newcommand{\Par}{\ensuremath{{V}}}
\newcommand{\Expr}{\ensuremath{\mathsf{Expr}}}
\newcommand{\rat}[1]{\ensuremath{\Rationals_{#1}}}
%\newcommand{\poly}[1]{\ensuremath{\Integers_{#1}}}
\newcommand{\rdtmc}{\ensuremath{\mathcal{R}}}
\newcommand{\Rdtmc}[3]{\ensuremath{\rdtmc_{#1}^{#2}\llbracket #3\rrbracket}}
\newcommand{\pdtmc}{\ensuremath{\mathcal{P}}}
\newcommand{\AP}{\ensuremath{\mathit{AP}}}
\renewcommand{\Pr}{\ensuremath{\textnormal{Pr}}}
\newcommand{\Prr}[1]{\ensuremath{\Pr^{#1}}}
\newcommand{\sched}{\ensuremath{\sigma}}
\newcommand{\Sched}{\ensuremath{\mathit{Sched}}}

\newcommand{\rmdp}{\ensuremath{\mathfrak{R}}}
\newcommand{\Rmdp}[3]{\ensuremath{\mdp_{#1}^{#2}\llbracket #3\rrbracket}}
\newcommand{\Act}{\ensuremath{\mathit{Act}}}
\newcommand{\act}{\ensuremath{\alpha}}
\newcommand{\pmdp}{\ensuremath{\mathcal{P}}}

\newcommand{\pathset}{\mathsf{Paths}}
\newcommand{\paths}[2]{\pathset(#1,\allowbreak\,#2)}
\newcommand{\pathsfin}{\pathset_{\mathit{fin}}}
\newcommand{\pathsinf}{\pathset_{\mathit{inf}}}
%\newcommand{\path}{\pi}
\newcommand{\fpath}{\hat\pi}
\newcommand{\last}[1]{\mathit{last}(#1)}
\newcommand{\bad}{\ensuremath{\lightning}}
\newcommand{\undesired}{\ensuremath{\langle \bad \rangle}\xspace}
\newcommand{\sinklabel}{\mathpzc{sink}\xspace}
\newcommand{\sink}{\ensuremath{\langle \sinklabel \rangle}\xspace}
%\newcommand{\expandable}{\ensuremath{\langle \mathpzc{expandable}\rangle}\xspace}

\newcommand{\term}{\ensuremath{{\downarrow}}}
\newcommand{\expandable}{\ensuremath{{\uparrow}}}
\newcommand{\exit}{\ensuremath{{\downarrow}}}
\newcommand{\ExpRew}[2]{\ensuremath{\textnormal{\textsf{ExpRew}}^{#1}\left(#2\right)}}
\newcommand{\LExpRew}[2]{\ensuremath{\textnormal{\textsf{LExpRew}}^{#1}\left(#2\right)}}
\newcommand{\CExpRew}[3]{\ensuremath{\textnormal{\textsf{CExpRew}}^{#1}\left(#2\,|\,#3\right)}}
\newcommand{\CLExpRew}[3]{\ensuremath{\textnormal{\textsf{CLExpRew}}^{#1}\left(#2\,|\,#3\right)}}
%temporary mdp stuff
\newcommand{\Rewset}{\mathfrak C}
\newcommand{\Paths}{\mbox{\sl Paths}}

%% Math-Fonts
\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}
\def\presuper#1#2%
  {\mathop{}%
   \mathopen{\vphantom{#2}}^{#1}%
   \kern-\scriptspace%
   #2}
   
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=.5pt] (char) {#1};}}
