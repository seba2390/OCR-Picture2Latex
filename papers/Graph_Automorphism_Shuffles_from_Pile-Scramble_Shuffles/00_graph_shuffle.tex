\documentclass[tikz]{amsart}
\usepackage[dvips]{graphicx}
\usepackage{amsmath,amssymb,amsthm,bm,fancybox,fullpage,dashbox}
\usepackage{bm}
\usepackage[all]{xy}
\usepackage{cite}
\usepackage{verbatim}
\usepackage{enumerate}
\usepackage{url}
\usepackage{color}
\usepackage{tikz-cd, mathdots}
\newcommand{\pnt}[1]{\stackrel{#1}{\bullet}}
\usepackage{setspace}


\theoremstyle{definition}
\newtheorem*{maintheorem}{Theorem}
\newtheorem*{ques}{Question}
\newtheorem*{theo}{Theorem}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{question}[theorem]{Question}
\newtheorem*{acknowledgement}{{\bf Acknowledgement}}

\theoremstyle{remark}
\newtheorem{assumption}[theorem]{Assumption}

% General symbols
\newcommand{\bin}{\{0,1\}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\ra}{\rightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\xra}[1]{\xrightarrow{#1}}
\newcommand{\lra}{\longrightarrow}
\newcommand{\lla}{\longleftarrow}
\newcommand{\Ra}{\Rightarrow}
\newcommand{\La}{\Leftarrow}
\newcommand{\ol}{\overline}
\newcommand{\wt}{\widetilde}
\def\qed{\hfill $\Box$}
\newcommand{\degree}{\mathrm{deg}}
\newcommand{\outdegree}{\mathrm{out}}
\newcommand{\indegree}{\mathrm{in}}
\newcommand{\aut}{\mathsf{Aut}}
%\newcommand{\stext}[1]{\hat{#1}}
%\newcommand{\stext}[1]{#1^{*}}
%\newcommand{\stext}[1]{\textcolor{red}{#1}}
\newcommand{\stext}[1]{\overline{#1}}
\newcommand{\PSS}{\mathsf{PSS}}
\newcommand{\turn}{\mathsf{turn}}
\newcommand{\shuffle}{\mathsf{shuffle}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\id}{\mathsf{id}}
\newcommand{\PT}{\mathcal{P}}
\newcommand{\act}{\mathsf{act}}

% Cards
\newlength{\ralen}
\setlength{\ralen}{-0.8ex}
\setlength{\unitlength}{1truept}
\newcommand{\blk}{\raisebox{\ralen}{\framebox(11,13){{\small $\clubsuit$}}}}
\newcommand{\red}{\raisebox{\ralen}{\framebox(11,13){{\small $\heartsuit$}}}}
\newcommand{\dia}{\raisebox{\ralen}{\framebox(11,13){{\small $\diamondsuit$}}}}
\newcommand{\spa}{\raisebox{\ralen}{\framebox(11,13){{\small $\spadesuit$}}}}
\newcommand{\back}{\raisebox{\ralen}{\framebox(11,13){{\large \textbf{?}}}}}
\newcommand{\redback}{\raisebox{\ralen}{\framebox(11,13){{\large \textbf{\textcolor{red}{?}}}}}}
\newcommand{\crd}[1]{\raisebox{\ralen}{\framebox(11,13){#1}}}
\newcommand{\heart}{\heartsuit}
\newcommand{\club}{\clubsuit}

% Trump
\newcommand{\ace}{\raisebox{\ralen}{\framebox(11,13){A}}}
\newcommand{\two}{\raisebox{\ralen}{\framebox(11,13){2}}}
\newcommand{\thr}{\raisebox{\ralen}{\framebox(11,13){3}}}
\newcommand{\fou}{\raisebox{\ralen}{\framebox(11,13){4}}}
\newcommand{\fiv}{\raisebox{\ralen}{\framebox(11,13){5}}}
\newcommand{\six}{\raisebox{\ralen}{\framebox(11,13){6}}}
\newcommand{\sev}{\raisebox{\ralen}{\framebox(11,13){7}}}
\newcommand{\eig}{\raisebox{\ralen}{\framebox(11,13){8}}}
\newcommand{\nin}{\raisebox{\ralen}{\framebox(11,13){9}}}
\newcommand{\ten}{\raisebox{\ralen}{\framebox(11,13){10}}}
\newcommand{\jac}{\raisebox{\ralen}{\framebox(11,13){J}}}
\newcommand{\que}{\raisebox{\ralen}{\framebox(11,13){Q}}}
\newcommand{\kin}{\raisebox{\ralen}{\framebox(11,13){K}}}
\newcommand{\joe}{\raisebox{\ralen}{\framebox(11,13){Jo}}}

\newcommand{\yes}{\raisebox{\ralen}{\framebox(11,13){$\mathsf{Y}$}}}
\newcommand{\no}{\raisebox{\ralen}{\framebox(11,13){$\mathsf{N}$}}}

\newcommand{\alice}{\raisebox{\ralen}{\framebox(11,13){$\mathsf{A}$}}}
\newcommand{\bob}{\raisebox{\ralen}{\framebox(11,13){$\mathsf{B}$}}}
\newcommand{\carol}{\raisebox{\ralen}{\framebox(11,13){$\mathsf{C}$}}}

% Encoding
\newcommand{\encA}{{\sf E}}
\newcommand{\encB}{{\sf B}}

% Permutation
\newcommand{\idcard}{{\bf e}}

% Modification
\newcommand{\md}[1]{\textcolor{black}{#1}}
\newcommand{\f}[1]{\mathsf{#1}}
\definecolor{Green}{rgb}{0.1, 0.5, 0.1}

\pagestyle{plain}

\begin{document}
\title{Graph Automorphism Shuffles from Pile-Scramble Shuffles}

\author[K. Miyamoto]{Kengo Miyamoto}
\author[K. Shinagawa]{Kazumasa Shinagawa}
%\address[K. Miyamoto, K. Shinagawa]{Ibaraki University, 4-12-1 Nakanarusawa, Hitachi, Ibaraki, Japan.}
\address[K. Miyamoto]{Ibaraki University, 4-12-1 Nakanarusawa, Hitachi, Ibaraki, 316-8511, Japan.}
\email{kengo.miyamoto.uz63@vc.ibaraki.ac.jp}
\address[K. Shinagawa]{Ibaraki University, 4-12-1 Nakanarusawa, Hitachi, Ibaraki, 316-8511, Japan; National Institute of Advanced Industrial Science and Technology (AIST), Tokyo Waterfront Bio-IT Research Building 2-4-7 Aomi, Koto-ku, Tokyo, 135-0064, Japan.}
%\address[K. Shinagawa]{National Institute of Advanced Industrial Science and Technology (AIST), Tokyo Waterfront Bio-IT Research Building 2-4-7 Aomi, Koto-ku, Tokyo, 135-0064, Japan.}
\email{shinagawakazumasa@gmail.com}
%\author{Kengo Miyamoto and Kazumasa Shinagawa}

\maketitle
\begin{abstract}
A pile-scramble shuffle is one of the most effective shuffles in card-based cryptography. 
Indeed, many card-based protocols are constructed from pile-scramble shuffles. 
This article aims to study the power of pile-scramble shuffles. 
In particular, for any directed graph $G$, we introduce a new protocol called ``a graph shuffle protocol for $G$'', and show that it \md{can be implemented} by using pile-scramble shuffles only. 
Our proposed protocol requires $2(n+m)$ cards, where $n$ and $m$ are the numbers of vertices and arrows of $G$, respectively. 
The number of pile-scramble shuffles is $k+1$, where $1 \leq k \leq n$ is the number of distinct degrees of vertices of $G$. 
As an application, a random cut for $n$ cards, which is also an important shuffle, can be realized by \md{$3n$} cards and \md{two} pile-scramble shuffles. 
\end{abstract}
\keywords{Secure computation; Card-based cryptography; Pile-scramble shuffles; Graph automorphisms}


%%%% Introduction %%%%%
\input{01_Introduction.tex}

%%%% Preliminaries %%%%%
\input{02_Preliminaries.tex}

%%%% Our Protocol %%%%
\input{03_ProposedProtocol.tex}

%%%% Application %%%%
\input{04_Application.tex}

%%%% Application %%%%
\input{05_Conclusion.tex}

%\section{準備}
%
%\subsection{カード}\label{ss:card}
%
%本稿では以下のカードを用いる。
%\[
%\crd{1}~\crd{2}~\crd{3}~\crd{4}~\crd{5}~\crd{6}~\cdots~\crd{$\stext{1}$}~\crd{$\stext{2}$}~\crd{$\stext{3}$}~\crd{$\stext{4}$}~\crd{$\stext{5}$}~\crd{$\stext{6}$}~\cdots
%\]
%$\crd{1}\,\crd{2}\,\crd{3}\,\crd{4}\,\crd{5}\,\crd{6}\,\cdots$を黒カードと呼び、$\crd{$\stext{1}$}\,\crd{$\stext{2}$}\,\crd{$\stext{3}$}\,\crd{$\stext{4}$}\,\crd{$\stext{5}$}\,\crd{$\stext{6}$}\,\cdots$を赤カードと呼ぶ。
%全てのカードの裏面は以下のように区別がつかないものとする。
%\[
%\back~\back~\back~\back~\back~\back~\cdots~\back~\back~\back~\back~\back~\back~\cdots
%\]
%
%\subsection{シャッフル}\label{ss:shuffle}
%
%シャッフルとは、カード列の確率的な並べ替え操作である。
%$n$枚のカード列に対するシャッフルは、置換の集合$\Pi \subset \mathfrak{S}_n$（ここで$\mathfrak{S}_n$は$n$次対称群）及び$\Pi$上の確率分布$\F$によってパラメトライズされ、$(\shuffle, \Pi, \F)$と表記される。
%シャッフル$(\shuffle, \Pi, \F)$は、確率分布$\F$によって選ばれた置換$\pi \in \Pi$に従って、$i$番目のカードを$\pi(i)$番目に移動する並べ替え操作を表す\footnote{シャッフル操作を適用したときに、実際にどの置換が選ばれたかは誰も知らない。}。
%$\Pi$が置換の合成について閉じており、$\F$が一様分布であるようなシャッフルは一様閉シャッフルと呼ばれており、性質の良いシャッフルのクラスとして知られている。
%本稿で登場するシャッフルは、全て一様閉シャッフルである。
%特に本研究では、一様閉シャッフルの中でも最も単純なシャッフルであるパイルスクランブルシャッフルが重要な役割を果たす。
%%この性質（選ばれた置換の秘匿性）を実際に実現するシャッフルの実装方法は非自明であり、安全なシャッフルの実装方法を提案する研究も知られているが、本研究ではここに深く
%%シャッフルの実装方法には、手操作で実装する方法や、補助的な道具を用いる方法など、さまざまな方法がある。
%%あるシャッフル$X$を実装方法$Y$によって実装した際に、どのプレイヤーに対しても選ばれた置換が秘匿されているとき、$Y$は$X$の安全な実装であるといい、$X$は安全に実装可能であると言う。
%%\[
%%\overset{1}{\back}\,\overset{2}{\back}\,\overset{3}{\back}\,\overset{4}{\back}\,\overset{5}{\back}\,\overset{6}{\back}\,\cdots\,\overset{n}{\back}\, \xrightarrow{\pi \la \F} \overset{\pi^{-1}(1)}{\back}\,\overset{\pi^{-1}(2)}{\back}\,\overset{\pi^{-1}(3)}{\back}\,\overset{\pi^{-1}(4)}{\back}\,\overset{\pi^{-1}(5)}{\back}\,\overset{\pi^{-1}(6)}{\back}\,\cdots\,\overset{\pi^{-1}(n)}{\back}
%%\]
%
%%\subsubsection{シャッフルの定義}\label{sss:shuffle}
%%
%%シャッフルとは、カード列の確率的な並べ替え操作である。
%%$n$枚のカード列に対するシャッフルは、置換の集合$\Pi \subset S_n$（ここで$S_n$は$n$次対称群）及び$\Pi$上の確率分布$\F$で定義され、$(\shuffle, \Pi, \F)$と表記する。
%%このシャッフルは、確率分布$\F$に従って置換$\pi \in \Pi$が選ばれ、$\pi$に従ってカード列を並び替えるシャッフルを意味する。
%%シャッフル$(\shuffle, \Pi, \F)$が一様シャッフルであるとは、$\F$が$\Pi$上の一様分布（各$\pi \in \Pi$が確率$1/|\Pi|$で選ばれるような分布）であることである。
%%一様シャッフルのときは確率分布$\F$を省略し、$(\shuffle, \Pi)$と書くことにする。
%%シャッフル$(\shuffle, \Pi, \F)$が閉シャッフルであるとは、$\Pi$が置換の合成について閉じていること（任意の$\pi, \pi' \in \Pi$について$\pi \pi' \in \Pi$ ）である。
%%シャッフルが一様閉シャッフルであるとは、一様シャッフルかつ閉シャッフルであることである。
%%
%%%カードベース暗号プロトコルにおいて特に重要と考えられているシャッフルは、ランダムカット（以降RCと表記）とパイルスクランブルシャッフル（以降PSSと表記）である\footnote{もう一つ特筆すべきシャッフルとして、Mizuki--Soneの提案したランダム二等分割カットがあるが、これはパイルスクランブルシャッフルの特別な場合と考えられるため、本稿ではランダム二等分割カットを特別扱いしないこととする。}。
%%%RCはランダム巡回置換を施すシャッフルであり、PSSはランダム置換を施すシャッフルである。
%
%\subsubsection{パイルスクランブルシャッフル}\label{sss:pss}
%
%%カード列のカード枚数を$\ell = mk$とする。
%（$k$個の$m$枚束に対する）パイルスクランブルシャッフルとは、$\ell = km$枚のカード列を各$m$枚の$k$個の束に分割し、$k$個の束に対して$k!$通りの一様ランダムな並び替えを施すシャッフルである。
%以降、パイルスクランブルシャッフルをPSSと略記する。
%
%以下の例は$3$個の$2$枚束に対するPSSである。
%\[
%\overset{1}{\back}\,\overset{2}{\back}~~\overset{3}{\back}\,\overset{4}{\back}~~\overset{5}{\back}\,\overset{6}{\back}\, \rightarrow
%\begin{cases}
%\overset{1}{\back}\,\overset{2}{\back}~~\overset{3}{\back}\,\overset{4}{\back}~~\overset{5}{\back}\,\overset{6}{\back} & \text{w.p. $1/6$}\\
%\overset{1}{\back}\,\overset{2}{\back}~~\overset{5}{\back}\,\overset{6}{\back}~~\overset{3}{\back}\,\overset{4}{\back} & \text{w.p. $1/6$}\\
%\overset{3}{\back}\,\overset{4}{\back}~~\overset{5}{\back}\,\overset{6}{\back}~~\overset{1}{\back}\,\overset{2}{\back} & \text{w.p. $1/6$}\\
%\overset{3}{\back}\,\overset{4}{\back}~~\overset{1}{\back}\,\overset{2}{\back}~~\overset{5}{\back}\,\overset{6}{\back} & \text{w.p. $1/6$}\\
%\overset{5}{\back}\,\overset{6}{\back}~~\overset{1}{\back}\,\overset{2}{\back}~~\overset{3}{\back}\,\overset{4}{\back} & \text{w.p. $1/6$}\\
%\overset{5}{\back}\,\overset{6}{\back}~~\overset{3}{\back}\,\overset{4}{\back}~~\overset{1}{\back}\,\overset{2}{\back} & \text{w.p. $1/6$}\\
%\end{cases}
%\]
%右側の$3! = 6$通りのカード列は、それぞれ$1/6$の確率で選ばれる。
%
%各束を$|\cdot |$で囲うことにより、PSSを以下のように表記する。
%\[
%\begin{tabular}{|c|c|c|}
%\back\,\back & \back\,\back & \back\,\back \\
%\end{tabular}
%\]
%以下のような二段組の表記も、同様のPSSを表す。
%例えば、以下は$5$個の$2$枚束に対するPSSを表す。
%\[
%\begin{tabular}{|c|c|c|c|c|}
%\back & \back & \back & \back & \back\\
%\back & \back & \back & \back & \back
%\end{tabular}
%\]
%
%%\subsubsection{ランダムカット}\label{sss:rc}
%
%\subsection{プロトコル}\label{ss:protocol}
%
%カードベース暗号プロトコルの標準的な定義はMizuki and Shizuyaで与えられており、本稿もそれに従う。
%本節では、プロトコルの簡単な説明をする。
%また、シャッフルプロトコルという新しい概念を説明する。
%
%\subsubsection{プロトコル}\label{sss:reduction}
%
%プロトコルとは、カード列に対して次に適用する操作を選ぶチューリングマシンである。
%カード列に対して適用する操作は、並べ替え操作、ターン操作（カードをめくったり伏せたりする操作）、シャッフル操作の三種類である。
%次に適用する操作は、visible sequenceとチューリングマシンの内部状態のみによって定まる。
%ここで、visible sequenceについて具体例を一つ与える。
%プロトコルが$\back\,\back\,\back\,\back$に対してシャッフルを行い、$1$枚目をめくり$\red$が出たとすると、カード列は以下のように変遷する。
%\[
%\back\,\back\,\back\,\back ~\xrightarrow{\shuffle}~
%\back\,\back\,\back\,\back ~\xrightarrow{\turn}~
%\red\,\back\,\back\,\back
%\]
%このときのvisible sequenceは、シンボルの列$(\textbf{?}\textbf{?}\textbf{?}\textbf{?}, \textbf{?}\textbf{?}\textbf{?}\textbf{?}, \heart\textbf{?}\textbf{?}\textbf{?})$のことである。
%
%プロトコルの正当性とは、プロトコルが必ず正しい計算を行う性質である。
%プロトコルの安全性とは、visible sequenceの確率分布と入力の確率分布が独立である性質である。
%
%\subsubsection{シャッフルプロトコル}\label{sss:reduction}
%
%シャッフル$(\shuffle, \Pi, \F)$を$n$枚のカード列に対するシャッフルであるとする。
%$n$枚のカード列$\back\,\back\,\cdots\,\back$を入力カード列$S_0$とし、$m \geq 0$枚の補助カード列$S_1$を用いて、連結したカード列$S_0||S_1$から出発し、最終的に$S'_0||S'_1$を出力するプロトコルを考える。
%\[
%\underbrace{\back\,\back\,\cdots\,\back}_{S_0}~\underbrace{\blk\,\red\,\cdots\,\crd{1}~\crd{2}~\crd{3}\,\cdots}_{S_1}
%~\lra~\cdots~\lra~
%\underbrace{\back\,\back\,\cdots\,\back}_{S'_0}~\underbrace{\blk\,\red\,\cdots\,\crd{1}~\crd{2}~\crd{3}\,\cdots}_{S'_1}
%\]
%このプロトコルが以下の条件を全て満たすとき、これはシャッフル$(\shuffle, \Pi, \F)$に対するシャッフルプロトコルであるという。
%\begin{itemize}
%\item 出力前半部$S'_0$に含まれるカードは、入力カード列$S_0$に含まれるいずれかのカードである。
%\item 出力後半部$S'_1$に含まれるカードは、補助カード列$S_1$に含まれるいずれかのカードである。
%\item プロトコル中に入力カード列$S_0$に含まれるどのカードもめくらない。
%\item $S'_0$の確率分布は、入力カード列$S_0$に対してシャッフル$(\shuffle, \Pi, \F)$を適用した確率分布と同一である。
%\end{itemize}
%
%シャッフルプロトコルが安全であるとは、visible sequenceの確率分布と$S'_0$の確率分布が独立であることである。
%
%あるシャッフルの集合$X$が存在して、シャッフル$(\shuffle, \Pi, \F)$に対するシャッフルプロトコルの中で用いるシャッフルは全て$X$に含まれるとき、シャッフル$(\shuffle, \Pi, \F)$は$X$によって実現可能であるという。
%特に本稿では$X$としてPSSの集合を考える。
%
%%シャッフルプロトコルとは、あるシャッフルと同等の効果を持つプロトコルである。
%%例えば、一様閉シャッフル$(\shuffle, \{\id, (1\;2), (3\;4), (1\;2)(3\;4)\})$は、「二つの一様閉シャッフル$(\shuffle, \{\id, (1\;2)\})$と$(\shuffle, \{\id, (3\;4)\})$を連続して適用する」というプロトコルと同等である（ここで、一様シャッフルだから確率分布を省略している）。
%%あるカード列に対して、シャッフル$s$を適用した際の出力のカード列の確率分布と、あるプロトコル$\Pi$を実行した際の出力のカード列の確率分布が等しいとき、$\Pi$は$s$のシャッフルプロトコルであるという。
%%さらに、あるシャッフルの族$S$が存在して、$\Pi$の実行中に用いるシャッフルは全て$S$に含まれるとき、シャッフル$s$は$S$によって実現可能であるという。
%%特に本稿では$S$としてPSSの族を考える。
%
%%$S = \{(\shuffle, \Pi_i, \F_i)\}_{i \in I}$をシャッフルの族とする。
%%あるシャッフル$s = (\shuffle, \Pi, \F)$が$S$から実現可能であるとは、以下の全ての条件を満たすカードベース暗号プロトコルが存在することである。
%%\begin{itemize}
%%\item $S$に含まれるシャッフルのみを用いる。
%%\item プロトコル中に$\Gamma$に含まれるカードを一切オープンしない。
%%\item カード列$\Gamma = \back \, \back \, \back \, \cdots \, \back$をプロトコルに入力したときの出力結果のカード列の確率分布と、$\Gamma$に$s$を適用したときのカード列の確率分布が全く等しい。
%%\end{itemize}
%%
%%本稿では特に$S$としてPSSの族を考える。
%%以降では「シャッフル$X$をPSSから実現可能である」と書いた場合には、「シャッフル$X$はPSSの族から実現可能である」ということを意味する。
%
%\section{グラフシャッフルプロトコル}\label{s:graph}
%
%本章ではグラフシャッフルプロトコルを構成する。
%グラフシャッフルプロトコルとは、\ref{ss:graph}節で定義するグラフシャッフルに対するシャッフルプロトコルである。
%グラフシャッフルプロトコルの構成は\ref{ss:graphprotocol}節で与える。
%なお、グラフシャッフルプロトコルの中で用いられるシャッフルはPSSのみである。
%
%\subsection{グラフシャッフル}\label{ss:graph}
%
%$G = (V, E)$を頂点数$|V| = n$および辺数$|E| = m$の有向グラフとする。
%$G$の自己同型群$\aut(G)$とは、$G$の自己同型写像\footnote{全単射$\phi: V \ra V$が$G$の自己同型写像であるとは、辺$(i, j) \in E$が存在するならば辺$(\phi(i), \phi(j)) \in E$も存在し、その逆も成り立つことである。}からなる群である。
%$\aut(G)$は自然に$\mathfrak{S}_n$の部分群とみなせる。
%
%$G$のグラフシャッフルとは、$n$枚のカード列に対する一様閉シャッフル$(\shuffle, \aut(G))$である。
%
%\textcolor{red}{残タスク：ここに図とともにグラフシャッフルの例を書く。}
%
%なお、次節のプロトコルは有向グラフに対するグラフシャッフルプロトコルであるが、無向グラフを扱いたい場合は、無向辺$(i, j) \in E$を、二つの有向辺$(i, j), (j, i) \in E$と考えればよい。
%
%\subsection{グラフシャッフルプロトコル}\label{ss:graphprotocol}
%
%\begin{figure}[h]
%\begin{center}
% \includegraphics[width=0.2\textwidth,bb=0 0 446 336]{graph_example.pdf}
%  \caption{グラフ$G_0$}
%  \label{fig:graph1}
%\end{center}
%\end{figure}
%
%提案プロトコルでは、$n$枚の入力カード列に加えて、以下の補助カード列を用いる。
%\[
%\crd{$\stext{1}$} \, \crd{$\stext{2}$} \, \crd{$\stext{3}$} ~\cdots ~\crd{$\stext{n}$}~
%\crd{1} ~\cdots ~ \crd{2} ~\cdots ~ \crd{3}  ~ \cdots \cdots~ \crd{$n$}
%\]
%赤カード$\crd{$\stext{i}$}$は各頂点$i$につき一枚である。
%黒カード$\crd{$i$}$は各頂点$i$につき$\degree(i) = \indegree(i) + \outdegree(i)$枚である。
%（$\indegree(i)$と$\outdegree(i)$はそれぞれ頂点$i$の入次数と出次数を表す。）
%$\sum_{i \in V}\indegree(i) = \sum_{i \in V}\outdegree(i) = m$だから、補助カード列のカード枚数は$n + 2m$枚である。
%
%具体例として図\ref{fig:graph1}のグラフ$G_0 = (V_0, E_0)$を考える。
%頂点集合は$V_0 = \{1, 2, 3, 4, 5\}$、辺集合は$E_0 = \{(1,2), (1,3), (2,1), (2,3), (3,4), (3,5)\}$である。
%この場合、補助カード列は以下の$17$枚である。
%\[
%\crd{$\stext{1}$} \, \crd{$\stext{2}$} \, \crd{$\stext{3}$} \, \crd{$\stext{4}$} \, \crd{$\stext{5}$}~
%\crd{1} \, \crd{1} \, \crd{1}  ~ \crd{2} \, \crd{2} \, \crd{2} ~ \crd{3} \, \crd{3} \, \crd{3} \, \crd{3} ~  \crd{4} ~ \crd{5}
%\]
%
%それでは、グラフシャッフルプロトコルの手続きを説明する。
%分かりやすさのため、図\ref{fig:graph1}のグラフ$G_0$を用いて説明を行うが、一般のグラフに対しても自然に拡張できる。
%%\footnote{\ref{sec:dihedral}章で述べるが、このグラフ$G_0$の場合、もっと効率的にグラフシャッフルを実現できる。}
%
%\begin{enumerate}
%
%\item 各頂点$i \in V$について、$\crd{$\stext{i}$} \, \crd{$i$} \,\crd{$i$} \,\cdots \,\crd{$i$}$を、一つの束とみなす。
%まず、$n$個の束を頂点の次数（＝入次数と出次数の和）についてグループ分けをする。
%グラフ$G_0$の場合、頂点$1, 2$が次数$3$のグループ、頂点$3$のみが次数$4$のグループ、頂点$4, 5$が次数$1$のグループである。
%\[
%\underbrace{\crd{$\stext{1}$} \, \crd{1} \, \crd{1} \, \crd{1}~~\crd{$\stext{2}$} \, \crd{2} \, \crd{2} \, \crd{2}}_{\text{次数$3$のグループ}}~~
%\underbrace{\crd{$\stext{3}$} \, \crd{3} \, \crd{3} \, \crd{3} \, \crd{3}}_{\text{次数$4$のグループ}}~~
%\underbrace{\crd{$\stext{4}$} \, \crd{4}~~\crd{$\stext{5}$} \, \crd{5}}_{\text{次数$1$のグループ}}
%\]
%
%\item 各グループについて、グループに属する束たちを、パイルスクランブルシャッフルする。
%グラフ$G_0$の場合、次数$3$のグループに対しては、$\crd{$\stext{1}$} \, \crd{1} \, \crd{1} \, \crd{1}$と$\crd{$\stext{2}$} \, \crd{2} \, \crd{2} \, \crd{2}$のパイルスクランブルシャッフルを行い、$\crd{$\stext{\phi_1}$} \, \crd{$\phi_1$} \, \crd{$\phi_1$} \, \crd{$\phi_1$}$と$\crd{$\stext{\phi_2}$} \, \crd{$\phi_2$} \, \crd{$\phi_2$} \, \crd{$\phi_2$}$を得る（ただし$(\phi_1, \phi_2) \in \{(1,2), (2,1)\}$である）。
%次数$4$のグループは一つの束$\crd{$\stext{3}$} \, \crd{3} \, \crd{3} \, \crd{3} \, \crd{3}$しかないので、何もしなくてよい。
%次数$1$のグループに対しては、$\crd{$\stext{4}$} \, \crd{4}$と$\crd{$\stext{5}$} \, \crd{5}$のパイルスクランブルシャッフルを行い、$\crd{$\stext{\phi_4}$} \, \crd{$\phi_4$}$と$\crd{$\stext{\phi_5}$} \, \crd{$\phi_5$}$を得る（ただし$(\phi_4, \phi_5) \in \{(4,5), (5,4)\}$である）。
%\begin{align*}
%&\bigg|~
%\underset{\stext{1}}{\back} \, \underset{1}{\back} \, \underset{1}{\back} \, \underset{1}{\back}
%~\bigg|~
%\underset{\stext{2}}{\back} \, \underset{2}{\back} \, \underset{2}{\back} \, \underset{2}{\back}
%~\bigg|
%~~\ra~~
%\underset{\stext{\phi_1}}{\back} \, \underset{\phi_1}{\back} \, \underset{\phi_1}{\back} \, \underset{\phi_1}{\back}~~
%\underset{\stext{\phi_2}}{\back} \, \underset{\phi_2}{\back} \, \underset{\phi_2}{\back} \, \underset{\phi_2}{\back}\\
%%
%&\bigg|~
%\underset{\stext{4}}{\back} \, \underset{4}{\back}
%~\bigg|~
%\underset{\stext{5}}{\back} \, \underset{5}{\back}
%~\bigg|
%~~\ra~~
%\underset{\stext{\phi_4}}{\back} \, \underset{\phi_4}{\back}~~
%\underset{\stext{\phi_5}}{\back} \, \underset{\phi_5}{\back}
%\end{align*}
%$\phi_3 = 3$とすれば、現在のカード列は以下のように表せる。
%\[
%\crd{$\stext{\phi_1}$} \, \crd{$\phi_1$} \, \crd{$\phi_1$} \, \crd{$\phi_1$}~~
%\crd{$\stext{\phi_2}$} \, \crd{$\phi_2$} \, \crd{$\phi_2$} \, \crd{$\phi_2$}~~
%\crd{$\stext{\phi_3}$} \, \crd{$\phi_3$} \, \crd{$\phi_3$} \, \crd{$\phi_3$} \, \crd{$\phi_3$}~~
%\crd{$\stext{\phi_4}$} \, \crd{$\phi_4$}~~
%\crd{$\stext{\phi_5}$} \, \crd{$\phi_5$}
%\]
%なお、$\phi_1, \phi_2, \phi_4, \phi_5$の実際の値は誰も知らないことに注意する。
%
%\item 以下のようにカード列を二段に並べる。
%まず、$\crd{$\stext{\phi_1}$} \, \crd{$\stext{\phi_2}$} \, \crd{$\stext{\phi_3}$} \, \crd{$\stext{\phi_4}$} \, \crd{$\stext{\phi_5}$}$を上段に並べ、その下に入力カード列$\back\,\back\,\back\,\back\,\back$を並べる。
%次に、各辺$(i, j) \in E_0$に対して、$\crd{$\phi_i$}$を上段に並べ、その下に$\crd{$\phi_j$}$を並べる。
%\begin{align*}
%&\overset{\stext{\phi_1}}{\back} \, \overset{\stext{\phi_2}}{\back} \, \overset{\stext{\phi_3}}{\back} \, \overset{\stext{\phi_4}}{\back} \, \overset{\stext{\phi_5}}{\back} \,
%\overset{\phi_1}{\back} \, \overset{\phi_1}{\back} \,
%\overset{\phi_2}{\back} \, \overset{\phi_2}{\back} \,
%\overset{\phi_3}{\back} \, \overset{\phi_3}{\back} \\
%&\back \, \back \, \back \, \back \, \back \,
%\overset{\phi_2}{\back} \, \overset{\phi_3}{\back} \,
%\overset{\phi_1}{\back} \, \overset{\phi_3}{\back} \,
%\overset{\phi_4}{\back} \, \overset{\phi_5}{\back}
%\end{align*}
%
%\item 各列を一つの束として、パイルスクランブルシャッフルを適用する。
%\[
%\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|}
%\back & \back & \back & \back & \back & \back & \back & \back & \back & \back & \back \\
%\back & \back & \back & \back & \back & \back & \back & \back & \back & \back & \back
%\end{tabular}
%\]
%
%\item 一段目のカードを全てめくる。すると$\stext{1}\stext{2}\stext{3}\stext{4}\stext{5}112233$を並べ替えた列が得られる。
%例えば、以下のようなカード列が得られる。
%\begin{align*}
%&\crd{$\stext{5}$}\,\crd{1}\,\crd{2}\,\crd{$\stext{4}$}\,\crd{$\stext{2}$}\,\crd{2}\,\crd{$\stext{1}$}\,\crd{3}\,\crd{3}\,\crd{1}\,\crd{$\stext{3}$}
%\,\\
%&\back\,\back\,\back\,\back\,\back\,\back\,\back\,\back\,\back\,\back\,\back\,
%\end{align*}
%
%\item 一段目が$\stext{1}\stext{2}\stext{3}\stext{4}\stext{5}112233$
%の順になるように、列ごとに（上下の$2$枚組をセットで）並べ替える。
%\begin{align*}
%&\crd{$\stext{1}$}\,\crd{$\stext{2}$}\,\crd{$\stext{3}$}\,\crd{$\stext{4}$}\,\crd{$\stext{5}$}\,\crd{1}\,\crd{1}\,\crd{2}\,\crd{2}\,\crd{3}\,\crd{3}\,\\
%&\back\,\back\,\back\,\back\,\back\,\back\,\back\,\back\,\back\,\back\,\back\,
%\end{align*}
%
%\item 一段目の黒カードの下のカードを全てめくる。
%例えば、以下のようなカード列が得られる。
%\begin{align*}
%&\crd{$\stext{1}$}\,\crd{$\stext{2}$}\,\crd{$\stext{3}$}\,\crd{$\stext{4}$}\,\crd{$\stext{5}$}\,\crd{1}\,\crd{1}\,\crd{2}\,\crd{2}\,\crd{3}\,\crd{3}\,\\
%&\back\,\back\,\back\,\back\,\back\,\crd{3}\,\crd{2}\,\crd{3}\,\crd{1}\,\crd{5}\,\crd{4}\,
%\end{align*}
%
%\item ステップ$7$のオープンの結果に従って、グラフ$G_0' = (V_0', E_0')$を以下のように定義する：
%\begin{itemize}
%\item 頂点集合を$V_0'$は$V_0$と同じである。
%\item 上段の黒カード$\crd{$i$}$の下に$\crd{$j$}$が現れているとき、またそのときに限り、$(i, j) \in E'$とする。
%\end{itemize}
%ステップ2の$\phi_i$の定義より、辺$(i, j) \in E_0$が存在することと辺$(\phi_i, \phi_j) \in E'_0$が存在することは同値である。
%したがって、グラフ$G_0'$は$G_0$の頂点の名前を付け替えたグラフであり、$G'_0$と$G_0$は同型である。
%$|\aut(G)|$個の同型写像の中から具体的に一つ$\psi: V'\ra V$を選ぶ（同型写像を求める計算のコストに関しては効率性のパラグラフで述べる）。
%$\psi_i := \psi(i)$とする。
%$\crd{$\stext{\psi_1}$}\, \crd{$\stext{\psi_2}$} \, \crd{$\stext{\psi_3}$} \, \crd{$\stext{\psi_4}$} \, \crd{$\stext{\psi_5}$}$の下にあるカードを順番に集め、その五枚のカード列$\back \, \back \, \back \, \back \, \back$を出力結果とする。
%ステップ7で図示したオープン結果の場合、$G'$は$1 \ra 3 \ra 4 \ra 2 \ra 1$という四角形なので、同型写像として$(\psi_1, \psi_2, \psi_3, \psi_4, \psi_5) = (1, 2, 3, 4, 5)$が取れるので、$\crd{$\stext{1}$}\,\crd{$\stext{2}$}\,\crd{$\stext{3}$}\,\crd{$\stext{4}$}\,\crd{$\stext{5}$}$の下のカードが出力結果である。
%\end{enumerate}
%
%\paragraph{\bf 正当性}
%\textcolor{red}{残タスク：正当性の証明を書く。出力結果のカード列は、入力カード列に対して一様ランダムな元$\pi \in \aut(G)$を適用したものと同じ分布であることを言えればよい。}
%
%\paragraph{\bf 安全性}
%\textcolor{red}{残タスク：安全性の証明を書く。ステップ7においてオープンされているシンボルの分布が、出力結果のカード列の分布と独立であることを言えればよい。}
%
%\paragraph{\bf 効率性}
%\textcolor{red}{残タスク：カード枚数とシャッフル回数について改めて書く。それと、二つのグラフの同型写像を求める計算コストについてBabaiの結果を引用する。}
%
%\section{具体的なグラフクラスに対する効率化}
%
%本章では、いくつかの具体的なグラフクラスに対して、グラフシャッフルプロトコルを効率化する。
%
%\subsection{有向閉路（ランダムカット）}
%
%\begin{figure}[h]
%\begin{center}
% \includegraphics[width=0.2\textwidth,bb=0 0 339 339]{graph_directed_cycle.pdf}
%  \caption{長さ$4$の有向閉路}
%  \label{fig:graph_directed_cycle}
%\end{center}
%\end{figure}
%
%有向閉路のグラフシャッフルは、ランダムカットと等しい。
%例えば、図\ref{fig:graph_directed_cycle}のグラフに対するグラフシャッフルは、$4$枚のランダムカットと等しい。
%長さ$n$の有向閉路に対してグラフシャッフルプロトコル（\ref{s:graph}章）を直接適用すると、$3n$枚の補助カードが必要である。
%本節では、これを効率化し、$2n$枚の補助カードを用いる方法を提案する。
%その手順は以下の通りである。
%
%\begin{enumerate}
%\item 用いる補助カードは$\crd{1}\,\crd{1}~\crd{2}\,\crd{2}~\crd{3}\,\crd{3}~\cdots\crd{$n$}\,\crd{$n$}$の$2n$枚である。
%まず、$n$個の二枚組（同じ数字のペア）に対してパイルスクランブルシャッフルを適用する。
%得られたカード列を$\crd{$\phi_1$}\,\crd{$\phi_1$}~\crd{$\phi_2$}\,\crd{$\phi_2$}~\crd{$\phi_3$}\,\crd{$\phi_3$}~\cdots\crd{$\phi_n$}\,\crd{$\phi_n$}$とする。
%\[
%\bigg|~
%\underset{1}{\back} \, \underset{1}{\back}
%~\bigg|~
%\underset{2}{\back} \, \underset{2}{\back}
%~\bigg|~
%\underset{3}{\back} \, \underset{3}{\back}
%~\bigg|~
%\cdots
%~\bigg|~
%\underset{n}{\back} \, \underset{n}{\back}
%~\bigg|
%~~\ra~~
%\underset{\phi_1}{\back} \, \underset{\phi_1}{\back}
%~
%\underset{\phi_2}{\back} \, \underset{\phi_2}{\back}
%~
%\underset{\phi_3}{\back} \, \underset{\phi_3}{\back}
%~
%\cdots
%~
%\underset{\phi_n}{\back} \, \underset{\phi_n}{\back}
%\]
%
%\item 入力カード列の各カードの間に以下のように二枚ずつ補助カードを挿入する。
%\[
%\overset{1}{\back} \,
%\overset{2}{\back} \,
%\overset{3}{\back} \,
%\cdots \,
%\overset{n}{\back}
%~~\ra~~
%\overset{1}{\back} \,
%\underset{\phi_1}{\back} \, \underset{\phi_2}{\back} ~
%\overset{2}{\back} \,
%\underset{\phi_2}{\back} \, \underset{\phi_3}{\back} ~
%\overset{3}{\back} \,
%\underset{\phi_3}{\back} \, \underset{\phi_4}{\back} ~
%\cdots ~
%\overset{n}{\back} \,
%\underset{\phi_n}{\back} \, \underset{\phi_1}{\back}
%\]
%カードの上に書いてある数字は、入力カード列の何番目かを表している。
%
%\item 三枚組を束として、$n$個の束に対してパイルスクランブルシャッフルを適用する。
%\[
%\begin{tabular}{|c|c|c|c|c|}
%$\back\, \back\, \back$ &
%$\back\, \back\, \back$ &
%$\back\, \back\, \back$ &
%$\cdots$ &
%$\back\, \back\, \back$
%\end{tabular}
%\]
%
%\item 各束の二枚目と三枚目を全てめくる。
%%以下のルールにしたがって束をソートする。
%以下のようなカード列が得られる。
%\[
%\back\,\crd{$a_1$}\,\crd{$b_1$}~~\back\,\crd{$a_2$}\,\crd{$b_2$}~~\back\,\crd{$a_3$}\,\crd{$b_3$}~~\cdots~~\back\,\crd{$a_n$}\,\crd{$b_n$}
%\]
%
%\item 以下のように束を並び替える。
%\[
%\back\,\crd{$c_1$}\,\crd{$d_1$}~~\back\,\crd{$c_2$}\,\crd{$d_2$}~~\back\,\crd{$c_3$}\,\crd{$d_3$}~~\cdots~~\back\,\crd{$c_n$}\,\crd{$d_n$}
%\]
%ただし$c_i, d_i$は、$(c_1, d_1) = (a_1, b_1)$、$d_i = c_{i+1}$（$1 \leq i \leq n-1$）、および$d_n = c_1$という条件を満たすものとする。
%
%\item 全ての補助カードを取り除く。残ったカード列が出力カード列である。
%\end{enumerate}
%
%\subsection{無向閉路（二面体群）}\label{sec:dihedral}
%
%\begin{figure}[h]
%\begin{center}
% \includegraphics[width=0.2\textwidth,bb=0 0 339 339]{graph_undirected_cycle.pdf}
%  \caption{長さ$4$の無向閉路}
%  \label{fig:graph_undirected_cycle}
%\end{center}
%\end{figure}
%
%無向閉路の自己同型群は、二面体群である。
%長さ$n$の無向閉路に対してグラフシャッフルプロトコル（\ref{s:graph}章）を直接適用すると、$3n$枚の補助カードが必要である。
%本節では、これを効率化し、$2n$枚の補助カードを用いる方法を提案する。
%その手順は以下の通りである。
%
%\begin{enumerate}
%\item 用いる補助カードは$\crd{1}\,\crd{1}~\crd{2}\,\crd{2}~\crd{3}\,\crd{3}~\cdots\crd{$n$}\,\crd{$n$}$の$2n$枚である。
%まず、$n$個の二枚組（同じ数字のペア）に対してパイルスクランブルシャッフルを適用する。
%得られたカード列を$\crd{$\phi_1$}\,\crd{$\phi_1$}~\crd{$\phi_2$}\,\crd{$\phi_2$}~\crd{$\phi_3$}\,\crd{$\phi_3$}~\cdots\crd{$\phi_n$}\,\crd{$\phi_n$}$とする。
%\[
%\bigg|~
%\underset{1}{\back} \, \underset{1}{\back}
%~\bigg|~
%\underset{2}{\back} \, \underset{2}{\back}
%~\bigg|~
%\underset{3}{\back} \, \underset{3}{\back}
%~\bigg|~
%\cdots
%~\bigg|~
%\underset{n}{\back} \, \underset{n}{\back}
%~\bigg|
%~~\ra~~
%\underset{\phi_1}{\back} \, \underset{\phi_1}{\back}
%~
%\underset{\phi_2}{\back} \, \underset{\phi_2}{\back}
%~
%\underset{\phi_3}{\back} \, \underset{\phi_3}{\back}
%~
%\cdots
%~
%\underset{\phi_n}{\back} \, \underset{\phi_n}{\back}
%\]
%
%\item 二つのカード列$\crd{$\phi_1$}\,\crd{$\phi_2$}\,\crd{$\phi_3$}\,\cdots\,\crd{$\phi_n$}$と$\crd{$\phi_2$}\,\crd{$\phi_3$}\,\crd{$\phi_4$}\,\cdots\,\crd{$\phi_n$}\,\crd{$\phi_1$}$に対してPSSを適用する。
%得られたカード列を$\crd{$\psi_1$}\,\crd{$\psi_2$}\,\crd{$\psi_3$}\,\cdots\,\crd{$\psi_n$}$と$\crd{$\chi_1$}\,\crd{$\chi_2$}\,\crd{$\chi_3$}\,\cdots\,\crd{$\chi_n$}$とする。
%\[
%\bigg|~
%\underset{\phi_1}{\back} \, \underset{\phi_2}{\back} \, \underset{\phi_3}{\back} \, \cdots \, \underset{\phi_{n-1}}{\back} \, \underset{\phi_n}{\back}
%~\bigg|~
%\underset{\phi_2}{\back} \, \underset{\phi_3}{\back} \, \underset{\phi_4}{\back} \, \cdots \, \underset{\phi_n}{\back} \, \underset{\phi_1}{\back}
%~\bigg|
%~~\ra~~
%\underset{\psi_1}{\back} \, \underset{\psi_2}{\back} \, \underset{\psi_3}{\back} \, \cdots \, \underset{\psi_n}{\back}
%~~
%\underset{\chi_1}{\back} \, \underset{\chi_2}{\back} \, \underset{\chi_3}{\back} \, \cdots \, \underset{\chi_n}{\back}
%\]
%
%\item 入力カード列の各カードの間に以下のように二枚ずつ補助カードを挿入する。
%\[
%\overset{1}{\back} \,
%\overset{2}{\back} \,
%\overset{3}{\back} \,
%\cdots \,
%\overset{n}{\back}
%~~\ra~~
%\overset{1}{\back} \,
%\underset{\psi_1}{\back} \, \underset{\chi_1}{\back} ~
%\overset{2}{\back} \,
%\underset{\psi_2}{\back} \, \underset{\chi_2}{\back} ~
%\overset{3}{\back} \,
%\underset{\psi_3}{\back} \, \underset{\chi_3}{\back} ~
%\cdots ~
%\overset{n}{\back} \,
%\underset{\psi_n}{\back} \, \underset{\chi_n}{\back}
%\]
%カードの上に書いてある数字は、入力カード列の何番目かを表している。
%
%\item 三枚組を束として、$n$個の束に対してパイルスクランブルシャッフルを適用する。
%\[
%\begin{tabular}{|c|c|c|c|c|}
%$\back\, \back\, \back$ &
%$\back\, \back\, \back$ &
%$\back\, \back\, \back$ &
%$\cdots$ &
%$\back\, \back\, \back$
%\end{tabular}
%\]
%
%\item 各束の二枚目と三枚目を全てめくる。
%%以下のルールにしたがって束をソートする。
%以下のようなカード列が得られる。
%\[
%\back\,\crd{$a_1$}\,\crd{$b_1$}~~\back\,\crd{$a_2$}\,\crd{$b_2$}~~\back\,\crd{$a_3$}\,\crd{$b_3$}~~\cdots~~\back\,\crd{$a_n$}\,\crd{$b_n$}
%\]
%
%\item 以下のように束を並び替える。
%\[
%\back\,\crd{$c_1$}\,\crd{$d_1$}~~\back\,\crd{$c_2$}\,\crd{$d_2$}~~\back\,\crd{$c_3$}\,\crd{$d_3$}~~\cdots~~\back\,\crd{$c_n$}\,\crd{$d_n$}
%\]
%ただし$c_i, d_i$は、$(c_1, d_1) = (a_1, b_1)$、$d_i = c_{i+1}$（$1 \leq i \leq n-1$）、および$d_n = c_1$という条件を満たすものとする。
%
%\item 全ての補助カードを取り除く。残ったカード列が出力カード列である。
%\end{enumerate}
%
%%$3$回のPSSと$2n$枚の補助カードを用いて$D_n$シャッフルを実装する。
%%以下の実行例は$n=4$のときである。
%%
%%\begin{enumerate}
%%
%%\item 補助カード$\crd{1} \, \crd{1}$と$\crd{2} \, \crd{2}$と$\crd{3} \, \crd{3}$と$\crd{4} \, \crd{4}$にパイルスクランブルシャッフルを適用し、$\crd{$\alpha$} \, \crd{$\alpha$}$と$\crd{$\beta$} \, \crd{$\beta$}$と$\crd{$\gamma$} \, \crd{$\gamma$}$と$\crd{$\delta$} \, \crd{$\delta$}$を得る。
%%\[
%%\bigg|~
%%\underset{1}{\back} \, \underset{1}{\back}
%%~\bigg|~
%%\underset{2}{\back} \, \underset{2}{\back}
%%~\bigg|~
%%\underset{3}{\back} \, \underset{3}{\back}
%%~\bigg|~
%%\underset{4}{\back} \, \underset{4}{\back}
%%~\bigg|
%%~~\ra~~
%%\underset{\alpha}{\back} \, \underset{\alpha}{\back}~
%%\underset{\beta}{\back} \, \underset{\beta}{\back}~
%%\underset{\gamma}{\back} \, \underset{\gamma}{\back}~
%%\underset{\delta}{\back} \, \underset{\delta}{\back}
%%\]
%%ここでパイルスクランブルシャッフルの性質より、$(\alpha, \beta, \gamma, \delta)$は$(1, 2, 3, 4)$の$4!$通りの並べ替えから一様ランダムに選ばれる。
%%
%%\item $\crd{$\alpha$} \,\crd{$\beta$} \, \crd{$\gamma$} \,\crd{$\delta$}$と$\crd{$\beta$} \, \crd{$\gamma$} \,\crd{$\delta$} \, \crd{$\alpha$}$に対してパイルスクランブルシャッフル（すなわちランダム二等分割カット）を適用し、$\crd{$\chi_0$} \, \crd{$\chi_1$} \,\crd{$\chi_2$} \, \crd{$\chi_3$}$と$\crd{$\psi_0$}\,\crd{$\psi_1$} \,\crd{$\psi_2$} \, \crd{$\psi_3$}$を得る。
%%\[
%%\bigg|~
%%\underset{\alpha}{\back}\, \underset{\beta}{\back} \, \underset{\gamma}{\back} \, \underset{\delta}{\back}
%%~\bigg|~
%%\underset{\beta}{\back} \, \underset{\gamma}{\back} \, \underset{\delta}{\back} \, \underset{\alpha}{\back}
%%~\bigg|
%%~~\ra~~
%%\underset{\chi_0}{\back} \, \underset{\chi_1}{\back}\, \underset{\chi_2}{\back} \, \underset{\chi_3}{\back}~~
%%\underset{\psi_0}{\back} \, \underset{\psi_1}{\back}\, \underset{\psi_2}{\back} \, \underset{\psi_3}{\back}
%%\]
%%ここで、$\chi_i = \psi_{i-1}$が全ての$i$で成り立つか、$\chi_i = \psi_{i+1}$が全ての$i$で成り立つか、どちらかが$1/2$の確率で生じている（添字は$\bmod 4$の計算）。
%%
%%\item 入力カード$\back \, \back \, \back \, \back$に補助カードを以下のように挿入する。
%%\[
%%\underset{\chi_0}{\back} \, \underset{\psi_0}{\back}  \, \back~
%%\underset{\chi_1}{\back} \, \underset{\psi_1}{\back}  \, \back~
%%\underset{\chi_2}{\back} \, \underset{\psi_2}{\back}  \, \back~
%%\underset{\chi_3}{\back} \, \underset{\psi_3}{\back}  \, \back~
%%\]
%%
%%\item 各三枚組を束として、パイルスクランブルシャッフルを適用する。
%%\[
%%\begin{tabular}{|c|c|c|c|}
%%$\back\, \back\, \back$ &
%%$\back\, \back\, \back$ &
%%$\back\, \back\, \back$ &
%%$\back\, \back\, \back$
%%\end{tabular}
%%\]
%%
%%\item 各束の一枚目と二枚目を全てめくる。例えば、以下のようなカード列が得られる。
%%\[
%%\crd{2}\,\crd{4}\,\back~~\crd{1}\,\crd{2}\,\back~~\crd{4}\,\crd{3}\,\back~~\crd{3}\,\crd{1}\,\back
%%\]
%%一枚目のカードを現在の番号、二枚目のカードを次の番号とみなすと、上の例の場合$2 \ra 4 \ra 3 \ra 1 \ra 2$というサイクルが表れている。（ステップ2の置き方から必ずサイクルになることに注意する。）サイクルの順番通りに各束から三枚目のカードを並べるたものが出力カード列である。
%%\end{enumerate}
%
%%\subsection{完全$n$部グラフ}
%%
%%\subsection{正則グラフ}
%%
%%\subsection{木}



\bibliographystyle{abbrv}
\bibliography{card}

\section*{Declarations}

\subsection*{Funding}
K. Miyamoto was partly supported by JSPS KAKENHI 20K14302. 
K. Shinagawa was partly supported by JSPS KAKENHI 21K17702. 
%\subsection*{Conflicts of interest/Competing interests}
%The second author has some co-authored papers with Takaaki Mizuki, Goichiro Hanaoka, Mitsugu Iwamoto, and Pascal Lafourcade within three years. The second author is a member of a research group organized by Goichiro Hanaoka. The second author had been visited Mitsugu Iwamoto's research group in UEC as a postdoc researcher last year. 
%\subsection*{Availability of data and material}
%Not applicable
%\subsection*{Code availability}
%Not applicable
%\subsection*{Authors' contributions}

\end{document}
