\begin{algorithm}[t]
{
\small
\caption{Bootstrap Confidence Interval}
\label{alg:ci}
\hspace*{\algorithmicindent} \textbf{Input:} $X, Z \in \mathbb{R}^{N\times M}$, $k \in \mathbb{N}, \alpha \in [0, 1]$ \\
\hspace*{\algorithmicindent} \textbf{Output:} $(1-\alpha)\times 100\%$-confidence interval
\begin{algorithmic}[1]
\State samples $\gets$ an empty list
\For{$k$ iterations}
    \State $S$ $\gets$ samp. $\{1,\dots, N\}$ w/ repl. $N$ times
    \State $D$ $\gets$ samp. $\{1,\dots, M\}$ w/ repl. $M$ times
    \State $X_s, Z_s \gets$ empty $N \times M$ matrices
    \For{$(i, j) \in \{1, \dots, N\} \times \{1, \dots M\}$}
        \State $X_s[i, j] \gets X[S[i], D[j]]$
        \State $Z_s[i, j] \gets Z[S[i], D[j]]$
    \EndFor
    \State Append $r(X_s, Z_s)$ to samples
\EndFor
\State $\ell, u \gets (\alpha/2)\times 100$ and $(1-\alpha/2)\times 100$ percentiles of samples
\State \Return $\ell, u$
\end{algorithmic}
}
\end{algorithm}
