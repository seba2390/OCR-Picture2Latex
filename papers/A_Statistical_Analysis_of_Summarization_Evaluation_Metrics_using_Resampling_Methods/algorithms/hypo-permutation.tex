\begin{algorithm}[t]
{\small
\caption{Permutation Hypothesis Test}
\label{alg:permutation}
\hspace*{\algorithmicindent} \textbf{Input:} $X, Y, Z \in \mathbb{R}^{N\times M}$, $k \in \mathbb{N}, \alpha \in [0, 1]$
\hspace*{\algorithmicindent} \textbf{Output:} $p$-value
\begin{algorithmic}[1]
\State Standardize $X$ and $Y$
\State c $\gets$ 0
\State $\delta \gets r(X, Z) - r(Y, Z)$
\For{$k$ iterations}
    \State $X_s, Y_s \gets$ empty $N \times M$ matrices
    \For{$(i, j) \in \{1, \dots, N\} \times \{1, \dots, M\}$}
        \If{random Boolean is true} \Comment{swap}
            \State $X_s[i, j] \gets Y[i, j]$
            \State $Y_s[i, j] \gets X[i, j]$
        \Else \Comment{do not swap}
            \State $X_s[i, j] \gets X[i, j]$
            \State $Y_s[i, j] \gets Y[i, j]$
        \EndIf
    \EndFor
    \State $\delta_s \gets r(X_s, Z) - r(Y_s, Z)$
    \If{$\delta_s > \delta$}
        \State $c \gets c + 1$
    \EndIf
\EndFor
\State \Return $c / k$
\end{algorithmic}
}
\end{algorithm}
