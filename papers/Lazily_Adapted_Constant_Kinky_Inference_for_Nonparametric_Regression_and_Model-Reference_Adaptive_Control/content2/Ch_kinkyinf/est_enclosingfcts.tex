\section{Conservative Lipschitz function estimates via enclosing functions }

Let $a,b \in \Real, a \leq b, I := [a,b] \subset \Real$. Given a
Lipschitz continuous \emph{target function} $f: I \to \Real $ and
let $L \geq 0$ be its Lipschitz constant. That is, $\forall S
\subset I \,\exists L_S \leq L \,\forall x,x' \in S: \abs{f(x) -
f(x')} \leq L_S \, \abs{x-x'}$. Let $a = t_1 < t_2 <...<t_N = b $
and define $G_N = \{ t_1,...,t_N\}$ to be the \emph{sample grid} of
size $N \geq 2$ consisting of the input at which we choose to evaluate the
target $f$.

\subsection{On dense grids}
Remember, a subset $G$ of a topological space $I$ is called \textit{dense} if for every point $x \in I$ we have $x \in G$ or that $x$ is a limit point of $G$: That is, if every neighborhood of $x$ contains at least one point of $I$.
In our case, we will consider the set $I$ to be the compact input interval together with the standard topology. The latter is defined to be the set of all open $\epsilon$ neighborhoods of the form $U_\epsilon (x) := \{t \in I | \norm{t - x} < \epsilon \}$ $(\epsilon \in \Real_+, x \in I)$.

To establish convergence to the ground truth (may it be the target function or its definite integral), we will assume that we constructs grids $G_N$ that become increasingly dense, with increasing grid size. That is to say, we desire that $G_N \to G \subset I$, where $G$ is dense in $I$.
If this is the case, we know the following:

\begin{defn}[Eventually dense partition]
Grid sequence $(G_N)_{N \in \nat}, G_N = \{t_1^N,...,t_N^N \}$ becomes an eventually dense partition of $I$ if the maximum interval radius $\bar r_N = \max\{\frac{t^{N}_{i+1} - t^{N}_{i}}{2} | i=1,...,N-1 \}$
vanishes in the limit of large $N$. That is, $\bar r_N \stackrel{N \to \infty}{\longrightarrow} 0$. 
\end{defn}

The following lemma establishes that a sequence converging to a dense subset of $I$ yields an eventually dense partition:

\begin{lem} \label{lem:densegridmaxdist}
Let $G_N = \{t_1^N,...,t_N^N \} \stackrel{N \to \infty }{\longrightarrow} G$ where $G$ is a dense subset of $I=[a,b]$ and where $a=t_1^N<,\ldots,<t_N^N=b$. 
Eventually, the maximum distance between any two consecutive grid elements is arbitrarily small:
\[ \forall \epsilon >0 \exists N_0 \in \nat \forall N\geq N_0 \forall i <N: \abs{t_{i+1}^N - t_i^N} \leq \epsilon.\]
\begin{proof}
Since $G_N$ converges to a dense set in $I$ as $N \to \infty$, we know
\begin{equation}\label{eq:densegrid}
 \forall \epsilon >0 \forall x \in I \exists N_0 \forall N\geq N_0: G_N \cap U_\epsilon(x) \neq \{\emptyset\} 
\end{equation}
where $U_\epsilon(x)$ denotes an $\epsilon -$ball around $x$.
Choose any $\epsilon >0$. Divide $I$ into $q =  \frac{\abs I}{\epsilon/2}$ compact intervals $U^1_{\epsilon/4},\ldots,U^q_{\epsilon/4}$, i.e. $U^j_{\epsilon/4} = \{x \in I \,|\, \norm{x - \bigl(a+(2j-1)\,\frac{\epsilon}{4}\bigr)  } \leq \frac{\epsilon}{4} \}$.
Due to (\ref{eq:densegrid}) we know that for each $j$ there exists $N_0^j$ such that $G_N \cap U^j_{\epsilon/4} \neq \emptyset, \forall N \geq N_0^j$. Choose $N_0 := \max_{j \in \{1,\ldots,q\}} N^j_0$.
Then, $\forall N \geq N_0,j \in \{1,\ldots,q\}: G_N \cap U^j_{\epsilon/4} \neq \emptyset  $. 
Equivalently, $\forall N \geq N_0,j \in \{1,\ldots,q\}\exists i \in \{1,\ldots, N\}: t^N_i \in U^j_{\epsilon/4}$. That is, all neighborhoods contain at least one grid point in $G_N$ ($N \geq N_0$). Hence, two consecutive grid points are either contained in the same neighborhood or in adjacent ones: 
$\forall i <N \exists j \in \{1,\ldots,q\}:  t^N_i \in U^j_{\epsilon/4} \Rightarrow (t^N_{i+1} \in U^j_{\epsilon/4} \vee t^N_{i+1} \in U^{j+1}_{\epsilon/4})$. 
Since the maximal distance between points of two adjacent $\epsilon/4$ neighborhoods is twice their diameter (and within the neighborhood is once the diameter), we have $ \abs{t_{i+1}^N - t_i^N} \leq \epsilon$.

\end{proof}

\end{lem}


\subsection{Enclosures}
\label{sec:enclosures}

\begin{defn}[Enclosure]
Let $\decke,\boden: I \to \Real$ be two functions, such that $\decke
\geq \boden$ pointwise on $I$. We define their enclosure on $I$ as
the compact interval $\mathcal E^\decke_\boden (I)$ of all functions
between them. That is, \[\mathcal E^\decke_\boden (I) := \{\phi: I
\to \Real \vert \forall t \in I: \decke(t) \geq \phi(t) \geq
\boden(t) \}.\]
\end{defn}
For ease of notation we omit the domain argument whenever we refer
to $I$. That is, we write  $\mathcal E^\decke_\boden :=\mathcal
E^\decke_\boden (I)$.

\begin{defn}[Sample-consistency]
A function is \emph{sample-consistent} (with $f$ on grid $G_N$) if
it coincides with $f$ on values contained in the grid $G_N$.
\end{defn}

\begin{defn}[Sample-consistent enclosure]
A \emph{sample-consistent enclosure} is a set containing all
sample-consistent functions of an enclosure.
\end{defn}



Based on the sample $f(t_1),...,f(t_N)$ we desire to find two
\emph{enclosing functions} $\decke_N: I \to \Real$, $\mathfrak
\boden_N: I \to \Real$ bounding the target from above and below that
are as tight as possible and converge to the target in the limit of
infinite, (equidistant) sample grid size $N$. Formally, we state the
following \textbf{desiderata}:
\begin{enumerate} 
    \item \textbf{Consistency}: The enclosing functions coincide with the target on the sample grid. That is,
    $\forall t \in G_N: \, f(t) = \decke_N(t) = \boden_N(t)$.
     \item \textbf{Exhaustiveness}: Every $\phi$ coinciding with target $f$ on with grid $G_N$ and
having the same Lipschitz
    constant $L$ on $I$ as $f$ is also contained in the enclosure:$\forall \phi: I \to \Real, \phi \notin \einschluss:
       \phi_{\vert G_N} \neq f_{\vert
    G_N} \vee L_I(\phi) > L$.
    
    In particular, the target is contained in the enclosure: $f \in \einschluss$.
\item \textbf{Minimality}: If $\mathcal E$ is an enclosure satisfying \emph{Desideratum 2} then $\einschluss \subseteq \mathcal E$.    
    
\item \textbf{Convergence} to the target: $\lim_{N \to \infty} \decke_N = \lim_{N \to \infty}
    \boden_N = f$ uniformly, if $(G_N)$ converges to a dense subset of $I$ as $N \to \infty$ or, if $(G_N)_{N \in \nat}$ becomes an eventually dense partition of $I$.
   % \item Minimality of the enclosure --the enclosure only contains functions with a minimum Lipschitz number up to
   % the target function's: $\phi \in \einschluss \Rightarrow L_I(\phi) \leq
%    L \wedge \phi_{\vert G_N} = f_{\vert
%    G_N}$ ;

\end{enumerate}

Next, we will define enclosing functions meeting all desiderata.

For $i=1,\ldots,N-1$ we define the \emph{sample intervals} $J_i :=
[t_i,t_{i+1}) \subset I$ and $\bar J_i :=
[t_i,t_{i+1}) \subset I$. In addition, we define $J_N = b$. Furthermore, we define $a_i = t_i, b_i =
t_{i+1}$, i.e. $J_i= [a_i,b_i), \bar J_i= [a_i,b_i], (i=1,\ldots,N-1)$. For $i=N$ we define $a_i=b_i=b$.


Due to Lipschitz continuity, we have

\begin{equation} \forall x,x' \in J_i: \abs{f(x) - f(x')} \leq L_i \,
\abs{x-x'}
\end{equation}
where $L_i := L_{J_i}$.

\begin{defn}[Lipschitz ceiling]\label{def:lipceil}
On interval $J_i$ we define line segments via $\alpha^\decke_i: x
\mapsto f(a_i) + L_i (x - a_i)$ and $\beta^\decke_i: x \mapsto
f(b_i) -L_i (x - b_i)$. We define components of the (Lipschitz)
\emph{ceiling} of function $f$ on interval $J_i$ as the piece-wise
linear function
\[\decke^i_N: t \mapsto \min\{ \alpha^\decke_i(t), \beta^\decke_i(t) \}.\] On
the entire interval $I = \bigcup_i J_i$ the upper enclosing function
is equated to the \emph{ overall (Lipschitz) ceiling} connecting the
local ceilings:
\[ \decke_N (t) :=   \sum_{i=1}^{N}  \chi_{J_i}(t) \,\decke^i_N(t),\,\,  \]
where $\chi_{J_i}: \Real \to \{0,1\}$ denotes the indicator function
for interval $J_i$.
\end{defn}
To complete our definition of our enclosing function we need to
define the lower bound as well, which we will refer to as the
\emph{Lipschitz-floor}.

\begin{defn}[Lipschitz floor]\label{def:lipbot}
On interval $J_i$ we define line segments via $\alpha^\boden_i: t
\mapsto f(a_i) - L_i (t - a_i)$ and $\beta^\boden_i: t \mapsto
f(b_i) +L_i (t - b_i)$. We define components of the (Lipschitz)
\emph{floor} of function $f$ on interval $J_i$ as the piece-wise
linear function
\[\boden^i_N: t \mapsto \max\{ \alpha^\boden_i(t), \beta^\boden_i(t) \}.\] On
the entire interval $I = \bigcup_i J_i$ the upper enclosing function
is equated to the \emph{ overall (Lipschitz) ceiling} connecting the
local ceilings:
\[ \boden_N (t) :=  \sum_{i=1}^{N}  \chi_{J_i}(t) \,\boden^i_N(t),\,\,  \]
where $\chi_{J_i}: \Real \to \{0,1\}$ denotes the indicator function
for interval $J_i$.
\end{defn}


An example for a Lipschitz enclosure is given in Fig. 
\begin{figure*}
	\centering
		\includegraphics[scale = .4]{content/figs/enclosure.pdf}
	\caption{Example of a Lipschitz enclosure for a given sample of function values. The Lipschitz constant was one, uniformly over the entire domain.}
	\label{fig:enclosure}
\end{figure*}


The following lemmata will prove useful:

\begin{lem} \label{lem:ceiling_values}
For $i \in \{1,\ldots,N-1\}$ let  $L_i > 0$, and let $L_N \geq 0$.
Define $\xi^{\mathfrak u}_i :=  \frac{b_i+a_i}{2}+ \frac{f(b_i) - f(a_i)}{2 L_i}  $.\\
We have 
\[\xi^{\mathfrak u}_i \in \arg\max_{t \in I} \decke^i_N (t), \,\,\xi^{\mathfrak u}_i \in \bar J_i\]
and 
 \[y^{\mathfrak u}_i := \decke_N^i(\xi^{\mathfrak u}_i) = \frac{f(b_i) +f(a_i)}{2} + L_i \frac{b_i-a_i}{2} .\]
\begin{proof} The case $i = N$ is trivial. Let $1 \leq i \leq N-1$. By definition,
$\decke^i_N (t) = \min\{ \alpha^\decke_i(t), \beta^\decke_i(t)\}$.
We have $\dot  \alpha^\decke_i(t) = L_i > 0$ and $\dot  \beta^\decke_i(t) = - L_i < 0$. Hence, the functions are strictly monotonous. Let $\xi$ the input where the lines intersect, i.e. $\alpha^\decke_i(\xi) = \beta^\decke_i(\xi)$. Monotonicity implies $\forall t \leq \xi : \alpha^\decke_i(t) \leq \alpha^\decke_i(\xi) \wedge \beta^\decke_i(t) \geq \beta^\decke_i(\xi) = \alpha^\decke_i(\xi)$. 
Hence,
 \[\forall t \leq \xi: \decke_N^i(t) = \min \{\alpha_i^{\mathfrak u} (t), \beta_i^{\mathfrak u} (t) \}= \alpha_i^{\mathfrak u} (t).\] 
 
Analogously, monotonicity implies $\forall t \geq \xi : \beta^\decke_i(t) \leq \beta^\decke_i(\xi) \wedge \alpha^\decke_i(t) \geq \alpha^\decke_i(\xi) = \beta^\decke_i(\xi)$. 
Thus,
 \[\forall t \geq \xi: \decke_N^i(t) = \min \{\alpha_i^{\mathfrak u} (t), \beta_i^{\mathfrak u} (t) \}= \beta_i^{\mathfrak u} (t).\] 

In conjunction, we have 
 $\decke_N^i(t) = 
 \begin{cases}  
 \alpha_i^{\mathfrak u} (t), & t \leq \xi \\
 \beta_i^{\mathfrak u} (t), & t \geq \xi 
 \end{cases}$.
 Again, using monotonicity of $\alpha_i^{\mathfrak u}$ and $\beta_i^{\mathfrak u}$ we infer that $\decke_N^i$ has a single maximum $y := \decke_N^i(\xi)$ at $\xi$.
It remains  (i) to show that $\xi = \xi_i^{\mathfrak u}$, (ii) we need to evaluate $\decke_N^i(\xi^{\mathfrak u}_i)$ and (iii) that $\xi^{\mathfrak u}_i \in \bar J_i$.

(i) $\alpha^\decke_i(\xi) = \beta^\decke_i(\xi)$

$\Leftrightarrow  f(a_i) + L_i (\xi - a_i) = f(b_i) -L_i (\xi - b_i)$

$\Leftrightarrow  L_i \bigl( 2 \xi - b_i  - a_i\bigr) = f(b_i) - f(a_i) $

$\stackrel{L_i > 0}{\Leftrightarrow}   \bigl( 2 \xi - b_i  - a_i\bigr) = \frac{f(b_i) - f(a_i)}{L_i} $

$\Leftrightarrow   \xi  = \frac{f(b_i) - f(a_i)}{2 L_i}  + \frac{b_i+a_i}{2} = \xi^{\mathfrak u}_i$.

(ii) $\decke_N^i(\xi) = \alpha_i^{\mathfrak u} (\xi) =  f(a_i) + L_i (\xi - a_i) $

$= f(a_i) + L_i \bigl( \frac{f(b_i) - f(a_i)}{2 L_i}  + \frac{b_i+a_i}{2} - a_i \bigr) $ 

$=  \frac{f(b_i) - f(a_i) + 2f(a_i)}{2 }  + L_i \frac{b_i-a_i}{2}   = y_i^{\mathfrak u}$. 

(iii) $\xi^{\mathfrak u}_i \in \bar J_i$ if and only if $a_i \leq \xi^{\mathfrak u}_i \leq b_i$. Since $\xi^{\mathfrak u}_i = \frac{f(b_i) - f(a_i)}{2 L_i}  + \frac{b_i+a_i}{2}$ and $\frac{b_i+a_i}{2}$ is just in the middle value of interval $\bar J_i = [a_i,b_i]$, we have 

$\xi^{\mathfrak u}_i \in \bar J_i$ if $\abs{\frac{f(b_i) - f(a_i)}{2 L_i}} \leq \abs{\frac{b_i-a_i}{2}}$.
However, the latter is the case due to $L_i$-Lipschitz continuity of $f$ on $\bar J_i$.  
\end{proof}

\end{lem}


\begin{lem} \label{lem:floor_values}
For $i \in \{1,\ldots,N-1\}$ let  $L_i > 0$, and let $L_N \geq 0$.
Define $\xi^{\mathfrak l}_i := \frac{b_i+a_i}{2} - \frac{f(b_i) - f(a_i)}{2 L_i}  $.\\
We have 
\[\xi^{\mathfrak l}_i \in \arg\min_{t \in I} \boden^i_N (t), \,\,\xi^{\mathfrak l}_i \in \bar J_i\]
and 
 \[y^{\mathfrak l}_i := \boden_N^i(\xi^{\mathfrak l}_i) = \frac{f(b_i) +f(a_i)}{2} - L_i \frac{b_i-a_i}{2} .\]
\begin{proof} The case $i = N$ is trivial. Let $1 \leq i \leq N-1$. By definition,
$\boden^i_N (t) = \min\{ \alpha^\boden_i(t), \beta^\boden_i(t)\}$.
We have $\dot  \alpha^\boden_i(t) = - L_i < 0, \forall t$ and $\dot  \beta^\boden_i(t) =  L_i > 0, \forall t$. Hence, the functions are strictly monotonous. Let $\xi$ the input where the lines intersect, i.e. $\alpha^\boden_i(\xi) = \beta^\boden_i(\xi)$. Monotonicity implies $\forall t \leq \xi : \alpha^\boden_i(t) \geq \alpha^\boden_i(\xi) \wedge \beta^\boden_i(t) \leq \beta^\boden_i(\xi) = \alpha^\boden_i(\xi)$. 
Hence,
 \[\forall t \leq \xi: \boden_N^i(t) = \max \{\alpha_i^{\mathfrak l} (t), \beta_i^{\mathfrak l} (t) \}= \alpha_i^{\mathfrak l} (t).\] 
 
Analogously, monotonicity implies $\forall t \geq \xi : \beta^\boden_i(t) \geq \beta^\boden_i(\xi) \wedge \alpha^\boden_i(t) \leq \alpha^\boden_i(\xi) = \beta^\boden_i(\xi)$. 
Thus,
 \[\forall t \geq \xi: \boden_N^i(t) = \max \{\alpha_i^{\mathfrak l} (t), \beta_i^{\mathfrak l} (t) \}= \beta_i^{\mathfrak l} (t).\] 

In conjunction, we have 
 $\boden_N^i(t) = 
 \begin{cases}  
 \alpha_i^{\mathfrak l} (t), & t \leq \xi \\
 \beta_i^{\mathfrak l} (t), & t \geq \xi 
 \end{cases}$.
 Again, utilizing monotonicity of $\alpha_i^{\mathfrak l}$ and $\beta_i^{\mathfrak l}$ we infer that $\boden_N^i$ has a single minimum $y := \boden_N^i(\xi)$ at $\xi$.
It remains  (i) to show that $\xi = \xi_i^{\mathfrak l}$, (ii) we need to evaluate $\boden_N^i(\xi^{\mathfrak l}_i)$ showing $y = y_i^{\mathfrak l}$, and (iii) we need to show that 
$\xi^{\mathfrak l}_i \in \bar J_i$ .

(i) $\alpha^\boden_i(\xi) = \beta^\boden_i(\xi)$

$\Leftrightarrow  f(a_i) - L_i (\xi - a_i) = f(b_i) +L_i (\xi - b_i)$

$\Leftrightarrow  L_i \bigl( 2 \xi - b_i  - a_i\bigr) = f(a_i) - f(b_i) $

$\stackrel{L_i > 0}{\Leftrightarrow}   \bigl( 2 \xi - b_i  - a_i\bigr) = \frac{f(a_i) - f(b_i)}{L_i} $

$\Leftrightarrow   \xi  = \frac{f(a_i) - f(b_i)}{2 L_i}  + \frac{b_i+a_i}{2} = \xi^{\mathfrak l}_i$.

(ii) $\boden_N^i(\xi) = \alpha_i^{\mathfrak l} (\xi) =  f(a_i) - L_i (\xi - a_i) $

$= f(a_i) - L_i \bigl( \frac{f(a_i) - f(b_i)}{2 L_i}  + \frac{b_i+a_i}{2} - a_i \bigr) $ 

$=  \frac{-f(a_i) + f(b_i) + 2f(a_i)}{2 }  - L_i \frac{b_i-a_i}{2}   = y_i^{\mathfrak l}$. 

(iii) $\xi^{\mathfrak l}_i \in \bar J_i$ if and only if $a_i \leq \xi^{\mathfrak l}_i \leq b_i$. Since $\xi^{\mathfrak l}_i = -\frac{f(b_i) - f(a_i)}{2 L_i}  + \frac{b_i+a_i}{2}$ and $\frac{b_i+a_i}{2}$ is just in the middle value of interval $\bar J_i = [a_i,b_i]$, we have 

$\xi^{\mathfrak l}_i \in \bar J_i$ if $\abs{\frac{f(b_i) - f(a_i)}{2 L_i}} \leq \abs{\frac{b_i-a_i}{2}}$.
However, the latter is the case due to $L_i$-Lipschitz continuity of $f$ on $\bar J_i$.  
  
\end{proof}

\end{lem}


The reason for calling $\mathfrak r$ \emph{ceiling} is that it
constitutes an upper bound on the function. This is formally
established in the following theorem:

\begin{thm} \label{thm:enclosure1d_desiderata}
With enclosing functions $\decke_N, \boden_N$ defined as per Def.
\ref{def:lipceil} and Def. \ref{def:lipceil} the resulting enclosure
$\einschluss$ satisfies \textit{Desiderata 1-4} specified above.
\begin{proof}
We will need the following fact:
\begin{equation} \label{eq:absineq}
\forall r,r': \abs{r -r'} \geq r -r' \wedge \abs{r -r'} \geq r' -r,
\end{equation}
which follows immediately from the definition of the absolute value.
1) We start proving \textit{Desideratum 1} stating that the enclosing functions defined above are consistent: Let $t_i \in G_n$ be a grid input. 

By definition, we have 
For $t_i =b$, trivially $\decke_N (t_i) = f(t_i)$ by definition. 
For $i < N$:
$ \decke_N (t_i) =   \sum_{j=1}^{N}  \chi_{J_j}(t_i) \,\decke^j_N(t_i) = \decke^i_N(t_i)$
$= \min\{f(a_i) + L_i (t_i - a_i), f(b_i) -L_i (t_i - b_i)\}$ 
$= \min\{f(t_i), f(b_i) -L_i (t_i - b_i)\} = f(t_i)$. The last equality can be shown as follows:
$f(t_i)\leq f(b_i) -L_i (t_i - b_i)$
$\Leftrightarrow f(t_i) - f(b_i) \leq  L_i (b_i - t_i)$
$\Leftrightarrow f(t_i) - f(b_i) \leq  L_i \abs{b_i - t_i}$.
But the latter holds true due to Lipschitz continuity and the fact that 
$f(t_i) - f(b_i) \leq \abs{f(t_i) - f(b_i)}$.

Analogously, for $i=1,...,N-1$, we have 
$ \boden_N (t_i) =  \sum_{i=1}^{N}  \chi_{J_i}(t_i) \,\boden^i_N(t_i)$
$= \max\{f(t_i), f(b_i) +L_i (t_i - b_i)\}$ 
 $= \max\{f(t_i), f(b_i) -L_i (b_i -t_i)\}  = f(t_i)$. The last equality can be shown as follows:
$f(t_i)\geq f(b_i) -L_i (b_i -t_i)$
$\Leftrightarrow L_i (b_i -t_i) \geq f(b_i) - f(t_i)$.
This is the case since: $L_i (b_i -t_i) = L_i \abs{b_i-t_i} \stackrel{\text{Lipschitz}}{\geq} \abs{f(b_i) - f(t_i)} \geq f(b_i) - f(t_i)$.\\

2) Next, we prove exhaustiveness of the enclosure.  
Let $N > 1$, $i \in \{1,...,N \}$, $t,t' \in J_i = [a_i,b_i] \subset
I$ be arbitrary.

Let $\Phi$ be the set of all functions agreeing with $f$ on the grid
and having the same Lipschitz properties as $f$. That is, $\Phi = \{
\phi: I \to \Real| \, (\forall i: L_i(f) = L_i(\phi)) \wedge
(\forall x \in G_N: f(x) = \phi(x)) \}$.

By Lipschitz continuity we have $\forall t,t' \in J_i \abs{\phi(t)
-\phi(t')} \leq L_{i} \, \abs{t-t'}$. In particular, $\abs{\phi(t)
-\phi(a_i)} \leq L_{i} \, \abs{t-a_i}$ and $\abs{\phi(b_i) -\phi(t)}
\leq L_{i} \, \abs{b_i -t}$. Hence, $\abs{\phi(t) - \phi(a_i)}
\stackrel{eq. \ref{eq:absineq}}{\geq} \phi(t) - \phi(a_i)
\wedge\abs{\phi(t) - \phi(a_i)} \stackrel{eq.
\ref{eq:absineq}}{\geq} \phi(a_i) - \phi(t)$.

Now, $t\geq a$ and the Lipschitz property imply $\phi(t) - \phi(a_i)
\leq L_{i} (t-a_i) \wedge  \phi(a_i) -\phi(t) \leq L_{i} (t-a_i)$.
This is equivalent to
\begin{equation} \label{eq:lipintungl1}
\phi(t)  \leq  L_{i} (t-a_i) + \phi(a_i) \wedge  \phi(a_i) - L_{i}
(t-a_i) \leq \phi(t).
\end{equation}

Analogously, we can derive
\begin{equation}\label{eq:lipintungl2}
\phi(t)  \leq  L_{i} (b_i-t) + \phi(b_i) \wedge  \phi(b_i) - L_{i}
(b_i -t) \leq \phi(t) .
\end{equation}

By definition of the ceiling (cf. Def. \ref{def:lipceil}) and floor
(cf. Def. \ref{def:lipbot}) functions, statement
(\ref{eq:lipintungl1}) and statement (\ref{eq:lipintungl2})
collectively yield
%
\begin{eqnarray}
% \nonumber to remove numbering (before each equation)
  \phi(t) &\leq& \decke_N^i (t)   \\
  \phi(t) &\geq& \boden_N^i (t).
\end{eqnarray}

This holds true for all $i$ and all grids of size $N$ and hence, on
all parts of the domain $I$. 
Hence, $ \phi \in \einschluss, \forall
\phi \in \Phi$. In particular, $f \in \Phi$. Thus, $f \in \einschluss$.\\

3) We prove minimality of the enclosure. Let $g,h$ be functions such that the enclosure $\mathcal E := \mathcal E_g^h$ is exhaustive, i.e. satisfies Desideratum 2. Now, $\alpha_i^{\mathfrak u},\alpha_i^{\mathfrak l},\beta_i^{\mathfrak u},\beta_i^{\mathfrak l}$ are all $L_i$-Lipschitz continuous. Thus, $\decke_N,\boden_N$ are Lipschitz with the same constants. Owing to our assumption of exhaustiveness we therefore have: $\decke_N,\boden_N \in \mathcal E$. Hence, $g \leq \boden_N \leq \decke_N \leq h$. Hence, $\einschluss \subset \mathcal E$.

4) We show that each $\phi_N \in \einschluss$ converges uniformly to $f$, regardless of the identity of $f$, as long as $G_N$ converges to a dense subset of $I$ (or is an eventually dense partition of $I$). That is, we show $\forall \epsilon >0 \exists N_0 \forall N \geq N_0 \forall t \in I : \abs{\phi_N(t) - f(t)} \leq \epsilon$.

Let $\epsilon > 0$ and define $L := \max_{i=1,...,N-1} L_i$ to be the maximum Lipschitz constant among the intervals $J_1,...,J_N$. By Lem. \ref{lem:densegridmaxdist}, we know that there exists $N_0$ such that for all $N \geq N_0$, the distance between two consecutive points in grid $G_N$ is maximally $\delta:=\frac{\epsilon}{L}$. That is,
$\forall N \geq N_0 \forall i: b_i - a_i = |J_i| \leq \delta$. 

So, let $N \geq N_0$. 
Note, $\sup_{ t \in I} \abs{\phi_N(t) - f(t)} \leq \sup_{ t \in I} \abs{\decke_N(t) - \boden_N (t)} \leq \max_{i} \sup_{ t \in J_i} \abs{\decke_N^i(t) - \boden_N^i (t)}$
$\leq \max_{i}  \abs{\sup_{ t \in J_i}\decke_N^i(t) - \inf_{ t \in J_i} \boden_N^i (t)}$
$\stackrel{Lem. \ref{lem:ceiling_values}, Lem. \ref{lem:floor_values}}{=} \max_i \abs{ \bigl(\frac{f(b_i) +f(a_i)}{2} + L_i \frac{b_i-a_i}{2}  \bigr)- \bigl(\frac{f(b_i) +f(a_i)}{2} - L_i \frac{b_i-a_i}{2} \bigr)}$
$=\max_i \abs{ L_i (b_i-a_i) }$
$\leq \max_i \abs{ L_i \delta } = \delta \max_i L_i = \epsilon$.
Thus, $\forall t \in I: \abs{\phi_N(t) - f(t)} \leq \epsilon$.

\end{proof}

\end{thm}
