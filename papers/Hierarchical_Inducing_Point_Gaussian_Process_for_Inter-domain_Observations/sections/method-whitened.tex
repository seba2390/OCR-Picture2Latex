\subsection{Whitened parameterization}
\label{sec:whitened}

Whitened (or non-centered) parameterizations are used to improve
inference in models with correlated priors because they offer a
better-conditioned posterior
\citep{murray2010slice, hensman2015mcmc}.
Here we obtain an additional important computational benefit of it
in the variational setting --- the whitened posterior allows us to
avoid computing $\ln |\bK_{\bu,\bu}|$, a fact that has not been observed
in the literature.
To define the whitened parameterization, we describe the GP prior over
$\bu$ as a deterministic function of standard normal parameters $\bepsilon$
\begin{align}
  \bepsilon \sim \mathcal{N}(0, I) \,, \quad
  \bu = \bK_{\bu,\bu}^{1/2} \bepsilon \sim \mathcal{N}(0, \bK^{}_{\bu,\bu}) \,.
   \label{eq:matrix-sqrt}
\end{align}
We target the posterior over
the \emph{whitened parameters}
$\bepsilon$ with variational approximation
${q_{\blambda}(\bepsilon) = \mathcal{N}(\bepsilon \given \bm, \bS)}$.
The resulting whitened variational objective is
\begin{align*}
\mathcal{L}(\blambda)
  %&= \mathbb{E}_{q_{\blambda}(\epsilon) p(\brho \given \epsilon)}
  %    \left[ \ln p(\by \given \brho) \right] -
  %    KL(q_{\blambda}(\epsilon) \,||\, p(\epsilon)) \\
  &= \sum_{n} \underbrace{
  	    \mathbb{E}_{q_{\blambda}(\bepsilon) p(\brho \given \bepsilon)} \left[
	    	\ln p(y_n \given \rho_n)
	    \right]
	  }_{\circled{$a'_n$}} -
      \underbrace{
	  	KL(q_{\blambda}(\bepsilon) \,||\, p(\bepsilon))
	  }_{\circled{b$'$}} \,
\end{align*}
where
\begin{align}
\circled{$a'_n$}
&= -\frac{1}{2}\ln \sigma_n^2 - \frac{1}{2\sigma_n^2}
    \Big( y_n^2 + \bK^{**}_{n,n} - \bk_n^\intercal \bk^{}_n  \nonumber \\
&\quad + \bk_n^\intercal
     \left( \bS + \bm \bm^\intercal \right) \bk_n - 2 y^{}_n \bk_n^\intercal \bm
    \Big) \,\,,\\
\circled{b$'$}
%KL(q_{\blambda}(\epsilon) \,||\, p(\epsilon))
  &= \frac{1}{2}\left( \text{tr}(\bS) + \bm^\intercal \bm - \ln |\bS| - M \right) \,
\label{eq:kl-term}
\end{align}
 and we define the correlation term for clarity
 \begin{align}
    \bk_n \triangleq Cov(\bepsilon, \be_n)  = \bK_{\bu,\bu}^{-1/2}\bK^*_{\bu,n}  \,\,.
    \label{eq:k-vector}
 \end{align}

Becuase $p(\bepsilon)$ is a standard normal we have simplified term \circled{$b'$},
by avoiding computing $\ln |\bK_{\bu,\bu}|$.
The remaining computational bottlenecks are
the correlation term $\bk_n$ in \circled{$a_n'$} and the $\ln |\bS|$ in \circled{$b'$}
which we address in the following.
Specifically, we note that the efficient computation of $\bk_n$
depends on the specific choice of whitening strategy,
which we will discuss in Section~\ref{sec:computational}.
