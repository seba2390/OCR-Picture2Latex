\subsection{Inferring Interstellar Dust Map}

  
\label{sec:experiment-dustmap}
\begin{figure}[t!]
  \centering
  \begin{subfigure}{.49\columnwidth}
    \includegraphics[width=\columnwidth]{figures/domain/predict-emu-test-3D.png}
    \caption{Posterior mean of $\rho^*$}
    \label{fig:domain-predict-rhostar}
    \vspace{.5cm}
  \end{subfigure}
  \begin{subfigure}{.49\columnwidth}
    \includegraphics[width=\columnwidth]{figures/domain/predict-fmu-test-3D.png}
    \caption{Posterior mean of $\rho$}
		\label{fig:domain-predict-rho}
    	\vspace{.5cm}
  \end{subfigure}
  \begin{subfigure}{\columnwidth}
		\centering
    \scalebox{.8}{
    \input{figures/domain/domain-report.tex}
    }
    \caption{Predictive statistics for integrated observations}
    \label{tab:domain-report}
  \end{subfigure}
	\caption{HIP-GP performance on 20{,}000 held-out data.
    Top: Posterior mean predictions in the integrated domain ($\rho^*$)
    and the latent domain ($\rho$).
    Bottom: We report the mean absolute error (MAE), the mean square error (MSE)
    and the test log likelihood in the intergrated domain.
  }
  \label{fig:domain-experiment}
\end{figure}

Finally, we investigate an inter-domain GP problem with $\mathcal{L}$ being the integral transformation:
inferring the interstellar dust map from integral observations.
The interstellar dust map $\rho$ is a three-dimensional density function at each location in the Galaxy.
The observations $y$, also known as the starlight extenctions, are noisy line
integrals of the dust function \citep{rezaei2017inferring}.
We experiment with the Ananke dataset,
which is comprised of $500{,}000$ starlight extinctions
within $4\textrm{kpc} \times 4 \textrm{kpc} \times 2 \textrm{kpc}$ region
 of a high resolution Milky Way like galaxy simulation --- a cutting edge simulation
 in the field because of the gas and dust resolution
  \citep{wetzel2016reconciling, hopkins2018fire, sanderson2020synthetic}.
Our goal is to infer the underlying dust map $\rho$
from the noisy extinctions $y$.
%Only HIP-GP is explored in this setting since standard SVGP is no longer feasible for large $M$ we consider.

We compare HIP-GP with $M=62{,}500 \,(50\times 50 \times 25)$
and SVGP with $M=16{,}384 \,(32 \times 32 \times 16)$ -- the largest $M$ feasible.
For both methods, we apply the block-independent variational
parameterization with neighboring block size $M_b = 8~(2\times2\times2)$,
and the Mat√©rn$\,(1.5)$ kernel.
The maximum number of PCG iterations within HIP-GP is set to
200 and 500 for training and evaluation.
We use Monte Carlo estimation to compute the
inter-domain and transformed-domain covariance functions
in Equations~\ref{eq:domain-kernel} and \ref{eq:domain-kernel2}.
We hold out 20{,}000 points for evaluation.
The posterior mean predictions of the extinctions $\rho^*$
and the latent dust map $\rho$ are displayed in
Figure~\ref{fig:domain-predict-rhostar} and \ref{fig:domain-predict-rho}.
The predictive test statistics are summarized in Table~\ref{tab:domain-report}.
We see that with more inducing points, the predictive accuracy is enhanced.
HIP-GP can scale to larger $M$ which enables better prediction quality,
while SVGP is limited to $M$ around $16{,}000$.


