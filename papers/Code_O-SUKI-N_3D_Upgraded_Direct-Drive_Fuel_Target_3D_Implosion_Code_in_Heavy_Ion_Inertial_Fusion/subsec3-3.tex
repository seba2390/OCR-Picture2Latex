%\documentclass[preprint,12pt]{elsarticle}
%\include{begin}

%----- Euler Code
\subsection{Eulerian code}
\begin{enumerate}
\item {\bf BoundaryTracking.cpp}\\
It is a function to track the material boundary surfaces. Each boundary point is specified by the coordinates of the three variables: $( BoundaryMesh\_i$,  $BoundaryMesh\_j$, $BoundaryMesh\_k )$. The function interpolates the velocities $u$, $v$ and $w$ at the coordinates by the volume interpolation, and tracks the position of each boundary point. In Fig. \ref {BP} dotted lines represent the material boundaries. When the boundary point exists at the position shown in Fig. \ref {BMV}, the boundary point velocity ($u_b, \ v_b, \ w_b$) is calculated by the volume interpolation method and is obtained by the following equations:
	\begin{eqnarray}
		u_b&=&V_{u1}u_{i+1,j+1,k+1}+V_{u2}u_{i,j+1,k+1}+V_{u3}u_{i,j,k+1}+V_{u4}u_{i+1,j,k+1} \\ \nonumber 
		&+&V_{u5}u_{i+1,j+1,k}+V_{u6}u_{i,j+1,k}+V_{u7}u_{i,j,k}+V_{u8}u_{i+1,j,k}\\
		v_b&=&V_{v1}v_{i+1,j+1,k+1}+V_{v2}v_{i,j+1,k+1}+V_{v3}v_{i,j,k+1}+V_{v4}v_{i+1,j,k+1} \\ \nonumber
		&+&V_{v5}v_{i+1,j+1,k}+V_{v6}v_{i,j+1,k}+V_{v7}v_{i,j,k}+V_{v8}v_{i+1,j,k}\\
		w_b&=&V_{w1}w_{i+1,j+1,k+1}+V_{w2}w_{i,j+1,k+1}+V_{w3}w_{i,j,k+1}\\ \nonumber
	 &+&V_{w4}w_{i+1,j,k+1} +V_{w5}w_{i+1,j+1,k}+V_{w6}w_{i,j+1,k}+V_{w7}w_{i,j,k}\\ \nonumber
	 &+&V_{w8}w_{i+1,j,k}
	\end{eqnarray}

	\begin{figure}[H]
		\centering
		\includegraphics[height=7cm]{images/Boundarypoint.eps}
		\caption{Material boundary points.}\label{BP}
	\end{figure}
	\begin{figure}[H]
		\centering
		\includegraphics[width=10cm]{images/BoundMeshVeloc.eps}
		\caption{Velocity interpolation by the volume interpolation.}\label{BMV}
	\end{figure}
	
%\item {\bf DIFINITS.H}\\
\item {\bf GenerateMatrix.cpp}\\
The mesh total numbers of $(im,\ jm,\ km)$ are loaded from the converted data in GenerateMatrix(). all the variables required  in the Euler code are defined based on the number $(im,\ jm,\ km)$. 

%\item {\bf InitBoundary.cpp}\\
\if0
\item {\bf Legendre.cpp}\\
The procedure performs the mode analyses based on the Legendre function in order to find the implosion non-uniformity. The analysis results are also output in this procedure. 
\fi
\item {\bf MS\_TDMA.cpp}\\
A function to solve matrixes by TDMA (TriDiagonal-Matrix Algorithm).
\item {\bf MaterialRecognation.cpp}\\
A function to discriminate each material by the material boundary lines. 
\item {\bf PaintMaterial.cpp\\}
The material is specified between the two material boundary lines in the procedure. 
\item {\bf RMFP\_ECSH.cpp}\\
A procedure to calculate the Rosseland mean free path (see Ref. \cite{Zeldovich}). 
\item {\bf ScanLine.cpp}\\
A procedure that specifies the material on each Euler mesh. 
\item {\bf artv\_ECSH.cpp}\\
This file contains a procedure to calculate the artificial viscosity. The three-dimensional artificial viscosity is written as follows: 
\begin{eqnarray}
q_x = \rho C^2_Q \left( \frac{\partial u}{\partial i} \right)^2 + \rho C_L C_s |\frac{\partial u}{\partial i}| \\
q_y = \rho C^2_Q \left( \frac{\partial v}{\partial j} \right)^2 + \rho C_L C_s |\frac{\partial v}{\partial j}| \\
q_z = \rho C^2_Q \left( \frac{\partial w}{\partial k} \right)^2 + \rho C_L C_s |\frac{\partial w}{\partial k}| 
\end{eqnarray}
Here, the discretized artificial viscosities are shown below: 
%$ u $ is the direction of $ r $ direction, $ v $ is the speed of $ z $ direction. 
\small
\begin{eqnarray}
{q_x}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} &=& \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} C_Q^2 (u^n_{i+1,j+\frac{1}{2},k+\frac{1}{2}} - u^n_{i,j+\frac{1}{2},k+\frac{1}{2}})^2 \\\nonumber
&& + \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} C_L C_s \left| u^n_{i+1,j+\frac{1}{2},k+\frac{1}{2}}-u^n_{i,j+\frac{1}{2},k+\frac{1}{2}} \right| \\
{q_y}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} &=& \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} C_Q^2 (u^n_{i+\frac{1}{2},j+1,k+\frac{1}{2}} - u^n_{i+\frac{1}{2},j,k+\frac{1}{2}})^2 \\ \nonumber
&& + \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} C_L C_s \left| u^n_{i+\frac{1}{2},j+1,k+\frac{1}{2}}-u^n_{i+\frac{1}{2},j,k+\frac{1}{2}} \right| \\
{q_z}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} &=& \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} C_Q^2 (u^n_{i+\frac{1}{2},j+\frac{1}{2},k+1} - u^n_{i+\frac{1}{2},j+\frac{1}{2},k})^2 \\ \nonumber
&& + \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} C_L C_s \left| u^n_{i+\frac{1}{2},j+\frac{1}{2},k+1}-u^n_{i+\frac{1}{2},j+\frac{1}{2},k} \right| \\
\end{eqnarray}
\normalsize

\item {\bf define\_ECSH.h}\\
It contains the constant values, the normalization factors and the procedure declarations required. 
\item {\bf dif\_ECSH.cpp}\\
The following equations of motion are used.
\begin{eqnarray}
\label{dmeEu}
\frac{\partial \tilde{u}}{\partial \tilde{t}} &=& -  \left( \tilde{u} \frac{\partial \tilde{u}}{\partial \tilde{x}} + \tilde{v} \frac{\partial \tilde{u}}{\partial \tilde{y}} +\tilde{w} \frac{\partial \tilde{u}}{\partial \tilde{z}} \right) -  \frac{1}{\tilde{\rho}}  \frac{\partial \left(\tilde{p} + \tilde{q}\right)}{\partial \tilde{x}}   \\
\frac{\partial \tilde{v}}{\partial \tilde{t}} &=& -  \left( \tilde{u} \frac{\partial \tilde{v}}{\partial \tilde{x}} + \tilde{v} \frac{\partial \tilde{v}}{\partial \tilde{y}} +\tilde{w} \frac{\partial \tilde{v}}{\partial \tilde{z}} \right) -  \frac{1}{\tilde{\rho}} \frac{\partial \left(\tilde{p} + \tilde{q}\right)}{\partial \tilde{y}}   \\
\frac{\partial \tilde{w}}{\partial \tilde{t}} &=& -  \left( \tilde{u} \frac{\partial \tilde{w}}{\partial \tilde{x}} + \tilde{v} \frac{\partial \tilde{w}}{\partial \tilde{y}} +\tilde{w} \frac{\partial \tilde{w}}{\partial \tilde{z}} \right) -  \frac{1}{\tilde{\rho}} \ \frac{\partial \left(\tilde{p} +  \tilde{q}\right)}{\partial \tilde{z}}   
\end{eqnarray}

Equations (\ref{dmeEu}) are discretized as follows: 

\begin{eqnarray}
u^{n+\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} &=& u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} - Dt^n \Biggl[ \left\{ \left(u \frac{\partial u}{\partial x} \right)^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} + \left(v \frac{\partial u}{\partial y} \right)^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \right. \\  \nonumber
&& \left.  + \left(w \frac{\partial u}{\partial z} \right)^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \right\} + \left\{ \frac{1}{\rho} \frac{\partial (p+q)}{\partial x} \right\}^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \Biggr] 
\end{eqnarray}
Here, 
\begin{eqnarray*}
&& u \frac{\partial u}{\partial x} \bigg|^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \\
&& \ \ \ \ \ \  = \left\{ 
\begin{array}{ll}
u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \frac{u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} - u^{n-\frac{1}{2}}_{i-1,j+\frac{1}{2},k+\frac{1}{2}}}{Dx^{n-\frac{1}{2}}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} &\left( u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \geq 0 \right) \\
	u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \frac{u^{n-\frac{1}{2}}_{i+1,j+\frac{1}{2},k+\frac{1}{2}} - u^{n-\frac{1}{2}}_{i+1,j+\frac{1}{2},k+\frac{1}{2}}}{Dx^{n-\frac{1}{2}}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} &\left( u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} <0 \right)
\end{array} 
\right. \\
&& v \frac{\partial u}{\partial y} \bigg|^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \\
&& \ \ \ \ \ \  = \left\{ 
\begin{array}{ll}
	v^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \frac{u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} - u^{n-\frac{1}{2}}_{i,j-\frac{1}{2},k+\frac{1}{2}}}{Dy^{n-\frac{1}{2}}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} &\left( v^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \geq 0 \right) \\
	v^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \frac{u^{n-\frac{1}{2}}_{i,j+\frac{3}{2},k+\frac{1}{2}} + u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}}}{Dy^{n-\frac{1}{2}}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} &\left( v^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} < 0 \right) 
\end{array} 
\right. \\
&&  w \frac{\partial u}{\partial z} \bigg|^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \\
&& \ \ \ \ \ \  = \left\{ 
\begin{array}{ll}
	w^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \frac{u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} - u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k-\frac{1}{2}}}{Dz^{n-\frac{1}{2}}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} &\left( w^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \geq 0 \right) \\
	w^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} \frac{u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{3}{2}} - u^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}}}{Dz^{n^\frac{1}{2}}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} &\left( w^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} < 0 \right) 
\end{array} 
\right. 
\end{eqnarray*}

\begin{eqnarray*}
 &&\frac{1}{\rho} \frac{\partial(p+q)}{\partial x}\bigg|^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}} = \frac{2}{\rho^{n-\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} + \rho^{n-\frac{1}{2}}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}  \\
&& \left\{ \frac{p^{n-\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} + q^{n-\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} - \left(p^{n-\frac{1}{2}}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} + q^{n-\frac{1}{2}}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \right) }{Dx^{n-\frac{1}{2}}_{i,j+\frac{1}{2},k+\frac{1}{2}}} \right\}
\end{eqnarray*}


\item {\bf eod\_ECSH.cpp}\\
The following continuity equation is used.
\begin{equation}
\label{eodE}
\frac{\partial \rho}{\partial t} = - \rho \left( \frac{\partial u}{\partial x} +\frac{\partial v}{\partial y} + \frac{\partial w}{\partial z} \right) - \left( u \frac{\partial \rho}{\partial x} + v \frac{\partial \rho}{\partial y} + w \frac{\partial \rho}{\partial z}\right)
\end{equation}
Equation (\ref{eodE}) is discretized as follows: 
\begin{eqnarray}
\rho^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} &=& \rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} - Dt^n \Biggl[ \rho^n_{i+\frac{1}{2}, j+\frac{1}{2}.k+\frac{1}{2}} \left\{ \frac{\partial u}{\partial x} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \right. \\ \nonumber
&& \left. + \frac{\partial v}{\partial y} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+ \frac{\partial w}{\partial z} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \right\} + \left\{  u \frac{\partial \rho}{\partial x} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \right. \\ \nonumber
&& \left. + v \frac{\partial \rho}{\partial y} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} + w \frac{\partial \rho}{\partial z} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \right\} \Biggr] 
\end{eqnarray}
\begin{eqnarray*}
&&  \frac{\partial u}{\partial x} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} = \frac{ u^n_{i+1,j+\frac{1}{2},k+\frac{1}{2}} - u^n_{i,j+\frac{1}{2},k+\frac{1}{2}}}{D x^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} \\
&& \frac{\partial v}{\partial y} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} = \frac{ v^n_{i+\frac{1}{2},j+1,k+\frac{1}{2}} - v^n_{i+\frac{1}{2},j,k+\frac{1}{2}}}{D y^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} \\
&& \frac{\partial w}{\partial z} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} = \frac{ w^n_{i+\frac{1}{2},j+\frac{1}{2},k+1} - w^n_{i+\frac{1}{2},j+\frac{1}{2},k}}{D z^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} \\
&& u \frac{\partial \rho}{\partial x} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \\
&& \ \ \ \  = \left\{ 
\begin{array}{ll}
	u^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{\rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} - \rho^n_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{Dx^n_{i,j+\frac{1}{2},k+\frac{1}{2}}} &\left( u^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \geq 0 \right) \\
	u^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{\rho^n_{i+\frac{3}{2},j+\frac{1}{2},k+\frac{1}{2}} - \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{Dx^n_{i+1, j+\frac{1}{2},k+\frac{1}{2}}} &\left( u^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} <0 \right)
\end{array} 
\right. \\
&& v \frac{\partial \rho}{\partial y} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \\
&& \ \ \ \  = \left\{ 
\begin{array}{ll}
	v^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{\rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} - \rho^n_{i+\frac{1}{2},j-\frac{1}{2},k+\frac{1}{2}}}{Dy^n_{i+\frac{1}{2},j,k+\frac{1}{2}}} &\left( v^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \geq 0 \right) \\
	v^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{\rho^n_{i+\frac{3}{2},j+\frac{1}{2},k+\frac{1}{2}} - \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{Dy^n_{i+\frac{1}{2}, j+1,k+\frac{1}{2}}} &\left( v^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} <0 \right)
\end{array} 
\right. \\
&& w \frac{\partial \rho}{\partial z} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \\
&& \ \ \ \  = \left\{ 
\begin{array}{ll}
	w^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{\rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} - \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k-\frac{1}{2}}}{Dz^n_{i+\frac{1}{2},j+\frac{1}{2},k}} &\left( w^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \geq 0 \right) \\
	w^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{\rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{3}{2}} - \rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{Dz^n_{i+\frac{1}{2},j+\frac{1}{2},k+1}} &\left( w^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} < 0 \right) \\
\end{array} 
\right.
\end{eqnarray*}
\item{\bf eoenergy\_ECSH}\\
The following basic energy equations are used.
\begin{eqnarray}
	\label{eq:EuEoE}
\frac{\partial T_i}{\partial t} &=& - \left( u \cdot \nabla \right) T_i -\frac{k_B}{C_{V_i}} \Biggl[ \left( \rho B_{T_i} + \frac{p_i +q}{\rho} \right) \left( \nabla \cdot u \right)  \Biggr] \\
\frac{\partial T_e}{\partial t} &=& - \left( u \cdot \nabla \right) T_e -\frac{k_B}{C_{V_e}} \Biggl[ \left( \rho B_{T_e} + \frac{p_e}{\rho} \right) \left( \nabla \cdot u \right)  \Biggr] \\
\frac{\partial T_r}{\partial t} &=& - \left( u \cdot \nabla \right) T_r -\frac{k_B}{C_{V_r}} \Biggl[ \left( \rho B_{T_r} + \frac{p_r}{\rho} \right) \left( \nabla \cdot u \right)  \Biggr]
\end{eqnarray}
Here, $B_{T_i} = 0$ in HIF. The discretized energy equation for the ion temperature, for example, becomes as follows: 
\begin{eqnarray}
{T_i}^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} &=& {T_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} - Dt^n \Biggl[ \left\{  u \frac{\partial T_i}{\partial x} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \right. \\ \nonumber
&& \left. + v \frac{\partial T_i}{\partial y} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} + w \frac{\partial T_i}{\partial z} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \right\} \\ \nonumber
&& + \frac{1}{{C_{V_i}}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}} \Biggl[ \frac{{p_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} + q^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{\rho^n_{i+\frac{1}{2},j+\frac{1}{2}+k\frac{1}{2}}}  \\ \nonumber
&& \left\{ \frac{\partial u}{\partial x} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} + \frac{\partial v}{\partial y} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}  + \frac{\partial w}{\partial z} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \right\} \Biggr] \Biggr]
\end{eqnarray}
\begin{eqnarray*}
&& u \frac{\partial {T_i}}{\partial x} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \\
&& \ \ \ \  = \left\{ 
\begin{array}{ll}
	u^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{{T_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} -  {T_i}^n_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{Dx^n_{i,j+\frac{1}{2},k+\frac{1}{2}}} &\left( u^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \geq 0 \right) \\
	u^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{{T_i}^n_{i+\frac{3}{2},j+\frac{1}{2},k+\frac{1}{2}} - {T_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{Dx^n_{i+1, j+\frac{1}{2},k+\frac{1}{2}}} &\left( u^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} <0 \right)
\end{array} 
\right. \\
&& v \frac{\partial {T_i}}{\partial y} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \\
&& \ \ \ \  = \left\{ 
\begin{array}{ll}
	v^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{{T_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} - {T_i}^n_{i+\frac{1}{2},j-\frac{1}{2},k+\frac{1}{2}}}{Dy^n_{i\frac{1}{2},j,k+\frac{1}{2}}} &\left( v^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \geq 0 \right) \\
	v^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{{T_i}^n_{i+\frac{1}{2},j+\frac{3}{2},k+\frac{1}{2}} - {T_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{Dy^n_{i+\frac{1}{2}, j+1,k+\frac{1}{2}}} &\left( v^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} <0 \right)
\end{array} 
\right. \\
&& w \frac{\partial {T_i}}{\partial z} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \\
&& \ \ \ \  = \left\{ 
\begin{array}{ll}
	w^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{{T_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} - {T_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k-\frac{1}{2}}}{Dz^n_{i\frac{1}{2},j+\frac{1}{2},k}} &\left( w^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \geq 0 \right) \\
	w^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} \frac{{T_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{3}{2}} - {T_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{Dz^n_{i+\frac{1}{2}, j+\frac{1}{2},k+1}} &\left( w^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} <0 \right)
\end{array} 
\right. \\
&& \frac{\partial u}{\partial x} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} = \frac{u^n_{i+1,j+\frac{1}{2},k+\frac{1}{2}} - u^n_{i,j+\frac{1}{2},k+\frac{1}{2}}}{Dx^n_{i,j+\frac{1}{2},k+\frac{1}{2}}} \\
&& \frac{\partial v}{\partial y} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} = \frac{v^n_{i+\frac{1}{2},j+1,k+\frac{1}{2}} - v^n_{i+\frac{1}{2},j,k+\frac{1}{2}}}{Dy^n_{i+\frac{1}{2},j,k+\frac{1}{2}}} \\
&& \frac{\partial w}{\partial z} \bigg|^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}} = \frac{w^n_{i+\frac{1}{2},j+\frac{1}{2},k+1} - w^n_{i+\frac{1}{2},j+\frac{1}{2},k}}{Dz^n_{i+\frac{1}{2},j+\frac{1}{2},k}}
\end{eqnarray*}
	
\item{\bf eos\_ECSH.cpp}\\
The same equation is used as the equation of state in the Lagrangian code.
\item{\bf fusion.cpp}\\
The fusion reactions are calculated in this procedure. The details are shown in Ref. \cite{CPC-O-SUKI}. The fusion reaction formulae for deuterium and tritium are shown below.
	\begin{eqnarray}
	\begin{split}
		\rm D+\rm D&\xrightarrow[50\%]{}\rm T(1.01{\rm MeV})+\rm p(3.02{\rm MeV})\\
		&\xrightarrow[50\%]{}{\rm He}^3(0.82{\rm MeV})+\rm n(2.45{\rm MeV})\\
		\rm D+\rm T&\rightarrow{\rm He}^4(3.5{\rm MeV})+\rm n(14.1{\rm MeV})
		\end{split}
		\label{NucEq}
	\end{eqnarray}
	D decreases due to the DD and DT reactions from the expression (\ref {NucEq}). The number density $n_{\rm D} $ change  is given bellow: 	
	\begin{eqnarray}
	\label{eq:ReacD}
		\frac{\partial n_{\rm D}}{\partial t}&=&-N_{\rm DD}-N_{\rm DT}\nonumber\\
							 &=&-\frac{1}{2}\langle\sigma v\rangle_{\rm DD}n_{\rm D}n_{\rm D}-\langle\sigma v\rangle_{\rm DT}n_{\rm D}n_{\rm T}
	\end{eqnarray}

Considering the diffusion term of $ \alpha $ particles and the term of $ \alpha $ particle absorption, $ n_\alpha $ is described as follows: 
		\begin{equation}
	\label{eq:alphaReac}
		\frac{\partial n_\alpha}{\partial t}=+\langle\sigma v\rangle_{\rm DT}n_{\rm D}n_{\rm T}-\bm\nabla\cdot\bm F-\omega_\alpha n_\alpha
	\end{equation}
	The discretized $\alpha$ particle reaction is written as: 
	\begin{equation}
		{n_\alpha}^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}={n_\alpha}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+\ \Delta t{n_{\rm D}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}{n_{\rm T}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\langle\sigma v{\rangle_{\rm DT}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}.
	\end{equation}
The D-D and the D-T reaction rates are shown in Refs. (\cite {CPC-O-SUKI, NRLpf}).	
The flux of the $\alpha$ particle is shown below $\mbox{\boldmath $F$}$.
\begin{eqnarray}
\mbox{\boldmath $F$}  = - D_\alpha \mbox{\boldmath $\nabla$} n_\alpha
\end{eqnarray}
Here $D_\alpha$ is the diffusion coefficient and is expressed by the following equation.
\begin{eqnarray}
\label{eq:alpha_kakusan}
D_\alpha = \frac{ \frac{1}{3} v_\alpha \lambda_\alpha}{1+ \frac{4}{3} \lambda_\alpha \frac{|\nabla n_\alpha|}{n_\alpha}}
\end{eqnarray}
Here $v_\alpha$ is the speed of $\alpha$ particle and $\lambda_\alpha$ the mean free path of $\alpha$. The second term of the denominator in Eq. (\ref{eq:alpha_kakusan}) expresses the flux limiting effect, which limits the excess flux by the steep gradient of the $\alpha$ density. The flux $\mbox{\boldmath $F$}$ of the $\alpha$ particles in the $x$, $y$ and $z$ directions are expressed by the following equations:  
\begin{eqnarray}
F_x = - \frac{ \frac{1}{3} n_\alpha v_\alpha \lambda_\alpha }{n_\alpha + \frac{4}{3} \lambda_\alpha \left| \frac{\partial n_\alpha}{\partial x} \right| } \frac{\partial n_\alpha}{\partial x} \\
F_y = - \frac{ \frac{1}{3} n_\alpha v_\alpha \lambda_\alpha }{n_\alpha + \frac{4}{3} \lambda_\alpha \left| \frac{\partial n_\alpha}{\partial y} \right| } \frac{\partial n_\alpha}{\partial y} \\
F_z = - \frac{ \frac{1}{3} n_\alpha v_\alpha \lambda_\alpha }{n_\alpha + \frac{4}{3} \lambda_\alpha \left| \frac{\partial n_\alpha}{\partial z} \right| } \frac{\partial n_\alpha}{\partial z} 
\end{eqnarray}
	
The energy increases by the $ \alpha $ particle energy deposition are shown below: 
	\begin{eqnarray}
	\label{NucEnIon}
		\Delta T_i=\frac{E_\alpha n_\alpha f_i}{\rho C_{v_i}}\\
	\label{NucEnEle}
		\Delta T_e=\frac{E_\alpha n_\alpha f_e}{\rho C_{v_e}}
	\end{eqnarray}
Here $f$ represents the distribution factor of the $\alpha $ particle energy among ions and electrons \cite{Fraley}. 

\begin{eqnarray}
f_i = \frac{1}{1+\frac{32}{T_e(KeV)}}, \hspace{1cm} f_e= 1-f_i
\end{eqnarray}

The discretized energy increases for ions and electrons are described as follows.

	\begin{eqnarray}
		{T_i}^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}={T_i}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+\Delta t\frac{E_\alpha {n_\alpha}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}{f_i}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{\rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}{C_{v_i}}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}\\
		{T_e}^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}={T_e}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+\Delta t\frac{E_\alpha {n_\alpha}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}{f_e}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{\rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}{C_{v_e}}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}
	\end{eqnarray} 
\item{\bf init\_ECSH.cpp}\\
The file initializes the Eulerian code.
\item{\bf load\_convert.cpp}\\
A procedure to read the converted data.
\item{\bf main\_ECSH.cpp}\\
The main function of the Eulerian code.
\item {\bf output\_ECSH.cpp}\\
The results are stored in this procedure.

\end{enumerate}
%\include{end}