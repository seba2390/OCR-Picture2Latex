%\documentclass[preprint,12pt]{elsarticle}
%\include{begin}

%--- Lagrangian and OK code

\subsection{Lagrangian code and OK3}
\begin{enumerate}
\item {\bf BC\_LC.cpp}\\
The boundary conditions are included in the procedure.
%ここから追記
\item {BeamMaking.cpp}\\
The function calculates the total input energy.
%ここまで追記
\item {\bf CONSTANT.h}\\
The file contains the definition of constant values and normalization factors.
\item {\bf Derf.c}\\
The file contains the error function in the double precision.
\item {\bf HIFScheme.h}\\
The file contains 1, 2, 3, 6, 12, 20, 32, 60 and 120-beam irradiation schemes. (see also Refs. \cite{ogoyski1, ogoyski2, ogoyski3}.)
%The file contains all direction coordinates of the irradiation schemes used in our simulations. The beam directions are defined in a spherical coordinate system linked to the reactor chamber center.
\item {\bf IMOK.cpp}\\
%\if0 The file contains a procedure to pass the data such  to OK3 and generate the spherical coordinates.  It also contains a function to pass the three-dimensional deposited energy distribution on a fuel target calculated in OK3 into a two-dimension Lagrangian target.\fi
%The file contains a procedure to transfer the data such as the target temperature and others to OK3. After the deposited energy distribution in OK3 is calculated, it is passed to the Lagrangian code.以下に修正
The file contains a procedure to transfer the Lagrange mesh date. The file sets the initial target surface numerically.

\item {\bf InitMesh\_LC.cpp}\\
The file initializes the Lagrangian coordinates and determines the number of the target layer. The number of the layers can be selected from 1 to 5 layers. The user must set the mesh number of each layer in this file.
\item {\bf InputOK3.h}\\
The input data file contains the target parameters, the HIB parameters. %, target mesh parameters and also the reactor chamber parameters.　削除
\item {\bf Insulation.cpp}\\
The file contains a procedure to calculate the adiabat $\alpha$ to evaluate the fuel preheating \cite{CPC-O-SUKI, ICFBook}. 
\item {\bf Lagrange\_set.cpp}
This function performs auxiliary calculations for spatial differentiation and thermal conductivity calculations in the Lagrange code. 
\item {\bf Legendre.cpp}\\
%The procedure performs the mode analyses based on the Legendre function in order to find the implosion non-uniformity. The analysis results are also output in this procedure. 以下に修正
The procedure performs the mode analyses based on the spherical harmonics in order to find the implosion non-uniformity. The analysis results are also output in this procedure. 
\item {\bf Lr\_LC.cpp}\\
A procedure to calculate the Rosseland mean free path (see Ref. \cite {Zeldovich}). 
\item {\bf MS.cpp}\\
A function to solve matrix by the Gauss elimination method. 
%ここから追記
This function is optimized specifically for Langnge calculations.  
%ここまで追記
\item {\bf MS\_TDMA.cpp}\\
A function to solve matrix by TDMA (TriDiagonal-Matrix Algorithm).
\item {\bf OK3code.cpp}\\
The file is the main routine of the HIBs illumination code of OK3 and contains the following procedures\cite{ogoyski1,ogoyski2,ogoyski3}. The details for each procedure relating to the HIBs illumination code OK3 are found in Ref. \cite{CPC-O-SUKI, ogoyski1, ogoyski2, ogoyski3}. The relating procedures are listed here: Irradiation(), InitEdp1(), Focus(), fDis(), Divider(), kBunch(), PointC(), PointF(), PointAlpha(), BeamCenterRot(), BeamletRot( ), Rotation() and StoppingPower1.cpp. The procedure of StoppingPower1.cpp contains a function Stop1. This function serves a heart of the OK1 code \cite{ogoyski1} and describes the energy deposition model. It calculates the stopping power from the projectile ions into the solid target. The one-ion stopping power is considered to be a sum of the deposition energy in the target nuclei, the target bound and free electrons and the target ions\cite{mehlhorn}. 

\item {\bf PelletSurface.h}\\
The file sets the initial target surface numerically.
\item {\bf RMS.cpp}\\
The procedure in this file calculates the root-mean-square (RMS) deviation in target non uniformity.
\item {\bf ResultIMP.cpp}\\
This file contains a procedure to calculate the implosion velocity.
\item {\bf SLC.cpp}\\
%This file contains a procedure that outputs the time history of each physical quantities obtained by cutting out one of the theta directions. 以下に修正
This file contains the procedure to output the time history of each physical quantity obtained by cutting one each in $\theta$ and $\phi$ directions. The positions of $\theta$ and $\phi$ are changed in "input\_LC.h". 

\item {\bf Acceleration.cpp}\\
A procedure for calculating the target acceleration. 

\item {\bf artv\_LC.cpp}\\
This file contains a procedure calculate the artificial viscosity. When dealing with shock waves propagating in a compressive fluid at a supersonic speed in fluid dynamics simulations, it is impossible to employ sufficient number of multiple meshes to describe the real shock front structure, because its thickness is very thin. As a method, we introduce the following artificial viscosity devised by Von Neumann and Richtmyer\cite{artv}.\\

     The three-dimensional artificial viscosity is written:
 
\begin{equation}
		q_A=\rho c^2_1\left|\displaystyle\frac{\partial }{\partial i}\left(\frac{\partial u}{\partial i}\right)^A_{\_}\right|\left(\frac{\partial u}{\partial i}\right)^A_{\_}\\
		\label{artv_LC1}
\end{equation}
\begin{equation}
		q_B=\rho c^2_1\left|\displaystyle\frac{\partial }{\partial j}\left(\frac{\partial u}{\partial j}\right)^B_{\_}\right|\left(\frac{\partial u}{\partial j}\right)^B_{\_}\\
		\label{artv_LC2}
\end{equation}
\begin{equation}
		q_C=\rho c^2_1\left|\displaystyle\frac{\partial }{\partial k}\left(\frac{\partial u}{\partial k}\right)^C_{\_}\right|\left(\frac{\partial u}{\partial k}\right)^C_{\_}
		\label{artv_LC3}
	\end{equation}
	
	\begin{eqnarray*}
		&&\left(\frac{\partial u}{\partial i}\right)^A_{\_}=\min{\left[\left(\frac{\partial u}{\partial i}\right)^A,0\right]}\nonumber\\
		&&\left(\frac{\partial u}{\partial j}\right)^B_{\_}=\min{\left[\left(\frac{\partial u}{\partial j}\right)^B,0\right]}\nonumber\\
		&&\left(\frac{\partial u}{\partial k}\right)^C_{\_}=\min{\left[\left(\frac{\partial u}{\partial k}\right)^C,0\right]}\nonumber\\
		&&\left(\frac{\partial u}{\partial i}\right)^A=\frac{\bar{\bm R}_i\cdot{\bm u}_i}{\left|\bar{\bm R}_i\right|}\nonumber\\
		&&\left(\frac{\partial u}{\partial j}\right)^B=\frac{\bar{\bm R}_j\cdot{\bm u}_j}{\left|\bar{\bm R}_j\right|}\nonumber\\
		&&\left(\frac{\partial u}{\partial k}\right)^C=\frac{\bar{\bm R}_k\cdot{\bm u}_k}{\left|\bar{\bm R}_k\right|}\nonumber
	\end{eqnarray*}

Here $\bar{\bm R_i}, \bar{\bm R_j}$ and $\bar{\bm R_k}$ are the normal vectors to the $i, j, k$ directions, respectively. $q_A$, $q_B$ and $q_C$ are the artificial viscosities in the directions of $\bar{\bm R_i}$, $\bar{\bm R_j}$ and $\bar{\bm R_k}$, respectively. Equations (\ref{artv_LC1}), (\ref{artv_LC2}) and (\ref{artv_LC3}) are discretized as follows: 
	\begin{eqnarray}
\begin{split}
		&{q_A}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\\
&\left({q_{A1}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+{q_{A2}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+{q_{A3}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+{q_{A4}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right)
\end{split}\\
\begin{split}
		&{q_B}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\\
&\left({q_{B1}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+{q_{B2}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+{q_{B3}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+{q_{A4}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right)
\end{split}\\
\begin{split}
		&{q_C}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\\
&\left({q_{C1}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+{q_{C2}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+{q_{C3}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+{q_{A4}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right)
\end{split}
	\end{eqnarray}
	
	Here, the expression appeared are summarized below: 
	\begin{eqnarray}
		{q_{A1}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddiV^{A1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}diV^{A1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{A2}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddiV^{A2}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}diV^{A2}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{A3}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddiV^{A3}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}diV^{A3}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{A4}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddiV^{A4}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}diV^{A4}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{B1}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddjV^{B1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}djV^{B1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{B2}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddjV^{B2}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}djV^{B2}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{B3}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddjV^{B3}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}djV^{B3}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{B4}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddjV^{B4}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}djV^{B4}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{C1}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddkV^{C1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}dkV^{C1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{C2}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddkV^{C2}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}dkV^{C2}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{C3}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddkV^{C3}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}dkV^{C3}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\\
		{q_{C4}}^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\rho^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}c_1^2ddkV^{C4}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}dkV^{C4}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
	\end{eqnarray}
\small
	\begin{eqnarray*}
		&&diV^{A1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Ri}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial i}}^{n+\frac{1}{2}}_{i+\frac{1}{2},j,k}}{\left|\bar{\bm Ri}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&diV^{A2}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Ri}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial i}}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+1,k}}{\left|\bar{\bm Ri}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&diV^{A3}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Ri}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial i}}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+1,k+1}}{\left|\bar{\bm Ri}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&diV^{A4}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Ri}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial i}}^{n+\frac{1}{2}}_{i+\frac{1}{2},j,k+1}}{\left|\bar{\bm Ri}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&djV^{B1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Rj}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial j}}^{n+\frac{1}{2}}_{i,j+\frac{1}{2},k}}{\left|\bar{\bm Rj}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&djV^{B2}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Rj}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial j}}^{n+\frac{1}{2}}_{i+1,j+\frac{1}{2},k}}{\left|\bar{\bm Rj}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&djV^{B3}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Rj}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial j}}^{n+\frac{1}{2}}_{i+1,j+\frac{1}{2},k+1}}{\left|\bar{\bm Rj}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&djV^{B4}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Rj}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial j}}^{n+\frac{1}{2}}_{i,j+\frac{1}{2},k+1}}{\left|\bar{\bm Rj}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&dkV^{C1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Rk}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial k}}^{n+\frac{1}{2}}_{i,j,k+\frac{1}{2}}}{\left|\bar{\bm Rk}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&dkV^{C2}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Rk}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial k}}^{n+\frac{1}{2}}_{i+1,j,k+\frac{1}{2}}}{\left|\bar{\bm Rk}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}
	\end{eqnarray*}
	\begin{eqnarray*}	
		&&dkV^{C3}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Rk}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial k}}^{n+\frac{1}{2}}_{i+1,j+1,k+\frac{1}{2}}}{\left|\bar{\bm Rk}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&dkV^{C4}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\min{\left[\frac{\bar{\bm Rk}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\cdot{\frac{\partial \bm u}{\partial k}}^{n+\frac{1}{2}}_{i,j+1,k+\frac{1}{2}}}{\left|\bar{\bm Rk}^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|},0\right]}\\
		&&ddiV^{A*}_{i,j+\frac{1}{2},k+\frac{1}{2}}=\left|diV^{A*}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}-diV^{A*}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\right|\\
		&&ddiV^{A*}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{1}{2}\left(ddiV^{A*}_{i,j+\frac{1}{2},k+\frac{1}{2}}+ddiV^{A*}_{i+1,j+\frac{1}{2},k+\frac{1}{2}}\right)\\
		&&ddjV^{B*}_{i+\frac{1}{2},j,k+\frac{1}{2}}=\left|djV^{B*}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}-djV^{B*}_{i+\frac{1}{2},j-\frac{1}{2},k+\frac{1}{2}}\right|\\
		&&ddjV^{B*}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{1}{2}\left(ddjV^{B*}_{i+\frac{1}{2},j,k+\frac{1}{2}}+ddjV^{B*}_{i+\frac{1}{2},j+1,k+\frac{1}{2}}\right)\\
		&&ddkV^{C*}_{i+\frac{1}{2},j+\frac{1}{2},k}=\left|dkV^{C*}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}-dkV^{C*}_{i+\frac{1}{2},j+\frac{1}{2},k-\frac{1}{2}}\right|\\
		&&ddkV^{C*}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{1}{2}\left(ddkV^{C*}_{i+\frac{1}{2},j+\frac{1}{2},k}+ddkV^{C*}_{i+\frac{1}{2},+\frac{1}{2}j,k+1}\right)\\
	\end{eqnarray*}
\normalsize
For the normal vectors to the $ i, j$ and $k$ directions, the outer products are used at  each side as shown in Fig. \ref{fig:qAbm}, and the averaged values are obtained:  
\small
\begin{eqnarray*}\label{vector}
	&&\bar{\bm Ri}^n_{i,j+\frac{1}{2},k+\frac{1}{2}}=\frac{\bar{\bm R_{A1}}^n_{i,j+\frac{1}{2},k+\frac{1}{2}}+\bar{\bm R_{A2}}^n_{i,j+\frac{1}{2},k+\frac{1}{2}}+\bar{\bm R_{A3}}^n_{i,j+\frac{1}{2},k+\frac{1}{2}}+\bar{\bm R_{A4}}^n_{i,j+\frac{1}{2},k+\frac{1}{2}}}{4}\\	
	&&\bar{\bm Rj}^n_{i+\frac{1}{2},j,k+\frac{1}{2}}=\frac{\bar{\bm R_{B1}}^n_{i+\frac{1}{2},j,k+\frac{1}{2}}+\bar{\bm R_{B2}}^n_{i+\frac{1}{2},j,k+\frac{1}{2}}+\bar{\bm R_{B3}}^n_{i+\frac{1}{2},j,k+\frac{1}{2}}+\bar{\bm R_{B4}}^n_{i+\frac{1}{2},j,k+\frac{1}{2}}}{4}\\
	&&\bar{\bm Rk}^n_{i+\frac{1}{2},j+\frac{1}{2},k}=\frac{\bar{\bm R_{C1}}^n_{i+\frac{1}{2},j+\frac{1}{2},k}+\bar{\bm R_{C2}}^n_{i+\frac{1}{2},j+\frac{1}{2},k}+\bar{\bm R_{C3}}^n_{i+\frac{1}{2},j+\frac{1}{2},k}+\bar{\bm R_{C4}}^n_{i+\frac{1}{2},j+\frac{1}{2},k}}{4}
\end{eqnarray*}
\normalsize
\begin{figure}[H]
	\centering
	\includegraphics[width=10cm]{images/avrtAbm.eps}
	\caption{The nomal vector to the $i$ direction}\label{fig:qAbm}
\end{figure}


% \begin{figure}[H]
%	\centering
%	\includegraphics[width=15cm]{images/avrtBbm.png}
%	\caption{The nomal vector of $j$ derection}\label{fig:qBbm}
%\end{figure}
%\begin{figure}[H]
%	\centering
%	\includegraphics[width=15cm]{images/avrtCbm.png}
%	\caption{The nomal vector of $k$ derection}\label{fig:qCbm}
%\end{figure}
%}


%\item {\bf check.cpp}\\
%This file contains a function that checks whether the argument is divergent.？？？
\item {\bf coc\_LC.cpp}\\
The file calculates the Lagrangian mesh dynamics. The Lagrangian meshes move together with the fluid motion. The new position coordinates for each mesh point are renewed at $n+1$. 

%\item {\bf cotc\_define.h}\\
%Define variables for calculating the heat conduction. 未使用につき削除

%\item {\bf cotc\_e.cpp, cotc\_r.cpp}\\　以下に修正
\item {\bf cotc3D\_e.cpp, cotc3D\_r.cpp}\\
For calculation of the heat conduction, the following basic equation is used\cite{Christiansen}.
\begin{eqnarray}
		&&C_{V_k}\frac{DT}{Dt}=\frac{1}{\rho}{\bm \nabla}\cdot(\kappa_k{\bm \nabla}T_k)\ \ \ \ \ \ \ (k=e,r)\\
		%&&\ \ \ \ \kappa_i=4.3\times10^{-12}T^{5/2}_{i}(\log{\Lambda})m^{-1/2}Z^{-4}\ \ [{\rm W/mK}]\nonumber\\
		&&\ \ \ \ \kappa_e=1.83\times10^{-10}T^{5/2}_{e}(\log{\Lambda})^{-1}Z^{-1}\ \ [{\rm W/mK}]\nonumber\\
		&&\ \ \ \ \kappa_r=\frac{16}{3}\sigma L_RT^3_r\ \ [{\rm W/mK}]\nonumber
	\end{eqnarray}
	
\begin{align*}
\kappa&: Heat conductivity\\
T_k&: Ion,\ electron,\ radiation\ temperature[\rm K]\\
\log{\Lambda}&: Coulomb\ logarithm\\
m&: Mass\\
Z&: Ionization\ degree\\
\sigma&: Stefan-Boltzmann\ constant\\
L_R&: \rm {Rosseland\ mean\ free\ path}\\
\end{align*}

Here,  If $\bm S$ is the area vector of each surface of the mesh, the basic equation is transformed as follows: 
	\begin{eqnarray}\label{trans2}
		C_v\frac{DT}{Dt}&=&\frac{1}{\rho}{\bm \nabla}\cdot(\kappa{\bm \nabla}T)\nonumber\\
		\iiint \rho C_v\frac{DT}{Dt}dV&=&\iiint{\bm \nabla}\cdot(\kappa{\bm \nabla}T)dV\nonumber\\
		MC_v\frac{DT}{Dt}&=&\sum_i \left(\kappa{\bm \nabla} T\right)\cdot \bm{S_i}\nonumber\\
		\frac{DT}{Dt}&=&\frac{1}{MC_v}\sum_i 	\bm{S_i} \cdot \left[\frac{\kappa}{J}Di\bm r\frac{\partial T}{\partial i}+\frac{\kappa}{J}Dj\bm r\frac{\partial T}{\partial j}+\frac{\kappa}{J}Dk\bm r\frac{\partial T}{\partial k}\right]\nonumber\\
	\end{eqnarray}
	
Equation (\ref{trans2}) is discretized as follows:
\small
	\begin{eqnarray}\label{trans3}
		\frac{T^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}-T^{n}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{Dt^{n+\frac{1}{2}}}&=&\frac{1}{MC_v}\nonumber\\
		&\times&\left[A_2\Bigl(T^{n+1}_{i+\frac{3}{2},j+\frac{1}{2},k+\frac{1}{2}}-T^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\Bigr)\right.\nonumber\\
		&-&A_1\Bigl(T^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}-T^{n+1}_{i-\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\Bigr)\nonumber\\
		&+&B_2\Bigl(T^{n+1}_{i+\frac{1}{2},j+\frac{3}{2},k+\frac{1}{2}}-T^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\Bigr)\nonumber\\
		&-&B_1\Bigl(T^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}-T^{n+1}_{i+\frac{1}{2},j-\frac{1}{2},k+\frac{1}{2}}\Bigr)\nonumber\\
		&+&C_2\Bigl(T^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{3}{2}}-T^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\Bigr)\nonumber\\
		&-&\left.C_1\Bigl(T^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}-T^{n+1}_{i+\frac{1}{2},j-\frac{1}{2},k-\frac{1}{2}}\Bigr)\right]\nonumber\\
	\end{eqnarray}
\normalsize
Here, the coefficients in Eq. (\ref{trans3}) are listed: 
\small
\begin{eqnarray*}
&&A_2=\Bigl|{Di\bm r}^n_{i+1,j+\frac{1}{2},k+\frac{1}{2}}\Bigr|{\Bigl|\bm{Si}^n_{i+1,j+\frac{1}{2},k+\frac{1}{2}}\Bigr|}\frac{\kappa^n_{i+1,j+\frac{1}{2},k+\frac{1}{2}}}{J^n_{i+1,j+\frac{1}{2},k+\frac{1}{2}}}\\
&&A_1=\Bigl|{Di\bm r}^n_{i,j+\frac{1}{2},k+\frac{1}{2}}\Bigr|{\Bigl|\bm{Si}^n_{i,j+\frac{1}{2},k+\frac{1}{2}}\Bigr|}\frac{\kappa^n_{i,j+\frac{1}{2},k+\frac{1}{2}}}{J^n_{i+1,j+\frac{1}{2},k+\frac{1}{2}}}\\
&&B_2=\Bigl|{Dj\bm r}^n_{i+\frac{1}{2},j+1,k+\frac{1}{2}}\Bigr|{\Bigl|\bm{Sj}^n_{i+\frac{1}{2},j+1,k+\frac{1}{2}}\Bigr|}\frac{\kappa^n_{i+\frac{1}{2},j+1,k+\frac{1}{2}}}{J^n_{i+\frac{1}{2},j+1,k+\frac{1}{2}}}\\
&&B_1=\Bigl|{Dj\bm r}^n_{i+\frac{1}{2},j,k+\frac{1}{2}}\Bigr|{\Bigl|\bm{Sj}^n_{i+\frac{1}{2},j,k+\frac{1}{2}}\Bigr|}\frac{\kappa^n_{i+\frac{1}{2},j,k+\frac{1}{2}}}{J^n_{i+\frac{1}{2},j,k+\frac{1}{2}}}\\
&&C_2=\Bigl|{Dk\bm r}^n_{i+\frac{1}{2},j+\frac{1}{2},k+1}\Bigr|{\Bigl|\bm{Sk}^n_{i+\frac{1}{2},j+\frac{1}{2},k+1}\Bigr|}\frac{\kappa^n_{i+\frac{1}{2},j+\frac{1}{2},k+1}}{J^n_{i+\frac{1}{2},j+\frac{1}{2},k+1}}\\
&&C_1=\Bigl|{Dk\bm r}^n_{i+\frac{1}{2},j+\frac{1}{2},k}\Bigr|{\Bigl|\bm{Sk}^n_{i+\frac{1}{2},j+\frac{1}{2},k}\Bigr|}\frac{\kappa^n_{i+\frac{1}{2},j+\frac{1}{2},k}}{J^n_{i+\frac{1}{2},j+\frac{1}{2},k}}\\
\end{eqnarray*}
\normalsize
	
	
\item {\bf define\_LC.h}\\
It contains the procedure declarations for the Lagrangian code and Ok3. 

\item {\bf dif\_LC.cpp}\\
The following Lagrangian equation of motion is used.
\begin{equation}\label{dme}
		\rho\frac{D\bm u}{Dt}=-{\bm\nabla}(P+q)
	\end{equation}
Equation (\ref {dme}) is expressed as follows: 
	\begin{equation}
\begin{split}\label{dmeu}
\frac{D\bm u}{Dt}\bigg|^n_{i,j,k}&
=-\frac{1}{\rho}\frac{\partial}{\partial \bm r} (P+q)\\&
=-\frac{1}{M^n_{i,j,k}}\left[Di\bm r\frac{\partial}{\partial i}(P+q_A)+Di\bm r\frac{\partial}{\partial j}(P+q_B)+Di\bm r\frac{\partial}{\partial k}(P+q_C)\right]^n_{i,j,k}\\&
\end{split}
\end{equation}
Equation (\ref{dmeu}) is discretized as follows: 

\small
	\begin{eqnarray}
		\bm u^{n+\frac{1}{2}}_{i,j,k}=\bm u^{n-\frac{1}{2}}_{i,j,k} - \frac{Dt^n}{M^n_{i,j,k}}\left[Di\bm r\frac{\partial}{\partial i}(P+q_A)+Di\bm r\frac{\partial}{\partial j}(P+q_B)+Di\bm r\frac{\partial}{\partial k}(P+q_C)\right]^n_{i,j,k}
		\label{dmeu2}
	\end{eqnarray}
\normalsize

Here, each term is shown: 
\begin{equation}
\begin{split}
Di\bm r\frac{\partial}{\partial i}(P+q_A)\bigg|^n_{i,j,k}&=
\frac{1}{4}\left[Di\bm r\frac{\partial}{\partial i}(P+q_{A1})\right]_{i,j+\frac{1}{2},k+\frac{1}{2}}\\&
+\frac{1}{4}\left[Di\bm r\frac{\partial}{\partial i}(P+q_{A2})\right]_{i,j-\frac{1}{2},k+\frac{1}{2}}\\&
+\frac{1}{4}\left[Di\bm r\frac{\partial}{\partial i}(P+q_{A3})\right]_{i,j-\frac{1}{2},k-\frac{1}{2}}\\&
+\frac{1}{4}\left[Di\bm r\frac{\partial}{\partial i}(P+q_{A4})\right]_{i,j+\frac{1}{2},k-\frac{1}{2}}\\
\end{split}
\end{equation}

\begin{equation}
\begin{split}
Dj\bm r\frac{\partial}{\partial j}(P+q_B)\bigg|^n_{i,j,k}&=
\frac{1}{4}\left[Dj\bm r\frac{\partial}{\partial j}(P+q_{B1})\right]_{i+\frac{1}{2},j,k+\frac{1}{2}}\\&
+\frac{1}{4}\left[Dj\bm r\frac{\partial}{\partial j}(P+q_{B2})\right]_{i-\frac{1}{2},j,k+\frac{1}{2}}\\&
+\frac{1}{4}\left[Dj\bm r\frac{\partial}{\partial j}(P+q_{B3})\right]_{i-\frac{1}{2},j,k-\frac{1}{2}}\\&
+\frac{1}{4}\left[Dj\bm r\frac{\partial}{\partial j}(P+q_{B4})\right]_{i+\frac{1}{2},j,k-\frac{1}{2}}\\
\end{split}
\end{equation}

\begin{equation}
\begin{split}
Dk\bm r\frac{\partial}{\partial k}(P+q_C)\bigg|^n_{i,j,k}&=
\frac{1}{4}\left[Dk\bm r\frac{\partial}{\partial k}(P+q_{C1})\right]_{i+\frac{1}{2},j+\frac{1}{2},k}\\&
+\frac{1}{4}\left[Dk\bm r\frac{\partial}{\partial k}(P+q_{C2})\right]_{i-\frac{1}{2},j+\frac{1}{2},k}\\&
+\frac{1}{4}\left[Dk\bm r\frac{\partial}{\partial k}(P+q_{C3})\right]_{i-\frac{1}{2},j-\frac{1}{2},k}\\&
+\frac{1}{4}\left[Dk\bm r\frac{\partial}{\partial k}(P+q_{C4})\right]_{i+\frac{1}{2},j-\frac{1}{2},k}\\
\end{split}
\end{equation}
	
\item {\bf dt\_LC.cpp}\\
This procedure calculates and controls the time step to satisfy the numerical stability condition. The time step $ \Delta t $ in the calculation must satisfy the following conditions.
	\begin{equation}
	\label{eq:Courant}
		\Delta t=\frac{\Delta r}{C_{S}+V_{max}}
	\end{equation}
The time step for the Lagrangian method $ Dt ^ {n + \frac {1}{2}} $ is represented by the following expression.
	\begin{equation}
		Dt^{n+\frac{1}{2}}=\alpha\displaystyle\frac{dr_{min}}{C_S+V_{max}}
	\end{equation}
		\begin{tabbing}
		12345678901234567890123\=789\=12345\=\kill\\
		\>\>$\alpha$\>: Numerical coefficient constant $(\alpha\leq1)$\\
		\>\>$dr_{min}$\>: the minimum grid spacing\\
		\>\>$C_S$\>: Sound speed\\
		\>\>$V_{max}$\>: the maximum flow speed\\
	\end{tabbing}
	
\item {\bf eoenergy\_LC.cpp}\\
The file contains a procedure for calculation of the energy equation. The following Lagrangian energy equation is used except for the heat conductions terms.
	\begin{eqnarray}
	\label{EoEkiso}
	\begin{cases}
		\frac{DT_i}{Dt}=-\frac{k_B}{C_{V_i}}\left[B_{T_i}\frac{D\rho}{Dt}+\frac{p_i+q}{M}\frac{DJ}{Dt}\right]\\
		\frac{DT_e}{Dt}=-\frac{k_B}{C_{V_e}}\left[B_{T_e}\frac{D\rho}{Dt}+\frac{p_e}{M}\frac{DJ}{Dt}\right]\\
		\frac{DT_r}{Dt}=-\frac{k_B}{C_{V_r}}\left[B_{T_r}\frac{D\rho}{Dt}+\frac{p_r}{M}\frac{DJ}{Dt}\right]
	\end{cases}
	\end{eqnarray}
Equation (\ref{EoEkiso}) is discretized as follows: 
	\small \begin{eqnarray}
		T^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}&=&T^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\nonumber\\
		&-&\frac{1}{{C_V}^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2}k+\frac{1}{2}}}\Bigg[{B_T}^{n+1}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}(\rho^{n+1}_{i+\frac{1}{2},j+\frac{1}{2}k+\frac{1}{2}}-\rho^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}})\nonumber\\
		&+&\frac{P^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}+q^{n+\frac{1}{2}}_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}{M_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}}(J^{n+1}_{i+\frac{1}{2},j+\frac{1}{2}k+\frac{1}{2}}-J^n_{i+\frac{1}{2},j+\frac{1}{2}k+\frac{1}{2}})\Bigg]\nonumber
	\end{eqnarray}
	
\normalsize	
\item {\bf eos.cpp}\\
The file contains the procedures to calculate the equation of state. The equation of state for ions is the ideal one. For the equation of state for electrons and the ionization, we use the equation of state based on the Thomas-Fermi model shown in Ref. \cite{Bell}. Users can select the Thomas-Fermi model or the ideal equation of state in the header file of "input\_LC.h". For the equation of state for the radiation, we use the equilibrium blackbody equations \cite{Zeldovich}. 
	
\item {\bf init\_LC.h}\\
It contains the initial conditions such as the initial target temperature and so on. 

\item {\bf init\_matrix\_LC.cpp}
The file get the matrix.


\item {\bf input\_LC.h}\\
%The input data for Lagrangian code contains the target layer thickness, the input beam pulse, the beam radius and so on. 以下に修正
The input data for Lagrangian code contains radius, $\theta$ and $\phi$ direction mush number, each layers mesh number,HIB number, beam pulse parameters, fuel target structure,  output date step, etc. 

\item {\bf jacobian\_LC.cpp}\\
 The volume of each mesh is calculated. The Jacobian $J$ is expressed by the following formula. 
\begin{eqnarray}\label{jaco}
\begin{split}
	J
	&=\frac{\partial (x,y,z)}{\partial (i,j,k)}\\
	&=\left[
	\begin{array}{rrr}
	\frac{\partial x}{\partial i} & \frac{\partial x}{\partial j} & \frac{\partial x}{\partial k} \\
	\frac{\partial y}{\partial i} & \frac{\partial y}{\partial j} & \frac{\partial y}{\partial k} \\
	\frac{\partial z}{\partial i} & \frac{\partial z}{\partial j} & \frac{\partial z}{\partial k} 
	\end{array}
	\right]\\
	&=\frac{\partial x}{\partial i}\frac{\partial y}{\partial j}\frac{\partial z}{\partial k}+\frac{\partial x}{\partial j}\frac{\partial y}{\partial k}\frac{\partial z}{\partial i}+\frac{\partial x}{\partial k}\frac{\partial y}{\partial i}\frac{\partial z}{\partial j}
	-\frac{\partial x}{\partial k}\frac{\partial y}{\partial j}\frac{\partial z}{\partial i}-\frac{\partial x}{\partial j}\frac{\partial y}{\partial i}\frac{\partial z}{\partial k}-\frac{\partial x}{\partial i}\frac{\partial y}{\partial k}\frac{\partial z}{\partial j}
\end{split}
\end{eqnarray}
	From Eq. (\ref {jaco}), the Jacobian is expressed as follows: 
	\begin{eqnarray}\label{Ja_R}
	J^n_{k+\frac{1}{2},l+\frac{1}{2},m+\frac{1}{2}}&=&
\left(\frac{\partial x}{\partial i}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial y}{\partial j}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial z}{\partial k}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\nonumber\\
&+&\left(\frac{\partial x}{\partial j}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial y}{\partial k}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial z}{\partial i}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\nonumber\\
&+&\left(\frac{\partial x}{\partial k}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial y}{\partial i}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial z}{\partial j}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\nonumber\\
&-&\left(\frac{\partial x}{\partial k}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial y}{\partial j}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial z}{\partial i}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\nonumber\\
&-&\left(\frac{\partial x}{\partial j}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial y}{\partial i}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial z}{\partial k}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\nonumber\\
&-&\left(\frac{\partial x}{\partial i}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial y}{\partial k}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}
\left(\frac{\partial z}{\partial j}\right)^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}\nonumber
\end{eqnarray}
	Here, each term is obtained: 
\begin{eqnarray}
\begin{cases}
&(\frac{\partial x_{i,j,k}}{\partial i})^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{\Delta_i x^n_{i+\frac{1}{2},j+1,k}+\Delta_i x^n_{i+\frac{1}{2},j,k+1}+\Delta_i x^n_{i+\frac{1}{2},j+1,k+1}+\Delta_i x^n_{i+\frac{1}{2},j,k}}{4}\\
&(\frac{\partial x_{i,j,k}}{\partial j})^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{\Delta_j x^n_{i+1,j+\frac{1}{2},k}+\Delta_j x^n_{i,j+\frac{1}{2},k+1}+\Delta_j x^n_{i+1,j+\frac{1}{2},k+1}+\Delta_j x^n_{i,j+\frac{1}{2},k}}{4}\\
&(\frac{\partial x_{i,j,k}}{\partial k})^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{\Delta_k x^n_{i+1,j,k+\frac{1}{2}}+\Delta_k x^n_{i,j+1,k+\frac{1}{2}}+\Delta_k x^n_{i+1,j+1,k+\frac{1}{2}}+\Delta_k x^n_{i,j,k+\frac{1}{2}}}{4}\\
&(\frac{\partial y_{i,j,k}}{\partial i})^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{\Delta_i y^n_{i+\frac{1}{2},j+1,k}+\Delta_i y^n_{i+\frac{1}{2},j,k+1}+\Delta_i y^n_{i+\frac{1}{2},j+1,k+1}+\Delta_i y^n_{i+\frac{1}{2},j,k}}{4}\\
&(\frac{\partial y_{i,j,k}}{\partial j})^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{\Delta_j y^n_{i+1,j+\frac{1}{2},k}+\Delta_j y^n_{i,j+\frac{1}{2},k+1}+\Delta_j y^n_{i+1,j+\frac{1}{2},k+1}+\Delta_j y^n_{i,j+\frac{1}{2},k}}{4}\\
&(\frac{\partial y_{i,j,k}}{\partial k})^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{\Delta_k y^n_{i+1,j,k+\frac{1}{2}}+\Delta_k y^n_{i,j+1,k+\frac{1}{2}}+\Delta_k y^n_{i+1,j+1,k+\frac{1}{2}}+\Delta_k y^n_{i,j,k+\frac{1}{2}}}{4}\\
&(\frac{\partial z_{i,j,k}}{\partial i})^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{\Delta_i z^n_{i+\frac{1}{2},j+1,k}+\Delta_i z^n_{i+\frac{1}{2},j,k+1}+\Delta_i z^n_{i+\frac{1}{2},j+1,k+1}+\Delta_k z^n_{k+\frac{1}{2},l,m}}{4}\\
&(\frac{\partial z_{i,j,k}}{\partial j})^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{\Delta_j z^n_{i+1,l+\frac{1}{2},k}+\Delta_j z^n_{i,j+\frac{1}{2},k+1}+\Delta_j z^n_{i+1,j+\frac{1}{2},k+1}+\Delta_j z^n_{i,j+\frac{1}{2},k}}{4}\\
&(\frac{\partial z_{i,j,k}}{\partial k})^n_{i+\frac{1}{2},j+\frac{1}{2},k+\frac{1}{2}}=\frac{\Delta_k z^n_{i+1,j,k+\frac{1}{2}}+\Delta_k z^n_{i,j+1,k+\frac{1}{2}}+\Delta_k z^n_{i+1,j+1,k+\frac{1}{2}+}\Delta_k z^n_{i,j,k+\frac{1}{2}}}{4}
\end{cases}
\end{eqnarray}

\item {\bf main\_LC.cpp}\\
%The main procedure of the Lagrangian fluid code. 以下に修正
The main procedure of the Lagrangian fluid code. If you want to artificially add non-uniformity in the $\theta$ and $\phi$ directions without using the OK3 code, change it here. 
\item {\bf outputRMS.cpp}\\
It contains a procedure to output the results for the RMS non-uniformity.
\item {\bf output\_LC.cpp}\\
The result data are stored by this procedure. The time interval of data output is 0.1 ns in the Lagrangian code. The user can adjust the output step in "input\_LC.h". The physical quantity (for example, velocity) defined at the grid points of the mesh is output to outputS1. The physical quantity defined at the center of the mesh (for example, temperature, density) is output to outputS2. 
\item {\bf output\_to\_EulerCode.cpp}\\
This file contains a procedure for outputting the data used in Euler code. After the beam irradiation is completed, the file is output every 0.1ns. 
\item {\bf relax.cpp}\\
The following equation is used as the basic equation for the temperature relaxation\cite{Tahir}. 
	\begin{eqnarray}
		\begin{cases}
			C_{V_i}\frac{dT_i}{dt}=-K_{ie}\\
			C_{V_e}\frac{dT_e}{dt}=K_{ie}-K_{re}\\
			C_{V_r}\frac{dT_r}{dt}=K_{re}
		\end{cases}
	\end{eqnarray}

Here, $K_{ie}$ is the energy exchange rate between the ions and the electrons,  and $K_{re}$ the energy exchange rate between the radiation and the electrons.
\begin{eqnarray}
	\begin{cases}
		K_{ie}=C_{V_i}\omega_{ie}(T_i-T_e)\\
		K_{re}=C_{V_r}\omega_{re}(T_e-T_r)
	\end{cases}
	\end{eqnarray}
	$ \omega_{ie}$ and $ \omega_{re} $ are the collision frequencies between the ions and the electrons and between the radiation and the electrons, respectively. They are obtained by the following formulae: The Compton effect  between the radiation and the electrons is included. Each expression and the solution method are found in Refs. \cite{Tahir, CPC-O-SUKI}. 

%\item {\bf relax\_define.h}\\
I%t contains the procedure declarations for the temperature relaxation. 未使用につき削除

\end{enumerate}
%\include{end}
