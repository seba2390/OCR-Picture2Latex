%\documentclass[preprint,12pt]{elsarticle}
%\include{begin}

\section{O-SUKI-N 3D code algorithm description}
\par

\subsection{O-SUKI-N 3D code structure}
     The O-SUKI-N 3D code system consists of three parts: The Lagrangian fluid code \cite{Schulz}, the data conversion code from the Lagrangian code to the Euler code, and Euler code. The fluid model is the three-temperature model in Ref. \cite{Tahir}. The Lagrangian fluid code, the data conversion code and the Euler code are described below in detail. 
     
     In the Lagrangian fluid code the spatial meshes move together with the fluid motion \cite{Schulz}. However, the Lagrange meshes can not follow the fluid large deformation. On the other hand, the Euler meshes are fixed to the space, and the fluid moves through the meshes. Therefore, just before the void closure time, that is, the stagnation phase, the Lagrangian code is used to simulate the DT fuel implosion. After the void closure time, the Euler code is employed to simulate the DT fuel further compression, ignition and burning. Between the Lagrangian code and the Euler code the data should be converted by the data conversion code. 

	All the simulation process is performed in its integrated way by using the script of "CodeO-SUKI-N-fusion-start.sh". The processes executed by this shell script are as follows: \\
1. Make the stack size infinite.\\
2. Remove all output data file and make the new output files.\\
3. Change the permission of shell scripts to executable. \\
4. Compile the main function of the Lagrangian code and execute it.\\
5. If any problems do not appear during the calculation of the Lagrangian code, compile the main function of the data conversion code and execute it.\\
6. If there is no problem during the data conversion, compile the main function of the Euler code and execute it.\\
     

\subsection{Steps in Lagrangian code}\par
     The Lagrangian code has the following steps: 

\begin{enumerate}
\item Initialize the variables and calculation of total input energy. \par
\item Calculation of time step size.\par
\item Calculation of coordinates.\par
\item Solve equation of motion. \par
\item Solve density by equation of continuity.\par
\item Calculation of artificial viscosity.\par
\item Transfer the data to the OK3. \par
\item Calculation of energy deposition distribution in code OK3. For details of the OK3, see the refs.\cite{ogoyski1,ogoyski2,ogoyski3}. \par
\item Solve energy equations\par
\item Calculation of heat conduction\par
\item Calculation of temperature relaxation among three temperatures.\par
\item Solve equation of state\par
\item Save the results.\par
\item End the Lagrangian calculation right before the void closure.\par
\item Transfer the data to converting code. \par
\end {enumerate}


\subsection{Data Conversion code from Lagrangian fluid code to Euler fluid code}

\begin {enumerate}
\item Read variables saved in Lagrangian code.\par
\item Generate the Eulerian mesh.\par
\item Calculate the interpolation of the physical quantity to them on the Eulerian mesh.\par
\item Write the converted data to the Eulerian code.\par
\end {enumerate}


\subsection{Steps in Eulerian code}

\begin {enumerate}
\item Read the mesh number from the converted data and define the each matrices.\par
\item Initialize the variables.\par
\item Calculation of time step size.\par
\item Solve equation of motion. \par
\item Track the material boundaries of DT, Al and Pb.\par
\item Linearly interpolate the boundary lines and transcribe them on the Eulerian code. \par
\item Discriminate the materials by using the transferred boundary line. \par
\item Solve density by equation of continuity.\par
\item Calculate artificial viscosity.\par
\item Solve energy equations\par
\item Calculation of fusion reaction.\par
\item Calculation of heat conduction\par
\item Calculation of temperature relaxation among three temperatures.\par
\item Solve equation of state.\par
\item Save the results.\par
\item End.
\end{enumerate}

%\include{end}