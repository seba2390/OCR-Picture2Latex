%\documentclass[preprint,12pt]{elsarticle}
%\include{begin}

\section{Testing the program O-SUKI-N 3D}
The several tests are shown below to present the target fuel implosion dynamics. In the example cases, the HIBs and the target fuel have the following common parameters, which are the same values employed in Ref. \cite{CPC-O-SUKI}: the beam radius at the entrance of a reactor chamber $R_{en}$ = 35 mm, the beam particle density distribution is in the Gaussian profile and all projectile Pb ions have 8 GeV. The target is a multilayered pellet, in which the pellet outer radius is 4 mm, a Pb layer thickness is 0.029 mm, the Al thickness is 0.460 mm, and the DT thickness is 0.083 mm; the Pb, Al and DT layers have the radial mesh numbers of 4, 46 and 30 in these example cases, respectively, and the total mesh number in the theta direction is 90. The input beam pulse is shown in Fig. 12 in Ref. \cite{CPC-O-SUKI}. The beam radius is 3.8mm on the target surface. However, $R_b$ = 3.8mm changes at $\tau_{wb}$ to 3.7mm for the wobbling beam irradiation. Here $\tau_{wb}$ is the rotational period of the beam axis. The rotational frequency is 424MHz ($rotaionnumber$ = 11). 



%% INPUT PULSE  
%\begin{figure}[H]
%		\centering
%		\includegraphics[width=10cm]{images/pulse.eps}
%		\caption{An example for the input beam pulse.}\label{pulse}
%\end{figure}



First the 3D Langrange code was run without the OK3 illumination code. This is the case for $OK\_Switch=10$, and we added the artificial non-uniformity $Y_3^2$ (the spherical harmonics) with the amplitude of $30.0\%$. In Fig. \ref{NoOK3_23_Ti} the ion temperature distribution is shown at $t$=35ns, and in Fig. \ref{NoOK3_23_rho} the mass density distribution is presented at $t$=35ns. The target shape is largely distorted due to the non-uniformity of the HIBs deposition energy distribution.  


%% LAGRANGE CASE WITHOUT OK3
\begin{figure}[H]
		\centering
		\includegraphics[width=10cm]{images/NoOK3_Non23_30_35ns_Ti.eps}
		\caption{Ion temperature in the 3D Lagrange code without OK3 code at $t$=35ns. The non-uniformity distiribution is $Y_3^2$ with the amplitude of $30\%$.}\label{NoOK3_23_Ti}
\end{figure}
\begin{figure}[H]
		\centering
		\includegraphics[width=10cm]{images/NoOK3_Non23_30_35ns_rho.eps}
		\caption{Mass density in the 3D Lagrange code without OK3 code at $t$=35ns. The non-uniformity distriution is $Y_3^2$ with the amplitude of $30\%$.}\label{NoOK3_23_rho}
\end{figure}


We also performed run-through simulation tests. In the example cases, the OK3 code was coupled with the run-through simulations. The implosion data were obtained by the Lagrange code, and the data just before the void closure time were transferred to the Euler code through the data Conversion code. Two cases are computed for the target fuel implosion dynamics with the spiral wobbling or without the oscillating HIBs. These examples are the run-through simulations with the OK3 illumination code ($OK\_Switch = 1$). The input beam pulse, employed in the run-through tests, is shown in Fig. \ref {Beam}. This beam input energy is 5.4MJ. We show the $r-t$ diagram for the case without the HIBs wobbling in Fig. \ref{rt}. The Lagrange-code test results stored in the output directory are visualized in Figs. \ref {fusion_Ti} for the target ion temperature ($T_i$) distributions at $t$ = 0.0, 15.0, 20.0 and 22.5 ns for the case with the HIBs wobbling behavior.  The RMS non-uniformity results are shown in Figs. \ref{fusion_RMS} (a) for DT layer's Ion temperature($T_i$), (b) for DT layer's Mass density($\rho$), (c) for Al layer's Ion temperature($T_i$) and (d) for Al layer's Mass density($\rho$). 
%
When the HIBs have the wobbling motion during the implosion with the wobbling frequency of 424MHz, the radius acceleration distributions are shown in Figs. \ref{Vr_tp} (a) in the $\theta$ direction and (b) in the $\phi$ direction at $t=6.25t_w=11.2ns$ (solid lines) and at $t=6.75t_w=12.2ns$ (dotted lines). Here $t_w$ shows the one rotation time. Figures \ref{Vr_tp} present that the non-uniformity phase of the implosion acceleration is controlled externally by the HIBs wobbling behavior \cite{CPC-O-SUKI, RSato2}.  
%

\begin{figure}[H]
		\centering
		\includegraphics[width=7.5cm]{images/Beam.eps}
		\caption{Input beam pulse shape used in the example run-through tests.}\label{Beam}
\end{figure}
\begin{figure}[H]
		\centering
		\includegraphics[width=8cm]{images/YesWob_SLC.eps}
		\caption{The $r-t$ diagram for the implosion with the HIBs wobbling illumination. The black line area shows the Pb layer, the blue line area Al and the red line area is DT.}\label{rt}
\end{figure}
\begin{figure}[H]
		\centering
		\includegraphics[width=6.5cm]{images/YesWob_Ti_0ns.eps}
		\includegraphics[width=6.5cm]{images/YesWob_Ti_15ns.eps}\\
		\includegraphics[width=6.5cm]{images/YesWob_Ti_20ns.eps}
		\includegraphics[width=6.5cm]{images/YesWob_Ti_225ns.eps}\\
		\caption{Ion temperature distributions in the example run-through test with the HIBs wobbling illumination at (a) $t$=0.0ns, (b) 15.0ns, (c) 20.0ns and (d) 22.5ns.}\label{fusion_Ti}
\end{figure}
\begin{figure}[H]
		\centering
		\includegraphics[width=6.5cm]{images/FusionRMS_DTTi.eps}
		\includegraphics[width=6.5cm]{images/FusionRMS_DTrho.eps}\\
		\includegraphics[width=6.5cm]{images/FusionRMS_AlTi.eps}
		\includegraphics[width=6.5cm]{images/FusionRMS_Alrho.eps}\\
		\caption{RMS non-uniformity histories of (a) the DT ion temperature, (b) the DT mass density, (c) the Al ion temperature and (d) the Al mass density for the cases with the wobbling HIBs (solid lines) and without the wobbling HIBs (dotted lines).}\label{fusion_RMS}
\end{figure}
%
\begin{figure}[H]
		\centering
		\includegraphics[width=6.5cm]{images/theta-Vr.eps}
		\includegraphics[width=6.5cm]{images/phi-Vr.eps}\\
		\caption{Radial acceleration distributions in (a) $\theta$ and (b) $\phi$. The solid lines show the acceleration ditributions at $t=6.25t_w=11.3ns$, and the dotted lines at $t=6.75t_w=12.2ns$.}\label{Vr_tp}
\end{figure}
%

After the Lagrange code computation, the implosion data are converted and transferred to the Euler code. Figures \ref{Ti_EuWobblIgnited} show the ion temperature distributions by the Euler code. Figures \ref{Ti_EuWobblIgnited} show that the DT fuel is ignited and the gain obtained is about 17.5 in this example case. For a realistic HIF reactor design, the implosion parameters should be further optimized to obtain a sufficient gain, which should be larger than 30$\sim$40 in HIF \cite{CPC-O-SUKI, Kawata1, Kawata2, RSato2}. 

\begin{figure}[H]
		\centering
		\includegraphics[width=13cm]{images/EuWobblIgnited.eps}
		\caption{Ion temperature distributions (a) at $t=$24.88ns, (b) at 28.44ns and at 29.21ns.}\label{Ti_EuWobblIgnited}
\end{figure}

\if0
In Fig. \ref{NoOK3_03_Ti}, a non-uniform energy deposition of the HIBs illumination is introduced based on the spherical harmonics $Y_3^0$ with the amplitude of $3.0\%$ in the 3D Lagrange code. The implosion data was obtained by the Lagrange code, and the data just before the void closure time were transferred to the Euler code through the data Conversion code.  Figure \ref{Ti_Eu_Y03} shows the ion temperature distributions  by the Euler code at (a) at $t$=36.36ns, (b) 36.57ns, (c) 41.32ns and (d) 42.41ns. In this example case the DT fuel is not yet ignited due to the insufficient ion temperature. 

\begin{figure}[H]
		\centering
		\includegraphics[width=8.5cm]{images/NoOK3_Non03_03_35ns_Ti.eps}
		\caption{Ion temperature in the 3D Lagrange code without OK3 code at $t$=35ns. The non-uniformity distriution is $Y_3^0$ with the amplitude of $3\%$.}\label{NoOK3_03_Ti}
\end{figure}


%% TIME VS ION TEMPERATURE Euler Y03
\begin{figure}[H]
		\centering
		\includegraphics[width=6.5cm]{images/ion_Eu_Y03_36_36ns.eps}
		\includegraphics[width=6.5cm]{images/ion_Eu_Y03_36_57ns.eps} \\
		\includegraphics[width=6.5cm]{images/ion_Eu_Y03_41_32ns.eps}
		\includegraphics[width=6.5cm]{images/ion_Eu_Y03_42_41ns.eps} \\
		\caption{Ion temperature distributions under a non-uniform energy deposition based on the spherical harmonics $Y_0^3$ by the Euler code,  (a) at $t$=36.36ns, (b) 36.57ns, (c) 41.32ns and (d) 42.41ns.}\label{Ti_Eu_Y03}
\end{figure}
\fi


In order to check the accuracy of the 3D Euler code, we also performed the Euler code tests, using the initial conditions of the 2D Euler code. The initial conditions in the Euler code are the output of the Lagrangian code.  To this end, the 2D Euler initial conditions were converted into 3D. Therefore, the physical values are uniform in the $\phi$ direction. The Lagrangian test 2D results for the target ion temperature ($T_i$) and the mass density ($\rho$) distribution at $t$ = 29 ns are shown in Figs. 14 and 15 in Ref. \cite{CPC-O-SUKI} for the cases with and without the wobbling HIBs.  The 2D Eulerian test results for the fusion energy gain is shown in Fig. 16 in Ref. \cite{CPC-O-SUKI}.  In Fig. \ref{Ti_Eu_3d} we show the ion temperature distributions by the 3D Euler code. The wobbling HIBs are not used in this simulation. In this case the fuel is ignited at $t \sim $30.1ns. The histories of the fusion gain $G$ of the 2D code and the 3D code are shown in Fig. \ref{FusionGain_Eu}. The fusion gain was 52.5 by the 2D code and 57.6 by the 3D code. In addition, we also did another test for the wobbling HIBs (see Figs. 15 and 16 in Ref. \cite{CPC-O-SUKI}), and the fusion gain was 76.1 in 2D \cite{CPC-O-SUKI} and 67.4 in 3D. The results would confirm that the 3D Euler code reproduces the 2D results successfully for the ignition time and the fusion gain obtained. 


%% TIME VS ION TEMPERATURE Euler
\begin{figure}[H]
		\centering
		\includegraphics[width=6.5cm]{images/ion_Eu_30_42ns.eps}
		\includegraphics[width=6.5cm]{images/ion_Eu_30_53ns.eps} \\
		\includegraphics[width=6.5cm]{images/ion_Eu_32_35ns.eps}
		\includegraphics[width=6.5cm]{images/ion_Eu_32_58ns.eps} \\
		\caption{Ion temperature distributions by the 3D Euler code without the HIBs wobbling at (a) $t$=30.42ns, (b) 30.53ns, (c) 32.35ns and (d) 32.58ns}\label{Ti_Eu_3d}
\end{figure}


%% ENERGY GAIN Euler
\begin{figure}[H]
		\centering
		\includegraphics[width=11cm]{images/FusionGain_Eu.eps}
		\caption{Fusion energy gain curves for the cases with 3D code (a solid line) and with 2D code (a dotted line).}\label{FusionGain_Eu}
\end{figure}

We also simulated the double-cone ignition scheme\cite{Double-cone} using a 3D Euler code. The double-cone ignition scheme was proposed by Prof. Jie Zhang \cite{Double-cone}, and the two compressed DT clouds are created by the gold cones. The two DT spherical clouds collide each other like the impact fusion \cite{Winterberg}. In this example case, the compressed DT maximum density of the DT fuel is set to be $1.0\times 10^5$[kg/m$^3$] with the Gaussian spatial distribution. The DT ignition will be attained by an additional heating, which is not taken into consideration in this example. The ion, electron and radiation temperatures are 10[eV] initially in the Euler code. The radius of the fuel is 92[$\mu$m] and the mass was $0.1$[mg]. We set the colliding speed $w$ of the two DT fuel clouds to $3.0\times10^5$ [m/s]. The ion temperature distributions are shown in Fig. \ref{Double_cone_Ti}.


%% DOUBLE-CONE
\begin{figure}[H]
		\centering
		\includegraphics[width=6.5cm]{images/double_cone_0ns.eps}
		\includegraphics[width=6.5cm]{images/double_cone_15_06ns.eps} \\
		\includegraphics[width=6.5cm]{images/double_cone_29_80ns.eps}
		\includegraphics[width=6.5cm]{images/double_cone_46_78ns.eps} \\
		\caption{Ion temperature distributions for the Double-cone ignition scheme \cite{Double-cone} at (a) $t$=0.0ns, (b) 15.06ns, (c) 29.80ns and (d) 46.78ns.}\label{Double_cone_Ti}
\end{figure}

	
%\include{end}