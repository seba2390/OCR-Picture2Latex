% ---------------------------------------------------------------------------
% Author guideline and sample document for EG publication using LaTeX2e input
% D.Fellner, v1.13, Nov 13, 2007

\documentclass{egpubl}

% --- for  Annual CONFERENCE
% \ConferenceSubmission % uncomment for Conference submission
% \ConferencePaper      % uncomment for (final) Conference Paper
% \STAR                 % uncomment for STAR contribution
% \Tutorial             % uncomment for Tutorial contribution
% \ShortPresentation    % uncomment for (final) Short Conference Presentation
%
% --- for  CGF Journal
 \JournalSubmission    % uncomment for submission to Computer Graphics Forum
% \JournalPaper         % uncomment for final version of Journal Paper
%
% --- for  CGF Journal: special issue
% \SpecialIssueSubmission    % uncomment for submission to Computer Graphics Forum, special issue
% \SpecialIssuePaper         % uncomment for final version of Journal Paper, special issue
%
% --- for  EG Workshop Proceedings
% \WsSubmission    % uncomment for submission to EG Workshop
% \WsPaper         % uncomment for final version of EG Workshop contribution
%
 \electronicVersion % can be used both for the printed and electronic version

% !! *please* don't change anything above
% !! unless you REALLY know what you are doing
% ------------------------------------------------------------------------

% for including postscript figures
% mind: package option 'draft' will replace PS figure by a filname within a frame
\ifpdf \usepackage[pdftex]{graphicx} \pdfcompresslevel=9
\else \usepackage[dvips]{graphicx} \fi

\PrintedOrElectronic

% prepare for electronic version of your document
\usepackage{t1enc,dfadobe}

\usepackage{egweblnk}
\usepackage{cite}


\usepackage[cmex10]{amsmath} %for \rm in eq:iso


\newcommand{\tcr}[1]{\textcolor{red}{#1}}
\newcommand{\tcb}[1]{\textcolor{blue}{#1}}
\newcommand{\tcy}[1]{\textcolor{white}{#1}}

% For backwards compatibility to old LaTeX type font selection.
% Uncomment if your document adheres to LaTeX2e recommendations.
%\let\rm=\rmfamily    \let\sf=\sffamily    \let\tt=\ttfamily
%\let\it=\itshape     \let\sl=\slshape     \let\sc=\scshape
%\let\bf=\bfseries


% end of prologue

% ---------------------------------------------------------------------
% EG author guidelines plus sample file for EG publication using LaTeX2e input
% D.Fellner, v1.17, Sep 23, 2010


\title[Topologically Robust 3D Shape Matching via Gradual Deflation and Inflation]%
      {Topologically Robust 3D Shape Matching via\\ Gradual Deflation and Inflation}

% for anonymous conference submission please enter your SUBMISSION ID
% instead of the author's name (and leave the affiliation blank) !!
\author[A. Genctav \& Y. Sahillioglu \& S. Tari]
       {Asli Genctav\thanks{Corresponding Author (e-mail: asli@ceng.metu.edu.tr)}, Yusuf Sahillioglu,
        and Sibel Tari
%        S. Spencer$^2$\thanks{Chairman Siggraph Publications Board}
        \\
% For Computer Graphics Forum: Please use the abbreviation of your first name.
         Middle East Technical University, Computer Engineering Dept., 06800, Ankara, Turkey\\     
% For Computer Graphics Forum: Please use the abbreviation of your first name.
%         $^2$Institut f{\"u}r ComputerGraphik \& Wissensvisualisierung, TU Graz, Austria
%        $^2$ Another Department to illustrate the use in papers from authors
%             with different affiliations
       }

% ------------------------------------------------------------------------

% if the Editors-in-Chief have given you the data, you may uncomment
% the following five lines and insert it here
%
% \volume{27}   % the volume in which the issue will be published;
% \issue{1}     % the issue number of the publication
% \pStartPage{1}      % set starting page


%-------------------------------------------------------------------------
\begin{document}

% \teaser{
%  \includegraphics[width=\linewidth]{eg_new}
%  \centering
%   \caption{New EG Logo}
% \label{fig:teaser}
% }

\maketitle

\begin{abstract}

Despite being vastly ignored in the literature, coping with topological noise is an issue of increasing importance, especially as a consequence of the increasing number and diversity of 3D polygonal models that are captured by devices of different qualities or synthesized by algorithms of different stabilities.  One approach for matching 3D shapes under topological noise is to replace the topology-sensitive geodesic distance with distances that are less sensitive to topological changes.  We propose an alternative approach utilising gradual deflation (or inflation) of the shape volume, of which purpose is to bring the pair of shapes to be matched to a \emph{comparable} topology before the search for correspondences. Illustrative experiments using different datasets demonstrate that as the level of topological noise increases, our approach outperforms the other methods in the literature. 
  
%\begin{classification} % according to http://www.acm.org/class/1998/
%\CCScat{Computer Graphics}{I.3.5}{3D Shape Correspondence}{Topological noise}
%\end{classification}

\end{abstract}





%-------------------------------------------------------------------------
\section{Introduction}

Establishing correspondences between a pair of 3D shapes is a crucial problem in computer graphics and vision with many applications including, but not limited to, attribute transfer, morphing, registration, retrieval, statistical modeling, and tracking \cite{Bronstein08, Kaick11}. 3D shape correspondence methods seek a plausible mapping that pair up similar or semantically equivalent surface points of two given shapes. Thanks to the broad application domain of this problem, it comes in various scenarios, such as correspondence between completely or partially similar objects that admit rigid or non-rigid deformations under geometric or topological noise. Recently, we also observe exploitation of context information when a collection of three or more shapes is given to be matched.

In this paper, we address a less-explored scenario that deals with a pair of non-rigid shapes \emph{under topological noise}. Shapes that are extrinsically different by non-rigid deformations, a.k.a isometric shapes, commonly appear in various contexts such as different poses of an articulated object, or two shapes representing different but semantically similar objects (e.g., two different humans). Despite being vastly ignored in the existing literature, topological noise is also a common issue with the increasing number and diversity of 3D polygonal models that are captured by devices of different qualities or synthesized by algorithms of different stabilities. We therefore believe that handling 3D shape correspondence under topological noise makes an important contribution to the computer graphics and vision fields.

There are, to the best of our knowledge, only four methods that address the shape correspondence problem under topological noise, three of which merely replace the topology-sensitive geodesic distance with topologically-robust diffusion distance \cite{Bronstein10, Sharma10, Sharma11}, whereas the other employs a heuristic eigenfunction alignment scheme \cite{Mateus08}.


We propose an alternative approach utilising gradual deflation (or inflation) of the shape volume. The purpose of inflating (or deflating) is to bring the pair of shapes to be matched to a \emph{comparable} topology before the search for correspondences. Roughly speaking, the process of deflation (inflation) is  curvature-dependent erosion (dilation).
The reason that we perform these processes in curvature-sensitive manner is to avoid development of singularities -- cusps and collapsed boundaries. Once the pair of shapes is brought to a topologically comparable form, a 3D isometric shape correspondence algorithm using geodesic distance is employed to find correspondences between topologically comparable forms; the found correspondences between topologically comparable forms are then transferred to the correspondences between the original pair of input shapes.


Though the above-mentioned previous methods handle topology noise to some extent, our approach provides more robust solution as the level of topological noise increases. 

For the purpose of equating the topologies of the pair of shapes, we employ a curvature-sensitive distance field. Specifically, the boundaries of the gradually deflated (or inflated) volumes  are obtained as the level surfaces of the field.
The isometric correspondences are searched between comparable level surfaces sampled from the respective fields computed for each shape of the pair, and then transferred to the original shape surfaces. An immediate advantage of a  field based solution is the replacement of the scale parameter in diffusion distances with a theoretically sound and automatic stopping condition based on Euler's formula. Level surfaces obtained from the field can be analyzed by geodesic distances, which are known to be more accurate than diffusion based counterparts.


Note that, although we primarily target the correspondence problem under topological noise, the proposed scheme can also be used to generate correspondences between shape pairs not suffering from such noise. 

%-------------------------------------------------------------------------
\section{Related Work}
\label{related}

Matching semantically similar shapes is a problem studied in deep depth for various scenarios including completely isometric shape pairs \cite{Ovsjanikov10}\cite{Sahillioglu12b}, partially isometric shape pairs \cite{Sahillioglu13}\cite{Litany16}, non-isometric shape pairs \cite{Panozzo13}\cite{Solomon16}, and a collection of shapes \cite{Cosmo16}\cite{Sahillioglu14}. Compared to these studies, and many other related ones \cite{Kaick11}, matching shapes under noise, especially topological noise, is a problem that is yet at its infancy.

An important set of geometric tools to help develop the existing methods under topological noise category consists of several distance metrics on surface, namely the diffusion metric \cite{Coifman05}, the commute-time metric \cite{Wang11}, and the biharmonic metric \cite{Rustamov10}. These distance metrics are all shape-aware in that they are isometry invariant and insensitive to small topological noises. They achieve this property by relying on a principle based on the spread of heat. Intuitively, these metrics capture the spread of heat over time from a seed surface point when a hot needle is touched into that point. In other words, these multiscale distances measure the amount of heat transferred from the seed to the target in a certain time, where the varying times make the metric multiscale. This measurement is obtained by averaging lengths of multiple paths from the seed to the target point, which is hence more topologically-robust than the common geodesic metric that uses only one path, namely the shortest path. We see \cite{Bronstein10}\cite{Sharma10}\cite{Sharma11} employing these topologically-robust metrics in their respective correspondence methods. Due to the inherent instability problem of these metrics under large topological noise, they are doomed to fail when the noise level is increased.

A different approach to topologically-robust correspondence is the eigenfunction alignment of \cite{Mateus08}. In this study, the unreliable eigenvalues of a large sparse Laplacian are reordered with the aim of handling topological noise. Similar to the other related works, it is able to handle very moderate topological noise.

Yet another approach for the correspondence under topological noise problem uses machine learning in order to deal with this geometrically difficult problem \cite{Wei16}. Main limitation of this method is its restriction to a special class of shapes, e.g., it works on human class only. Obtaining a training set that covers all the plausible poses of a given class is a cumbersome process that is also prone to the possibility of missing some poses out of consideration. Problems in the training will result in inconsistent output correspondences.

A recent deformation-based method strives to alleviate the problem of topological noise in correspondence search \cite{Boscaini14}. In this method, two shapes in question are deformed into a canonical pose that removes all the bending transformations over the surface, hence effectively making the resulting shapes comparable under simpler rigid transformations that do not deal with the complicated bendings \cite{Besl92}. Borrowing ideas from Coulomb energy that models electrostatic repulsion, their model naturally deals with topological noises by tearing up the shape at points of strong repulsion.

There is a very recent work on establishing correspondences between surfaces with different topologies \cite{Park16}. Although the problem addressed in this work is not to deal with topological noise, the ideas can help improve the methods handling noise. Essentially, this work morphs the source shape into a topologically different target shape by using the intermediate implicit surfaces, which is in that sense similar to our work.

Although it is not explored yet, the recent functional correspondence framework for shape correspondence has the potential of handling topological noise thanks to their capability of going beyond point-to-point maps \cite{Ovsjanikov12}\cite{Huang14}. Rather than vertices on shapes, these methods matches real-valued functions over surfaces. They, however, have a disadvantage of converting the optimal functional map into a more user-friendly point-to-point map, an action that is prone to bring artifacts and discontinuities \cite{Ganapathi16}.

\section{The Methods}
\label{sec:method}
\input{method_v5.tex}
%-------------------------------------------------------------------------
\input{experimental_results_v5.tex}

%-------------------------------------------------------------------------
\vspace{-0.2cm}

\section{Conclusion}

We presented a simple yet effective approach for coping with topological noise when computing a correspondence between two shapes given in the form of surface meshes. Instead of constructing distance measures that are less sensitive to topological variations as compared to geodesic distance, we resort to graded deflation (inflation) of the object(s) to obtain meshes that are topologically comparable.  The deflated (inflated) shape boundaries at a variety of grades are simultaneously computed as the level surfaces of a field of which value at a point approximately codes the distance from the nearest boundary point as well the curvature of the respective level surface, hence, at the respective boundary location. Level surfaces obtained from the field can be analyzed by geodesic distances, which are known to be more accurate than diffusion based counterparts. As we use an approximate method for deflation (inflation), the computations are simple and fast. The step of computing a field and extracting all deflations or inflations for the purpose of equating topology adds an extra load which is on the order of a minute.  Considering that a computed field can be stored and later used in multiple matching tasks (not just for matching a single pair of shape), we find this cost negligible.

We  performed matching experiments using datasets for which ground truth mesh correspondences are available.  One of the test datasets is a small custom dataset (TN-SCAPE) prepared by us by adding topology noise to five of the model meshes of the SCAPE~\cite{anguelov2005scape} dataset. Experiments demonstrate that as the level of topological noise increase, our approach significantly outperforms the biharmonic distance.

\vspace{-0.3cm}

\section*{Acknowledgements} The work is funded by TUBITAK under grant 112E208 \url{http://user.ceng.metu.edu.tr/~asli/112E208.html}

%-------------------------------------------------------------------------

%\bibliographystyle{eg-alpha}
\bibliographystyle{eg-alpha-doi}

\vspace{-0.3cm}


%\bibliography{egbibsample_versionS2}

\newcommand{\etalchar}[1]{$^{#1}$}
\begin{thebibliography}{\uppercase{vKZHCO11}}

\bibitem[ASK{\etalchar{*}}05]{anguelov2005scape}
\textsc{Anguelov D., Srinivasan P., Koller D., Thrun S., Rodgers J., Davis J.}:
\newblock {SCAPE}: Shape completion and animation of people.
\newblock \emph{ACM Trans. Graph. (Proc. of SIGGRAPH) 24}, 3 (2005), 408--416.

\bibitem[BBC{\etalchar{*}}10a]{bronstein2010shrecCorr}
\textsc{Bronstein A.~M., Bronstein M.~M., Castellani U., Dubrovina A., Guibas
  L.~J., Horaud R.~P., Kimmel R., Knossow D., Von~Lavante E., Mateus D.,
  Ovsjanikov M., Sharma A.}:
\newblock {SHREC} 2010: robust correspondence benchmark.
\newblock In \emph{Proc. Eurographics Workshop on 3D Object Retrieval} (2010).

\bibitem[BBC{\etalchar{*}}10b]{bronstein2010shrec}
\textsc{Bronstein A.~M., Bronstein M.~M., Castellani U., Falcidieno B.,
  Fusiello A., Godil A., Guibas L.~J., Kokkinos I., Lian Z., Ovsjanikov M.,
  Patan\'{e} G., Spagnuolo M., Toldo R.}:
\newblock {SHREC} 2010: robust large-scale shape retrieval benchmark.
\newblock \emph{Proc. Eurographics Workshop on 3D Object Retrieval} (2010).

\bibitem[BBK06]{bronstein2006generalized}
\textsc{Bronstein A.~M., Bronstein M.~M., Kimmel R.}:
\newblock Generalized multidimensional scaling: A framework for
  isometry-invariant partial surface matching.
\newblock \emph{Proceedings of the National Academy of Science 103}, 5 (2006),
  1168--1172.

\bibitem[BBK08]{Bronstein08}
\textsc{Bronstein A.~M., Bronstein M.~M., Kimmel R.}:
\newblock \emph{Numerical Geometry of Non-Rigid Shapes}.
\newblock Springer, 2008.

\bibitem[BBK{\etalchar{*}}10]{Bronstein10}
\textsc{Bronstein A.~M., Bronstein M.~M., Kimmel R., Mahmoudi M., Sapiro G.}:
\newblock A {Gromov-Hausdorff} framework with diffusion geometry for
  topologically-robust non-rigid shape matching.
\newblock \emph{International Journal of Computer Vision 89}, 2 (2010),
  266--286.

\bibitem[BGB14]{Boscaini14}
\textsc{Boscaini D., Girdziusas R., Bronstein M.~M.}:
\newblock Coulomb shapes: using electrostatic forces for deformation-invariant
  shape representation.
\newblock \emph{Eurographics Workshop on 3D Object Retrieval} (2014).

\bibitem[BM92]{Besl92}
\textsc{Besl P.~J., Mckay N.~D.}:
\newblock A method for registration of {3D} shapes.
\newblock \emph{IEEE Trans. PAMI 14} (1992), 239--256.

\bibitem[CLL{\etalchar{*}}05]{Coifman05}
\textsc{Coifman R., Lafon S., Lee A., Maggioni M., Nadler B., Warner F., Zucker
  S.}:
\newblock Geometric diffusions as a tool for harmonic analysis and structure
  definition of data: Diffusion maps.
\newblock \emph{Proceedings of the National Academy of Sciences of the United
  States of America 102}, 21 (2005), 7426--7431.

\bibitem[CRA{\etalchar{*}}16]{Cosmo16}
\textsc{Cosmo L., Rodola E., Albarelli A., Memoli F., Cremers D.}:
\newblock Consistent partial matching of shape collections via sparse modeling.
\newblock \emph{Computer Graphics Forum} (2016).

\bibitem[GBP07]{giorgi2007shrec}
\textsc{Giorgi D., Biasotti S., Paraboschi L.}:
\newblock {SHREC}: Shape retrieval contest: Watertight models track, 2007.

\bibitem[GSTOG16]{Ganapathi16}
\textsc{Ganapathi-Subramanian V., Thibert B., Ovsjanikov M., Guibas L.}:
\newblock Stable region correspondences between non-isometric shapes.
\newblock \emph{Computer Graphics Forum 35}, 5 (2016), 121--133.

\bibitem[HWG14]{Huang14}
\textsc{Huang Q., Wang F., Guibas L.}:
\newblock Functional map networks for analyzing and exploring large shape
  collections.
\newblock \emph{ACM Trans. Graph. 33}, 4 (2014), 36.

\bibitem[LRB{\etalchar{*}}16]{Litany16}
\textsc{Litany O., Rodola E., Bronstein A.~M., Bronstein M.~M., Cremers D.}:
\newblock Non-rigid puzzles.
\newblock \emph{Computer Graphics Forum 35}, 5 (2016), 135--143.

\bibitem[LRF10a]{Rustamov10}
\textsc{Lipman Y., Rustamov R., Funkhouser T.}:
\newblock Biharmonic distance.
\newblock \emph{ACM Trans. Graph. 29}, 3 (2010).

\bibitem[LRF10b]{Lipman10}
\textsc{Lipman Y., Rustamov R.~M., Funkhouser T.~A.}:
\newblock Biharmonic distance.
\newblock \emph{ACM Trans. Graph. 29}, 3 (2010), 27:1--11.

\bibitem[MHK{\etalchar{*}}08]{Mateus08}
\textsc{Mateus D., Horaud R., Knossow D., Cuzzolin F., Boyer E.}:
\newblock Articulated shape matching using {Laplacian} eigenfunctions and
  unsupervised point registration.
\newblock \emph{Proc. of Computer Vision and Pattern Recognition (CVPR)}
  (2008).

\bibitem[OBCS{\etalchar{*}}12]{Ovsjanikov12}
\textsc{Ovsjanikov M., Ben-Chen M., Solomon J., Butscher A., Guibas L.}:
\newblock Functional maps: A flexible representation of maps between shapes.
\newblock \emph{ACM Trans. Graph. (Proc. of SIGGRAPH) 31}, 4 (2012),
  30:1--30:11.

\bibitem[OF03]{osher2006level}
\textsc{Osher S., Fedkiw R.}:
\newblock \emph{Level set methods and dynamic implicit surfaces}, vol.~153.
\newblock Springer-Verlag New York, 2003.

\bibitem[OMMG10]{Ovsjanikov10}
\textsc{Ovsjanikov M., M\'{e}rigot Q., M\'{e}moli F., Guibas L.}:
\newblock One point isometric matching with the heat kernel.
\newblock \emph{Computer Graphics Forum 29}, 5 (2010), 1555--1564.

\bibitem[PBDSH13]{Panozzo13}
\textsc{Panozzo D., Baran I., Diamanti O., Sorkine-Hornung O.}:
\newblock Weighted averages on surfaces.
\newblock \emph{Proc. SIGGRAPH} (2013).

\bibitem[PCBL16]{Park16}
\textsc{Park H., Cho Y., Bang S., Lee S.}:
\newblock An eulerian approach for constructing a map between surfaces with
  different topologies.
\newblock \emph{Computer Graphics Forum 35}, 7 (2016), 11--19.

\bibitem[SH10]{Sharma10}
\textsc{Sharma A., Horaud R.}:
\newblock Shape matching based on diffusion embedding and on mutual isometric
  consistency.
\newblock \emph{Proc. of Computer Vision and Pattern Recognition Workshops}
  (2010).

\bibitem[SHCB11]{Sharma11}
\textsc{Sharma A., Horaud R., Cech J., Boyer E.}:
\newblock Topologically-robust {3D} shape matching based on diffusion geometry
  and seed growing.
\newblock \emph{Proc. of Computer Vision and Pattern Recognition (CVPR)}
  (2011), 2481--2488.

\bibitem[SPKS16]{Solomon16}
\textsc{Solomon J., Peyre G., Kim V., Sra S.}:
\newblock Entropic metric alignment for correspondence problems.
\newblock \emph{ACM Trans. Graph. 35}, 4 (2016).

\bibitem[SY12]{ys2012EM}
\textsc{Sahillio\u{g}lu Y., Yemez Y.}:
\newblock Minimum-distortion isometric shape correspondence using {EM}
  algorithm.
\newblock \emph{IEEE Trans. PAMI 34}, 11 (2012), 2203--2215.

\bibitem[SY13]{Sahillioglu12b}
\textsc{Sahillio\u{g}lu Y., Yemez Y.}:
\newblock Coarse-to-fine isometric shape correspondence by tracking symmetric
  flips.
\newblock \emph{Computer Graphics Forum 32}, 1 (2013), 177--189.

\bibitem[SY14a]{Sahillioglu14}
\textsc{Sahillio\u{g}lu Y., Yemez Y.}:
\newblock Multiple shape correspondence by dynamic programming.
\newblock \emph{Computer Graphics Forum (Proc. of Pacific Graphics) 33}, 7
  (2014), 121--130.

\bibitem[SY14b]{Sahillioglu13}
\textsc{Sahillio\u{g}lu Y., Yemez Y.}:
\newblock Partial {3D} correspondence from shape extremities.
\newblock \emph{Computer Graphics Forum 33}, 6 (2014), 63--76.

\bibitem[TSP96]{TSP96}
\textsc{Tari S., Shah J., Pien H.}:
\newblock A computationally efficient shape analysis via level sets.
\newblock In \emph{IEEE Workshop on Mathematical Methods in Biomedical Image
  Analysis} (1996).

\bibitem[vKZHCO11]{Kaick11}
\textsc{van Kaick O., Zhang H., Hamarneh G., Cohen-Or D.}:
\newblock A survey on shape correspondence.
\newblock \emph{Computer Graphics Forum 30}, 6 (2011), 1681--1707.

\bibitem[WBBP11]{Wang11}
\textsc{Wang C., Bronstein M.~M., Bronstein A.~M., Paragios N.}:
\newblock Discrete minimum distortion correspondence problems for non-rigid
  shape matching.
\newblock \emph{Proc. Scale Space and Variational Methods} (2011).

\bibitem[WHC{\etalchar{*}}16]{Wei16}
\textsc{Wei L., Huang Q., Ceylan D., Vouga E., Li H.}:
\newblock Dense human body correspondences using convolutional networks.
\newblock In \emph{Proc. IEEE Conference on Computer Vision and Pattern
  Recognition} (2016), pp.~1544--1553.

\end{thebibliography}


\end{document}
