
\section{Method}
\label{sec:method}

\subsection{Cyclostationarity}
''A cyclostationary signal is a
random signal whose statistical characteristics vary periodically in
time'' \cite{jurdic_investigation_2009}. This is especially relevant in a fan. Although the stochastic signal is different at each revolution of the fan, its characteristics reappear periodically. This is valid for rotor-triggered mean values but also for the turbulent statistics.

By replacing the ensemble average with a cycle average~\cite{gardner_cyclostationarity:_2006}, the subsequently used hybrid method is expanded to reproduce cyclostationary processes. Hence, the mean flow and stationary turbulent characteristics are extended to a periodically changing background flow and cyclostationary turbulence. This method is referred to as cyclostationary stochastic hybrid (CSH) method. Although the changes to the underlying governing equations are small as discussed in subsection~\ref{sec:hybrid}, the resulting level of complexity is very much increased. The combination possibilities are shown in subsection~\ref{sec:coupling}. The influence of periodically changing background flow, variance and length scale is investigated in section~\ref{sec:Application}. 

% Phänomenologie, Literatur

%\todo[inline]{Unterteilung in Hintergrundanteil und Schwankungsanteil ist beliebig. Formel $u = u_0(t) + u_a(t) +u_t(t)$ erwähnen?}

\subsection{Hybrid approach}
\label{sec:hybrid}
The cyclostationary stochastic hybrid approach, which simulates broadband RSI noise using both stationary and cyclostationary turbulence, is depicted in Fig.~\ref{fig:hybridAnsatz}. It consists of three methods: The (U)RANS method computes the background flow and turbulence statistics. The RPM method synthesizes the turbulence in the time domain. The CAA method convects the synthetic turbulence into the source region and radiates the resulting broadband noise to the sensor positions. 

Solely the geometry and operating condition of the turbomachine and the shape of the correlation function are needed as inputs for this hybrid approach. It outputs broadband time signals at the desired microphone positions, which are converted into sound power levels (PWL) in an equivalent duct.

Next, the separate methods of the hybrid approach and the post-processing are explained.
\begin{figure}
\input{figures/hybridAnsatz.tex}
\caption{Overview of the tools involved in the hybrid approach.\label{fig:hybridAnsatz}}
\end{figure}

\subsubsection{(U)RANS: background flow and turbulence statistics}
\label{sec:RANS}
The in-house Computational Fluid Dynamics (CFD) solver TRACE was used~\cite{becker_recent_2010}. The mean flow and mean turbulent statistics were predicted by a Reynolds-Averaged Navier Stokes (RANS) simulation, while the periodic flow, periodic turbulent statistics and the tonal noise were predicted by an unsteady RANS (URANS) simulation. 

In this investigation, the (U)RANS calculations were performed on a quasi-3D (q3D) domain. A q3D computational domain consists of a few cells in the radial direction and its radial boundaries follow streamlines of a preliminary 3D RANS simulation. In most cases, the aerodynamic results of such a q3D computation closely resemble the 3D results at the same position~\cite{holewa_impact_2014}.
 
%Notice that the Navier-Stokes equations are solved and the results are saved in the relative frame of reference. The unsteady periodic part of the solution is expressed as frequency Fourier coefficients referred to as ``harmonics''. Harmonics are multiples of base frequencies that have different values in the rotor and stator domains. 
% \begin{equation}
%\begin{array}{c}
%\omega_R = h_R N_V \Omega_r \mbox{ with } h_R \in [0, 1, 2, ...[ \\
%\omega_S = h_S N_B \Omega_r \mbox{ with } h_S \in [0, 1, 2, ...[ \\
%\end{array}
%\end{equation}
%As a consequence the solutions saved at the same harmonic number in the rotor domain and the stator domain do not correspond to the same frequency and therefore do not match. Using a frequency-space transformation it is possible to pass from one system to the other.

\subsubsection{Random Particle Mesh (RPM) method: synthesized turbulence}
The Random Particle Mesh method~\cite{ewert_caa_2011} allows to synthetically realize the time-space-dependent turbulent fluctuations based on the background flow, the local variance, and the local length scales provided by the (U)RANS simulation. In general, the RPM method is able to generate anisotropic, evolving synthetic turbulence of local integral turbulence length scale $\Lambda$ 
realizing arbitrary model spectra. The turbulence is generated by spatially filtering a random stochastic field with a Gaussian filter of the aforementioned length scale. The turbulence is scaled with the local variance, which corresponds to the turbulent kinetic energy $k_t$ for this particular application, and convects with the local background velocity $\u_0$.

The derivation of the RPM method is neither restricted to a spatially constant variance or length scale nor to a constant background mean flow. The statement of separating velocity $\u = \u_0 + \u'$ into a background flow $\u_0$ and a fluctuating part $\u'$ is still valid if the background flow $\u_0$ is also fluctuating in time. In this manner, $\u'$ can be understood as the fluctuation in a moving frame of reference. The only requirement is that $\u_0$ has to be known in advance. Therefore, $\u_0$ cannot be influenced by the fluctuating velocity components $\u'$. 

A fast Random Particle Mesh (fRPM) method was implemented by \citet{siefert_sweeping_2009} utilizing recursive filters on a Cartesian grid to speed up the computation. This implementation was used in this investigation to synthesize the turbulent field.

The method has been extended to arbitrary spectra by \citet{wohlbrandt_analytical_2016} by deriving analytical weighting functions $f(l,\Lambda)$. Thus, a von K\'arm\'an spectrum with an integral length scale $\Lambda$ can be realized by superposing $N_i$ Gauss spectra of various length scales $l_i$:
\begin{align}
E(k,\Lambda) &\approx \sum\limits_{i=1}^{N_i} f(l_i,\Lambda) E_G(k,l_i) \Delta l. \label{eq:weighting_disketerAnsatz}
\end{align}
% ranging logarithmically ($ \Lambda/5 \leq l \leq 4\Lambda$). 
% The afore used Purser Filter \cite{purser_numerical_2003} is restricted to small changes in the length scale and unstable for high gradients. \todo[inline]{Den Teil verschieben? Passt besser wenn du die Unterschiede zu 2015 erklärst.}
By using spatially and temporally constant length scales $l_i$, it is possible to use the recursive Young-van-Vliet Filter \cite{young_recursive_1995}, which is restricted to constant length scales but beneficial in terms of computational time and robustness. 
The realization of spatially and temporally varying length scales $\Lambda(\x,t)$ with this filter necessitates appropriate weighting functions:
\begin{align}
E(k,\Lambda(\x,t)) &\approx \sum\limits_{i=1}^{N_i} f(l_i,\Lambda(\x,t)) E_G(k,l_i) \Delta l. \label{eq:weighting_timeDep}
\end{align}
This approach allows for arbitrarily high spatial and temporal gradients in the integral length scale. 
\subsubsection{Computational Aeroacoustics (CAA): convection of turbulent disturbances, generation and propagation of acoustic waves }
The turbulent and acoustic fluctuations are resolved in the time domain by the CAA solver PIANO~\cite{delfs_numerical_2008}. In this study, it was used to solve the linearized Euler equations. The well-known dispersion-relation-preserving finite difference scheme by \citet{tam_dispersion-relation-preserving_1993} was utilized for the spatial discretization and the low-dispersion low-dissipation Runge-Kutta method~\cite{hu_low-dissipation_1996}, for time-integration. 
The LEE for time-varying Navier-Stokes background flow can be derived by neglecting the turbulent stresses, viscous effects, heat fluxes and non-linear terms in the non-linear Navier-Stokes equations in perturbation form~\cite{ewert_linear-_2014} without limitations to slow changes of $\u_0$. Using the tensor notation $\u_0 = u^0_i \e_i$, it reads:
\begin{subequations}
\begin{align}
\pAbl{\rho'}{t}  + \pAbl{}{x_i}\left(\rho'u^0_i+\rho_0 u_i'\right) &= 0\\
\pAbl{u_i'}{t}+u^0_j\pAbl{u_i'}{x_j}+u_j'\pAbl{u^0_i}{x_j}+\frac{1}{\rho_0}\left(\pAbl{p'}{x_i}-\frac{\rho'}{\rho_0}\pAbl{p_0}{x_i}\right)&=0\\
\pAbl{p'}{t}+u^0_i\pAbl{p'}{x_i}+ u_i'\pAbl{p_0}{x_i}+\gamma\left(p'\pAbl{u^0_i}{x_i}+p_0\pAbl{u_i'}{x_i}\right)&=0.
\end{align}
\end{subequations}
It can be taken advantage of the periodicity in the fan by setting all flow field variables, represented by $\phi_0(t)$, to 
\begin{align}\label{eq:fourierCoeff4CAA}
\phi_0(t) = \sum\limits_{k = 0}^{\infty}\phi^0_{k} e^{-i k \omega t},
\end{align}
where $\phi^0_{k}$ is the $k^\text{th}$ harmonic of the base frequency $\omega$ and $k = 0$ represents the steady part $\phi^0_0 = \overline{ \phi_0(t)}$. That way, only the complex Fourier coefficients need to be stored to reconstruct the flow at each time step.

\subsection{Coupling of fRPM and CAA methods}
\label{sec:coupling}
Fluctuating vorticity as generated by the fRPM method over a given background flow is coupled with the CAA solver PIANO by applying the LEE-relaxation formulation~\cite{ewert_linear-_2014}. This method adds a relaxation term to the impulse equations,
\begin{align}
\pAbl{u'_i}{t} + \cdot\cdot\cdot = \epsilon_{ijk}\pAbl{}{x_j}\left[\sigma\left(\Omega'_k -\Omega^\text{ref}_k\right)\right],
\end{align}
where $\sigma$ is the forcing parameter, $\Omega'_i$ is the vorticity given by the left hand side of this equation as
\begin{align}
\Omega'_i = \epsilon_{ijk}\pAbl{u'_k}{x_j},
\end{align}
and $\Omega^\text{ref}_i$ is the externally imposed fluctuating reference vorticity. This reference vorticity is determined by the fRPM method by applying the so called 'source A' model~\cite{ewert_caa_2011}. In short, this means that a stream function is modeled to realize the divergence-free turbulent velocity fluctuations, from which the vorticity is derived.

In this paper, the turbulence is coupled into the CAA domain in a region upstream of the blades. Therefore, only frozen Taylor vortices but no de-correlation effects or local turbulent characteristics can be modeled. To enable a coupling with negligible energy loss, the forcing parameter $\sigma$ must be as high as the stability limit permits. This stability limit behaves similarly as that for viscous equations as discussed by \cite{moghadam_implementation_2012}. In fact, the forcing parameter has the unit of viscosity. The approach during this study was to iteratively increase the forcing parameter, while keeping the simulation stable without changing the initial linear stability time step given by the CFL number.   
 
There are several advantages of using a LEE-relaxation formulation rather than a modified \citet{tam_radiation_1996} radiation boundary condition (BC) or an additional sponge zone.  While the results of all methods are identical, the LEE-relaxation formulation is invisible to acoustic pressure waves and can be placed anywhere inside the computational domain.  Thus, a smaller region of the grid upstream of the blade has to resolve small turbulent structures, which requires less computational effort. Lastly, it can locally and noiselessly cancel out vorticity waves by setting $\bfm \Omega^\text{ref} = 0$ where needed.
 
\subsection{Types of cyclostationarity realized by the CSH method}\label{sec:config}
The possible cases offered by the CSH method are discussed in this subsection. A summary and the hereafter used abbreviations are listed in Table~\ref{Tab:Configurations} and Figure~\ref{fig:Configurations}. The investigated configurations are detailed in Section~\ref{sec:confRealised}.

\begin{table}[h]
\caption{Four simulation configurations aimed at investigating the impact of cyclostationarity in RSI broadband noise.
\label{Tab:Configurations} }
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
configurations & background mean flow      & \multicolumn{2}{c|}{turbulence}   \\
\cline{3-4}
               &                & TKE           & TLS      \\
\hline
\hline
{\bf P-PP}            & time-{\bf P}eriodic  & \multicolumn{2}{c|}{time-{\bf P}eriodic}  \\
\hline
{\bf C-PP}            & {\bf C}onstant       & \multicolumn{2}{c|}{time-{\bf P}eriodic}  \\
\hline
{\bf C-PC}           & {\bf C}onstant        & time-{\bf P}eriodic & {\bf C}onstant             \\
\hline
{\bf C-CC}            & {\bf C}onstant       &  \multicolumn{2}{c|}{{\bf C}onstant}   \\
\hline
\end{tabular}
\end{center}
\end{table}

\begin{figure}
% % \begin{subfigmatrix}{4}
\subfigure[\textbf{P-PP}: Periodic background flow, TKE and TLS. \label{fig:configPPP}]{
\begin{overpic}[width=0.21\textwidth]{figures/eps_conf_PPP.pdf}
\put(0,80){\colorbox{white}{$\mathbf{ l_s = f(t)}$}}
\put(0,95){$\mathbf{ k_t = f(t)}$}
\put(50,2){\colorbox{white}{\textcolor{blue}{$\mathbf{ u_0 = f(t)}$}}}
\end{overpic}
}\hfill
\subfigure[\textbf{C-PP}: Constant background flow, periodic TKE and TLS. \label{fig:configCPP}]{
\begin{overpic}[width=0.21\textwidth]{figures/eps_conf_CPP.pdf}
\put(0,80){\colorbox{white}{$\mathbf{ l_s = f(t)}$}}
\put(0,95){$\mathbf{ k_t = f(t)}$}
\put(50,2){\colorbox{white}{\textcolor{blue}{$\mathbf{ u_0 = \const}$}}}
\end{overpic}
}\hfill
\subfigure[\textbf{C-PC}: Constant background flow, periodic TKE but constant TLS. Inflow turbulence assumed small and not shown.  \label{fig:configCPC}]{
\begin{overpic}[width=0.21\textwidth]{figures/eps_conf_CPC.pdf}
\put(0,80){\colorbox{white}{$\mathbf{ l_s = \const}$}}
\put(0,95){$\mathbf{ k_t = f(t)}$}
\put(50,2){\textcolor{blue}{$\mathbf{ u_0 = \const}$}}
\end{overpic}
}\hfill
\subfigure[\textbf{C-CC}: Constant background flow, TKE and TLS.\label{fig:configCC}]{
\begin{overpic}[width=0.21\textwidth]{figures/eps_conf_CCC.pdf}
\put(0,80){\colorbox{white}{$\mathbf{ l_s = \const}$}}
\put(0,95){$\mathbf{ k_t = \const}$}
\put(48.5,2){\textcolor{blue}{$\mathbf{ u_0 = \const}$}}
\end{overpic}
}
% \end{subfigmatrix}
% \vspace{-1em}
\caption{Varying complexity for coupling cyclostationary turbulence into the CAA domain. The red box depicts the fRPM domain and the blue line indicates the flow path. The inflow turbulence between the rotor wakes is only schematically shown in \subref{fig:configPPP} and \subref{fig:configCPP} to emphasize the difference due to the TLS. \label{fig:Configurations}}
\end{figure}

For the sake of clarity and comparability, all subsequent cases realize the sources in the stator frame of reference using a patch at the same position and of the same size. There is also the possibility to model the sources in the rotor frame of reference with a so-called moving patch. This has been discussed in \cite{wohlbrandt_extension_2015} and is not brought up again as it does not give any additional physical insight.

\paragraph{{\bf P-PP}: Time-periodic mean flow, TKE and TLS,} 
see Fig.~\ref{fig:configPPP}. 
This variant most closely resembles reality since it fully accounts for the periodicity in the background flow and turbulence statistics as prescribed by the URANS. As in Eq.~\ref{eq:fourierCoeff4CAA} the Fourier coefficients of the harmonics are used to reproduce the flow and statistics at each time step. This accounts for the mean wake velocity deficit, the periodicity of the turbulent kinetic energy statistics, and the variation of the integral length scale across the blade passage. The turbulence generation in fRPM and the background mean flow in fRPM and CAA domains are synchronized. It could mistakenly be assumed that this configuration generates the tones produced by the mean wake deficit impingement on the stator, even without the stochastic sources. However, this is not the case. The pure tones are part of the URANS simulation and appear as part of the time-varying background flow in the CAA domain. But since the CAA realizes the fluctuations on top of the background flow, there are no tones in the CAA simulation itself. Only the superposition of CAA and URANS data contains these tones. 

\paragraph{{\bf C-PP}: Constant mean flow with time-periodic TKE and TLS,}
see Fig.~\ref{fig:configCPP}.
The complexity can be reduced by neglecting the periodic background flow in both the fRPM patch and the CAA domain. This is accomplished by using only the $0^\text{th}$ harmonic of the flow, i.e. the steady part. Compared to the P-PP case, the influence of the periodic background flow can be studied. To guarantee consistency in the input data for all considered cases, the TKE and TLS are extracted directly from the URANS simulation. 
Since a TLS cannot be expressed in terms of Fourier coefficients, the Fourier coefficients of the TKE and the specific dissipation rate $\omega_t$ are used instead.  Then, the TLS can be computed for each time step as follows:
\begin{equation}\label{eq:Lambda}
\Lambda = \frac{C_\text{Re}}{C_\mu}\frac{\sqrt{k_t}}{\omega_t}.
\end{equation}
A model parameter $C_\mu=0.09$ and a Reynolds-number dependent scaling parameter $C_\text{Re} \approx 0.4$~\cite{pope_turbulent_2000} were used.
Note that for this case and subsequently discussed cases, it would be sufficient to use a RANS simulation. In this respect, the Fourier coefficients result from the transformation of the stationary wake in the rotor frame of reference to the stator frame of reference. 

\paragraph{{\bf C-PC}: Constant mean flow with time-periodic TKE but uniform constant TLS,}
see Fig.~\ref{fig:configCPC}.
By additionally averaging the time-periodic TLS, e.g. by replacing it by its $0^\text{th}$ harmonic, only the periodicity of the turbulent kinetic energy statistics remains. \citet{dieste_random_2012} have investigated this case analytically.

\paragraph{{\bf C-CC}: Constant mean flow with uniform constant TKE and TLS,} see Fig.~\ref{fig:configCC}.
This configuration corresponds to homogeneous stationary turbulence impinging on a stator blade. This approach uses the datum fRPM method without cyclostationarity, which has been validated before~\cite{wohlbrandt_simultaneous_2013}. It is very similar to the approach used by the authors for predicting the FC1 benchmark case presented at the fan broadband noise workshop of AIAA Aviation 2014.  The CFD solution could come from a steady-state RANS calculation, but for consistency the $0^\text{th}$ harmonic of a URANS is used here.
%At the mixing plane, rotor wakes are mixed out so that the flow and the turbulence statistics (TKE and TLS) are nearly constant in front of the stator (see example in Fig.~\ref{fig:RANS_k}). 


% \begin{figure}
% \centering
% \includegraphics[width=0.7\textwidth]{figures/k_mixing_named.png}
% \caption{Distribution of turbulent kinetic energy (TKE) in a RANS calculation with mixing plane; DLR UHBR fan at a streamline close to mid-span.\label{fig:RANS_k} }
% \end{figure}
% \begin{figure}
% \centering
% \parbox{0.49\textwidth}{\centering
% \includegraphics[width=0.45\textwidth]{figures/k_URANS01.png} \\
% Harmonic \#1 (1$\times$BPF in the stator block) \\
% \includegraphics[width=0.45\textwidth]{figures/k_URANS03.png} \\
% Harmonic \#3 (3$\times$BPF in the stator block)}
% \hfill 
% \parbox{0.49\textwidth}{\centering
% \includegraphics[width=0.45\textwidth]{figures/k_URANS02.png} \\
% Harmonic \#2 (2$\times$BPF in the stator block)\\
% \includegraphics[width=0.45\textwidth]{figures/k_URANS04.png} \\
% Harmonic \#4 (4$\times$BPF in the stator block)}
% \caption{Fourier coefficients (real part) of the turbulent kinetic energy as obtained from a URANS calculation; DLR UHBR fan at the mid-span streamline. Note that the constant part of the TKE is very similar to the one obtained in the RANS calculation shown in Fig.~\ref{fig:RANS_k}. \label{fig:URANS_k} }
% \end{figure}
% 
% 


