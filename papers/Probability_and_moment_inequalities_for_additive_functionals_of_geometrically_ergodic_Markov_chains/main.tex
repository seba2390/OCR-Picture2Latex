%Version 2.1 April 2023
% See section 11 of the User Manual for version history
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%\documentclass[referee,sn-basic]{sn-jnl}% referee option is meant for double line spacing

%%=======================================================%%
%% to print line numbers in the margin use lineno option %%
%%=======================================================%%

%%\documentclass[lineno,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style

%%======================================================%%
%% to compile with pdflatex/xelatex use pdflatex option %%
%%======================================================%%

%%\documentclass[pdflatex,sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style


%%Note: the following reference styles support Namedate and Numbered referencing. By default the style follows the most common style. To switch between the options you can add or remove Numbered in the optional parenthesis. 
%%The option is available for: sn-basic.bst, sn-vancouver.bst, sn-chicago.bst, sn-mathphys.bst. %  
 
%%\documentclass[sn-nature]{sn-jnl}% Style for submissions to Nature Portfolio journals
%%\documentclass[sn-basic]{sn-jnl}% Basic Springer Nature Reference Style/Chemistry Reference Style
\documentclass[sn-mathphys,Numbered]{sn-jnl}% Math and Physical Sciences Reference Style
%%\documentclass[sn-aps]{sn-jnl}% American Physical Society (APS) Reference Style
%%\documentclass[sn-vancouver,Numbered]{sn-jnl}% Vancouver Reference Style
%%\documentclass[sn-apa]{sn-jnl}% APA Reference Style 
%%\documentclass[sn-chicago]{sn-jnl}% Chicago-based Humanities Reference Style
%%\documentclass[default]{sn-jnl}% Default
%%\documentclass[default,iicol]{sn-jnl}% Default with double column layout

%%%% Standard Packages
%%<additional latex packages if required can be included here>
\usepackage{graphicx}%
\usepackage{multirow}%
\usepackage{amsmath,amssymb,amsfonts}%
\usepackage{amsthm}%
\usepackage{mathrsfs}%
\usepackage{xcolor}%
\usepackage{textcomp}%
\usepackage{manyfoot}%
\usepackage{booktabs}%
\usepackage{listings}%

\input{heading}
\input{def}

\begin{document}

\title[Probability and moment inequalities for additive functionals of geometrically ergodic Markov chains]{Probability and moment inequalities for additive functionals of geometrically ergodic Markov chains}

%%=============================================================%%
%% Prefix	-> \pfx{Dr}
%% GivenName	-> \fnm{Joergen W.}
%% Particle	-> \spfx{van der} -> surname prefix
%% FamilyName	-> \sur{Ploeg}
%% Suffix	-> \sfx{IV}
%% NatureName	-> \tanm{Poet Laureate} -> Title after name
%% Degrees	-> \dgr{MSc, PhD}
%% \author*[1,2]{\pfx{Dr} \fnm{Joergen W.} \spfx{van der} \sur{Ploeg} \sfx{IV} \tanm{Poet Laureate} 
%%                 \dgr{MSc, PhD}}\email{iauthor@gmail.com}
%%=============================================================%%

\author[1]{\fnm{Alain} \sur{Durmus}}\email{alain.durmus@polytechnique.edu}

\author[1]{\fnm{Eric} \sur{Moulines}}\email{eric.moulines@polytechnique.edu}

\author[2]{\fnm{Alexey} \sur{Naumov}}\email{anaumov@hse.ru}

\author*[2]{\fnm{Sergey} \sur{Samsonov}}\email{svsamsonov@hse.ru}

\affil[1]{Ecole polytechnique, Paris, France}

\affil[2]{HSE University, Moscow, Russia}


%%==================================%%
%% sample for unstructured abstract %%
%%==================================%%

\abstract{In this paper, we establish moment and Bernstein-type inequalities for additive functionals of  geometrically ergodic Markov chains. These inequalities extend the corresponding inequalities for independent random variables. Our conditions cover Markov chains converging geometrically to the stationary distribution either in weighted total variation norm or in weighted Wasserstein distances. Our inequalities apply to unbounded functions and depend explicitly on constants appearing in the conditions that we consider.}

\keywords{concentration inequalities for Markov chains, cumulant expansion}

\pacs[MSC Classification]{60E15, 60J20, 65C40}

\maketitle

\section{Introduction}
\label{sec:introduction}
\input{introduction}

\section{Main results}
\label{sec:main-results}
\subsection{Geometrically $V$-ergodic Markov chains}
\label{sec:geom-v-ergod}
First, we consider the case where the Markov kernel $\MK$ is $V$-uniformly geometrically ergodic. We impose the following assumptions on the Markov kernel $\MK$:
\begin{assumption}
\label{assG:kernelP_q}
There exist a measurable function $V: \Xset \to \coint{\rme,\infty}$, $\lambda \in (0,1)$, and $b \geq 0$ such that for any $x \in \Xset$, $\MK V(x) \leq \lambda V(x) + b$.
\end{assumption}
Note that, in contrast to the usual definition of Lyapunov functions in the Markov chain literature, we assume here that $V$ takes values in $\coint{\rme,\plusinfty}$, rather than in $\coint{1,\plusinfty}$. This choice allows us to avoid technical problems when we consider $W = \log
V$ later in this section.

\begin{assumption}
\label{assG:kernelP_q_smallset}
There are an integer $ m \geq 1$, $\epsilon \in (0,1)$, and $d \in \rset_{+}$, such that  the level set $\{x \in\Xset \, :\, V(x) \leq d\}$ is $(m,\epsilon)$-small and $\lambda+2b/(1+d)<1$. The quantities $\lambda$ and $b$ are defined in \Cref{assG:kernelP_q}.
\end{assumption}
The definition of $(m,\epsilon)$-small set can be found, e.g., in \cite[Definition~9.1.1.]{douc:moulines:priouret:soulier:2018}. In particular, it is known that the Markov kernel $\MK$ is known to be uniformly geometrically ergodic if and only if the entire space $\Xset$ is $(m,\epsilon)$-small, see \cite[Theorem~15.3.1]{douc:moulines:priouret:soulier:2018}. Under \Cref{assG:kernelP_q} and \Cref{assG:kernelP_q_smallset}, the Markov kernel $\MK$ admits a unique invariant probability measure $\pi$ satisfying $\pi(V) < \infty$. Moreover, \cite[Theorem~19.4.1]{douc:moulines:priouret:soulier:2018} implies that for any probability measure $\xi$ satisfying $\xi(V) < \infty$ and all $n \in \nset$,
\begin{align}
    \label{eq:V-geometric-coupling-general}
    \tvnorm{\xi \MK^n - \pi} \leq \Vnorm[V]{\xi \MK^n - \pi} \leq \cmconstv \{ \xi(V) + \pi(V) \} \ratev^n \eqsp,
  \end{align}
  where the constants $\ratev$ and $\cmconstv$ are given by
  \begin{equation}
    \label{eq:bornes-v-geometric-coupling}
      \begin{aligned}
        &\log \ratev = \frac{\log(1-\epsilon) \log\bar\lambda_m} { m\bigl(\log(1-\epsilon) +
          \log\bar\lambda_m-\log\bar{b}_m\bigr) } \eqsp ,\\
        &\bar\lambda_m = \lambda^m+2b_m/(1+d) \eqsp,
        \eqspp \bar{b}_m = \lambda^m b_m + d
        \eqsp, \eqspp b_m=b (1-\lambda^m) /(1-\lambda) \eqsp ,   \\
        &\cmconstv  = \ratev^{-m}\{\lambda^m+(1-\lambda^m)/(1-\lambda)\}\{1+\bar{b}_m/[(1-\epsilon)(1-\bar\lambda_m)]\} \eqsp .
  \end{aligned}
\end{equation}
Before proceeding with our main results, we introduce some additional quantities. For each $q \in \nset, u \in \{1, \dots, q-1\}$ and $\gamma \geq 0$, we introduce
\begin{equation}
\label{eq: B_u_q_def_new}
\ConstB_{\gamma}(u,q)
= \frac{(2q)!}{u!} \sum_{(k_1,\ldots,k_u) \in \scrE_{u,q}}   \prod_{i=1}^u (k_{i}!)^{\gamma + 2} \eqsp,
\end{equation}
where $\scrE_{u,q} = \{ (k_1,\ldots,k_u) \in \nset^u \, : \, \sum_{i=1}^u k_i = 2q\, ,\, k_i \geq 2\}$.
Note that the cardinality of $\scrE_{u,q}$ is $\binom{2q-u-1}{u-1}$ which implies and upper bound
\begin{equation}
\label{eq:bound-Balpha}
\ConstB_{\gamma}(u,q)
\leq \frac{(2q)!}{u!} \binom{2q-u-1}{u-1} \bigl((2q-2u+2)!\bigr)^{2+\gamma} 2^{(u-1)(2+\gamma)}\eqsp.
\end{equation}
We first establish a Rosenthal-type inequality for uniformly $V$-geometrically ergodic Markov chains. The leading term is the variance (under stationarity) scaled by the corresponding moment of the Gaussian distribution.
\begin{theorem}\label{th:rosenthal_V_q}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_smallset}, and let $q \in \nset^*$. Then, for any function $g \in \mrl_{V^{1/(2q)}}$, 
\begin{equation}
\label{eq:main-rosenthal}
\PE_\pi[|S_n|^{2q}] \leq \momentGq[q] \{\PVar[\pi](S_n)\}^q + \Constmainros^{2q} \Vnorm[V^{1/(2q)}]{\bar{g}}^{2q}
\sum_{u=1}^{q-1} \frac{\ConstB_0(u,q) n^{u}}{\ratev^{u/2} \log^{2q-u}{(1/\ratev)}}\eqsp,
\end{equation}
where
\begin{equation}
\label{eq:constmainros}
\Constmainros = 2 \cmconstv \pi(V)\eqsp.
\end{equation}
\end{theorem}
\begin{proof}
The proof is postponed to \Cref{sec:proof-ros_v_q}.
\end{proof}
\begin{remark}
\label{remark:theo_1_scaling_mix_time}
Note that the bound \eqref{eq:main-rosenthal} scales homogeneously w.r.t. the factor $\{\log(1/\ratev)\}^{-1}$. Indeed, for any $g \in \mrl_{V^{1/(2q)}}$, we get applying \Cref{lem:geom_ergodicity_variance_bound}, that 
\[
\PVar[\pi](S_n) \leq 5 n c^{1/2} \ratev^{-1/2} \{\log{1/\ratev}\}^{-1} \pi(V)^{3/2} \Vnorm[V^{1/2}]{\bar{g}}^{2}\eqsp.
\]
Thus, applying \Cref{lem:scale_B_gamma} and dividing both parts of \eqref{eq:main-rosenthal} by $n^{2q}$, we obtain from \eqref{eq:main-rosenthal} that
\begin{equation}
\label{eq:main-rosenthal-simplified}
\PE_\pi\bigl[\bigl|\tfrac{S_n}{n}\bigr|^{2q}\bigr] \lesssim q^{q} \biggl(\frac{\ratev^{-1/2}}{n \log(1/\ratev)}\biggr)^{q} + q^{2q} \sum_{u=1}^{q-1} \biggl(\frac{\ratev^{-1/2} (2q-u)^{2}}{\rme n \log(1/\ratev)}\biggr)^{2q-u}\eqsp.
\end{equation}
Here $ a \lesssim b $ stands for $a \leq \operatorname{c} b$ where $\operatorname{c}$ prefactor, depending upon $c, \pi(V)$, and $\Vnorm[V^{1/(2q)}]{\bar{g}}$. That is, for $n = \kappa \ratev^{-1/2} / \log(1/\ratev)$, the r.h.s. of \eqref{eq:main-rosenthal-simplified} scales with $\kappa^{-1}$. 
\end{remark}
The above result can be extended using the construction of the exact distributional coupling for any initial distribution (see \Cref{sec:non-stationary-extension} for the necessary definitions). It is worth noting that in our approach it is not necessary to assume that the Markov chain is strongly aperiodic (unlike \cite{adamczak2015exponential}).
\begin{theorem}
\label{theo:changeofmeasure}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_smallset} and let $q \in \nset^*$. Then, for any probability measure $\xi$ on $(\Xset,\Xsigma)$ satisfying $\xi(V) < \infty$ and
$g \in \mrl_{V^{1/(2q)}}$,
\begin{equation*}
\PE_\xi\big[ \big|S_n \big|^{2q} \big] \leq 2^{2q-1} \PE_\pi\big[ \big|S_n \big|^{2q} \big]  + 2^{6q-1} \Vnorm[V^{1/(2q)}]{\bar{g}}^{2q} \cmconstv \{ \xi(V) + \pi(V) \} \frac{q^{2q}}{\ratev (\log(1/\ratev))^{2q}}\eqsp.
\end{equation*}
\end{theorem}
\begin{proof}
  The proof is postponed to \Cref{sec:non-stationary-extension}.
\end{proof}

In the above results we fix $q \in \nsets$ and consider a function $g \in \mrl_{V^{1/(2q)}}$. Of course, with these assumptions we can only obtain moment bounds of order $2q$ or smaller and cannot control the exponential moments of $S_n$. In our next statement, we consider the case of the function $g \in \mrl_{W^{\gamma}}$, where $W = \log V$ and $\gamma \geq 0$. Note that when $\gamma = 0$, $\mrl_{W^{\gamma}}$ coincides with the set of bounded functions. In this case, in addition to the Rosenthal-type bound \eqref{eq:main-rosenthal}, we can formulate a counterpart of the Bernstein-type bound \eqref{eq:gene_Bernstein type bound}. We begin with the result that is a counterpart of \Cref{th:rosenthal_V_q}.
\begin{theorem}\label{th:rosenthal_log_V}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_smallset} and let $\gamma \geq 0$, $q \in \nset^*$. Then for any $g \in \mrl_{W^\gamma}$, it holds
\begin{equation*}
\PE_{\pi}[|S_n|^{2q}] \leq \momentGq[q] \{\PVar[\pi](S_n)\}^q+  \Constmainros^{2q} (2\gamma)^{2\gamma q} \Vnorm[W^\gamma]{\bar{g}}^{2q} \sum_{u=1}^{q-1}  \frac{\ConstB_{\gamma}(u,q) n^{u}}{\ratev^{u/2} \log^{2q-u}{(1/\ratev)}}\eqsp,
\end{equation*}
where $\Constmainros$ is defined in \eqref{eq:constmainros}.
\end{theorem}
\begin{proof}
The proof is postponed to ~\Cref{sec:proof-ros_log_V}.
\end{proof}
Similar to \Cref{theo:changeofmeasure}, we provide a version of the above statement for any initial distribution.
\begin{theorem}
\label{theo:changeofmeasure-1}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_smallset} and let $\gamma \geq 0$,  $q \in \nset^*$. Then for any probability measure $\xi$ on $(\Xset,\Xsigma)$, and any $g \in \mrl_{W^\gamma}$, it holds
\begin{equation}
     \PE_\xi\big[ \big|S_n \big|^{2q} \big] \leq 2^{2q-1} \PE_\pi\big[ \big|S_n \big|^{2q} \big]  + 2^{4q-2} \Vnorm[W^\gamma]{\bar{g}}^{2q} \cmconstv \{ \xi(V) + \pi(V) \} \operatorname{D}^{(1)}_{q,\gamma}\eqsp,
\end{equation}
where
\begin{equation}
\operatorname{D}^{(1)}_{q,\gamma}= \rme^{-1} \ratev^{-1} \{ \log(1/\ratev) \}^{1- 4 q} (4q-2) ! +  \ratev^{-1} \{ \log(1/\ratev) \}^{-1} (4 q \gamma/ \rme)^{4 q \gamma}\eqsp.
\end{equation}
\end{theorem}
\begin{proof}
  The proof is postponed to \Cref{sec:non-stationary-extension}.
\end{proof}
We can also obtain Bernstein-type bound. We start from the stationary case.
\begin{theorem}
\label{th:rosenthal_log_V_cor_2}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_smallset} and let $\gamma \geq 0$. Then for any $g \in \mrl_{W^\gamma}$ and $t \geq 0$, it holds that 
\begin{equation}
\label{eq:bernstein_mc}
\PP_{\pi}(|S_n| \geq t) \leq 2\exp\biggl\{-\frac{t^2/2}{\PVar[\pi](S_n) + \ConstJ^{1/(\gamma+3)} t^{2-1/(\gamma+3)}}\biggr\}\eqsp.
\end{equation}
Moreover, for any $\delta > 0$ we get
\begin{equation}
\label{eq:high_prob_bound_W_ergodic}
\PP_{\pi}\biggl(|S_n| \geq 2\sqrt{\PVar[\pi](S_n)}\sqrt{\log(4/\delta)} + 4^{\gamma+3}\ConstJ\{\log(4/\delta)\}^{\gamma+3}\biggr) \leq \delta\eqsp.
\end{equation}
Here the constant $\ConstJ$ is given by
\begin{equation}
\label{eq:const_B_n_definition_main}
\ConstJ = \biggl( \frac{n \ratev^{-1/2} \{\log(1/\ratev)\}^{-1} \Constmainros^{2} \|\bar{g}\|_{W^{\gamma}}^{2}}{\PVar[\pi](S_n)} \vee 1\biggr) \frac{ 2^{1+3\gamma}\gamma^{3\gamma} \Constmainros \|\bar{g}\|_{W^{\gamma}}}{\log(1/\ratev)} \eqsp.
\end{equation}
\end{theorem}
\begin{proof}
The proof is postponed to ~\Cref{sec:proof_bernstein_bound}.
\end{proof}
Comparing \eqref{eq:bernstein_mc} with \eqref{eq: Bernstein type bound}, one can see that in the subexponential regime $t^{1/(\gamma+1)}$ is replaced by $t^{1/(\gamma+3)}$, as in \cite{doukhan2007probability}. This factor is caused by the dependence along the observations of the Markov chain. Similar to \eqref{eq: Bernstein type bound}, the constant $\ConstJ$ is not distribution-free, moreover, compared to \eqref{eq:gene_Bernstein type bound}, it is possible that $\ConstJ$ scales with $n$. However, the dependence in the distribution is fully explicit: one has to compare $\PVar[\pi](S_n)$ with $n \{\log(1/\ratev)\}^{-1} \Vnorm[W^\gamma]{\bar{g}}^{2}$.
\begin{remark}
\label{rem:lower_bound_variance}
For some particular instances of Markov chains, this comparison can be done explicitly. Indeed, let us choose a function $g$ with $\|\bar{g}\|_{W^\gamma} \leq 1$, $\pi(g^2) < \plusinfty$, and introduce for $\ell \in \nset$ the quantity
\[
\varsigma_\pi(g,\ell) = \PCov[\pi]( g(X_0),g(X_{\ell}))\eqsp.
\]
Under \Cref{assG:kernelP_q} and \Cref{assG:kernelP_q_smallset}, the Markov chain is$V$-uniformly geometrically ergodic, which implies $\sum_{\ell=-\infty}^\infty | \varsigma_\pi(g,\ell)| < \infty$.
Therefore, we can calculate the spectral density $f(g,\lambda)= (2\uppi)^{-1}\sum_{\ell = -\infty}^{\infty} \varsigma_\pi(g,\ell) \rme^{-\rmi \ell \lambda}$, for $\lambda \in [-\pi,+\pi]$. If we additionally assume that there is $f_{\min} \in \rset_{+}$ such that $f(g,\lambda) \geq f_{\min}$ for all $\lambda \in [-\pi,\pi]$, it is straightforward to show that $\PVar[\pi](S_n) \geq n f_{\min}$ and hence the constant
\[
\ConstJ \leq \biggl(\frac{\ratev^{-1/2} \{\log(1/\ratev)\}^{-1} \Constmainros^{2}}{f_{\min}} \vee 1\biggr) \frac{ 2^{1+3\gamma}\gamma^{3\gamma} \Constmainros}{\log(1/\ratev)}
\]
is independent of $n$.
\end{remark}
Finally, we provide a Bernstein-type bound for the case of an arbitrary initial distribution. For this proof we again use distributional coupling, but the reasoning is more complicated to obtain Weibulian dependence in the initial conditions.
\begin{comment}
\begin{corollary}
\label{th:rosenthal_log_V_cor_1}
Under assumptions of \Cref{th:rosenthal_log_V}, for any $q \geq 1$
\begin{equation}
\PE_{\pi}[|S_n|^{2q}] \leq 2^{2q+1}q!\{\PVar[\pi](S_n)\}^q + 2\rme \Constroslogmom^{q} q^{(6+6\gamma)q} \ConstB^{(6+6\gamma)q}\eqsp,
\end{equation}
where
\begin{equation}
\label{eq:const_K_2_def}
\Constroslogmom = 2^{18+18\gamma}\rme^{-(3\gamma+3)}(3\gamma+3)^{6\gamma+6}\eqsp.
\end{equation}
\end{corollary}
\begin{proof}
The proof is postponed to ~\Cref{sec:proof_moment_corollary_bentkus}.
\end{proof}
\end{comment}

\begin{theorem}
  \label{theo:prob_ineq_V_norm}
  Assume \Cref{assG:kernelP_q} and \Cref{assG:kernelP_q_smallset} and let $\gamma \geq 0$. Then, for any initial distribution $\xi$ on $(\Xset,\Xsigma)$, $g \in \mrl_{W^\gamma}$, and $t \geq 0$, it holds setting  $\varpi_{\gamma} = 1/(1+\gamma)$, that
  \begin{align*}
%    \label{eq:1}
&\PP_{\xi}(|S_n| \geq t) \leq    \PP_{\pi}(|S_n| \geq t/4) \\
    & \quad + \parenthese{\frac{\rme^{-\log(1/\rho)t^{\varpi_{\gamma}}/(4^{1+\varpi_{\gamma}}\|\bar{g}\|_{W^\gamma}^{\varpi_{\gamma}}\varpi_{\gamma})}}{\ratev^{1/2}} +   \frac{\rme^{-(1+\gamma) t^{\varpi_{\gamma}}/(2^{1+2\varpi_{\gamma}}\|\bar{g}\|_{W^\gamma}^{\varpi_{\gamma}}\gamma)}}{1-\ratev} }\cmconstv \{ \xi(V) + \pi(V) \}\eqsp.
  \end{align*}
\end{theorem}
\begin{proof}
  The proof is postponed to \Cref{sec:non-stationary-extension}.
\end{proof}
It is worth noting that the exponent of the terms reflecting the dependence in the initial conditions is $1/(1+\gamma)$, as in \cite[Theorem~5.1]{adamczak2015exponential}, but without the assumption of strong aperiodicity. Finally, unlike \cite[Theorem~5.1]{adamczak2015exponential}, the dependence in the initial condition appears as a multiplicative factor rather than in the exponential rate.
\subsection{Geometrically ergodic Markov chains with respect to Wasserstein semi-metric}
\label{sec:geom-ergod-mark}
Now we extend the results obtained in \Cref{sec:geom-v-ergod} to the case of Markov kernels that are geometrically contracting for a weighted Wasserstein (pseudo)distance. The advantage of this setting is that we do not have to assume that the Markov kernel is irreducible. This is a significant advantage for the study of stochastic algorithms (which is one of the goals of this paper), but also for Markov chains in infinite dimensions; see \cite{hairer2011asymptotic,hairer:stuart:vollmer:2012,butkovsky:veretennikov:2013} and \cite[Chapter~20]{douc:moulines:priouret:soulier:2018} and references therein.
In this section we assume that $(\Xset,\distance)$ is a complete separable metric space and denote by $\Xsigma$ its Borel $\sigma$-field. Let $\cost:\Xset\times\Xset\to\rplus$ satisfy the following condition.
\begin{assumptionC}
  \label{ass:cost_fun}
$\cost$ is a lower semicontinuous symmetric function such that $\cost(x,x')=0$ for $x=x'$. Also, there is $\pcost \in\nsets$ such that for any $x,x'\in\Xset$, $(\distance(x,x') \wedge 1)^{\pcost} \leq \cost(x,x') \leq 1$.
\end{assumptionC}
A function $\cost$ satisfying \Cref{ass:cost_fun} is called distance-like.
For two probability measures $\xi$ and
$\xi'$ on $(\Xset,\Xsigma)$, we say that a probability measure $\nu$ on $(\Xset^2,\Xsigma^{\otimes 2})$ is a coupling of $\xi$ and $\xi'$, if for each $\msa \in \Xsigma$, $\nu(\msa \times \Xset) = \xi(\msa)$ and $\nu( \Xset \times \msa) = \xi'(\msa)$.
Denote by
$\couplingmeasure(\xi,\xi')$  the set of couplings of $\xi$ and
$\xi'$ on $(\Xset,\Xsigma)$,  and define
\begin{align*}
  \wasser[\cost]{\xi}{\xi'} = \inf_{\nu \in \couplingmeasure(\xi,\xi')} \int_{\Xset\times\Xset} \cost(x,x')
  \nu(\rmd x\rmd x')  \eqsp .
\end{align*}
We say that $\MKK$ is a Markov coupling of $\MK$ if for all $(x,x') \in \Xset^2$ and $\msa \in \Xsigma$, $\MKK((x, x'), \msa \times \Xset) = \MK (x, \msa)$ and $\MKK((x,x'), \Xset \times \msa) = \MK(x',\msa)$.
If $\MKK$ is a kernel coupling of $\MK$, then for every $n \in \nset$, $\MKK^n$ is a kernel coupling of $\MK ^n$ and for every $\nu \in \couplingmeasure (\xi,\xi')$, $\nu \MKK^n$ is a coupling of $(\xi \MK ^n,\xi'\MK^n)$, which means
$ \wasser[\cost]{\xi \MK ^n}{\xi' \MK ^n} \leq \int_{\Xset\times\Xset} \MKK^n\cost(x,x') \nu(\rmd x\rmd x')$.
For any  probability measure $\nu$ on $(\Xset^2,\Xsigma^{\otimes 2})$, we denote by
$\PP_{\nu}^\MKK$ (respectively $\PE_{\nu}^\MKK$) the probability (respectively the
expectation) on the canonical space $((\Xset^2)^\nset,(\Xsigma^{\otimes 2})^{\otimes \nset})$  such that the canonical process $\sequenceDouble{X}{X'}[n][\nset]$ is a Markov chain with initial
probability $\nu$ and Markov kernel $\MKK$.  By convention, we set
$\PE_{x,x'}^{\MKK} = \PE_{\delta_{x,x'}}^{\MKK}$ for all $(x,x') \in \Xset^2$.
Consider the following assumption, which weakens the $\distance$-small set condition of \cite{hairer2011asymptotic} by allowing the contraction to occur in $m \in \nset^*$ steps:
\begin{assumption}
  \label{assG:kernelP_q_contractingset_m}
 There exist a kernel coupling $\MKK$ of $\MK$, $m \in \nset, \minorwas \in (0,1)$, $\boundmetric \geq 1$ such that  \begin{equation}
  \label{eq:assG:kernelP_q_contractingset_m}
\MKK \metricc(x,x') \leq \boundmetric \metricc(x,x') \eqsp, \qquad    \MKK^m \metricc(x,x') \leq (1 - \minorwas \indi{\CKset}(x,x'))\metricc(x,x') \eqsp,
\end{equation}
where $ \CKset = \{V \leq d\} \times \{V \leq d\}$ with $\lambda+2b/(1+d)<1$ where $\lambda$ and $b$ are given in \Cref{assG:kernelP_q}.
\end{assumption}
Define for $x,x'\in\Xset$, $\bar V(x,x') = \{V(x) + V(x')\}/2$, $\bar \lambda_m = \lambda^m+ 2 b_m/(1+d)$,
$b_m = b(1-\lambda^m)/(1-\lambda)$, and $\bar d = (d+1)/2$. Consider the equation with unknown $\delta \geq 0$,
\begin{equation}
\label{eq: delta def}
(1-\minorwas)\lr{\frac{\bar \lambda_m+ b_m+\delta}{1+\delta}} =  \frac{\bar \lambda_m \bar{d}+\delta}{\bar{d}+\delta}\eqsp.
\end{equation}
Since necessarily, $b \geq 1$, note that the left-hand side of this equation is  a decreasing function of $\delta$, while the right-hand side is an increasing function. Hence, \eqref{eq: delta def} has a unique positive root (denoted by $\rootwas$) if $(1-\minorwas)(\bar \lambda_m+ b_m) > \bar \lambda_m$, and we define
\begin{equation}
\label{eq:delta_star_def}
\deltawas =
\begin{cases}
\rootwas & \text{ if } (1-\minorwas)(\bar \lambda_m+ b_m) > \bar \lambda_m\eqsp, \\
0 & \text{otherwise}\eqsp.
\end{cases}
\end{equation}
We first note that the assumptions \Cref{assG:kernelP_q} and \Cref{assG:kernelP_q_contractingset_m} imply the existence and uniqueness of an invariant distribution $\pi$, and second, that for any initial $\xi$-distribution, the $\xi \MK ^n$-iterates geometrically converge  to the invariant distribution $\pi$- for the pseudodistance $\wassersym[\metricc^{1/2} \bar{V}^{1/2}]$. This result generalizes the weak Harris theorem of \cite{hairer2011asymptotic} (see also \cite[Theorem~20.4.5]{douc:moulines:priouret:soulier:2018}).
\begin{proposition}
\label{prop:wasser:geo}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_contractingset_m} and \Cref{ass:cost_fun}, and let $q \in \nset^*$. Then for $(x,x')\in \Xset^2$, $p \le 2q$, and $n\in \nset$, $n \geq m$ it holds
\begin{equation}
\label{eq: constraction}
\PE_{x,x'}^{\MKK}[\metricc^{1/2}(X_n, X_n') \bar V^{p/(4q)}(X_n, X'_n)] \leq  \boundmetric^{m/2} \vartconstwas^{p/(2q)}  \metricc^{1/2}(x,x') \bar{V}^{p/(4q)}(x,x') \ratewas^{np/(2q)}  \eqsp,
\end{equation}
where
\begin{equation}
\label{eq:def:rho}
\ratewas  = \Bigl(\frac{\bar \lambda_m \bar{d}+\deltawas}{\bar{d}+\deltawas} \Bigr)^{1/(2m)} < 1 \eqsp,  \quad \vartconstwas = (1 + b/(1-\lambda) + \deltawas)^{1/2} / \ratewas^m \eqsp.
\end{equation}
\end{proposition}
\begin{corollary}
\label{cor:wasserstein-convergence}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_contractingset_m}, and \Cref{ass:cost_fun}. Then $\MK$ admits a unique invariant probability measure $\pi$ satisfying $\pi(V) < \infty$. Moreover, for all
  initial distributions $\xi$ and $n\in \nset$,
  \begin{equation}
    \label{eq:wasser:geo:bound:pi}
    \wasser[\cost]{\xi \MK^n}{\pi} \leq \wasser[\cost^{1/2} \bar V^{1/2}]{\xi \MK^n}{\pi}
    \leq  (1/\sqrt{2}) \boundmetric^{m/2} \vartconstwas  \ratewas^{n}    \lrb{\xi(V^{1/2})+\pi(V^{1/2})} \eqsp.
  \end{equation}
\end{corollary}
\begin{proof}
The proof is postponed to \Cref{sec:proof-ros_W_q}.
\end{proof}
%definition of a new norm
For a measurable function  $\lyapW: \Xset \to \coint{1,\infty}$, set $\bar \lyapW(x,y) = (\lyapW(x) + \lyapW(y))/2$, and for  $\beta \in \rset_+$, define
\begin{equation*}
  \Nnorm[\beta, \lyapW]{f} = \max \bigg \{\sup_{\substack{x,x'\in\Xset\eqsp, \,\, x \neq x'}} \frac{|f(x) - f(x')|}{\metricc^{1/2}(x,x') \bar{\lyapW}^{\beta}(x,x')} , \, \sup_{x \in \Xset} \frac{|f(x)|}{\lyapW^{\beta}(x)} \bigg\}\eqsp,
\end{equation*}
and $\Lclass_{\beta,\lyapW} = \{f: \Xset \to \rset: \Nnorm[\beta,\lyapW]{f} < \infty\}$. The first main result of this section is a Rosenthal-type inequality for geometrically ergodic Markov chains in terms of the Wasserstein semi-metric. Again, the leading term is the stationary variance multiplied by the corresponding moment of a Gaussian random variable.
\begin{theorem}
\label{th:rosenthal_V_poly_wasserstein}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_contractingset_m}, \Cref{ass:cost_fun}, and let $q \in\nsets$.
Then for any function $g \in \Lclass_{1/(4q), V}$,
\begin{equation}
\label{eq:wasser_scaling_main}
    \PE_\pi[|S_n|^{2q}] \leq \momentGq[q] \{\PVar[\pi](S_n)\}^q + \Constwasspoly^{2q} \Nnorm[1/(4q), V]{\bar{g}}^{2q} \sum_{u=1}^{q-1} \frac{\ConstB_0(u,q) n^{u}}{\ratewas^{u/2} \{\log(1/\ratewas)\}^{2q-u}}\eqsp,
\end{equation}
where $\ConstB_0(u,q)$ is defined in~\eqref{eq: B_u_q_def_new} and with $\vartconstwas$ in \eqref{eq:def:rho},
\begin{equation}
\label{eq:const_poly_class_wasserstein}
\Constwasspoly = 2\sqrt{2} \boundmetric^{m/2} \vartconstwas \{\pi(V)\}^{1/2}\eqsp.
\end{equation}
\end{theorem}
\begin{proof}
The proof is postponed to~\Cref{sec:proof:rosenthal_V_poly_wasserstein}.
\end{proof}

Note that the right-hand side of \eqref{eq:wasser_scaling_main} has the same homogeneous scaling with respect to the ratio $n/\log(1/\ratewas)$ as in the corresponding bound for the $V$-geometrically ergodic case \eqref{eq:main-rosenthal}. We can now extend this result to the non-stationary case in a similar way to \Cref{theo:changeofmeasure}.
We use here a coupling argument but unlike \Cref{theo:changeofmeasure} we do not use a distributional coupling but a coupling kernel together with the coupling inequality outlined in \Cref{prop:wasser:geo}.
\begin{theorem}
\label{theo:changeofmeasure_wasser}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_contractingset_m}, \Cref{ass:cost_fun}, and let $q \in \nset^*$. Then, for any probability measure $\xi$ on $(\Xset,\Xsigma)$ satisfying $\xi(V^{1/2}) < \infty$ and $g \in \Lclass_{1/(4q), V}$, we get
\begin{equation*}
     \PE_\xi\big[ \big|S_n \big|^{2q} \big] \leq 2^{2q-1} \PE_\pi\big[ \big|S_n \big|^{2q} \big] + 2^{4q-1} \Nnorm[1/(4q), V]{\bar{g}}^{2q}\,\boundmetric^{m/2}  \vartconstwas \{\xi(V^{1/2}) + \pi(V^{1/2})\} \frac{q^{2q}}{\ratewas (\log(1/\ratewas))^{2q}}\eqsp.
\end{equation*}
\end{theorem}
\begin{proof}
  The proof is postponed to \Cref{sec:proof-crefth_wass_change_mease}.
\end{proof}

Finally, we provide a series of results where we replace the class $\Lclass_{1/(4q), V}$ by the class $\Lclass_{1, W^\gamma}$ for $\gamma \geq 0$. We first prove a Rosenthal-type inequality in the stationary case, which we then extend to the arbitrary inital distribution. Results below are the analogues of \Cref{th:rosenthal_log_V} and \Cref{theo:changeofmeasure-1}. The proof in the stationary case again involves an inequality on centered moments adapted to the weighted Wasserstein distance. The extension to the non-stationary case still requires a coupling inequality but more subtle than for \Cref{theo:changeofmeasure_wasser}.
\begin{theorem}\label{th:rosenthal_log_V_wasserstein}
  Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_contractingset_m}, \Cref{ass:cost_fun}, let $\gamma \geq 0$, $q \in \nset^*$.  Then for any $g \in \Lclass_{1, W^\gamma}$, we get
\begin{equation*}
\PE_{\pi}[|S_n|^{2q}] \leq \momentGq[q] \{\PVar[\pi](S_n)\}^q+  \Constwasspoly^{2q} (2\gamma)^{2\gamma q} \Nnorm[1,W^\gamma]{\bar{g}}^{2q}\,\sum_{u=1}^{q-1} \frac{\ConstB_{\gamma}(u,q) n^{u}}{\ratewas^{u/2} \log^{2q-u}{(1/\ratewas)}}\eqsp,
\end{equation*}
where the constant $\Constwasspoly$ is defined in \eqref{eq:const_poly_class_wasserstein}.
\end{theorem}
\begin{proof}
The proof is postponed to~\Cref{sec:proof_ros_W_log}.
\end{proof}


\begin{theorem}
\label{theo:changeofmeasure-1_wasser}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_contractingset_m}, \Cref{ass:cost_fun}. Then for any probability measure $\xi$ on $(\Xset,\Xsigma)$, $\gamma \geq 0$, $q \in \nsets$ and function $g \in \Lclass_{1, W^\gamma}$, it holds
\begin{equation*}
     \PE_\xi\big[ \big|S_n \big|^{2q} \big] \leq 2^{2q-1} \PE_\pi\big[ \big|S_n \big|^{2q} \big] + 2^{2q-1} \Nnorm[1,W^\gamma]{\bar{g}}^{2q} \operatorname{D}^{(2)}_{q,\gamma} \eqsp,
\end{equation*}
\begin{multline*}
  \operatorname{D}^{(2)}_{q,\gamma}=
  \boundmetric^{m/2}  \vartconstwas \{ \xi(V^{1/2}) + \pi(V^{1/2}) \} \ratewas^{-1} \defEns{ \bigl(\frac{2\sqrt{2}}{\log(1/\ratewas)}\bigr)^{4q} (4q-1)! +  \frac{(8q\gamma/\rme)^{4q\gamma}}{\log(1/\ratewas)}}\eqsp.
\end{multline*}
\end{theorem}
\begin{proof}
The proof is postponed to \Cref{sec:proof-crefth-1_wass:theo:changeofmeasure-1_wasser}.
\end{proof}
We conclude with a Bernstein-type inequality. The following results extend \Cref{th:rosenthal_log_V_cor_2}
and \Cref{theo:prob_ineq_V_norm}. The proof of \Cref{th:rosenthal_log_V_cor_2} is straightforward due to the centered moment inequality. The non-stationary extension \Cref{th:rosenthal_log_V_cor_2_wasserstein_non_statio} requires more effort to obtain the correct dependence in the initial conditions (which is the same as in the $V$-geometric-ergodic case).
\begin{theorem}
\label{th:rosenthal_log_V_cor_2_wasserstein}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_contractingset_m}, \Cref{ass:cost_fun}. Then,  for any $\gamma \geq 0$, $g \in \Lclass_{1, W^\gamma}$, and  $t \geq 0$,
\begin{equation}
\PP_{\pi}(|S_n| \geq t) \leq 2\exp\biggl\{-\frac{t^2/2}{\PVar[\pi](S_n) + \ConstJW^{1/(\gamma+3)} t^{2-1/(\gamma+3)}}\biggr\}\eqsp,
\end{equation}
where $\ConstJW$ is given by
\begin{equation}
\label{eq:const_J_n_definition_main_was}
\ConstJW = \biggl( \frac{n \ratewas^{-1/2} \{\log(1/\ratewas)\}^{-1} \Constwasspoly^{2} (2\gamma)^{4\gamma} \Nnorm[1, W^{\gamma}]{\bar{g}}^{2}}{\PVar[\pi](S_n)} \vee 1\biggr) \frac{2 (2\gamma)^{2\gamma} \Constwasspoly \Nnorm[1, W^{\gamma}]{\bar{g}}}{\log(1/\ratewas)}\eqsp.
\end{equation}
\end{theorem}
\begin{proof}
The proof is postponed to ~\Cref{sec:proof_bernstein_bound_wasserstein}.
\end{proof}


\begin{theorem}
\label{th:rosenthal_log_V_cor_2_wasserstein_non_statio}
Assume \Cref{assG:kernelP_q}, \Cref{assG:kernelP_q_contractingset_m}, \Cref{ass:cost_fun}. Then,  for any probability measure $\xi$ on $(\Xset,\Xsigma)$ satisfying $\xi(V^{1/2}) < \infty$,  $\gamma \geq 0$,  function $g \in \Lclass_{1, W^\gamma}$, and  $t \geq 0$, it holds that
\begin{align*}
&\PP_{\xi}(|S_n| \geq t) \leq
  \PP_{\pi}(|S_n| \geq t/2) \\
&\quad   +  \exp\parenthese{-\frac{\log(1/\ratewas) t^{\varpi_{\gamma}}}{2^{3+\varpi_{\gamma}} \Nnorm[1,W^\gamma]{\bar{g}}^{\varpi_{\gamma}} \varpi_{\gamma}}}\defEns{1+(-\log(\ratewas)/4)\frac{[ \boundmetric^{m/2}  \vartconstwas \{\pi(V^{1/2}) + \xi(V^{1/2})\}]^{1/2}}{\ratewas^{1/4}(1-\ratewas^{1/4})}} \\
  &\quad   +\exp\parenthese{-\frac{ (1+\gamma)\upsilon_{\gamma} t^{\varpi_{\gamma}}}{2^{5+\varpi_{\gamma}} \Nnorm[1,W^\gamma]{\bar{g}}^{\varpi_{\gamma}} \gamma }}\defEns{1+ \upsilon_{\gamma} \sup_{a \geq \rme} \{a^{4^{-1}\upsilon_{\gamma}}\log(a)\} \frac{[\boundmetric^{m/2}  \vartconstwas \{\pi(V^{1/2}) + \xi(V^{1/2})\}]^{\upsilon_{\gamma}}}{1-\ratewas^{\upsilon_{\gamma}}}}\eqsp,
\end{align*}
where $\varpi_{\gamma} = 1/(1+\gamma)$ and $\upsilon_{\gamma} = 1\wedge(2\gamma)^{-1}$\,.
\end{theorem}
\begin{proof}

The proof is postponed to \Cref{sec:proof-crefth:r_th:rosenthal_log_V_cor_2_wasserstein_non_statio}.
\end{proof}
\subsection{Related works}
\label{sec:related-works}
Moment bounds and the concentration of the additive function of Markov chains have been studied in many papers using a wealth of different techniques; the list of papers below does not claim to be exhaustive, but rather provides a selection of existing results and related theoretical tools. \cite{dedecker2015subgaussian} used coupling techniques to obtain Azuma-Hoeffding type inequality (the variance parameter is not considered) for geometrically ergodic Markov chains and bounded functions $g$ \footnote{\cite{dedecker2015subgaussian} considered separately bounded functions, which is more general than additive functionals}; this result was extended to unbounded functions by \cite{wintenberger2017exponential} but with random normalization.
 In \cite{marton1996measure}, Hoeffding inequalities are derived using Marton coupling. \cite{samson2000concentration} extends Marton's information-theoretic approach to obtain Gaussian concentration results for uniformly ergodic Markov chains and $\Phi$-mixing processes.
Probability bounds for Markov kernels that are contractive with respect to a Wasserstein distance are presented in \cite{joulin:ollivier:2010}. However, additional conditions are needed involving quantities such as \textit{granularity} and \textit{local dimension}, which are difficult to evaluate in most applications.

% In addition, probability bounds are
Using Kato's perturbation theory on the spectrum of bounded operators on Hilbert space \cite{kato:2013}, \cite{lezaud:1998} establishes Chernoff-type bounds for Markov chains on general state spaces and bounded functions $g$. This work was followed by
\cite{paulin2015concentration,fan:jiang:sun:2018:hoeffding,fan:jiang:sun:2018:bernstein}, which establish Hoeffding and Berstein probability bounds using spectral methods for Markov chains and bounded functions $g$ under the assumption that $\MK$ admits a positive absolute spectral gap.
% \cite{paulin2015concentration} established Bernstein-type inequalities for additive functionals of Markov chains and bounded $\{g_\ell\}_{\ell=0}^{n-1}$; for non-reversible Markov chains, the Bernstein bound depends on a proxy for the variance and a pseudo-spectral gap which is difficult to evaluate for most examples.
Note also that geometric ergodicity assumptions (see \Cref{assG:kernelP_q} and \Cref{assG:kernelP_q_smallset}) do not necessarily imply the existence of a spectral gap (see \cite{kontoyiannis2012geometric}).
% , moreover, evaluation of the constants in the Bernstein-type inequalities \cite[Theorems~3.4-3.5]{paulin2015concentration} is intractable.

\cite{kontoyiannis2003spectral,kontoyiannis2005large} develop the theory of multiplicative regular Markov chains based on multiplicative drift conditions which strengthen the classical Foster-Lyapunov drift conditions.
These conditions, introduced by \cite{varadhan:1984}, play a key role in the study of large deviations of additive functions of Markov chains. Multiplicative drift conditions are generally difficult to verify; see the discussion in \cite[Section~3.1]{adamczak2015exponential}. The bounds reported in these papers are not quantitative: the bounds depend on the multiplicative Poisson equation, which amounts to solving an eigenvalue problem for an operator associated with $\MK$.

\cite{clemenccon2001moment,bertail2010sharp,Adamczak2008,adamczak2015exponential,bertail2018new,lemanczyk2020general}
use regenerative decompositions to obtain, among others, moment bounds and Bernstein inequalities under \Cref{assG:kernelP_q} and \Cref{assG:kernelP_q_smallset}.
%These methods apply to $\phi$-irreducible Markov chains (assuming equivalently the existence of an accessible small set).
These techniques are based on the Numellin splitting construction (see \cite{athreya1978new} and \cite{Nummelin1978AST}), which allows the sum $S_n$ to be decomposed into a random number of single-valued blocks of random length. The regenerative decomposition allows one to derive exponential inequalities for additive functionals of Markov chains from the concentration of a (random) sum of one-dependent random variables, at the cost of some very non-trivial technical work. \cite[Theorem~1]{adamczak2015exponential} provides a Bernstein-type inequality for a $V$-uniformly geometrically ergodic strongly aperiodic Markov chain and unbounded functions. \cite[Theorem~1]{lemanczyk2020general} extends the result to aperiodic Markov chains, but is restricted to bounded functions and does not give an explicit expression for constants.


%\cite{kloeckner2019effective} and the references therein.

Moment bounds and Bernstein-type inequalities have also been obtained under various conditions of weak dependence/mixing; see \cite{doukhan:louhichi:1999,doukhan2007probability,merlevede2011bernstein}. In general, these results are not directly comparable because the bounds depend on different types of weak dependence/mixing coefficients instead of drift conditions and local minorization/contraction conditions. However, the connections between weak dependence/mixing assumptions and $V$-geometric ergodicity are discussed in detail in \cite{adamczak2015exponential}. The results based on weak dependence / mixing methods are more appropriate for the stationary case. The extensions for the non-stationary case are less accurate than those given in our work (the way the bounds depend on the initial conditions). Finally, note that our proof for the stationary case is based on the argument developed by \cite{doukhan2007probability}, which we adapt to the Markov case. Compared to that work, we replace a covariance bound with an accurate bound for centered moments.


\input{examples}
\input{proof}

\section*{Declarations}

\textbf{Conflict of interest. } The authors have no competing interests to declare that are relevant to the content of this article.

\noindent\textbf{Data availability. } Data sharing is not applicable to this article as no datasets were generated or analyzed during the current study.

\newpage
\bibliography{biblio}
\end{document}



\bibliography{sn-bibliography}% common bib file
%% if required, the content of .bbl file can be included here once bbl is generated
%%\input sn-article.bbl


%\end{document}
