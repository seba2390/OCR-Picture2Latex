\subsubsection{Repetition Coding}
\label{subsubsec:repetition_coding}

Consider a coding scheme that simply ignores the weaker user and focuses on using the stronger user's feedback to retransmit each of his required source symbols until it is received.  We wish to calculate the expected value of $\Nretransmit$, which we define as the number of \emph{unique} source symbols received by the weaker user when $k \in \mathbb{N}$ symbols are to be sent to the stronger user via repetition coding.

Let $\nRepi{i}$ be a random variable representing the number of transmissions needed to be sent for symbol $S(i)$ to be received by the \emph{stronger} user, user~1, in the repetition scheme.  Let $\indi{i}$ be an indicator variable indicating whether symbol $S(i)$ was received by the \emph{weaker} user, user~2, in any of the $\nRepi{i}$ transmissions and let $\vecnRep = \{\nRepi{1}, \nRepi{2}, \ldots, \nRepi{k}\}$ be the vector of random variables giving the number of repetitions needed to send each source symbol.  %Lastly, let $\Nretransmit$ be the number of unique source symbols received by the weaker user during the repetition scheme for the stronger user.  
Given $\vecnRep$, we calculate $\mathbb{E}(\Nretransmit | \vecnRep)$ as 

\setcounter{cnt}{1}
\begin{align}
	\mathbb{E}(\Nretransmit | \vecnRep) &= \sum_{i = 1}^{k} \mathbb{E}(\indi{i} | \vecnRep) \\
	&= \sum_{i = 1}^{k} \Prob(\text{user~2 receives } S(i) | \vecnRep) \\
%	\addtocounter{cnt}{1}
	&\stackrel{(\alph{cnt})}{=} \sum_{i = 1}^{k} \left\{1 - \textrm{Pr}(Z_2(t) = 1 | Z_{1}(t) = 1)^{\nRepi{i} - 1}\textrm{Pr}(Z_2(t) = 1 | Z_{1}(t) = 0) \right\}\\
	\addtocounter{cnt}{1}	
	\label{eq:Nretransmit_g_Mi}	
	&\stackrel{(\alph{cnt})}{=} \sum_{i = 1}^{k} \left\{1 - \left( \frac{\epsot}{\epsilon_1} \right)^{\nRepi{i} - 1} \left(\frac{\epsilon_2 - \epsot}{1 - \epsilon_1}\right)\right\}
%	\addtocounter{cnt}{1}	
%	&\stackrel{(\alph{cnt})}{=}  k - \sum_{i = 0}^{k} \epsilon_{2}^{\nRepi{i}} \\
\end{align}
where 
\begin{enumerate}[(a)]
	\item follows by construction of the repetition-based scheme
	\item we have calculated the conditional probabilities from~\eqref{eq:pmf_z1z2}.
\end{enumerate}

\setcounter{cnt}{1}
We next use the law of total probability to get that 
\begin{align}
	\ENretransmit &= \sum_{\vecnRep} \mathbb{E}(\Nretransmit | \vecnRep) \Prob(\vecnRep) \\
	&\stackrel{(\alph{cnt})}{=} \sum_{\vecnRep} \sum_{i = 1}^{k} \left\{1 - \left( \frac{\epsot}{\epsilon_1} \right)^{\nRepi{i} - 1} \left(\frac{\epsilon_2 - \epsot}{1 - \epsilon_1}\right)\right\}  \Prob(\vecnRep) \\
	\addtocounter{cnt}{1}
	&\stackrel{(\alph{cnt})}{=} \sum_{i = 1}^{k}  \sum_{j= 1}^{\infty}  \left\{1 - \left( \frac{\epsot}{\epsilon_1} \right)^{\nRepi{i} - 1} \left(\frac{\epsilon_2 - \epsot}{1 - \epsilon_1}\right)\right\} \Prob(\nRepi{i} = j)  \\
	\addtocounter{cnt}{1}
	&= k - \left(\frac{\epsilon_2 - \epsot}{1 - \epsilon_1}\right)\sum_{i = 1}^{k}  \sum_{j= 1}^{\infty} \epsilon_{2}^{j} \Prob(\nRepi{i} = j)  \\
	&\stackrel{(\alph{cnt})}{=} k - \sum_{i = 1}^{k}  \sum_{j= 1}^{\infty} \epsilon_{2}^{j} (\epsilon_{1}^{j - 1}(1 - \epsilon_1))  \\
	\addtocounter{cnt}{1}	
	&= k \left( 1 - \epsilon_2(1 - \epsilon_1)  \sum_{j= 1}^{\infty} (\epsilon_{1}\epsilon_2)^{j-1}   \right) \\
%	\addtocounter{cnt}{1}	
	&\stackrel{(\alph{cnt})}{=} k \left( 1 - \epsilon_2(1 - \epsilon_1) \left\{ \frac{1}{1 - \epsilon_1\epsilon_2}\right\}   \right) \\
	\label{eq:ENretransmit}
	&=  k \cdot \frac{1 - \epsilon_2}{1 -\epsilon_1\epsilon_2}
\end{align}
where 
\begin{enumerate}[(a)]
	\item follows from~\eqref{eq:Nretransmit_g_Mi}
	\item follows from the fact that the $\nRepi{i}$ are i.i.d.
	\item follows from the fact that by construction, $\nRepi{i}$ is a geometric random variable with probability of success $(1 - \epsilon_1)$
	\item follows from the formula for the geometric series and the fact that $\epsilon_1\epsilon_2 < 1$.
\end{enumerate}

\begin{myLemma}
\label{lem:repetition}
	Let $k$ source symbols be sent to the stronger user via a repetition scheme.  Then $\ENretransmit $, the expected number of unique source symbols received by the weaker user, is given by~\eqref{eq:ENretransmit}.
\end{myLemma}