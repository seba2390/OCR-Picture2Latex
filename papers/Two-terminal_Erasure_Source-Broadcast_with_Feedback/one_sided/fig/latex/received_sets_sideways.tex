%\begin{pspicture}[showgrid=false](0,-4)(15, 0)
\begin{pspicture}[showgrid=true](0,-4.5)(15, 0)
	\psset{gratioWh=2}


	\pssignal(0,-2) {S}{$S^N$}
	
	\pssignal(1.5,-0.5){A}{$\mathbf{A}$}
	\pssignal(1.5,-3.5){Ab}{$A^{\complement}$}	

	\pssignal(3,0.5){B}{$B$}
	\pssignal(3,-1.5){Bb}{$B^{\complement}$}	

	\pssignal(3,-2.5){C}{$C$}
	\pssignal(3,-4.5){Cb}{$C^{\complement}$}	

	%%%%%%%%%%%%%%%%%%  Encoders %%%%%%%%%%%%%%%%%%

%%	\newcount\cnt
%%
%%	\psfblock(3,0){enc}{Encoder}
%%	\dotnode(5.5,0){dot1}
%%	\dotnode(5.5,-2.5){dot2}
%%%	\dotnode(7,0){dot2}
%%
%%%	\dotnode(1,-2.5){dot4}
%%
%%	% Test Channel	
%%%	\dotnode(1,0){dot3}
%%%	\pscircleop[operation=plus](1,-2.5){op3} 
%%%	\pssignal(3,-2.5){W}{$W^{k}$}
%%%	\pssignal(1,-3.5) {U}{$U^{k}$}
%%	
%%	%%%%%%%%%%%%%%%%%% Multipliers %%%%%%%%%%%%%%%%%%
%%%	\cnt=0
%%%	\psforeach{\ry}{0,-2.5}{\advance\cnt by 1\relax
%%%		\pscircleop[operation=times](8,\ry){op\the\cnt}
%%%	}
%%
%%	% Channel
%%	\psfblock(8,0){channel1}{$\textrm{BEC}(\epsilon_{1})$}	
%%	\psfblock(8,-2.5){channel2}{$\textrm{BEC}(\epsilon_{2})$}	
%%
%%%	\psfblock(8,0){channel1}{$p(Y_{1}|X)$}	
%%%	\psfblock(8,-2.5){channel2}{$p(Y_{2}|X)$}	
%%	
%%	%%%%%%%%%%%%%%%%%%  Decoders %%%%%%%%%%%%%%%%%%
%%	\psfblock(11,0){dec1}{Decoder 1}
%%	\psfblock(11,-2.5){dec2}{Decoder 2}
%%		
%%	%%%%%%%%%%%%%%%%%%  S hat %%%%%%%%%%%%%%%%%%
%%	\pssignal(14,0){b1}{$\hat{S}_{1}^{k}$}
%%	\pssignal(14,-2.5){b2}{$\hat{S}_2^{k}$}
%%
%%	%%%%%%%%%%%%%%%%%%  Noise symbols %%%%%%%%%%%%%%%%%%
%%	% Draw N1 noise symbols
%%%	\pssignal(8,-1){N1_1}{$N_{1}^{n}$}
%%%	\pssignal(8,-3.5){N2_1}{$N_{2}^{n}$}
%%
%%
%%	% Only one feedback
%%%%	\dotnode(9.5,-2.5){Y2dot_high}
%%%%	\dotnode(9.5,-3.5){Y2dot_low}
%%%%	\pnode(2.5,-0.65){encdot2_high}
%%%%	\pnode(2.5,-3.5){encdot2_low}
%%
%%
%%	\dotnode(9.5,0){Y1dot_high}
%%	\dotnode(9.5,-1){Y1dot_low}
%%	\pnode(5.7,-1){loopdot_r}
%%	\pnode(5.3,-1){loopdot_l}
%%	\pnode(3.5,-0.65){encdot_high}
%%	\pnode(3.5,-1){encdot_low}
		
	%%%%%%%%%%%%%%%%%%  Connecting blocks 	%%%%%%%%%%%%%%%%%%
%	\nclist[style=Arrow]{ncline}[naput]{S,enc,channel1  $X_{i}$,dec1 $Y_{1,i}$,b1}
%	\nclist[style=Arrow]{ncline}[naput]{channel2,dec2 $Y_{2,i}$,b2}
%	\ncangle[style=Arrow,angleA=-90,angleB=180]{dot1}{channel2}
%	\ncline[style=Arrow]{N1_1}{op1}
%	\ncline[style=Arrow]{N2_1}{op2}

	% Test Channel
%	\ncline[style=Arrow]{W}{op3}
%	\ncline[style=Arrow]{dot3}{op3}
%	\ncline[style=Arrow]{op3}{U}

	\nclist[style=Arrow]{ncline}[naput]{S,A $N(1 - \epsilon_1)$}
	\nclist[style=Arrow]{ncline}[naput]{S,Ab $N\epsilon_1$}
%	\nclist{ncline}{S,A}
	\nclist{ncline}{A, B}
	\nclist{ncline}{A, Bb}
%	\nclist{ncline}{S, Ab}
	\nclist{ncline}{Ab, C}
	\nclist{ncline}{Ab, Cb}
%	\ncarc[arcangle=-100]{loopdot_l}{loopdot_r}
%	\nclist{ncline}{loopdot_l,encdot_low}
%	\nclist[style=Arrow]{ncline}{encdot_low, encdot_high}
%	\nclist[linecolor=red,style=Arrow]{ncline}{fdbck_dot_enclow,enc}		

	% only one feedback
%%	\nclist{ncline}{Y2dot_high,Y2dot_low,encdot2_low}
%%	\nclist[style=Arrow]{ncline}{encdot2_low, encdot2_high}
	
\end{pspicture}