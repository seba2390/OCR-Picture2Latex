\begin{figure}
\centering
\begin{lstlisting}[style=haskell]
-- App version 1
import Dir (exists)
import Hash (mkHash)

main () =
  let s = getArg () in
  let digest = mkHash s in
  if exists digest
    then print "Found"
    else error "Not found"
\end{lstlisting}

\begin{lstlisting}[style=haskell]
-- Dir version 1
import Hash (match)

exists hash = 
  let files = getFileList () in
  foldLeft
    (\(acc, f) ->
      acc || match f hash)
    false
    files
\end{lstlisting}

\begin{lstlisting}[style=haskell]
-- Hash version 1
mkHash s = (* generate MD5 hash *)
match s hash = (mkHash s) == hash
\end{lstlisting}

\caption{\textit{App}, \textit{Dir}, and \textit{Hash} modules \emph{before} update.}
\label{list1}
\end{figure}