\begin{figure}[tb]
\centering
% \begin{minipage}[t]{0.49\textwidth}
\begin{tikzpicture}[thick, node distance=0.8cm and 1cm]
\tikzset{codeblock/.style={
    % inner xsep=20pt,
    outer xsep=-7pt,
    outer ysep=-7pt,
    rectangle,
    % fill=gray!10,
    % text width=3cm,
    text centered,
    rounded corners,
    % minimum height=1.5cm,
    minimum width=5.8cm
}};


\node[codeblock] (app1) {
\begin{minipage}{.44\linewidth}
% \begin{lstlisting}[style=haskell]
\begin{minted}[linenos,numbersep=2pt,highlightcolor=white,highlightlines={6-7}]{haskell}
module App where
import Dir
import Hash
main () =
  let s = getArg ()
      digest = mkHash s in
  if exists digest
    then print "Found"
    else error "Not found"
\end{minted}
% \end{lstlisting}
\end{minipage}
% \hspace*{-15pt}
};

\node[codeblock, right=of app1] (dir1) {
\begin{minipage}{.42\linewidth}
% \begin{lstlisting}[style=haskell]
\begin{minted}{haskell}
module Dir where
import Hash
-- version 1.0.0
exists hash = 
  let fs = getFiles () in
  foldLeft
    (\(acc, f) ->
      acc || match f hash)
    false fs
\end{minted}
% \end{lstlisting}
\end{minipage}
% \hspace*{-15pt}
};

\node[codeblock, below right=of app1] (hash1) {
\begin{minipage}{.42\linewidth}
% \begin{lstlisting}[style=haskell]
\begin{minted}{haskell}
module Hash where
-- version 1.0.0
mkHash s = {- MD5 hash -}
match s hash =
    mkHash s == hash
\end{minted}
% \end{lstlisting}
\end{minipage}
% \hspace*{10pt}
};

\node[codeblock, below=of app1] (hash2) {
\begin{minipage}{.44\linewidth}
% \begin{lstlisting}[style=haskell]
\begin{minted}{haskell}
module Hash where
-- version 2.0.0
mkHash s = {- SHA-3 hash -}
match s hash =
    mkHash s == hash
\end{minted}
% \end{lstlisting}
\end{minipage}
% \hspace*{10pt}
};

\coordinate [below = 0.4 of dir1] (B) {};

\draw[->] (app1.east)  -- node[midway,above] {} (dir1.west);
% \draw[->] ([yshift=-0.5cm]app1.east)  -- node[midway,below] {version 2} ([yshift=-0.5cm]dir1.west);
\draw[->,red] (app1.south) -- node[midway,left] {\textcolor{red}{version 2.0.0}}(hash2.north);
% node[midway, draw=red, shape=cross out,inner sep=7pt, outer sep=0pt] {}
\draw[dashed,->] ([xshift=0.5cm]app1.south) |- ([xshift=-0.5cm]B) -- ([xshift=-0.5cm]hash1.north);
% \draw[->] (app1.south) -- node[midway,above] {version 2} (hash2.north);
\draw[->] (dir1.south) -- node[midway,right] {version 1.0.0} (hash1.north);
% \draw[line width=1pt, double distance=3pt,
%              arrows = {-Latex[length=0pt 3 0]}] (hash1.west) -- node[midway,above] {Update} (hash2.east);

\end{tikzpicture}


\parbox[t]{.9\linewidth}{\small The \fn{exists} provided from \mn{Dir} (which depends on version $1$ of \mn{Hash}) expects an MD5 hash as an argument. However, after the dependency update of \mn{App} on \mn{Hash}, the value assigned to \texttt{digest} is a SHA-3 hash.}

\caption{Minimal module configuration before and after the dependency update  causing an error due to inconsistency expected to the dependent package.}
\label{fig2-1}
% \end{minipage}
\end{figure}