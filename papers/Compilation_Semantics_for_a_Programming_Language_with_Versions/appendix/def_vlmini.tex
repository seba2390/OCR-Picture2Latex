\section{\vlmini{} Definitions}

\subsection{\vlmini{} Syntax (w/o version control terms/data constructors)}

\paragraph{\textnormal{\textbf{\vlmini{} syntax}}}
\begin{align*}
t \quad&::=\quad n \mid x \mid \app{t_1}{t_2} \mid \lam{p}{t} \mid \pr{t} \tag{terms}\\
p \quad&::=\quad x \mid [x] \tag{patterns}\\
A, B \quad&::=\quad \alpha \mid \inttype{} \mid \ftype{A}{B} \mid \vertype{r}{A} \tag{types}\\
\kappa \quad&::=\quad \typekind{} \mid \labelskind{} \tag{kinds}\\
r      \quad&::=\quad \alpha \mid  \bot \mid \{\overline{l_i}\} \tag{version resources}\\
\mathcal{L}\ \ni\ l\quad&::=\quad \{\overline{M_i = V_i}\} \tag{version labels}
\end{align*}
where $M_i\in\mathcal{M}$ and $V_i\in\mathcal{V}_{M_i}$ are metavariables over module names and versions of $M_i$, respectively.

\paragraph{\textnormal{\textbf{\vlmini{} contexts}}}
\begin{align*}
\Gamma,\Delta \quad&::=\quad \emptyset \mid \Gamma, x:A \mid \Gamma, x:\verctype{A}{r} \tag{contexts}\\
\Sigma \quad&::=\quad \emptyset \mid \Sigma, \alpha:\kappa \tag{type variable kinds}\\
R      \quad&::=\quad - \mid r \tag{resource contexts}
\end{align*}

\paragraph{\textnormal{\textbf{\vlmini{} constraints}}}
\begin{align*}
\mathcal{C} \quad&::=\quad \top \mid \mathcal{C}_1 \land \mathcal{C}_2 \mid \mathcal{C}_1 \lor \mathcal{C}_2 \mid \alpha \preceq \alpha' \mid \alpha \preceq \mathcal{D} \tag{dependency constraints}\\
\mathcal{D} \quad&::=\quad \cs{\overline{M_i = V_i}} \tag{dependent labels}\\
\Theta      \quad&::=\quad \top \mid \Theta_1 \land \Theta_2 \mid \{A \sim B\} \tag{type constraints}
\end{align*}


\paragraph{\textnormal{\textbf{\vlmini{} type substitutions}}}
\begin{align*}
\theta \quad&::=\quad \emptyset \mid \theta \circ [\alpha \mapsto A] \mid \theta \circ [\alpha \mapsto r] \tag{type substitutions}\\
\eta   \quad&::=\quad \emptyset \mid \eta\circ[\alpha \mapsto \{l\}] \tag{label substituions} 
\end{align*}







\subsection{\vlmini{} Well-formedness and Kinding}
\begin{rules}{Type variable kinds well-formedness}{\vdash \Sigma}
    \begin{minipage}{.25\linewidth}
        \infrule[Kw$_\emptyset$]{
            \\
        }{
            \vdash \emptyset
        }
    \end{minipage}
    \begin{minipage}{.70\linewidth}
        \infrule[Kw$_\alpha$]{
            \vdash \Sigma
            \andalso
            \kappa \in \{\typekind,\,\labelskind\}
            \andalso
            \alpha \notin \mathrm{dom}(\Sigma)
        }{
            \vdash \Sigma, \alpha : \kappa
        }
    \end{minipage}
\end{rules}

\begin{rules}{\vlmini{} kinding}{\Sigma \vdash A:\kappa}
    \begin{minipage}{.30\linewidth}
        \infrule[$\kappa_\textsc{Int}$]{
            \vdash \Sigma
        }{
            \Sigma \vdash \inttype : \typekind
        }
    \end{minipage}
    \begin{minipage}{.45\linewidth}
        \infrule[$\kappa_\rightarrow$]{
             \Sigma \vdash A : \typekind
             \andalso
             \Sigma \vdash B : \typekind
        }{
            \Sigma \vdash \ftype{A}{B} : \typekind
        }
    \end{minipage}
    \begin{minipage}{.50\linewidth}
        \infrule[$\kappa_\square$]{
            \Sigma \vdash r : \labelskind
            \andalso
            \Sigma \vdash A : \typekind
        }{
            \Sigma \vdash \vertype{r}{A} : \typekind
        }
    \end{minipage}
    \begin{minipage}{.35\linewidth}
        \infrule[$\kappa_\alpha$]{
            \vdash \Sigma
            \andalso
            \Sigma(\alpha) = \kappa
        }{
            \Sigma \vdash \alpha : \kappa
        }
    \end{minipage}
    \begin{minipage}{.30\linewidth}
        \infrule[$\kappa_\bot$]{
            \vdash \Sigma
        }{
            \Sigma \vdash \bot : \labelskind
        }
    \end{minipage}
    \begin{minipage}{.35\linewidth}
        \infrule[$\kappa_\textsc{Label}$]{
            \vdash \Sigma
            \andalso
            l_i \in \mathcal{L} \\
        }{
            \Sigma \vdash \{\overline{l_i}\} : \labelskind
        }
    \end{minipage}
\end{rules}

\begin{rules}{Type environment well-formedness}{\Sigma \vdash A}
    \begin{minipage}{.19\linewidth}
        \infrule[Tew$_\emptyset$]{
            \vdash \Sigma
        }{
            \Sigma \vdash \emptyset
        }
    \end{minipage}
    \begin{minipage}{.65\linewidth}
        \infrule[Tew$_\textsc{Lin}$]{
             \Sigma \vdash \Gamma
             \andalso
             \Sigma \vdash A : \typekind
             \andalso
             x \notin \mathrm{dom}(\Gamma)
        }{
            \Sigma \vdash \Gamma, x : A
        }
    \end{minipage}
    \begin{minipage}{.80\linewidth}
        \infrule[Tew$_\textsc{Gr}$]{
             \Sigma \vdash \Gamma
             \andalso
             \Sigma \vdash A : \typekind
             \andalso
             \Sigma \vdash r : \labelskind
             \andalso
             x \notin \mathrm{dom}(\Gamma)
        }{
            \Sigma \vdash \Gamma, x : \verctype{A}{r}
        }
    \end{minipage}
\end{rules}

\begin{rules}{Resource environment well-formedness}{\Sigma \vdash R}
    \begin{minipage}{.25\linewidth}
        \infrule[Rew$_{-}$]{
            \vdash \Sigma
        }{
            \Sigma \vdash -
        }
    \end{minipage}
    \begin{minipage}{.50\linewidth}
        \infrule[Rew$_r$]{
            \vdash \Sigma
            \andalso
            \Sigma \vdash r : \labelskind
        }{
            \Sigma \vdash r
        }
    \end{minipage}
\end{rules}

\begin{rules}{Type substitutions well-formedness}{\Sigma \vdash \theta}
    \begin{minipage}{.25\linewidth}
        \infrule[Sw$_{\emptyset}$]{
            \vdash \Sigma
        }{
            \Sigma \vdash \emptyset
        }
    \end{minipage}
    \begin{minipage}{.65\linewidth}
        \infrule[Sw$_\textsc{Ty}$]{
            \Sigma \vdash \theta
            \andalso
            \Sigma \vdash \alpha : \typekind
            \andalso
            \Sigma \vdash A : \typekind
        }{
            \Sigma \vdash \theta \circ [\alpha \mapsto A]
        }
    \end{minipage}
    \begin{minipage}{.65\linewidth}
        \infrule[Sw$_\textsc{Res}$]{
            \Sigma \vdash \theta
            \andalso
            \Sigma \vdash \alpha : \labelskind
            \andalso
            \Sigma \vdash r : \labelskind
        }{
            \Sigma \vdash \theta \circ [\alpha \mapsto r]
        }
    \end{minipage}
\end{rules}





























\subsection{\vlmini{} Algorithmic Type Inference System}
\label{appendix:typing_vlmini}

\begin{rules}{\vlmini{} type synthesis}{\Sigma;\Gamma \vdash t \Rightarrow A;\Sigma'; \Delta; \Theta; \mathcal{C}}
    \begin{minipage}{.45\linewidth}
      \infrule[$\Rightarrow_{\textsc{int}}$]{
        \vdash \Sigma
        \andalso
        \Sigma \vdash \Gamma
      }{
        \Sigma; \Gamma \vdash n \Rightarrow \inttype; \Sigma; \emptyset; \top; \top
      }
    \end{minipage}
    \begin{minipage}{.5\linewidth}
      \infrule[$\Rightarrow_{\textsc{lin}}$]{
        \vdash \Sigma
        \andalso
        \Sigma \vdash \Gamma
        \andalso
        x:A\in\Gamma
      }{
        \Sigma; \Gamma \vdash x \Rightarrow A; \Sigma; x:A; \top; \top
      }
    \end{minipage}
    \begin{minipage}{.5\linewidth}
      \infrule[$\Rightarrow_{\textsc{gr}}$]{
        \vdash \Sigma
        \andalso
        \Sigma \vdash \Gamma
        \andalso
        x:\verctype{A}{r}\in\Gamma
      }{
        \Sigma; \Gamma \vdash x \Rightarrow A; \Sigma; x:\verctype{A}{1}; \top; \top
      }
    \end{minipage}
    \begin{minipage}{.95\linewidth}
      \infrule[$\Rightarrow_{\textsc{abs}}$]{
        \Sigma_1, \alpha:\textsf{Type};- \vdash p:\alpha \rhd \Gamma'; \Sigma_2; \Theta_1
        \andalso
        \Sigma_2;\Gamma,\Gamma' \vdash t \Rightarrow B;\Sigma_3;\Delta; \Theta_2; \mathcal{C}
      }{
        \Sigma_1;\Gamma \vdash \lam{p}{t} \Rightarrow \ftype{\alpha}{B};\Sigma_3;\Delta\backslash\Gamma' ; \Theta_1\land\Theta_2; \mathcal{C}
      }
    \end{minipage}
    \begin{minipage}{.95\linewidth}
      \vspace{0.5\baselineskip}
      \infrule[$\Rightarrow_{\textsc{app}}$]{
        \Sigma_1; \Gamma \vdash t_1 \Rightarrow A_1 ; \Sigma_2; \Delta_1; \Theta_1; \mathcal{C}_1
        \andalso
        \Sigma_2; \Gamma \vdash t_2 \Rightarrow A_2; \Sigma_3; \Delta_2; \Theta_2; \mathcal{C}_2
      }{
        \Sigma_1;\Gamma \vdash \app{t_1}{t_2} \Rightarrow \beta; \Sigma_3, \beta:\typekind; \Delta_1+\Delta_2; \\\hspace{11em}\Theta_1\land\Theta_2\land\{A_1\sim \ftype{A_2}{\beta}\}; \mathcal{C}_1 \land \mathcal{C}_2
      }
    \end{minipage}
    \begin{minipage}{.95\linewidth}
      \vspace{0.5\baselineskip}
      \infrule[$\Rightarrow_{\textsc{pr}}$]{
        \Sigma_1 \vdash [\Gamma\cap\textsf{FV}(t)]_{\textsf{Labels}} \rhd \Gamma'
        \andalso
        \Sigma_1; \Gamma' \vdash t \Rightarrow A; \Sigma_2; \Delta; \Theta; \mathcal{C}_1
        \andalso\\
        \Sigma_3 = \Sigma_2, \alpha:\textsf{Labels}
        \andalso
        \Sigma_3 \vdash \alpha \sqsubseteq_c \Gamma' \rhd \mathcal{C}_2
      }{
        \Sigma_1;\Gamma \vdash [t] \Rightarrow \vertype{\alpha}{A}; \Sigma_3; \alpha \cdot \Delta ;\Theta; \mathcal{C}_1 \land \mathcal{C}_2
      }
    \end{minipage}
\end{rules}

\begin{rules}{\vlmini{} pattern type synthesis}{\Sigma; R\vdash p : A \rhd \Gamma; \Sigma'; \Theta; \mathcal{C}}
    % \begin{minipage}{.55\linewidth}
    %   \infrule[pInt]{
    %     \vdash \Sigma
    %     \andalso
    %     \Sigma \vdash R
    %     \andalso
    %     \Sigma \vdash A:\typekind
    %   }{
    %     \Sigma; R \vdash n : A \rhd \emptyset; \Sigma; \{A\sim\inttype\}; \top
    %   }
    % \end{minipage}
    % \begin{minipage}{.45\linewidth}
    %   \infrule[p\_]{
    %     \vdash \Sigma
    %     \andalso
    %     \Sigma \vdash R
    %     \andalso
    %     \Sigma \vdash A : \textsf{Type}\\
    %   }{
    %     \Sigma; R \vdash \_ : A \rhd \emptyset; \Sigma; \top; \top
    %   }
    % \end{minipage}
    \begin{minipage}{.50\linewidth}
      \infrule[pVar]{
        \vdash \Sigma
        \andalso
        \Sigma \vdash A : \textsf{Type}
      }{
        \Sigma; - \vdash x : A \rhd x:A; \Sigma; \top; \top
      }
    \end{minipage}
    \begin{minipage}{.6\linewidth}
      \infrule[\mbox{[}pVar\mbox{]}]{
        \vdash \Sigma
        \andalso
        \Sigma \vdash A : \textsf{Type}
        \andalso
        \Sigma \vdash r : \textsf{Labels}
      }{
        \Sigma; r \vdash x : A \rhd x:\verctype{A}{r}; \Sigma; \top; \top
      }
    \end{minipage}
    %
    \begin{minipage}{.7\linewidth}
      \vspace{0.75\baselineskip}
      \infrule[p$\square$]{
        \Sigma, \alpha:\textsf{Labels}, \beta:\textsf{Type}; \alpha \vdash x : \beta \rhd \Delta; \Sigma'; \Theta; \mathcal{C}
      }{
        \Sigma; - \vdash [x] : A \rhd \Delta; \Sigma'; \Theta \land \{A \sim \vertype{\alpha}{\beta}\}; \mathcal{C}
      }
    \end{minipage}
    % %
    % \begin{minipage}{.85\linewidth}
    %   \vspace{0.75\baselineskip}
    %   \infrule[\mbox{[}p$\square$\mbox{]}]{
    %     \Sigma, \alpha:\textsf{Labels}, \beta:\textsf{Type}; r \otimes \alpha \vdash p : \beta \rhd \Delta; \Sigma'; \Theta; \mathcal{C}
    %     % \textsf{flatten}(r,R,r',R')=(s,S)
    %   }{
    %     \Sigma; r \vdash [p] : A \rhd \Delta; \Sigma'; \Theta\land \{A \sim \vertype{\alpha}{\beta}\}; \mathcal{C}
    %   }
    % \end{minipage}
\end{rules}



\begin{rules}{\vlmini{} context grading}{\Sigma \vdash [\Gamma]_{\textsf{Labels}} \rhd \Gamma'}
        \begin{minipage}{.30\linewidth}
            \infrule[$\emptyset$]{
                \\
            }{
                \Sigma \vdash [\emptyset]_{\textsf{Labels}} \rhd \emptyset
            }
        \end{minipage}
        \begin{minipage}{.5\linewidth}
            \infrule[{[}lin{]}]{
                \Sigma \vdash [\Gamma]_{\textsf{Labels}} \rhd \Gamma'
            }{
                \Sigma \vdash [\Gamma,x:A]_{\textsf{Labels}} \rhd \Gamma', x:[A]_1
            }
        \end{minipage}
        \begin{minipage}{.55\linewidth}
            \infrule[{[}gr{]}]{
                \Sigma \vdash [\Gamma]_{\textsf{Labels}} \rhd \Gamma'
            }{
                \Sigma \vdash [\Gamma,x:[A]_r]_{\textsf{Labels}} \rhd \Gamma', x:[A]_{r}
            }
        \end{minipage}
\end{rules}

\ \newline
\hbox{where $1 = \emptyset$.}

\begin{rules}{\vlmini{} constraints generation}{\Sigma \vdash \alpha \sqsubseteq_{c} [\Gamma] \rhd \mathcal{C}}
    \begin{minipage}{.35\linewidth}
      \infrule[$\sqsubseteq^{\textsc{VD}}_\emptyset$]{
        % \Sigma \vdash \alpha : \textsf{Labels}
        \\
      }{
        \Sigma \vdash \alpha \sqsubseteq_{c} \emptyset \rhd \top
      }
    \end{minipage}
    \begin{minipage}{.60\linewidth}
      \infrule[$\sqsubseteq^{\textsc{VD}}_\Gamma$]{
        % \Sigma \vdash \alpha : \textsf{Labels}
        % \andalso
        \Sigma \vdash \alpha \sqsubseteq_{c} [\Gamma] \rhd \mathcal{C}
      }{
        \Sigma \vdash \alpha \sqsubseteq_{c} ([\Gamma], x:[A]_r) \rhd (\mathcal{C} \land (\alpha \preceq r))
      }
    \end{minipage}
  % \caption{\vlmini{} constraints generation}
  % %\ecaption{Typing of \corelang}
  % % \Description{\corelang algorithmic typing}
  % \label{fig:rule_constraints_generation}
\end{rules}


\begin{rules}{\vlmini{} type unification}{\Sigma \vdash A \sim B \rhd \theta}
    \begin{minipage}{.45\linewidth}
      \infrule[$U_{\alpha}$]{
        \Sigma \vdash \alpha:\typekind
        \andalso
        \Sigma \vdash A:\typekind
      }{
        \Sigma \vdash \alpha \sim A \rhd \alpha \mapsto A
      }
    \end{minipage}
    % \begin{minipage}{.35\linewidth}
    %   \infrule[$U_{\alpha=}$]{
    %     \Sigma \vdash \alpha:\typekind\\
    %   }{
    %     \Sigma \vdash \alpha \sim \alpha \rhd \emptyset
    %   }
    % \end{minipage}
    \begin{minipage}{.35\linewidth}
      \infrule[$U_{=}$]{
        \Sigma \vdash A:\typekind
      }{
        \Sigma \vdash A \sim A \rhd \emptyset      }
    \end{minipage}
    \begin{minipage}{.62\linewidth}
      \infrule[$U_\rightarrow$]{
        \Sigma \vdash A' \sim A \rhd \theta_1
        \andalso
        \Sigma \vdash \theta_1B\sim \theta_1B' \rhd \theta_2
      }{
        \Sigma \vdash A \rightarrow B \sim A' \rightarrow B' \rhd \theta_1 \uplus \theta_2
      }
    \end{minipage}
    %  &
    % \begin{minipage}{.20\linewidth}
    %   \infrule[$U_{\textsc{Con}}$]{
    %     \\
    %   }{
    %     \Sigma \vdash K \sim K \rhd \emptyset
    %   }
    % \end{minipage}
    \begin{minipage}{.6\linewidth}
      \infrule[$U_{\Box}$]{
        \Sigma \vdash A \sim A' \rhd \theta_1
        \andalso
        \Sigma \vdash \theta_1r \sim \theta_1r' \rhd \theta_2
      }{
        \Sigma \vdash \vertype{r}{A} \sim \vertype{r'}{A'} \rhd \theta_1 \uplus \theta_2
        % \Sigma \vdash \vertype{r}{A} \sim \vertype{r'}{A'} \rhd \theta_1
      }
    \end{minipage}
\end{rules}
\vspace{\baselineskip}
otherwise fail.

\begin{rules}{\vlmini{} unification}{\Sigma \vdash \Theta \rhd \theta}
    \begin{minipage}{.25\linewidth}
      \infrule[$U_\emptyset$]{
        \\
      }{
        \Sigma \vdash \top \rhd \emptyset
      }
    \end{minipage}
    \begin{minipage}{.55\linewidth}
      \infrule[$U_\Theta$]{
        \Sigma \vdash \Theta \rhd \theta_1
        \andalso
        \Sigma \vdash \theta_1A \sim \theta_1B \rhd \theta_2
      }{
        \Sigma \vdash \Theta \land \{A \sim B\} \rhd  \theta_1 \uplus \theta_2
      }
    \end{minipage}
\end{rules}

\paragraph{\textnormal{\textbf{Type substitutions}}}
\begin{align*}
\theta \inttype{} \quad&= \quad \inttype{}\\
\theta\alpha \quad&= \quad
    \left\{\begin{aligned}
    A \hspace{1.5em} (\theta(\alpha)=A)\\
    \alpha \hspace{1.5em} (\mathrm{otherwise})
    \end{aligned}\right.\\
\theta(\ftype{A}{B}) \quad&= \quad \ftype{\theta A}{\theta B}\\
% \theta(\app{A}{B}) \quad&= \quad \app{(\theta A)}{(\theta B)}\\
% \theta(A \op B) \quad&= \quad (\theta A) \op (\theta B)\\
\theta(\vertype{r}{A}) \quad&= \quad \vertype{(\theta r)}{(\theta A)}\\
\theta \bot \quad&= \quad \bot \\
\theta \{\overline{l_i}\} \quad&= \quad \{\overline{l_i}\}
% \theta(r_1\otimes r_2) \quad&= \quad (\theta r_1)\otimes (\theta r_2)\\
% \theta(r_1\oplus r_2) \quad&= \quad (\theta r_1)\oplus (\theta r_2)
\end{align*}

\paragraph{\textnormal{\textbf{Substitution compositions}}}
\begin{align*}
\emptyset \uplus \theta_2 &= \theta_2\\
(\theta_1, \alpha \mapsto A) \uplus \theta_2 &= \left\{\begin{aligned}
    &(\theta_1 \uplus (\theta_2 \backslash \alpha) \uplus \theta), \alpha \mapsto \theta A &\theta_2(\alpha) = B \land \Sigma \vdash A \sim B \rhd \theta\\
    &(\theta_1 \uplus \theta_2),\alpha \mapsto A &\alpha\notin  \mathrm{dom}(\theta_2)
\end{aligned} \right.
\end{align*}




\subsection{Extensions for Version Control Terms}
\label{appendix:vlmini_version_control_terms}
\paragraph{\textnormal{\textbf{\vlmini{} syntax}}}
\begin{align*}
t \quad&::=\quad \ldots \mid \verof{l}{t} \mid \unver{t}\tag{terms}
\end{align*}

\begin{rules}{\vlmini{} algorithmic type synthesis}{\Sigma;\Gamma \vdash t \Rightarrow A;\Sigma'; \Delta; \Theta; \mathcal{C}}
    \begin{minipage}{.95\linewidth}
      \vspace{0.5\baselineskip}
      \infrule[$\Rightarrow_{\textsc{Ver}}$]{
        l \in \mathcal{L}
        \andalso
        \Sigma_1 \vdash [\Gamma\cap\textsf{FV}(t)]_{\textsf{Labels}} \rhd \Gamma'
        \andalso\\
        \Sigma_1 \vdash \Gamma' \sqsubseteq_c \cs{l} \rhd \mathcal{C}_2
        \andalso
        \Sigma_1; \Gamma' \vdash t \Rightarrow A; \Sigma_2; \Delta_1; \Theta_1; \mathcal{C}_1
      }{
        \Sigma_1;\Gamma \vdash \verof{l}{t} \Rightarrow A; \Sigma_2; \Delta_1 ; \Theta_1 ; \mathcal{C}_1 \land \mathcal{C}_2
      }
    \end{minipage}
    \begin{minipage}{.95\linewidth}
      \vspace{0.5\baselineskip}
      \infrule[$\Rightarrow_{\textsc{Unver}}$]{
        \Sigma_1; \Gamma \vdash t \Rightarrow A; \Sigma_2; \Delta; \Theta; \mathcal{C}
        \andalso\\
        A = \vertype{r}{A'}
        \andalso
        \Sigma_3 = \Sigma_2,\alpha:\labelskind
        \andalso
        \vdash \Sigma_3
      }{
        \Sigma_1;\Gamma \vdash \unver{t} \Rightarrow \vertype{\alpha}{A'}; \Sigma_3; \Delta; \Theta; \mathcal{C}
      }
    \end{minipage}
\end{rules}


\begin{rules}{\vlmini{} constraints generation}{\Sigma \vdash [\Gamma] \sqsubseteq_{c} \mathcal{D} \rhd \mathcal{C}}
    \begin{minipage}{.35\linewidth}
      \infrule[$\sqsubseteq^{\textsc{LD}}_{\emptyset}$]{
        % \Sigma \vdash \alpha : \textsf{Labels}
        \\
      }{
        \Sigma \vdash \emptyset \sqsubseteq_{c} \mathcal{D} \rhd \top
      }
    \end{minipage}
    \begin{minipage}{.60\linewidth}
      \infrule[$\sqsubseteq^{\textsc{LD}}_{\Gamma}$]{
        % \Sigma \vdash \alpha : \textsf{Labels}
        % \andalso
        \Sigma \vdash [\Gamma] \sqsubseteq_{c} \mathcal{D} \rhd \mathcal{C}
      }{
        \Sigma \vdash ([\Gamma], x:[A]_r) \sqsubseteq_{c} \mathcal{D} \rhd \left(\mathcal{C}\land (r \preceq \mathcal{D})\right)
      }
    \end{minipage}
  % \caption{\vlmini{} constraints generation}
  % %\ecaption{Typing of \corelang}
  % % \Description{\corelang algorithmic typing}
  % \label{fig:rule_constraints_generation}
\end{rules}
\vspace{\baselineskip}
Note that type environment resources in \vlmini{} always contain only type variables, so $r = \alpha~(\exists\alpha)$.




\subsection{Extensions for Data Constructors}
\label{appendix:vlmini_data_structures}
\paragraph{\textnormal{\textbf{\vlmini{} syntax}}}
\begin{align*}
t \quad&::=\quad \ldots \mid C\,\overline{t_i} \mid \caseof{t}{\overline{p_i \mapsto t_i}}\tag{terms}\\
p \quad&::=\quad \ldots \mid C\,\overline{p_i} \tag{patterns}\\
C \quad&::=\quad (,) \mid [,] \tag{constructors}\\
A, B \quad&::=\quad \ldots \mid K\,\overline{A_i} \tag{types}\\
K    \quad&::=\quad (,) \mid [,] \tag{type constructors}
\end{align*}

\begin{rules}{\vlmini{} algorithmic type synthesis}{\Sigma;\Gamma \vdash t \Rightarrow A;\Sigma'; \Delta; \Theta; \mathcal{C}}
    \begin{minipage}{.95\linewidth}
      \infrule[$\Rightarrow_{\textsc{(,)}}$]{
        \Sigma_{i-1};\Gamma \vdash t_i \Rightarrow A_i; \Sigma_i; \Delta_i; \Theta_i; \mathcal{C}_i
      }{
        \Sigma_0;\Gamma \vdash (t_1,\,..\,,t_n) \Rightarrow (A_1,\,..\,,A_n); \Sigma_{n}; \Delta_1,..\Delta_n; \bigwedge\Theta_{i}; \bigwedge \mathcal{C}_i
      }
    \end{minipage}
    \begin{minipage}{.95\linewidth}
      \infrule[$\Rightarrow_{\textsc{[,]}}$]{
        \Sigma_{i-1};\Gamma \vdash t_i \Rightarrow A; \Sigma_i; \Delta_i; \Theta_i; \mathcal{C}_i
      }{
        \Sigma_0;\Gamma \vdash [t_1,\,..\,,t_n] \Rightarrow [A]; \Sigma_{n}; \Delta_1,..\Delta_n; \bigwedge\Theta_{i}; \bigwedge\mathcal{C}_i
      }
    \end{minipage}
    \begin{minipage}{.95\linewidth}
      \vspace{.5\baselineskip}
      \infrule[$\Rightarrow_{\textsc{case}}$]{
        \Sigma_{0};\Gamma \vdash t \Rightarrow A; \Sigma_1; \Gamma'_1; \Theta_0; \mathcal{C}_0
        \andalso\\
        \Sigma_{i-1};- \vdash p_{i}:A \rhd \Delta_{i}; \Sigma'_{i}; \Theta'_{i}
        \andalso
        \Sigma'_{i};\Gamma,\Delta_{i} \vdash t_{i} \Rightarrow B;\Sigma_{i}; \Delta'_{i}; \Theta_{i}; \mathcal{C}_{i}
      }{
        \Sigma_0;\Gamma \vdash \caseof{t}{\overline{p_i\mapsto t_i}} \Rightarrow B;\Sigma_{n}; \Gamma_1'+\bigcup(\Delta'_i\backslash\Delta_i); \bigwedge\Theta_{i}; \bigwedge \mathcal{C}_i
      }
    \end{minipage}
\end{rules}


\begin{rules}{\vlmini{} pattern type synthesis}{\Sigma; R\vdash p : A \rhd \Gamma; \Sigma'; \Theta; \mathcal{C}}
    \begin{minipage}{.95\linewidth}
      \vspace{.5\baselineskip}
      \infrule[pCon]{
        \Sigma_{i-1}' = \Sigma_{i-1}, \alpha_i:\textsf{Type}
        \andalso
        \Sigma_{i-1}'; - \vdash p_i : \alpha_i \rhd \Gamma_i; \Sigma_i; \Theta_i; \mathcal{C}
      }{
        \Sigma_0; - \vdash C\,p_1\,..\,p_n : A \rhd \Gamma_i, .. ,\Gamma_n; \Sigma_n; \{K\,\overline{\alpha_i} \sim A\} \land \bigwedge\Theta_i; \mathcal{C}
      }
    \end{minipage}
    \begin{minipage}{.95\linewidth}
      \vspace{.5\baselineskip}
      \infrule[\mbox{[}pCon\mbox{]}]{
        \Sigma_{i-1}' = \Sigma_{i-1}, \alpha_i:\textsf{Type}
        \andalso\\
        \Sigma_{i-1}'; r \vdash p_i : \alpha_i \rhd \Gamma_i; \Sigma_i; \Theta_i; \mathcal{C}
        \andalso
        \Sigma_i' \vdash r : \textsf{Labels}
      }{
        \Sigma_0; r \vdash C\,p_1\,..\,p_n : A \rhd \Gamma_i, .. ,\Gamma_n; \Sigma_n; \{K\,\overline{\alpha_i} \sim A\}\land\bigwedge\Theta_{i}; \mathcal{C}
      }
    \end{minipage}
\end{rules}


\begin{rules}{\vlmini{} type unification}{\Sigma \vdash A \sim B \rhd \theta}
    \begin{minipage}{.95\linewidth}
      \infrule[$U_\textsc{Con}$]{
        \Sigma \vdash A_1 \sim B_1 \rhd \theta_1
        \andalso
        \Sigma \vdash \theta_{i-1} A_i \sim \theta_{i-1} B_i \rhd \theta_i~(i\geq 2)
      }{
        \Sigma \vdash K\,\overline{A_i} \sim K\,\overline{B_i} \rhd \biguplus\theta_{i}}
    \end{minipage}
\end{rules}

\paragraph{\textnormal{\textbf{Type substitutions}}}
\begin{align*}
\theta (K\,\overline{A_i}) \quad&= \quad K\,\overline{\theta A_i}
\end{align*}