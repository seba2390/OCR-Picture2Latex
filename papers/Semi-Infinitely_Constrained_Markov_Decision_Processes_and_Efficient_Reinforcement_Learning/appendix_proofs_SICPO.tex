\section{Omitted Proofs in Section \ref{Section_Theory_SICPO}}
\label{Appendix_Proofs_SICPO}

\begin{lemma}\label{Lemma_basic_expansion}
We have
$$
\begin{aligned}
&(1-\gamma)\alpha\sum_{t\in \gB} (V_r^*(\mu)-V_r^{(t)}(\mu))+(1-\gamma)\alpha\sum_{t\in\gN}\left(\eta-\left|\widehat V_{c^{(t)}}^{(t)}(\mu)-V_{c^{(t)}}^{(t)}(\mu)\right|\right)\\
&\leq \log|\gA|+\alpha\sum_{t\in\gB}\sqrt{E^{\nu^*}\left(r, \theta^{(t)},\hat w^{(t)}\right)}+\alpha\sum_{t\in\gN}\sqrt{E^{\nu^*}\left(c^{(t)}, \theta^{(t)},\hat w^{(t)}\right)}+\frac{\beta\alpha^2}{2}\sum_{t=0}^{T-1}\|\hat w^{(t)}\|_2^2.
\end{aligned}
$$
\end{lemma}
\proof{Proof of Lemma~\ref{Lemma_basic_expansion}}
Note that using Assumption~\ref{Assumption_smooth} and Taylor's expansion we have
$$
\log \frac{\pi_t(a | s)}{\pi_{t+1}(a | s)}+\nabla_{\theta} \log \pi_{t}(a | s)^\top\left(\theta_{t+1}-\theta_t\right) \leq \frac{\beta}{2}\left\|\theta_{t+1}-\theta_t\right\|^{2}.
$$
and $\theta^{(t+1)}-\theta^{(t)}=\alpha\hat w^{(t)}$.
As a result, suppose $t\in\gB$,
$$
\begin{aligned}
&\EB_{s\sim d^{\pi^*}}(D_{\operatorname{KL}}(\pi^*(\cdot|s)\|\pi^{(t)}(\cdot|s))-D_{\operatorname{KL}}(\pi^*(\cdot|s)\|\pi^{(t+1)}(\cdot|s)))\\
&=-\EB_{(s,a)\sim\nu^*}\log\frac{\pi^{(t)}(a|s)}{\pi^{(t+1)}(a|s)}\\
&\geq\alpha\EB_{(s,a)\sim\nu^*}[\nabla_{\theta} \log \pi^{(t)}(a | s)^\top \hat w^{(t)}]-\frac{\beta\eta_\theta^2}{2}\|\hat w^{(t)}\|^2_2\\
&=\alpha\EB_{(s,a)\sim\nu^*} A_r^{(t)}(s,a)+\alpha \EB_{(s,a)\sim\nu^*}\left[\nabla_\theta\log \pi^{(t)}(a|s)^\top \hat w^{(t)}-A_r^{(t)}(s,a)\right]-\frac{\beta\alpha^2}{2}\|\hat w^{(t)}\|^2_2\\
&\geq (1-\gamma)\alpha(V_r^*(\mu)-V_r^{(t)}(\mu))-\alpha\sqrt{E^{\nu^*}\left(r, \theta^{(t)},\hat w^{(t)}\right)}
-\frac{\beta\alpha^2}{2}\|\hat w^{(t)}\|^2_2\\
\end{aligned}
$$

The second last inequality is true due to the performance difference lemma, the last inequality is true due to Jensen's inequality and definition of the transferred function approximation error.
Rearranging terms yields
$$
\begin{aligned}
&(1-\gamma)\alpha(V_r^*(\mu)-V_r^{(t)}(\mu))\\
&\leq \EB_{s\sim d^{\pi^*}}(D_{\operatorname{KL}}(\pi^*(\cdot|s)\|\pi^{(t)}(\cdot|s))-D_{\operatorname{KL}}(\pi^*(\cdot|s)\|\pi^{(t+1)}(\cdot|s)))+\alpha\sqrt{E^{\nu^*}\left(r, \theta^{(t)},\hat w^{(t)}\right)}
+\frac{\beta\alpha^2}{2}\|\hat w^{(t)}\|^2_2.
\end{aligned}
$$
Similarly, suppose $t\in\gN$, we have $\theta^{(t+1)}-\theta^{(t)}=-\alpha\hat w^{(t)}$
$$
\begin{aligned}
&(1-\gamma)\alpha(V_{c^{(t)}}^{(t)}(\mu)-V_{c^{(t)}}^*(\mu))\\
&\leq \EB_{s\sim d^{\pi^*}}(D_{\operatorname{KL}}(\pi^*(\cdot|s)\|\pi^{(t)}(\cdot|s))-D_{\operatorname{KL}}(\pi^*(\cdot|s)\|\pi^{(t+1)}(\cdot|s)))+\alpha\sqrt{E^{\nu^*}\left(c^{(t)}, \theta^{(t)},\hat w^{(t)}\right)}
+\frac{\beta\alpha^2}{2}\|\hat w^{(t)}\|^2_2.
\end{aligned}
$$
Then we may get
$$
\begin{aligned}
&(1-\gamma)\alpha\sum_{t\in \gB} (V_r^*(\mu)-V_r^{(t)}(\mu))+(1-\gamma)\alpha\sum_{t\in \gN}\left(V_{c^{(t)}}^{(t)}(\mu)-V_{c^{(t)}}^*(\mu)\right)\\
&\leq \sum_{t=0}^{T-1} \EB_{s\sim d^{\pi^*}}(D_{\operatorname{KL}}(\pi^*(\cdot|s)\|\pi^{(t)}(\cdot|s))-D_{\operatorname{KL}}(\pi^*(\cdot|s)\|\pi^{(t+1)}(\cdot|s)))\\
&\quad+\alpha\sum_{t\in\gB}\sqrt{E^{\nu^*}\left(r, \theta^{(t)},\hat w^{(t)}\right)}+\alpha\sum_{t\in\gN}\sqrt{E^{\nu^*}\left(c^{(t)}, \theta^{(t)},\hat w^{(t)}\right)}+\frac{\beta\alpha^2}{2}\sum_{t=0}^{T-1}\|\hat w^{(t)}\|_2^2\\
&\leq \log|\gA|+\alpha\sum_{t\in\gB}\sqrt{E^{\nu^*}\left(r, \theta^{(t)},\hat w^{(t)}\right)}+\alpha\sum_{t\in\gN}\sqrt{E^{\nu^*}\left(c^{(t)}, \theta^{(t)},\hat w^{(t)}\right)}+\frac{\beta\alpha^2}{2}\sum_{t=0}^{T-1}\|\hat w^{(t)}\|_2^2.
\end{aligned}
$$
Since for $t\in\gN$
$$
\begin{aligned}
V_{c^{(t)}}^{(t)}(\mu)-V_{c^{(t)}}^*(\mu)&\geq \widehat V_{c^{(t)}}^{(t)}(\mu)-V_{c^{(t)}}^*(\mu)-\left|\widehat V_{c^{(t)}}^{(t)}(\mu)-V_{c^{(t)}}^{(t)}(\mu)\right|\\
&\geq u_{y_*^{(t)}}+\eta-u_{y_*^{(t)}}-\left|\widehat V_{c^{(t)}}^{(t)}(s)-V_{c^{(t)}}^{(t)}(\mu)\right|\\
&=\eta-\left|\widehat V_{c^{(t)}}^{(t)}(s)-V_{c^{(t)}}^{(t)}(\mu)\right|
\end{aligned}
$$
we may obtain the conclusion.
\endproof

\begin{lemma}\label{Lemma_SGD_convergence}
We have for $t\in\gB$, $\forall\delta\in(0,1)$, with probability at least $1-\delta$,
for $t\in\gB$
$$
\begin{aligned}
    & E^{\nu^*}(r,\theta^{(t)}, \hat w^{(t)})\\
    &\leq \frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right),
\end{aligned}
$$
for $t\in\gN$,
$$
\begin{aligned}
     &E^{\nu^*}(c^{(t)},\theta^{(t)}, \hat w^{(t)})\\
     &\leq \frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right),
\end{aligned}
$$
where $\nu_0$ is the uniform distribution on $\gS\times\gA$.
\end{lemma}

\proof{Proof of Lemma~\ref{Lemma_SGD_convergence}}
First we show for $t\in\gB$, with high probability
$$
\begin{aligned}
    &E^{\nu^*}(r,\theta^{(t)}, \hat w^{(t)})\\
    &\leq \frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right).
\end{aligned}
$$
We have:
$$
\begin{aligned}
&E^{\nu^*}(r,\theta^{(t)}, \hat w^{(t)})\\
&\leq \left\|\frac{\nu^{*}}{\nu^{(t)}}\right\|_{\infty} E^{\nu^{(t)}}(r,\theta^{(t)}, \hat w^{(t)})\\
&\leq \frac{1}{1-\gamma} \left\|\frac{\nu^{*}}{\nu_{0}}\right\|_{\infty} E^{\nu^{(t)}}(r,\theta^{(t)}, \hat w^{(t)})\\
&=\frac{1}{1-\gamma}\left\|\frac{\nu^{*}}{\nu_{0}}\right\|_{\infty}\left( \min_w E^{\nu^{(t)}}(r,\theta^{(t)},w)+E^{\nu^{(t)}}\left(r,\theta^{(t)}, \hat w^{(t)}\right)-\min_w E^{\nu^{(t)}}(r,\theta^{(t)},w)\right)\\
&\leq \frac{1}{1-\gamma}\left\|\frac{\nu^{*}}{\nu_{0}}\right\|_{\infty}\left(\epsilon_{bias}+E^{\nu^{(t)}}\left(r, \theta^{(t)}, \hat w^{(t)}\right)-\min_{w\in B(0,W,\|\cdot\|_2)} E^{\nu^{(t)}}(r,\theta^{(t)},w)\right),
\end{aligned}
$$
the last step is due to Assumption~\ref{Assumption_func_approx_err} and Assumption~\ref{Assumption_est_err}.
Now we define a proximal loss function:
$$
\widetilde{E}^{\nu^{(t)}}(r,\theta^{(t)},w):=\EB_{(s,a)\sim\nu}(\widetilde{A}^{\pi^{(t)}}_r(s,a)-w^\top\nabla_\theta\log\pi_\theta(a|s))^2,
$$
where
$$
\begin{aligned}
    \widetilde{A}^{(t)}_r(s,a):&=\widetilde{Q}^{\pi^{(t)}}_r(s,a)-\widetilde{V}^{\pi^{(t)}}_r(s),\\
    \widetilde{Q}^{\pi^{(t)}}_r(s,a):&=\EB\left(\sum_{t=0}^H\gamma^t r(s_t,a_t)\mid (s_0,a_0)=(s,a)\right),\\
    \widetilde{V}^{\pi^{(t)}}_r(s):&=\EB\left(\sum_{t=0}^H\gamma^t r(s_t,a_t)\mid s_0=s\right).\\
\end{aligned}
$$
Recall that
$$
\begin{aligned}
&\widetilde{E}^{\nu^{(t)}}(r,\theta^{(t)},w)\\
&=\EB_{(s,a)\sim\nu^{(t)}}(\widetilde{A}^{(t)}(s,a)-w^\top\nabla_\theta\log\pi_{\theta^{(t)}}(a|s))^2\\    &=w^\top F(\theta^{(t)})w-2\sum_{s,a}\nu^{(t)}(s,a)w^\top \nabla_\theta\log\pi_{\theta^{(t)}}(a|s)\widetilde{A}^{(t)}(s,a)+\sum_{s,a}\nu^{(t)}(s,a)\widetilde{A}^{(t)}(s,a)^2.
\end{aligned}
$$
According to Assumption~\ref{Assumption_PSD_Fisher}, $E^{\nu^{(t)}}(r,\theta^{(t)},w)$ is $(1-\gamma)^2\mu_F$-strongly convex.
The full gradient is
$$G(w)=2F(\theta^{(t)})w-2\sum_{s,a}\nu^{(t)}(s,a)\widetilde{A}^{(t)}(s,a)\nabla_\theta\log\pi_{\theta^{(t)}}(a|s),
$$
and the stochastic gradient we use is 
$$\widehat G(w)=2\nabla_\theta\log\pi_\theta(A|S)\nabla_\theta\log\pi_\theta(A|S)^\top w-2\widehat A^{\pi_\theta}(S,A)\nabla_\theta\log\pi_\theta(A|S),
$$
where $(S,A)\sim \nu^{(t)}$.
Then we have $\EB\widehat G(w)=G(w)$ and
$$
\|G(w)-\widehat G(w)\|_2\leq 2L_\pi^2W+\frac{4L_\pi}{1-\gamma}.
$$
Set $\eta_k=\frac{2}{(1-\gamma)^2\mu_F(k+1)}$, $\gamma_k=\frac{2k}{K(K+1)}$, by Theorem C.3 in \cite{Harvey2019Simple}, for any $\delta\in(0,1)$, with probability at least $1-\delta$ we have,
$$
\widetilde{E}^{\nu^{(t)}}\left(r, \theta^{(t)}, \hat w^{(t)}\right)-\min_{w\in B(0,W,\|\cdot\|_2)} \widetilde{E}^{\nu^{(t)}}(r,\theta^{(t)},w)\leq C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(1/\delta)}{K_{sgd}}.
$$
Here $C$ is a universal constant.
We may finish the bound by noting that
$$
\sup_{w\in B(0,W,\|\cdot\|_2)}\left|\widetilde{E}^{\nu^{(t)}}\left(r, \theta^{(t)}, \hat w^{(t)}\right)-E^{\nu^{(t)}}\left(r, \theta^{(t)}, \hat w^{(t)}\right)\right|\leq \frac{2\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right).
$$
For $t\in\gN$, the inequality holds by similar arguments as above.
And we would like to emphasize that $c^{(t)}$ is determined a priori and thus can be viewed as a fixed cost.
Our final conclusion can be obtained by a union bound argument.
% Set $\delta=\frac{1}{4L_\pi^2}$, by Theorem 1 in \cite{bach2013non} we may get:
% $$
% \EB\left[E^{\nu^{(t)}}\left(r,\theta^{(t)}, \hat w^{(t)}\right)-\min_w E^{\nu^{(t)}}(r,\theta^{(t)},w)\right]\leq \frac{2(\sigma\sqrt{d}+L_\pi W)^2}{K}.
% $$
% $\sigma$ is defined as:
% $$
% \EB_{(s,a)\sim\nu^{(t)}}\left[G_r^{(t)}\left(G_r^{(t)}\right)^\top\right]\preceq \sigma^2 F(\theta^{(t)}),
% $$
% where $G_{r}^{(t)}:=2\left(\left(w_{r}^{*}\right)^\top \nabla_{\theta} \log \pi^{(t)}(a \mid s)-\widehat{A}_{r}^{(t)}(s, a)\right) \nabla_{\theta} \log \pi^{(t)}(a \mid s)$ and $w_{r}^*:=\underset{w}{\mathrm{argmin}} E^{\nu^{(t)}}(r,\theta^{(t)},w).$
% We have $\sigma\leq 2WL_\pi +\frac{2}{1-\gamma}$.
% For $t\in\gN$, we may note that for any fixed $y\in Y$, $\theta$, and corresponding NPG update $\hat w$,
% $$
% \EB_{\hat w}E^{\nu^*}(c_y,\theta, \hat w)
% \leq \frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+\frac{2\left(2\sqrt{d}WL_\pi+\frac{2\sqrt{d}}{1-\gamma}+WL_\pi\right)^2}{K}\right).
% $$ 
% The inquality holds by similar arguments as above.
% And the expectation is taken w.r.t. the randomness of $\hat w$.
% Therefore, we may get
% $$
% \EB E^{\nu^*}(c^{(t)},\theta^{(t)}, \hat w^{(t)})
% \leq \frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+\frac{2\left(2\sqrt{d}WL_\pi+\frac{2\sqrt{d}}{1-\gamma}+WL_\pi\right)^2}{K}\right).
% $$ 
\endproof

\begin{lemma}\label{Lemma_whp_basic_expansion}
For any $\delta\in(0,1)$, let $A$ denote the event
$$
\begin{aligned}
&(1-\gamma)\alpha\sum_{t\in \gB} (V_r^*(\mu)-V_r^{(t)}(\mu))\\
&+(1-\gamma)\alpha|\gN|\left(\eta-\frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)-\frac{\gamma^H}{1-\gamma}\right)\\
&\leq \log|\gA|+\frac{\beta\alpha^2 TW^2}{2(1-\gamma)^2}\\
&+\alpha T\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}.
\end{aligned}
$$
Then we have $\PB(A)\geq 1-\delta$.
\end{lemma}
\proof{Proof of Lemma~\ref{Lemma_whp_basic_expansion}}
Let $A_1$ denote the event that 
for $t\in\gB$
$$
\begin{aligned}
     &E^{\nu^*}(r,\theta^{(t)}, \hat w^{(t)})\\
     &\leq \frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right),
\end{aligned}
$$
for $t\in\gN$,
$$
\begin{aligned}
     &E^{\nu^*}(c^{(t)},\theta^{(t)}, \hat w^{(t)})\\
     &\leq \frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right).
\end{aligned}
$$
By Lemma~\ref{Lemma_SGD_convergence}, $\PB(A_1)\geq 1-\delta/2$.
Also note that we always have $\|\hat w^{(t)}\|_2^2\leq \frac{W^2}{(1-\gamma)^2}$, together with Lemma~\ref{Lemma_basic_expansion} lead to that conditioned on $A_1$,
$$
\begin{aligned}
&(1-\gamma)\alpha\sum_{t\in \gB} (V_r^*(\mu)-V_r^{(t)}(\mu))+(1-\gamma)\alpha\sum_{t\in\gN}\left(\eta-\left|\widehat V_{c^{(t)}}^{(t)}(\mu)-V_{c^{(t)}}^{(t)}(\mu)\right|\right)\\
&\leq \log|\gA|+\frac{\beta\alpha^2 TW^2}{2(1-\gamma)^2}\\
&\alpha T\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}.
\end{aligned}
$$
It remains to bound $\left|\widehat V_{c^{(t)}}^{(t)}(\mu)-V_{c^{(t)}}^{(t)}(\mu)\right|$.
Let $A_2$ denote the event that $\forall t\in\{0,...,T-1\}$,
 $$
    \left|\widehat V_{c^{(t)}}^{(t)}(\mu)-V_{c^{(t)}}^{(t)}(\mu)\right|\leq \frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}+\frac{\gamma^H}{1-\gamma}\right)
    $$
By Lemma~\ref{Lemma_WHP_Bound_Evaluation_Uniform_y}, $\PB(A_2)\geq \delta/2$.
Thus conditioned on the event $A_1\cap A_2$,
$$
\begin{aligned}
&(1-\gamma)\alpha\sum_{t\in \gB} (V_r^*(\mu)-V_r^{(t)}(\mu))\\
&+(1-\gamma)\alpha|\gN|\left(\eta-\frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)-\frac{\gamma^H}{1-\gamma}\right)\\
&\leq \log|\gA|+\frac{\beta\alpha^2 TW^2}{2(1-\gamma)^2}\\
&+\alpha T\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}.
\end{aligned}
$$
We complete the proof by noting $\PB(A_1\cap A_2)\geq 1-\delta$.
\endproof

\begin{lemma}\label{Lemma_well_define_B}
    Suppose 
    $$\begin{aligned}
        &\frac{T}{2}\left(\eta-\frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)-\frac{\gamma^H}{1-\gamma}\right)\\
        &>\frac{\log|\gA|}{(1-\gamma)\alpha}+\frac{\beta\alpha TW^2}{2(1-\gamma)^3}\\
        &+\frac{ T}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)},
    \end{aligned}
    $$
Then $\gB\not=\emptyset$. Then for any $\delta\in(0,1)$, conditioned on event $A$, either a). $|\gB|\geq T/2$ or b). $\sum_{t\in\gB}(V_r^*(\mu)-V_r^{(t)}(\mu))< 0$.
\end{lemma}
\proof{Proof of Lemma~\ref{Lemma_well_define_B}}
    First we set $\sum_{t\in\gB}(V_r^*(\mu)-V_r^{(t)}(\mu))= 0$ if $\gB=\emptyset$. Now we would show $|\gB|\geq T/2$ as long as $\sum_{t\in\gB}(V_r^*(\mu)-V_r^{(t)}(\mu))\geq 0$, which also precludes the possibility that $\gB=\emptyset$.
    Note that when $\sum_{t\in\gB}(V_r^*(\mu)-V_r^{(t)}(\mu))\geq 0$ and $A$ happens,
    $$
    \begin{aligned}
    &|\gN|\left(\eta-\frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)-\frac{\gamma^H}{1-\gamma}\right)\\
    &\leq\frac{\log|\gA|}{(1-\gamma)\alpha}+\frac{\beta\alpha TW^2}{2(1-\gamma)^3}\\
    &+\frac{ T}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}.
    \end{aligned}
    $$
    Since
    $$
    \begin{aligned}
    &\frac{T}{2}\left(\eta-\frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)-\frac{\gamma^H}{1-\gamma}\right)\\
    &>\frac{\log|\gA|}{(1-\gamma)\alpha}+\frac{\beta\alpha TW^2}{2(1-\gamma)^3}\\
    &+\frac{ T}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}.
    \end{aligned}
    $$ we can conclude $|\gN|\leq T/2$ and $|\gB|\geq T/2$.
\endproof

\begin{lemma}\label{Lemma_reward_bound}
    Let $\alpha=1/\sqrt{T}$. Suppose we choose
    $$K_{eval}=\widetilde{O}\left(\frac{1}{\eta^2(1-\gamma)^2}\right)
    ,~H=O\left(\log\left(\frac{\eta(1-\gamma)}{\gamma}\right)\right)$$ and
    $$\begin{aligned}
    \eta&> \frac{4\log |\gA|}{\sqrt{T}(1-\gamma)}+\frac{2\beta W^2}{\sqrt{T}(1-\gamma)^3}\\
    &+\frac{4}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}
    \end{aligned}
    $$,
    then we have for any $\delta\in(0,1)$, conditioned on event $A$,
    $$
    \begin{aligned}
        &\frac{1}{|\gB|}\sum_{t\in\gB}(V_r^*(\mu)-V_r^{(t)}(\mu)) \leq \frac{2\log|\gA|}{\sqrt{T}(1-\gamma)}+\frac{\beta W^2}{\sqrt{T}(1-\gamma)^3}\\
       &+\frac{2}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}.
    \end{aligned}
    $$
    Here $\widetilde{O}$ means we discard any logarithmic terms. 
\end{lemma}
\proof{Proof of Lemma~\ref{Lemma_reward_bound}}
    When we choose $K_{eval}=\widetilde{O}\left(\frac{m}{\eta^2(1-\gamma)^2}\right)$ and $H=O\left(\log\left(\frac{\eta(1-\gamma)}{\gamma}\right)\right)$, we have
    $$
    \eta-\frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)-\frac{\gamma^H}{1-\gamma}
    >\frac{\eta}{2}$$
    Setting
    $$\begin{aligned}
    \eta&> \frac{4\log |\gA|}{\sqrt{T}(1-\gamma)}+\frac{2\beta W^2}{\sqrt{T}(1-\gamma)^3}\\
    &+\frac{4}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}
    \end{aligned}
    $$
    results in
   $$\begin{aligned}
        &\frac{T}{2}\left(\eta-\frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)-\frac{\gamma^H}{1-\gamma}\right)\\
        &>\frac{\log|\gA|}{(1-\gamma)\alpha}+\frac{\beta\alpha TW^2}{2(1-\gamma)^3}\\
        &\frac{ T}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)},
    \end{aligned}
    $$
    Then we may use Lemma~\ref{Lemma_well_define_B} to conclude either a). $|\gB|\geq T/2$ or b). $\sum_{t\in\gB}(V_r^*(\mu)-V_r^{(t)}(\mu))< 0$.
    If $a)$, the conclusion holds trivially.
    Else via the combination of b) and the fact that we are in event $A$ we may obtain
$$
    \begin{aligned}
        &\frac{1}{|\gB|}\sum_{t\in\gB}(V_r^*(\mu)-V_r^{(t)}(\mu)) \leq \frac{2\log|\gA|}{\sqrt{T}(1-\gamma)}+\frac{\beta W^2}{\sqrt{T}(1-\gamma)^3}\\
       &+\frac{2}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}.
    \end{aligned}
    $$
    
\endproof

\begin{lemma}\label{Lemma_constraint_violation_random_search}
    Suppose Assumption~\ref{Assumption_regular_maxima} holds and we use random search (Algorithm~\ref{Algorithm_random_search}) to solve the inner-loop problem.
    Let $B$ denote the event that for any $t\in\{1,...,T\}$, 
    $$\begin{aligned}
    &\max_{y\in Y} \left[V_{c_y}^{(t)}(\mu)-u_y\right]-\left[\widehat V_{c_{y^{(t)}}}^{(t)}(\mu)-u^{(t)}\right]\\
    &\leq \frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)+\frac{\gamma^H}{1-\gamma}+2\epsilon_{con},
    \end{aligned}$$
    We have $\PB(B\cap A_2)\geq 1-\delta$ as long as $M>\log(2T/\delta)/\log(1-\epsilon_{con}^m/[\operatorname{vol}(Y)(2L_y)^m(1-\gamma)^m])    
    $
\end{lemma}
\proof{Proof of Lemma~\ref{Lemma_constraint_violation_random_search}}
    According to Lemma~\ref{Lemma_WHP_Bound_Evaluation_Uniform_y}, conditioned on event $A_2$, we have $\forall t\in\{1,...,T\}$
     $$
    \sup_{y\in Y}\left|\widehat V_{c_y}^{(t)}(\mu)-V_{c_y}^{(t)}(\mu)\right|\leq \frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)+\frac{\gamma^H}{1-\gamma}
    $$
    as long as $K_{eval}$ is large enough.
    Therefore, let $y^*\in\arg\max_{y\in Y} \left[V_{c_y}^\pi(\mu)-u_y\right]$, 
    $$
    \left|V_{c_{y^*}}^\pi(\mu)-\widehat{V}_{c_{y^*}}^\pi(\mu)\right|\leq \frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)+\frac{\gamma^H}{1-\gamma}
    $$
    By Assmption~\ref{Assumption_Lipschitz}, as long as $\exists i\in\{1,...,M\}$, $\|y_i-y^*\|_\infty\leq \epsilon_{con}(1-\gamma)/2L_y$,
    we have 
    $$\left[\widehat V_{c_{y^*}}^{(t)}(\mu)-u_{ y^*}\right]-\max_{i\in\{1,...,M\}}\left[\widehat V_{c_{y_i}}^\pi(\mu)-u_{y_i}\right]\leq \epsilon_{con}.$$
     According to Assumption~\ref{Assumption_regular_maxima}, when $\epsilon_{con}(1-\gamma)/2L_y<\epsilon_0$
    $$
    \PB(\exists i\in\{1,...,M\}, \|y_i-\hat y\|_\infty\leq \epsilon_{con}(1-\gamma)/2L_y)\geq 1-\left(1-\frac{\epsilon_{con}^m(1-\gamma)^m}{\operatorname{vol}(Y)(2L_y)^m}\right)^M.
    $$
    If $M\geq M(\epsilon_{con},\beta)$, we have
    $$\PB\left(\left[\widehat V_{c_{y^*}}^{(t)}(\mu)-u_{ y^*}\right]-\max_{i\in\{1,...,M\}}\left[\widehat V_{c_{y_i}}^\pi(\mu)-u_{y_i}\right]\leq \epsilon\right)\geq 1-\beta,$$ 
    where we define
    $$M(\epsilon_{con},\beta)=\frac{\log\beta}{\log\left(1-\frac{\epsilon_{con}^m(1-\gamma)^m}{\operatorname{vol}(Y)(2L_y)^m}\right)}.
    $$
    Setting $M=M(\epsilon_{con},\delta/2T)$ and applying the union bound argument yields the result.
\endproof

\begin{lemma}\label{Lemma_constraint_violation_PGA}
    Suppose Assumption~\ref{Assumption_concave_constraint} holds and we use projected subgradient ascent (Algorithm~\ref{Algorithm_projected_GD}) to solve the inner-loop problem.
    Then 
    $$\begin{aligned}
    &\max_{y\in Y} \left[V_{c_y}^{(t)}(\mu)-u_y\right]-\left[\widehat V_{c_{y^{(t)}}}^{(t)}(\mu)-u^{(t)}\right]\\
    &\leq \frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)+\frac{\gamma^H}{1-\gamma}+\epsilon_{con},
    \end{aligned}$$
    as long as $T_{PGA}>\frac{4[\mathrm{diam}(Y)]^2L_y^2}{\epsilon_{con}^2(1-\gamma)^2}
    $.
\end{lemma}
\proof{Proof of Lemma~\ref{Lemma_constraint_violation_PGA}}
Noting that the objective is $\frac{2L_y}{1-\gamma}$-Lipschitz, we may complete the proof by directly applying Theorem 3.2 in \cite{bubeck2015convex}.
\endproof
\proof{Proof of Theorem~\ref{Theorem_random_search_SICPO}}
Conditioned on event $A=A_1\cap A_2$, setting $K_{sgd}, H, K_{eval}, T, \alpha, \eta$ as above yields
$$\begin{aligned}
    \eta&> \frac{4\log |\gA|}{\sqrt{T}(1-\gamma)}+\frac{2\beta W^2}{\sqrt{T}(1-\gamma)^3}\\
    &+\frac{4}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}.
    \end{aligned}
$$
Now we use Lemma~\ref{Lemma_reward_bound} to get
$$
    \begin{aligned}
        &\frac{1}{|\gB|}\sum_{t\in\gB}(V_r^*(\mu)-V_r^{(t)}(\mu)) \leq \frac{2\log|\gA|}{\sqrt{T}(1-\gamma)}+\frac{\beta W^2}{\sqrt{T}(1-\gamma)^3}\\
       &+\frac{2}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}\\
       &\leq \epsilon+\frac{1}{(1-\gamma)^{3/2}}\sqrt{\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\epsilon_{bias}}.
    \end{aligned}
    $$
According to Lemma~\ref{Lemma_constraint_violation_random_search}, conditioned on event $A_2\cap B$, as long as we set $M$ as in the statement of the theorem, we have $\forall t\in\{1,...,T\}$
$$\begin{aligned}
    &\sup_{y\in Y} \left[V_{c_y}^{(t)}(\mu)-u_y\right]-\left[\widehat V_{c_{y^{(t)}}}^{(t)}(\mu)-u^{(t)}\right]\\
    &\leq \frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)+\frac{\gamma^H}{1-\gamma}+\epsilon/2,
    \end{aligned}$$
Thus for $t\in \gB$, 
$$ \sup_{y\in Y}\left[V_{c_y}^{(t)}(\mu)-u_y\right]\leq 2\epsilon+\frac{1}{(1-\gamma)^{3/2}}\sqrt{\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\epsilon_{bias}}.
$$
We complete the proof by noting that
$$
P(A\cap B)\geq 1-(1-P(A))-(1-P(A_2\cap B))\geq 1-2\delta.
$$
\endproof

\proof{Proof of Theorem~\ref{Theorem_PGA_SICPO}}
Conditioned on event $A=A_1\cap A_2$, setting $K_{sgd}, H, K_{eval}, T, \alpha, \eta$ as above yields
$$\begin{aligned}
    \eta&> \frac{4\log |\gA|}{\sqrt{T}(1-\gamma)}+\frac{2\beta W^2}{\sqrt{T}(1-\gamma)^3}\\
    &+\frac{4}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}.
    \end{aligned}
$$
Now we use Lemma~\ref{Lemma_reward_bound} to get
$$
    \begin{aligned}
        &\frac{1}{|\gB|}\sum_{t\in\gB}(V_r^*(\mu)-V_r^{(t)}(\mu)) \leq \frac{2\log|\gA|}{\sqrt{T}(1-\gamma)}+\frac{\beta W^2}{\sqrt{T}(1-\gamma)^3}\\
       &+\frac{2}{1-\gamma}\sqrt{\frac{1}{1-\gamma}\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\left(\epsilon_{bias}+C\frac{(4L_\pi^2W+8L_\pi/(1-\gamma))^2}{(1-\gamma)^2\mu_F}\frac{\log(2T/\delta)}{K_{sgd}}+\frac{4\gamma^H}{1-\gamma}\left(\frac{1}{1-\gamma}+WL_\pi\right)\right)}\\
       &\leq \epsilon+\frac{1}{(1-\gamma)^{3/2}}\sqrt{\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\epsilon_{bias}}.
    \end{aligned}
    $$
According to Lemma~\ref{Lemma_constraint_violation_PGA}, conditioned on event $A_2$, as long as we set $T_{PGA}$ as in the statement of the theorem, we have $\forall t\in\{1,...,T\}$
$$\begin{aligned}
    &\sup_{y\in Y} \left[V_{c_y}^{(t)}(\mu)-u_y\right]-\left[\widehat V_{c_{y^{(t)}}}^{(t)}(\mu)-u^{(t)}\right]\\
    &\leq \frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(4T/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)+\frac{\gamma^H}{1-\gamma}+\epsilon/2,
    \end{aligned}$$
Thus for $t\in \gB$, 
$$ \sup_{y\in Y}\left[V_{c_y}^{(t)}(\mu)-u_y\right]\leq 2\epsilon+\frac{1}{(1-\gamma)^{3/2}}\sqrt{\left\|\frac{\nu^*}{\nu_0}\right\|_\infty\epsilon_{bias}}.
$$
\endproof


\begin{lemma}\label{Lemma_WHP_Bound_Evaluation_Uniform_y}
    For any $\delta\in(0,1)$, with probability at least $1-\delta$,
    $$
    \sup_{y\in Y}\left|\widehat V_{c_y}^{(t)}(\mu)-V_{c_y}^{(t)}(\mu)\right|\leq \frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(2/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right)+\frac{\gamma^H}{1-\gamma}
    $$
    as long as $L_y\sqrt{2K_{eval}}>1$.
\end{lemma}
\proof{Proof of Lemma~\ref{Lemma_WHP_Bound_Evaluation_Uniform_y}}
Assumption~\ref{Assumption_Lipschitz} implies
$$
\left|\widehat V_{c_y}^{(t)}(\mu)-\widetilde{V}_{c_y}^{(t)}(\mu)\right|-\left|\widehat V_{c_{y^\prime}}^{(t)}(\mu)-\widetilde{V}_{c_{y^\prime}}^{(t)}(\mu)\right|\leq \frac{2L_y}{1-\gamma}\|y-y^\prime\|_{\infty}.
$$
Let $N_{\epsilon}:=\{y_1,...,y_N\}$ be a $\epsilon$ cover w.r.t. $\|\cdot\|_{\infty}$ of $Y$, Example 5.8 in \cite{wainwright2019high}. We have
$$
\log N\leq m\log(2\mathrm{diam}(Y)/\epsilon+\mathrm{diam}(Y)).
$$
Combining Theorem~\ref{Theorem_Hoeffding_Inequality} and the arguments of union bound we may have that for any $\delta\in(0,1)$, with probability at least $1-\delta$,
 $$
    \sup_{y\in N_{\epsilon/2}}\left|\widehat V_{c_y}^{(t)}(\mu)-\widetilde{V}_{c_y}^{(t)}(\mu)\right|\leq \frac{1}{1-\gamma}\sqrt{\frac{\log(2N/\delta)}{2K_{eval}}}.
    $$
Then we may get
$$
\begin{aligned}
    \sup_{y\in Y}\left|\widehat V_{c_y}^{(t)}(\mu)-\widetilde{V}_{c_y}^{(t)}(\mu)\right|&\leq
    \frac{2L_y\epsilon}{1-\gamma}+
    \frac{1}{1-\gamma}\sqrt{\frac{\log(2/\delta)+m\log(2\mathrm{diam}(Y)/\epsilon+\mathrm{diam}(Y))}{2K_{eval}}}.
\end{aligned}
    $$
Here we set $\epsilon=\frac{1}{2L_y\sqrt{2K_{eval}}}$ and get
$$
    \sup_{y\in Y}\left|\widehat V_{c_y}^{(t)}(\mu)-\widetilde{V}_{c_y}^{(t)}(\mu)\right|\leq \frac{1}{(1-\gamma)\sqrt{2K_{eval}}}\left(1+\sqrt{\log{(2/\delta)}+m\log(4\mathrm{diam}(Y)L_y\sqrt{2K_{eval}}+\mathrm{diam}(Y))}\right).
$$
Since
$$
\sup_{y\in Y}\left|V_{c_y}^{(t)}(\mu) -\widetilde{V}_{c_y}^{(t)}(\mu)\right|\leq \frac{\gamma^H}{1-\gamma},
$$
we complete the proof.
\endproof