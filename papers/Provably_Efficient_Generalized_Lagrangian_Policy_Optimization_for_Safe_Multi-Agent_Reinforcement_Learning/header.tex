%\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{footnote}
\usepackage{float}
\usepackage{xspace}
\usepackage{multirow}
\usepackage{nicefrac}
\usepackage{wrapfig}
\usepackage{framed}
\usepackage{url}
%\usepackage[colorlinks=true, linkcolor=blue, citecolor=blue]{hyperref}
%\usepackage[ruled, vlined]{algorithm2e}
%\usepackage{blkarray}
%\PassOptionsToPackage{round}{natbib}
\usepackage{tikz}
\usetikzlibrary{arrows,chains,matrix,positioning,scopes}


%%%
\let\hat\widehat
\let\tilde\widetilde
\let\check\widecheck
%%%


\newcommand{\push}{\hspace{0pt plus 1 filll} }	

%\newtheorem{lemma}{Lemma}
%\newtheorem{theorem}{Theorem}
\newtheorem{cor}{Corollary}
%\newtheorem{remark}{Remark}
\newtheorem{prop}{Proposition}
\newtheorem{property}{Property}
%\newtheorem{definition}{Definition}
\newtheorem{assumption}{Assumption}

\DeclareMathOperator*{\minimize}{minimize}
\DeclareMathOperator*{\maximize}{maximize}
\DeclareMathOperator*{\subject}{subject~to}

\newcommand{\calA}{{\mathcal{A}}}
\newcommand{\calB}{{\mathcal{B}}}
\newcommand{\calH}{{\mathcal{H}}}
\newcommand{\calL}{{\mathcal{L}}}
\newcommand{\calX}{{\mathcal{X}}}
\newcommand{\calY}{{\mathcal{Y}}}
\newcommand{\calS}{{\mathcal{S}}}
\newcommand{\calI}{{\mathcal{I}}}
\newcommand{\calD}{{\mathcal{D}}}
\newcommand{\calK}{{\mathcal{K}}}
\newcommand{\calE}{{\mathcal{E}}}
\newcommand{\calR}{{\mathcal{R}}}
\newcommand{\calT}{{\mathcal{T}}}
\newcommand{\calP}{{\mathcal{P}}}
\newcommand{\calZ}{{\mathcal{Z}}}
\newcommand{\calM}{{\mathcal{M}}}
\newcommand{\calN}{{\mathcal{N}}}
\newcommand{\calF}{{\mathcal{F}}}
\newcommand{\calV}{{\mathcal{V}}}
\newcommand{\calQ}{{\mathcal{Q}}}
\newcommand{\ips}{\wh{r}}
\newcommand{\whpi}{\wh{\pi}}
\newcommand{\whE}{\wh{\E}}
\newcommand{\whV}{\wh{V}}
\newcommand{\reg}{{\mathcal{R}}}
\newcommand{\breg}{{\mathcal{\bar{R}}}}
\newcommand{\hmu}{\wh{\mu}}
\newcommand{\tmu}{\wt{\mu}}
\newcommand{\one}{\boldsymbol{1}}
\newcommand{\loss}{\ell}
\newcommand{\hloss}{\wh{\ell}}
\newcommand{\bloss}{\bar{\ell}}
\newcommand{\tloss}{\wt{\ell}}
\newcommand{\htheta}{\wh{\theta}}

\newcommand{\bz}{\boldsymbol{z}}
\newcommand{\bx}{\boldsymbol{x}}
\newcommand{\br}{\boldsymbol{r}}
\newcommand{\bX}{\boldsymbol{X}}
\newcommand{\bu}{\boldsymbol{u}}
\newcommand{\by}{\boldsymbol{y}}
\newcommand{\bY}{\boldsymbol{Y}}
\newcommand{\bg}{\boldsymbol{g}}
\newcommand{\ba}{\boldsymbol{a}}
\newcommand{\be}{\boldsymbol{e}}
\newcommand{\bq}{\boldsymbol{q}}
\newcommand{\bp}{\boldsymbol{p}}
\newcommand{\bZ}{\boldsymbol{Z}}
\newcommand{\bS}{\boldsymbol{S}}
\newcommand{\bw}{\boldsymbol{w}}
\newcommand{\bW}{\boldsymbol{W}}
\newcommand{\bU}{\boldsymbol{U}}
\newcommand{\bv}{\boldsymbol{v}}
\newcommand{\bzero}{\boldsymbol{0}}

\newcommand{\blue}[1]{{\color{blue}#1}}

\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argminimax}{argminimax}
%\DeclareMathOperator*{\liminf}{liminf}
%\DeclareMathOperator*{\limsup}{limsup}
\DeclareMathOperator*{\range}{range}
\DeclareMathOperator*{\mydet}{det_{+}}

\newcommand{\field}[1]{\mathbb{#1}}
\newcommand{\fY}{\field{Y}}
\newcommand{\fX}{\field{X}}
\newcommand{\fH}{\field{H}}
\newcommand{\fR}{\field{R}}
\newcommand{\fB}{\field{B}}
\newcommand{\fS}{\field{S}}
\newcommand{\fN}{\field{N}}
\newcommand{\E}{\field{E}}
\renewcommand{\P}{\field{P}}

\newcommand{\theset}[2]{ \left\{ {#1} \,:\, {#2} \right\} }
%\newcommand{\inner}[1]{ \left\langle {#1} \right\rangle }
\newcommand{\Ind}[1]{ \field{I}{\{{#1}\}} }
\newcommand{\eye}[1]{ \boldsymbol{I}_{#1} }
\newcommand{\norm}[1]{\left\|{#1}\right\|}
%\newcommand{\trace}[1]{\text{tr}\left({#1}\right)}
\newcommand{\trace}[1]{\textsc{tr}({#1})}
\newcommand{\diag}[1]{\mathrm{diag}\!\left\{{#1}\right\}}
\newcommand{\RE}{{\text{\rm RE}}}
\newcommand{\KL}{{\text{\rm KL}}}
\newcommand{\LCB}{{\text{\rm LCB}}}
\newcommand{\Reg}{{\text{\rm Reg}}}
\newcommand{\Rel}{{\text{\rm Rel}}}
%\newcommand{\ERM}{{\text{\rm ERM}}\xspace}

\newcommand{\defeq}{\stackrel{\rm def}{=}}
\newcommand{\DefinedAs}[0]{\mathrel{\mathop:}=}
\newcommand{\sgn}{\mbox{\sc sgn}}
\newcommand{\scI}{\mathcal{I}}
\newcommand{\scO}{\mathcal{O}}
\newcommand{\scN}{\mathcal{N}}

\newcommand{\dt}{\displaystyle}
\renewcommand{\ss}{\subseteq}
\newcommand{\wh}{\widehat}
\newcommand{\wt}{\widetilde}
\newcommand{\ve}{\varepsilon}
\newcommand{\hlambda}{\wh{\lambda}}
\newcommand{\yhat}{\wh{y}}
\newcommand{\pred}{\yhat}

\newcommand{\hDelta}{\wh{\Delta}}
\newcommand{\hdelta}{\wh{\delta}}
\newcommand{\spin}{\{-1,+1\}}

\newcommand{\paren}[1]{\left({#1}\right)}
\newcommand{\brackets}[1]{\left[{#1}\right]}
\newcommand{\braces}[1]{\left\{{#1}\right\}}

\newcommand{\normt}[1]{\norm{#1}_{t}}
\newcommand{\dualnormt}[1]{\norm{#1}_{t,*}}

\newcommand{\order}{\ensuremath{\mathcal{O}}}
\newcommand{\otil}{\ensuremath{\widetilde{\mathcal{O}}}}
\newcommand{\risk}{{\text{\rm Risk}}}
\newcommand{\iid}{{\text{\rm iid}}}
\newcommand{\seq}{{\text{\rm seq}}}
\newcommand{\iidV}{\calV^\iid}
\newcommand{\seqV}{\calV^\seq}
\newcommand{\poly}{{\text{\rm poly}}}
\newcommand{\sign}{{\text{\rm sign}}}
\newcommand{\ERM}{\pred_{{\text{\rm ERM}}}}
\newcommand{\iidRad}{\calR^{\iid}}
\newcommand{\iidCRad}{\wh{\calR}^{\iid}}
\newcommand{\VC}{{\text{\rm VCdim}}}
\newcommand{\vol}{{\text{\rm Vol}}}
\newcommand{\Holder}{{H{\"o}lder}\xspace}

%%%%  brackets
\newcommand{\inner}[2]{\left\langle #1,#2 \right\rangle}
\newcommand{\minimax}[1]{\left\llangle #1 \right\rrangle}
\newcommand{\rbr}[1]{\left(#1\right)}
\newcommand{\sbr}[1]{\left[#1\right]}
\newcommand{\cbr}[1]{\left\{#1\right\}}
\newcommand{\nbr}[1]{\left\|#1\right\|}
\newcommand{\abr}[1]{\left|#1\right|}

\DeclareFontFamily{OMX}{MnSymbolE}{}
\DeclareFontShape{OMX}{MnSymbolE}{m}{n}{
    <-6>  MnSymbolE5
   <6-7>  MnSymbolE6
   <7-8>  MnSymbolE7
   <8-9>  MnSymbolE8
   <9-10> MnSymbolE9
  <10-12> MnSymbolE10
  <12->   MnSymbolE12}{}
\DeclareSymbolFont{mnlargesymbols}{OMX}{MnSymbolE}{m}{n}
\SetSymbolFont{mnlargesymbols}{bold}{OMX}{MnSymbolE}{b}{n}
\DeclareMathDelimiter{\llangle}{\mathopen}{mnlargesymbols}{'164}{mnlargesymbols}{'164}
\DeclareMathDelimiter{\rrangle}{\mathclose}{mnlargesymbols}{'171}{mnlargesymbols}{'171}

\usepackage{prettyref}
\newcommand{\pref}[1]{\prettyref{#1}}
%\newcommand{\pfref}[1]{Proof of \prettyref{#1}}
\newcommand{\savehyperref}[2]{\texorpdfstring{\hyperref[#1]{#2}}{#2}}
\newrefformat{eq}{\savehyperref{#1}{\textup{(\ref*{#1})}}}
\newrefformat{eqn}{\savehyperref{#1}{Equation~\eqref{#1}}}
\newrefformat{lem}{\savehyperref{#1}{Lemma~\ref*{#1}}}
\newrefformat{def}{\savehyperref{#1}{Definition~\ref*{#1}}}
\newrefformat{line}{\savehyperref{#1}{line~\ref*{#1}}}
\newrefformat{thm}{\savehyperref{#1}{Theorem~\ref*{#1}}}
\newrefformat{corr}{\savehyperref{#1}{Corollary~\ref*{#1}}}
\newrefformat{cor}{\savehyperref{#1}{Corollary~\ref*{#1}}}
\newrefformat{sec}{\savehyperref{#1}{Section~\ref*{#1}}}
\newrefformat{app}{\savehyperref{#1}{Appendix~\ref*{#1}}}
\newrefformat{assum}{\savehyperref{#1}{Assumption~\ref*{#1}}}
\newrefformat{ex}{\savehyperref{#1}{Example~\ref*{#1}}}
\newrefformat{fig}{\savehyperref{#1}{Figure~\ref*{#1}}}
\newrefformat{alg}{\savehyperref{#1}{Algorithm~\ref*{#1}}}
\newrefformat{rem}{\savehyperref{#1}{Remark~\ref*{#1}}}
\newrefformat{conj}{\savehyperref{#1}{Conjecture~\ref*{#1}}}
\newrefformat{prop}{\savehyperref{#1}{Proposition~\ref*{#1}}}
\newrefformat{proto}{\savehyperref{#1}{Protocol~\ref*{#1}}}
\newrefformat{prob}{\savehyperref{#1}{Problem~\ref*{#1}}}
\newrefformat{claim}{\savehyperref{#1}{Claim~\ref*{#1}}}
\newrefformat{que}{\savehyperref{#1}{Question~\ref*{#1}}}