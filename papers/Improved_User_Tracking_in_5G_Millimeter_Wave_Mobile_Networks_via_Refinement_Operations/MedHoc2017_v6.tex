%\documentclass[journal]{IEEEtran}
%\documentclass[12pt,journal,draftclsnofoot,onecolumn]{IEEEtran}
\documentclass[conference]{IEEEtran}

\IEEEoverridecommandlockouts
%\pagenumbering{gobble} 

\renewcommand{\baselinestretch}{0.97} 

%Fixing IEEEtran.cls bug with [english]{babel}
\makeatletter
\def\markboth#1#2{\def\leftmark{\@IEEEcompsoconly{\sffamily}\MakeUppercase{\protect#1}}%
\def\rightmark{\@IEEEcompsoconly{\sffamily}\MakeUppercase{\protect#2}}}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%	CONFIGURE TRACKCHANGES PACKAGES

%	select style of notes

% \usepackage[finalnew,ignoremode]{trackchanges}
%\usepackage[finalold]{./trackchanges/LatexPackage/trackchanges}
%\usepackage[footnotes]{./trackchanges/LatexPackage/trackchanges}
%\usepackage[inline,ignoremode]{trackchanges}
% \usepackage[inline]{./trackchanges/LatexPackage/trackchanges}
%\usepackage[margins,ignoremode]{./trackchanges/LatexPackage/trackchanges}
% \usepackage[margins, movemargins,ignoremode]{trackchanges}
% \usepackage[margins, adjustmargins]{./trackchanges/LatexPackage/trackchanges}
%\tcignore{\ref}{1}{1}
%\tcignore{\eqref}{1}{1}
%\tcignore{\cite}{1}{1}

% 	add editor profiles
%\addeditor{Felipe}
% \addeditor{b}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \usepackage{t1enc}

%\usepackage[utf8x]{inputenc}
\usepackage[english]{babel}
\selectlanguage{english}
\usepackage{color}
\usepackage{lipsum}% http://ctan.org/pkg/lipsum
%\usepackage{caption}
\usepackage{cite}
\usepackage[pdftex]{graphicx}
%\usepackage{subfigure}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{array}
\usepackage{verbatim}
\usepackage{listings}
%\usepackage{algorithm}
%\usepackage{algorithmic}
%\usepackage{algpseudocode}
%\usepackage{hyperref}
\usepackage{url}
\usepackage{enumerate}
\usepackage{multirow}

\usepackage{epsfig}
\usepackage{epstopdf}
\usepackage{multicol}% http://ctan.org/pkg/multicols
\usepackage[font=footnotesize]{caption}
\usepackage[font=footnotesize]{subcaption}
% Tikz
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=newest} 
\pgfplotsset{plot coordinates/math parser=false} 
\newlength\fheight
\newlength\fwidth
\usetikzlibrary{patterns,decorations.pathreplacing,backgrounds,calc}
\definecolor{SchoolColor}{RGB}{0.71, 0, 0.106}%181,0,27} unipd red
\definecolor{chaptergrey}{rgb}{0.61, 0, 0.09} % dialed back a little
\definecolor{midgrey}{rgb}{0.4, 0.4, 0.4}
\definecolor{chaptergreen}{rgb}{0.09, 0.612, 0}
\definecolor{chapterpurple}{rgb}{0.522, 0, 0.612}
\definecolor{chapterlightgreen}{rgb}{0, 0.612, 0.522}

%\raggedbottom

% Pseudocode
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\renewcommand\algorithmicthen{}
\renewcommand\algorithmicdo{}
\captionsetup[algorithm]{font=footnotesize}
\usepackage{lscape}
\usepackage{setspace}




% remove space after title
\usepackage{etoolbox}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}

\newcommand{\field}[1]{\mathbb{#1}}

\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\renewcommand{\arraystretch}{2}

\newcommand{\Hb}{\mathbf{H}}
\newcommand{\Sb}{\mathbf{\Sigma}}
\newcommand{\U}{\mathbf{U}}
\newcommand{\F}{\mathbf{F}}
\newcommand{\V}{\mathbf{V}}
\newcommand{\A}{\mathbf{A}}
\newcommand{\B}{\mathbf{B}}
\newcommand{\C}{\mathbf{C}}
\newcommand{\E}{\mathbf{E}}
\newcommand{\I}{\mathbf{I}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\N}{\mathbf{N}}
\newcommand{\W}{\mathbf{W}}
\newcommand{\Z}{\mathbf{Z}}
%\newcommand{\R}{\mathbf{R}}
\newcommand{\X}{\mathbf{X}}
\newcommand{\Pb}{\mathbf{P}}
\newcommand{\Q}{\mathbf{Q}}
\newcommand{\D}{\mathbf{D}}
\newcommand{\one}{\mathbf{1}}
\newcommand{\zero}{\mathbf{0}}
\newcommand{\Rm}{\mathbf{R^{-1}}}
\newcommand{\LL}{\mathbf{\boldsymbol{\Lambda}}}
\newcommand{\J}{\mathbf{J}}

\newcommand{\textr}[1]{{\color{red} #1 } }
\newcommand{\cc}{\mathbf{c}}
\newcommand{\h}{\mathbf{h}}
\newcommand{\x}{\mathbf{x}}
\newcommand{\f}{\mathbf{f}}
\newcommand{\s}{\mathbf{s}}
\newcommand{\q}{\mathbf{q}}
\newcommand{\vv}{\mathbf{v}}
\newcommand{\uu}{\mathbf{u}}
\newcommand{\y}{\mathbf{y}}
\newcommand{\bb}{\mathbf{b}}
\newcommand{\n}{\mathbf{n}}
\newcommand{\w}{\mathbf{w}}
\newcommand{\uv}{\mathbf{u}}
\newcommand{\al}{\mathbf{\boldsymbol{\alpha}}}
\newcommand{\g}{\mathbf{g}}
\newcommand{\rr}{\mathbf{r}}
\newcommand{\z}{\mathbf{z}}
\newcommand{\ab}{\mathbf{a}}

\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pw}[1]{\frac{\partial #1}{\partial \w}}
\usepackage{chronology}

\newcommand{\bi}{\begin{itemize}}
\newcommand{\ei}{\end{itemize}}
\newcommand{\be}{\begin{equation}} 
\newcommand{\ee}{\end{equation}}
\newcommand{\rank}{\textnormal{rank}}
\newcommand{\trace}{\textnormal{trace}}
\newcommand{\exptr}{\textnormal{exptr}}
\newcommand{\tr}{\textnormal{tr}}
%  |x>
\newcommand{\ket}[1]{\left\vert#1\right\rangle}
%  <x|
\newcommand{\bra}[1]{\left\langle#1\right\vert}
%  <x|y>
\newcommand{\braket}[2]{\left< #1 \vphantom{#2}\,
                        \right\vert\left.\!\vphantom{#1} #2 \right>}
%  <x|a|y>
\newcommand{\sandwich}[3]{\left< #1 \vphantom{#2 #3} \right|
                          #2 \min\left(\vphantom{#1 #2} #3 \right>}
%  d/dt
\newcommand{\ddt}{\frac{d}{dt}}
%  D/Dx
\newcommand{\pdd}[1]{\frac{\partial}{\partial#1}}
%  |x|
\newcommand{\abs}[1]{\left\vert#1\right\vert}
%  k_{x}
\newcommand{\kv}[1]{\mathbf{k}_{#1}}
%  \textnormal{E}_{domain of integration}{variable}
\newcommand{\Ex}[2]{{\textnormal{E}_{#1}\left[#2\right]}}
\newcommand{\CInf}[3]{{\textnormal{I}\left(#1;#2|#3\right)}}
\newcommand{\Inf}[2]{{\textnormal{I}\left(#1;#2\right)}}

\renewcommand{\figurename}{Fig.}
\renewcommand{\figurename}{Fig.}
\newcommand{\PESrule}{\noindent\rule{.57\columnwidth}{0.1mm}}

\newcommand{\R}{R_{\rm comm}}
\newcommand{\T}{T_{\rm RTO}}

\newtheorem{definition}{Definition}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{remark}{Remark}
\newtheorem{corollary}{Corollary}
\usepackage{color}

\def\beq{\begin{equation}}
\def\eeq{\end{equation}}
\def\beqa{\begin{eqnarray}}
\def\eeqa{\end{eqnarray}}
\def\beqan{\begin{eqnarray*}}
\def\eeqan{\end{eqnarray*}}

\newcommand{\mz}[1]{\textbf{(MZ: #1)}}
\newcommand{\MP}[1]{\textr{(MP: #1)}}

\usepackage{threeparttable}
%\usepackage[table,xcdraw]{xcolor}
\usepackage{tabularx}
   \usepackage{multirow}
   \usepackage{booktabs}
%\newcommand{\tabitem}{~~\llap{\textbullet}~~}
   \usepackage{array, blindtext}
   \usepackage{wrapfig}
\usepackage{pdfpages}
\newcommand{\tabitem}{~~\llap{-}~~}



\usetikzlibrary{automata,positioning}

\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=0.5pt] (char) {#1};}}


% use tikz images or eps
\newif\iftikz
\tikztrue

\usepackage{cleveref}[2012/02/15]% v0.18.4; 
% 0.16.1 of May 2010 would be sufficient, but what is the exact day?

\crefformat{footnote}{#2\footnotemark[#1]#3}


\graphicspath{{./figures/}}
\title{Improved User Tracking in 5G Millimeter Wave Mobile~Networks   via Refinement Operations}
\author{Marco Giordani, Michele Zorzi
%Onur Altintas$^*$
\\
Department of Information Engineering (DEI), University of Padova, Italy\\
%\, Toyota, Silicon Valley, USA\\
\small{$\{$\texttt{giordani}, \texttt{zorzi}$\}$\texttt{@dei.unipd.it}}
\thanks{The work of M. Zorzi was partially supported by NYU Wireless.}}


%\IEEEoverridecommandlockouts\IEEEpubid{\makebox[\columnwidth] \centering {978-1-5090-1983-0/16/\$31.00~\copyright{}2016 IEEE \hfill} \hspace{\columnsep}\makebox[\columnwidth]{ }}

% Reduce the space below figs.
\setlength{\belowcaptionskip}{-0.4cm}

\makeatletter
\patchcmd{\@maketitle}
  {\addvspace{0.5\baselineskip}\egroup}
  {\addvspace{-0.4\baselineskip}\egroup}
  {}
  {}
\makeatother

 \usetikzlibrary{fixedpointarithmetic,external,matrix, automata,trees,positioning,shadows,arrows,shapes.geometric,shapes.multipart,trees,calc, fit, decorations.pathmorphing,decorations.pathreplacing}

\begin{document}
\maketitle

%\thispagestyle{plain}
%\pagestyle{plain}


\begin{abstract}
The millimeter wave (mmWave) frequencies offer the availability of huge bandwidths to provide unprecedented data rates to  next-generation cellular mobile terminals.
However, directional mmWave links are highly susceptible to rapid channel variations and suffer from  severe isotropic pathloss. 
To face these impairments, this paper addresses the issue of tracking the channel quality of a moving user, an essential procedure for rate prediction, efficient handover and  periodic monitoring and adaptation of the user's transmission configuration.
The performance of an innovative tracking scheme, in which periodic refinements of the optimal steering direction are alternated to sparser refresh events, are analyzed  in terms of both achievable data rate and energy consumption, and compared to those of a state-of-the-art approach.
 We aim at understanding in which circumstances the proposed scheme is a valid option to provide a robust 
and efficient mobility management solution. We show that our  procedure is particularly well suited to highly variant and unstable mmWave environments.
\end{abstract}

\begin{IEEEkeywords}
Tracking, Mobility, Millimeter Wave (mmWave), 5G, Directionality.
\end{IEEEkeywords}


\section{Introduction}

The millimeter wave (mmWave) bands -- roughly corresponding to frequencies above $10$ GHz\footnote{Although strictly speaking mmWave bands include frequencies between
$30$ and $300$ GHz,  industry has loosely defined it to include any frequency
above $10$ GHz.} --
have attracted considerable attention for the fifth-generation  (5G) of cellular mobile systems \cite{KhanPi:11-CommMag, Rappaport_WillWork}.
On the one hand, the vast amount of largely unused bandwidth can support orders of magnitude more spectrum than conventional sub-$6$ GHz networks. 
On the other hand, the mmWave signals suffer from increased pathloss, severe channel intermittency, and inability to penetrate through most common materials \cite{Allen:94}, thus making the propagation conditions more demanding than at lower frequencies.
To overcome these issues, next-generation cellular systems must provide a mechanism by which user equipments (UEs) and mmWave eNBs establish highly directional transmission links, typically formed with high-dimensional phased arrays, to benefit from the resulting beamforming (BF) gain and support a more sustainable communication quality.
In this context, directional links require  fine alignment of the transmitter and the receiver beams, an operation which might dramatically increase the time it takes to access the network \cite{Giordani_magazineIA_2016}. 
Moreover, the dynamics of the mmWave channel imply that the directional path to any cell can deteriorate rapidly, necessitating an intensive \emph{tracking} of the mobile terminal\cite{RanRapE:14}.
%, to provide robust service in the face of variable link quality . 
Therefore, periodic monitoring of the channel quality between each UE-mmWave eNB pair, to perform a variety of control tasks (including handover, path selection, radio link failure detection and recovery, beam adaptation), is fundamental to provide efficient mobility-management schemes.

The issue of designing adequate tracking solutions has been recently addressed in the literature.
In 3GPP LTE, the tracking of the downlink channel quality is studied; however, omnidirectional pilots are used for  channel estimation, preventing the proposed techniques from being applicable in mmWave environments.
In our previous contribution \cite{Giordani_magazineIA_2016}, we investigated several schemes by which a proper directional beam pair could be established between a transmitting and a receiving mobile nodes.
In \cite{giordani_MedHoc2016,giordani2016uplink}, we proposed an uplink measurement system to enable the mmWave eNB to efficiently track the UE channel quality along multiple links and spatial directions, to perform fast beam realignment and/or handover. This scheme was based on \emph{multi-connectivity} \cite{ghosh2014millimeter}, to benefit from both the high capacities of mmWave channels, as well as from the more robust, but lower capacity, sub-6 GHz links.
Articles \cite{chandra2014adaptive, MC} propose a multi-connectivity solution for
mobility-related link failures and throughput degradation of cell-edge users, enabling increased
reliability with different levels of~mobility.

In this paper, we present an innovative tracking technique by which the UE can  alternate exhaustive scans of the whole angular space (i.e., to determine the optimal surrounding mmWave eNB to connect to, and eventually trigger a handover event accordingly) to more frequent (and faster) \emph{refinements} operations (i.e., to adapt the beam if the previously optimal configuration has degraded).
With respect to our previous works, the proposed tracking architecture is compared in terms of both experienced data rate and energy consumption at the mobile terminal's side, aiming at understanding in which circumstances and in which mmWave scenarios our scheme is a valid option to provide robust and efficient user tracking. Moreover, to the best of our knowledge, this is the first contribution which numerically provides a global evaluation of the performance of multiple tracking algorithms in mmWave mobile cellular networks. 
We argue that the proposed procedure is particularly well suited to highly variant and unstable environments, or as a support to  legacy tracking operations when frequent complete angular sweeps are not executable.

The remainder of this paper is organized as follows. In Section \ref{sec:procedures}, we present the tracking procedure we aim at comparing. In Section \ref{sec:sim_setup}, we describe the setup we use to carry out our simulations, while in Section \ref{sec:results} our major findings and results are presented. Finally, we conclude this work and  list our proposed next research steps in Section~\ref{sec:conclusion}.



\section{Tracking Procedures Description}
\label{sec:procedures}

%\begin {figure*}[!t]
%\centering
%\begin{chronology}[20]{1}{42}{3ex}{\textwidth}
%        \multirowevent[6]{6}{\color{black}\parbox{3cm}{\centering  	Refresh}}	
%                \multirowevent[12]{12}{\color{black}\parbox{3cm}{\centering Refinement}}	
%                                \multirowevent[18]{18}{\color{black}\parbox{3cm}{\centering Refinement}}	
%                                 \multirowevent[24]{24}{\color{black}\parbox{3cm}{\centering Refinement}}
%                                  \multirowevent[30]{30}{\color{black}\parbox{3cm}{\centering Refinement}}		
%        \multirowevent[36]{36}{\color{black}\parbox{3cm}{\centering Refresh}}	
%	\action[6]{36}{\color{red}Refresh Period}
%		\actionbis[12]{18}{\color{blue}Refinement  Period}
%
%    \end{chronology}
%\end{figure*}


 
In this section, we  describe the tracking procedures whose performance we will compare and discuss. 
In all schemes, a
multi-connectivity approach can be applied, to benefit from the
presence of the LTE eNB to enable a more robust connection
and a better performing mobility and handover management,
as pointed out in our previous contributions~\cite{giordani_MedHoc2016,giordani2016uplink, JSAC_2017}.

In the general scenario, we consider one controller node (that can be identified by an LTE eNB) and $M$ mmWave eNBs deployed under its coverage.
These nodes are interconnected and can communicate and exchange control information via traditional backhaul X2 interface links (whose latency is assumed to be negligible).
Each UE needs to establish a \emph{directional} connection (by selecting the most suitable mmWave eNB to attach with)  when it first accesses the network, to balance for the increased pathloss experienced at high frequencies.
Moreover, monitoring the transmitting direction over time is fundamental to trigger handovers and/or adapt the beams of the user and its serving cell, to grant good average
throughput and deal with the channel dynamics experienced at mmWave frequencies.
We assume that nodes select one of a finite number of directions, and we let
$N_{\rm eNB}$ and $N_{\rm UE}$ be the number of directions at each  eNB and
UE, respectively.



In each scheme, the mmWave eNBs continuously scan the angular space, one direction every  $T_{\rm per}$ s (if an analog beamforming architecture is chosen) sending a Primary Synchronization Signal (PSS) for   $T_{\rm sig}$ s, in order to maintain a constant overhead $\phi_{\rm ov}$. Those pilots are scrambled by locally unique identifiers and can be used for channel estimation.
Users are instead required to collect those signals: multiple schemes may be chosen, as described in the following.

\begin{figure}[t]
  \centering
  \begin{subfigure}[t]{0.4\columnwidth}
    \includegraphics[width = \textwidth]{Figures/Refresh}
    \caption{Refresh process,  through $N_{\rm UE}=8$ directions.}
          \label{fig:procedures_PR}
  \end{subfigure}\quad \quad
  \begin{subfigure}[t]{0.4\columnwidth}
 \includegraphics[width = \textwidth]{Figures/Refinement}
      \caption{Refinement process, through $k_{\rm ref} = 2$ direcions.}
         \label{fig:procedures_PRaR}
  \end{subfigure}
  \vspace{0.5cm}
  \caption{Tracking procedures. In all schemes, the mmWave eNBs continuously scan the angular space, one direction at a time, through $N_{\rm eNB}$ directions. Refreshes and refinements are performed every $T_{\rm RP}$ and $t_{\rm ref}$ s, respectively.} 
\end{figure}

\paragraph{\textbf{Scheme A -- Periodical Refresh (PR)}}

The PR scheme (Fig. \ref{fig:procedures_PR}) follows the implementation proposed in \cite{Giordani_magazineIA_2016}. While each mmWave eNB periodically sends pilots through  directions $D_1,\dots,D_{N_{\rm eNB}}$, one at a time, the UE configures its antenna array in order to exhaustively receive those synchronization messages. 
If an analog beamforming architecture is employed\footnote{If instead a digital beamforming architecture is  implemented, the UE can receive the pilots in all the $N_{\rm UE}$ angular directions simultaneously. The effects of this choice will be investigated in Section \ref{sec:results}.}, the UE investigates each of its $d_1,\dots,d_{N_{\rm UE}}$ directions sequentially, until the whole angular space has been scanned.
At each iteration, the user evaluates the Signal-to-Interference-plus-Noise-Ratio (SINR) experienced when receiving through direction $j\in \{d_1,\dots,d_{N_{\rm UE}}\}$ the PSS transmitted by the mmWave eNB$_m$, $m\in \{1,\dots ,M\}$ through direction   $i\in \{D_1,\dots,D_{N_{\rm eNB}}\}$: $\text{SINR}_{i,j}(m) $.
 Thus, between any mmWave eNB and the UE, there
are a total of $N_{\rm eNB} \times N_{\rm UE}$ direction pairs to investigate, to gain a comprehensive overview of the surrounding channel conditions and make the optimal attachment decision.
At the end of the sweep, the UE selects the optimal mmWave eNB$_{m_{\rm opt}}$ to associate with, based on the absolute maximum collected SINR value, which corresponds to a specific direction pair ($D_{\rm opt}, d_{\rm opt}$):
\beq
\{m_{\rm opt}, D_{\rm opt}, d_{\rm opt} \} \argmax_{\substack{m =1,\dots, M\\j=d_1,\dots,d_{N_{\rm UE}}\\ i =D_1,\dots,D_{N_{\rm eNB}}} } \text{SINR}_{i,j}(m)
\label{eq:max_SINR}
\eeq
Finally, the UE feeds back (either through the LTE connection or by performing a complete scan) to the candidate  mmWave eNB$_{m_{\rm opt}}$ the information on the optimal direction to set  ($D_{\rm opt}$) to communicate with the best performance.
We highlight that the
procedure described in this section allows  to optimally adapt the beam even when a handover is
not strictly required. In particular, if the user's optimal mmWave eNB is the same as the current
one, but a new steering direction pair ($D_{\rm opt},d_{\rm opt}$) is able to provide a higher SINR to the
user, a beam switch is prompted, to realign with the eNB and guarantee better communication
performance \cite{JSAC_2017}. The minimum time required to complete each periodical refresh ($T_{\rm PR}$) is:
\beq
\min(T_{\rm PR}) = T_{\rm per} \cdot N_{\rm eNB} \cdot N_{\rm UE}
\eeq
\paragraph{\textbf{Scheme B -- Periodical Refinement and Refresh (PRaR)}}
The PRaR scheme (Fig. \ref{fig:procedures_PRaR}) is composed of two  stages. 
Once every $T_{\rm PR}$ s, following the procedure described in the previous paragraph, the UE is able to refresh and select the best mmWave eNB to connect to (even after a handover event is triggered), together with the  angular direction through which to optimally steer the beam.
As a second stage, every ${t_{\rm ref} < T_{\rm PR}}$ s, the UE performs a \emph{refinement procedure} to adapt its beam if the previously optimal configuration has degraded (e.g., if the moving user misaligns from its serving mmWave eNB, or after a modification of the surrounding channel conditions). 
Of course, only a beam switch operation can occur at this stage, since a handover can eventually take place only during a PR.
In this case, the UE investigates its current optimal directions $d_{\rm opt}$, and it forms $k_{\rm ref}$ refining beams in adjacent directions, looking for stronger paths. The UE only acquires pilot signals spread from its current serving mmWave eNB$_{m_{\rm opt}}$.
At each iteration, the SINR values experienced when the UE is receiving from directions ${j\in \{d_{{\rm opt}-k_{\rm ref}/2 },\dots,d_{\rm opt}, \dots,d_{{\rm opt}+k_{\rm ref}/2 }\} }$ are computed.
At this point, based on the maximum collected SINR  entry, the UE is able to select, among the $k_{\rm ref}+1$ directions investigated during the refining process, the direction $d_{\rm opt}'$ through which it experiences the maximum data rate: 
 \beq
\{D_{\rm opt}', d_{\rm opt}' \} = \argmax_{\substack{ i =D_1,\dots,D_{N_{\rm eNB}} \\ j=d_{{\rm opt}-k_{\rm ref}/2 },\dots,d_{{\rm opt}+k_{\rm ref}/2 } }} \text{SINR}_{i,j}(m_{\rm opt})
\label{eq:max_SINR}
\eeq
 Again, the new optimal mmWave eNB direction $D_{\rm opt}'$ (if any) can be fed back to the intended  mmWave cell either through an LTE message or after an uplink mmWave control signal is exchanged through direction $d_{\rm opt}'$. The minimum time required to complete each periodic refinement ($t_{\rm ref}$) is:
\beq
\min(t_{\rm ref}) = T_{\rm per} \cdot N_{\rm eNB} \cdot (k_{\rm ref} + 1)
\label{eq:t_ref}
\eeq
As we will further discuss in Section \ref{sec:results}, Scheme A results in a reduced energy consumption, at the expense of a less frequent channel monitoring, which may lead to a performance degradation in terms of  data rate. 
On the other hand, Scheme B can leverage on more frequent beam updates and consequently guarantee a more stable and robust throughput over time, while however requiring more energy to be consumed for the  refinement processes.
A trade-off between achievable data rate and consumed energy (over a fixed time window) must be investigated, when considering specific network scenarios.


\section{Simulation Setup}
\label{sec:sim_setup}
In  Section \ref{sec:channel} we briefly describe the mmWave channel model we used to carry out the results, and in Section \ref{sec:mobility} we present the mobility model we implemented to simulate the channel variations and fluctuations over time (in terms of both small and large scale fading). An energy consumption model is also discussed in Section \ref{sec:EC}, while in Section \ref{sec:sim:params} we present our main simulation parameters.

\subsection{MmWave Channel Model}
\label{sec:channel}
The channel model is based on recent real-world measurements at 28 GHz in New York
City, to provide a realistic assessment of mmWave micro and picocellular networks in a dense
urban deployment \cite{Mustafa,MacCartney2015Wideband,samimi2015chanmod}. 
The parameters of the mmWave channel that are
used to generate one instance of the channel matrix \textbf{H} include: (i) spatial clusters; (ii) fractions of power; (iii) angular beamspreads; and
(iv) a small-scale fading model, massively affected by the Doppler shift, where each of the path clusters is synthesized with a large number of subpaths. A complete description of the channel parameters can be found in \cite{Mustafa,giordani2016uplink}.

The distance-based pathloss, which models Line-of-Sight (LoS), Non-Line-of-Sight (NLoS) and outage, is defined as
%\begin{equation}
$PL(d)[dB] = \alpha + \beta 10 \log_{10}(d)$,
%\end{equation}
where $d$ is the distance between the receiver and the transmitter and the values of the parameters $\alpha$ and $\beta$ are given in \cite{Mustafa}.

Due to the high pathloss experienced at mmWaves, multiple antenna elements with beamforming (BF) are essential to provide an acceptable  communication range. The BF gain from transmitter $i$ to receiver $j$ is  given by:
\begin{equation}
G({{i,j}}) = |\textbf{w}^*_{rx_{i,j}}\textbf{H}_{ij}\textbf{w}_{tx_{i,j}}|^2
\label{beamforming_gain}
\end{equation}
where $\textbf{H}_{i,j}$ is the channel matrix of the $ij^{th}$ link, $\textbf{w}_{tx_{i,j}}\in \mathbb{C}^{n_{\mathbb{T}x}}$ is the BF vector of transmitter $i$ when transmitting to receiver $j$, and $\textbf{w}_{rx_{i,j}}\in \mathbb{C}^{n_{\mathbb{R}x}}$ is the BF vector of receiver $j$ when receiving from transmitter $i$.  Both vectors are complex, with length equal to the number of antenna elements in the array, and are chosen according to the specific direction that links mmWave eNB and UE.

The channel quality is measured in terms of SINR. By referring to the mmWave statistical channel described above, the SINR between eNB$_m$ and a test UE is:
\begin{equation}
\text{SINR}( m) = \frac{\frac{P_{\rm TX}}{PL_{ m}}G{(m, \rm UE)}}{\sum_{k\neq m}\frac{P_{\rm TX}}{PL_{ k}}G({ k,\rm UE})+W_{\rm tot}\times N_0}
\vspace{0.5cm}
\label{eq:SINR}
\end{equation}
where $G({ m,\rm UE})$ and $PL_{ m}$ are the BF gain and the pathloss obtained between eNB$_{m}$ and the UE, respectively, and ${ W_{\rm tot}\times N_0}$ is the thermal noise.
In \eqref{eq:SINR}, it is assumed that the UE is interfered by other transmitters. However, to some extent, we can assume that the PSS waveforms are transmitted over multiple sub-signals with each sub-signal being transmitted over a small bandwidth $W_{\rm sig}$. 
The use of the sub-signals can provide frequency diversity, and narrowband signals in~the control plane  remove any inter-cell interference and support  low power receivers with high SINR capabilities~\cite{giordani2016uplink,Barati_IA}.

Finally, the rate ($R$) experienced by the UE connected to eNB$_{m}$ is approximated using the Shannon capacity:
\begin{equation}
R({m)} = \frac{W_{\rm tot}}{N}  \log_2\Big(1+\text{SINR}(m)\Big)
\label{eq:rate}
\end{equation}

where $N$ is the  number of users that are currently being served by eNB$_m$ and $W_{\rm tot}$ is the total available  bandwidth.



\subsection{Mobility Model}
\label{sec:mobility}


In our scenario, the test user moves in a fixed direction, at   speed $v$. 
When moving, the user experiences a strong Doppler shift  whose effect increases with speed.
However, most of the studies have been conducted in stationary
conditions with minimal local blockage, thus it is quite difficult to estimate the rapid channel dynamics
that affect a realistic mmWave scenario.
In order to simulate such  dynamics, following the model proposed in \cite{ giordani2016uplink}, we periodically update both the small and the large scale fading parameters of the \textbf{H} matrix, to emulate short fluctuations and sudden changes of the perceived channel, respectively. These assumptions are in line with the majority of the studies that are conducted in this~field.

The Doppler shift and the user's angular position, given in terms of Angle-of-Arrival (AoA) and Angle-of-Departure (AoD), are updated at every time slot, according to the user speed. 
The distance-based pathloss is also updated, but we maintain the same pathloss state (LoS, NLoS or outage) recorded in the previous complete update of the \textbf{H} matrix.
On the other hand, every $T_H$ s, the \textbf{H} matrix is completely updated, to capture the effects of  long term fading.
 Therefore, we update all the statistical parameters of the channel, e.g., the number of spatial clusters and subpaths, the fractions of power, the angular beamspreads and the pathloss conditions, for all the mmWave links between each UE and each mmWave eNB. Of course, this may cause the user to switch from a certain pathloss state to another one (e.g., from LoS to NLoS, to simulate the presence of an obstacle between transmitter and receiver), with a consequent sudden drop of the channel quality by many dBs.





\subsection{Energy Consumption Model}
\label{sec:EC}

As we  previously discussed, beamforming in mmWave communication is
an essential requirement for both data and control planes, to help overcome the increased pathloss experienced at high frequencies.
Moreover, at mmWaves, huge bandwidths are available to meet the data rate requirements of future 5G cellular networks. 
This bandwidth increase and the utilization of large antenna arrays result in a higher power consumption (with respect to  legacy LTE systems), which is particularly critical for energy-constrained mobile terminals. 
In this section, we aim at understanding the user's energy consumption associated with different BF schemes and the different tracking procedure presented in Section~\ref{sec:procedures}. 

\textbf{Power Consumption.} Analog (ABF) and digital (DBF) beamforming architectures are the commonly discussed BF schemes for mmWave communication \cite{Sun_Rappaport_BF}. According to \cite{Waqas_EW2016}, the total power consumption ($P_C$) for these schemes is evaluated as:
\begin{equation}
P_{C_{\rm ABF}} = N_{\rm ANT}(P_{\rm LNA} + P_{\rm PS}) + P_{\rm RF} + P_{\rm C} + 2P_{\rm ADC};
\label{eq:ABF}
\end{equation}
\begin{equation}
P_{C_{\rm DBF}} = N_{\rm ANT}(P_{\rm LNA} +  P_{\rm RF} + 2P_{\rm ADC}),
\label{eq:DBF}
\end{equation}
where $P{C_{\rm ABF}}$ ($P_{C_{\rm DBF}}$) is the power consumed when an analog (digital) BF configuration is employed, $N_{ANT}$ is the number of antenna elements in the MIMO array, and $P_{\rm LNA}$, $P_{\rm PS}$, $P_{\rm C}$ represent the power consumptions of the Low Power Amplifier, Phase Shifter and Combiner, respectively.

$P_{\rm RF}$  (the power consumption of the RF chain) is given~by:
\beq
P_{\rm RF} = P_{\rm M} + P_{\rm LO} + P_{\rm LPF} + P_{\rm BB_{\rm amp}},
\eeq
where $P_{\rm M}$, $P_{\rm LO}$, $P_{\rm LPF}$, $P_{\rm BB_{\rm amp}}$ represent the power consumption of Mixer, Local Oscillator, Low Pass Filter and BaseBand amplifier, respectively.

\begin{figure*}[t!]
	\centering
		\setlength{\belowcaptionskip}{0cm}
		\iftikz
		\setlength{\belowcaptionskip}{0cm}
		\setlength\fwidth{0.95\textwidth}
		\setlength\fheight{0.15\textwidth}
		\input{./Figures/rate_example_v2_smaller.tex}
		\else
		\includegraphics[width = \textwidth]{Figures/rate_example}
		\fi
		\caption{Example of time-varying rate experienced by a user moving at  speed $v=20$ m/s. The small scale fading parameters of \textbf{H} change every time slot ($1$ ms), while the large scale fading parameters are updated every $T_{H}=0.2$ s (blue vertical straight lines). Refreshes are performed every $T_{\rm PR} = 1$ s (magenta vertical straight lines) while, if Scheme B is applied, refinement events (with $k_{\rm ref}=2$) are also performed, every $t_{\rm ref}=0.1$ s (blue vertical dashed~lines).}
		\vspace{-1.2em}
		\label{fig:rate_example}
\end{figure*}

$P_{\rm ADC}$ is the power consumption of the Analog-to-Digital Converter (ADC), which increases
linearly with the bandwidth $W_{\rm tot}$, and is given by:
\begin{equation}
P_{\rm ADC} = c W_{\rm tot} 2^b,
\end{equation}
where $c$ is the energy consumption per conversion step, and $2^b$ is the number of quantization levels of the ADC.

In general, DBF requires a separate RF chain for each antenna element and therefore has the highest power consumption. However, DBF allows to form multiple beams in multiple angular directions simultaneously, thus greatly reducing the  beam sweep  time \cite{abbas2016_ECIA}.

\textbf{Energy Consumption.}
The energy consumption ($E_C$) of a refresh or refinement procedure can be computed by evaluating the product of the total power consumption (either $P_{C_{\rm ABF}}$ or $P_{C_{\rm DBF}}$) and the time required to complete such procedure \cite{abbas2016_ECIA}. 
The scanning time is divided by $L$, whose value depends on the beamforming capabilities. In particular, $L = 1$ if the user has analog BF and $L = N_{\rm UE}$ if it has a fully digital transceiver\footnote{\label{footnoteL}For Scheme B, the value of $L$ is bounded by $k_{\rm ref}+1$, since the UE does not need to refine through all its angular directions.}. Therefore, according to the chosen scheme:
\begin{equation}
E_{C_{\rm refresh}} = P_C \cdot \frac{T_{\rm PR}}{L} \qquad E_{C_{\rm ref} }= P_C \cdot \frac{t_{\rm ref}}{L}.
\label{eq:EC}
\end{equation}


As we will further comment in Section \ref{sec:results}, refresh events are the most consuming in terms of energy, since they require $ N_{\rm eNB} \cdot N_{\rm UE}$ directions to be investigated (conversely, only $k_{\rm ref}+1$ directions are swept in the refinement process). 
However, Scheme B is expected to be the most consuming tracking procedure, requiring both a refresh and multiple refinements within the same time window, to monitor the user's steering direction more intensively. 


\subsection{Simulation Parameters}
\label{sec:sim:params}

\renewcommand{\arraystretch}{1}
\begin{table}[!t]
\small
\centering
\begin{tabular}{@{}lll@{}}
\toprule
Parameter & Value & Description \\ \midrule
 $W_{\rm tot}$ & $1$ GHz & Bandwidth of mmWave eNBs\\
 
$f_{\rm c}$ & $28$ GHz &  Carrier frequency \\

$P_{\rm TX}$ & $30$ dBm & Transmission power \\


% NF  & $5$ dB & Noise figure \\

$\Gamma$ & $ -5$ dB &  Minimum SINR threshold \\

$N_{\rm ANT,eNB}$ & $8 \times 8$  & eNB UPA MIMO array size  \\

$N_{\rm ANT,UE}$ & $4 \times 4$ & UE UPA MIMO array size\\

$N_{\rm eNB}$& $16$  & eNB scanning directions  \\

$N_{\rm UE}$& $8$  & UE scanning directions  \\


$T_{\rm sim}$ & $10$ s & Simulation duration \\

$v$ & $20$ m/s & UE speed\\

$k_{\rm ref}$ & Varied & Refinement factor\\

$T_{H}$ & Varied & Channel update periodicity\\

$\min (T_{PR})$ & $25.6$ ms & Minimum refresh period\\

$\min (t_{\rm ref})$ & $3.2(k_{\rm ref}+1$) ms & Minimum refinement period\\

$M$ & $70$ eNB/km$^2$ & mmWave eNB density \\

$T_{\rm sig}$ & $10 \, \: \mu s$& SRS duration \\

$\phi_{\rm ov}$ & $5\%$ & Overhead\\

$T_{\rm per}$ & $200 \: \mu$s & Period between PSS transmissions \\

\bottomrule
\end{tabular}
\caption{Simulation parameters.}
\label{tab:params}
\end{table}




The parameters used to run our simulations are based on realistic system design considerations and are summarized in Tab. \ref{tab:params}. We  consider an SINR threshold $\Gamma = -5$ dB, assuming that, if ${\text{SINR}_{i,j}(m) < \Gamma}$, no control signals are collected when the UE  receives through direction $j$  and the mmWave eNB$_m$ is steering through direction $i$.
 A two dimensional antenna array is used at both the mmWave eNBs and the UE.
eNBs are equipped with a Uniform Planar Array (UPA) of $8 \times 8$ elements, which allows them to steer beams in $N_{\rm eNB}=16$ directions; the user exploits an array of $4 \times 4$ antennas, steering beams through $N_{\rm UE}=8$ angular directions. The spacing of the elements is set to $\lambda/2$, where $\lambda$ is the wavelength.

According to \cite{Giordani_magazineIA_2016}, we assume that the PSSs  are transmitted periodically once every ${T_{\rm per} = 200 \: \mu s}$, for a duration of ${T_{\rm sig}=10}$ $\mu s$ (which is deemed sufficient to allow proper channel estimation at the receiver), to maintain a constant overhead  ${\phi_{\rm ov} = T_{\rm sig}/T_{\rm per} = 5 \%}$.

The parameters for the energy consumption evaluation can be retrieved from \cite{Waqas_EW2016,abbas2016_ECIA}, with $b=3$ quantization bits.

Our results are derived through a Monte Carlo approach, where multiple independent simulations (each of length $T_{\rm sim} = 10$ s), are repeated, to  get different statistical quantities of interest. In each experiment, we deploy multiple mmWave eNBs and multiple UEs, according to a Poisson Point Process (PPP), as done in \cite{Heath_coverage}, with an average density of $10$ users per mmWave eNB.

The goal of these simulations is to assess the difference in performance between systems
implementing a tracking procedure in which only periodic refreshes are performed (Scheme A) and those in which refreshes are interspersed with more frequent refinement operations (Scheme B).
The comparison is based  on both the average rate experienced by the user during each Monte Carlo trial and the energy consumed by the mobile terminal within a fixed time window. 
When an analog beamforming architecture is employed, each refresh event can be triggered every ${\min (T_{\rm PR}) = T_{\rm per} \cdot N_{\rm eNB} \cdot N_{\rm UE} = 25.6}$ ms and each refinement event can be triggered every ${\min (t_{\rm ref}) =  T_{\rm per} \cdot N_{\rm eNB} \cdot (k_{\rm ref}+1) = 3.2(k_{\rm ref}+1)}\, \rm ms$\footnote{\label{footnoteANB} The scanning time is divided by $L$, whose value depends on the beamforming capabilities. In particular, $L = 1$ if the user has analog BF and $L = N_{\rm UE}$ if it has a fully digital transceiver.}. 
However, sometimes we can accept sparser handover and/or beam adaptation operations, especially when considering flat and stable channels or sparse environments. 
Therefore, the performance of the tracking schemes is compared, in Section \ref{sec:results}, for different refresh and refinement periodicities, under a constraint on their minimum allowed values ($\min (T_{\rm PR})$ and $\min (T_{\rm PR})$). 
Finally, while the small scale fading parameters of the mmWave channel are updated every time slot ($1$ ms), its large scale fading parameters are updated for different values~of~$T_H$.

\begin{figure*}[t]
	\centering
	\begin{subfigure}[t]{0.45\textwidth}
		\setlength{\belowcaptionskip}{0cm}
		\iftikz
		\setlength{\belowcaptionskip}{0cm}
		\setlength\fwidth{0.83\textwidth}
		\setlength\fheight{0.41\textwidth}
		\input{Figures/rate_vs_tref.tex}
		\else
		\includegraphics[width = \textwidth]{Figures/rate_vs_tref.tex}
		\fi
		\caption{Rate vs. refinement periodicity $t_{\rm ref}$ (only for Scheme B), for different tracking procedures. $T_{\rm PR} = 0.6$ s and $T_{H} = 0.1$ s. }
			\label{fig:rate_vs_tref}
	\end{subfigure}
	\quad \quad
	\begin{subfigure}[t]{0.45\textwidth}
		\setlength{\belowcaptionskip}{0cm}
		\iftikz
		\setlength{\belowcaptionskip}{0cm}
		\setlength\fwidth{0.83\textwidth}
		\setlength\fheight{0.41\textwidth}
		\input{Figures/rate_vs_trh.tex}
		\else
		\includegraphics[width = \textwidth]{Figures/rate_vs_trh.tex}
		\fi
		\caption{Rate vs. refresh periodicity $T_{\rm PR}$, for different tracking procedures. $t_{\rm ref} =0.01$ s (only for Scheme B) and $T_{H} = 0.1$ s. } 
			\label{fig:rate_vs_trh}
	\end{subfigure}
	\caption{Comparison between tracking Scheme A (PR) and Scheme B (PRaR), in terms of average experienced data rate. $k_{\rm ref=}2$.}

	\label{fig:rate_vs_t} 
\end{figure*}



As an example (referred to a specific Monte Carlo simulation),  in Fig. \ref{fig:rate_example} we plot the rate experienced by a test user, moving on a straight line  at  speed $v=20$ m/s (quite reasonably constant for a $T_{\rm sim}=10$ s simulation time frame), in order to intuitively
compare the tracking performance, in terms of data rate, of a PR or a PRaR scheme (leaving any energy consumption consideration to the next section).
 The mmWave channel matrix \textbf{H} is assumed to be updated every $T_{H}=0.2$ s, and refreshes and refinements are triggered every $T_{\rm PR}=1$ s and $t_{\rm ref}=0.1$ s, respectively.
In general, alternating multiple refinement operations to less frequent refreshes is vital to achieve more stable and robust throughput values (as the gap between the red and the blue curves in Fig. \ref{fig:rate_example} suggests).
For instance, it can be seen that, at time $t=8^-$, the user's rate has strongly degraded when considering a pure PR tracking scheme, while periodic refinements can help the mobile terminal realign with its serving eNB.
Nevertheless, at time $t=8$, a new refresh event occurs and the transceiver is finally able to  perform either a  beam switch or a handover, regardless of the employed tracking scheme, thus recovering the maximum achievable transmission rate.
We notice that wide rate collapses (e.g., at time $t=8.4$ or $t=8.6$) mainly refer to pathloss state changes (i.e., from LoS to NLoS, caused by the update of the large scale fading parameters of the mmWave channel), while the rapid fluctuations of the rate are due to adaptations of the small scale fading parameters of \textbf{H}  (and mainly to the Doppler effect experienced by the moving user).
Of course, frequent refresh operations or stable channels make  Scheme B less attractive, as we will see in Section \ref{sec:results}.





\section{Results}
\label{sec:results}
In this section, we present some results that have been derived from the simulation framework described in Section 	\ref{sec:sim_setup}, aiming at comparing the two tracking procedures introduced in Section \ref{sec:procedures},  in terms of both data rate and energy consumption at the mobile terminal. 
Various configuration parameters will be tested, e.g., refinement and refresh periodicity ($t_{\rm ref}$, $T_{\rm PR}$), channel variability ($T_H$), BF architecture (ABF, DBF), refinement factor ($k_{\rm ref}$), in order to discuss the circumstances and the scenarios in which one scheme is preferable to the other.

\subsection{Rate vs. Refinement Periodicity}
\label{sec:rate_vs_tref}

In Fig. \ref{fig:rate_vs_tref}, we plot the average rate\footnote{\label{footnoteSameRate}Notice that the rate referred to Scheme A does not vary with $t_{\rm ref}$, since tracking only relies on periodic refresh events.}  received by the user when either the tracking  Scheme A or the tracking Scheme B (for different refinement periodicity values) is applied.

We first notice that the PRaR configuration outperforms  PR. 
In fact, alternating periodic refinements between consecutive refresh events allows the steering directions of each  UE-mmWave eNB pair to be monitored and  updated more frequently, to counteract any misalignment  that might arise when moving.
Of course, the rate decreases for increasing values of $t_{\rm ref}$, due to the reduced number of refinement actions performed during each simulation.
%since the number of  is reduced, resulting in a less aggressive tracking operation.
It can also be observed that the performance gap between Schemes A and B reduces as $t_{\rm ref}$ increases, since the number of refinement events carried out between two consecutive refresh events proportionally reduces, thus gradually leveling the advantages that would be gained if a Scheme B tracking configuration were applied.
It must finally be highlighted that sparser refinement operations can still provide satisfactory throughput gains if sparse networks or flat channels are considered. On the other hand, as  will be clearer in Section  \ref{sec:rate_vs_H}, a larger number of refinement operations should be preferred when dealing with more unstable mmWave environments.



\subsection{Rate vs. Refresh Periodicity}

Fig. \ref{fig:rate_vs_trh} shows how the rate varies for different refresh periodicity values, when the user employs either a tracking configuration in which no refinement events are performed (Scheme A) or  a tracking configuration which includes periodical beam adaptation operations within refreshes (Scheme~B).

When $T_{\rm PR}$ increases, the average rate decreases, since the user is
monitored less frequently. 
This means that, when a channel impairment occurs, the communication quality is not immediately
recovered and the throughput is affected by portions of time where suboptimal network settings
are chosen~\cite{giordani2016uplink}.
In general, Scheme B outperforms Scheme A since refinement operations make it possible to react to any possible UE-mmWave eNB misalignment condition. If the tracking procedure of Scheme A were employed, this adapatation could only occur at the subsequent refresh event.
Nevertheless, the rate drops when $T_{\rm PR}>T_{H}$ (here fixed to $0.1$ s), even when a PRaR procedure is considered. 
This is due to the fact that, when refreshes become sparser, the major problem does not reside in a misalignment between the user and its serving infrastructure (which could be easily solved through a refinement operation), but might rather be due to a pathloss modification (i.e., an obstacle obstructing the propagation path) or to an adaptation of the channel parameters (i.e., a large-scale fading update). This issue can only be managed through a complete refresh event (possibly followed by a handover operation).
However, the gap between the tracking schemes grows as $T_{\rm PR}$ increases since, when refreshes are sporadic, refinements may be vital to guarantee more stable~rates.




\subsection{Rate vs. Channel Variability}
\label{sec:rate_vs_H}




In Fig. \ref{fig:rate_vs_th}, the performance of Schemes A  and B in terms of rate are compared for different values of $t_{\rm ref}$ and $T_H$.

We first observe that, when $T_H$ increases, the average rate also increases since the
channel varies less rapidly, so the rate can assume more stable values even if the mmWave eNB-UE
beam pair is updated less frequently. 
In fact, although a change in the \textbf{H} matrix's large scale fading
parameters represents the strongest cause for the user's rate slump, if we consider flat and stable channels we can accept more rare handover and beam
switch events and still provide a sufficiently good communication quality \cite{giordani2016uplink}.
Moreover, it is clear that the implementation of a PRaR procedure is able to guarantee higher rates, for any value of $T_H$, thanks to the more aggressive tracking  provided by the periodical refinement events.
Furthermore, the impact of the refinements becomes more pronounced for more sensitive and unstable channels, as can be seen from the increasing gap between Schemes A and B for decreasing values of $T_H$.
This is caused by the ever-growing need for beam adaptation operations as the channel becomes more variable in time (or as considering more dense mmWave environments).
Finally, it must be said that only configurations in which ${t_{\rm ref} > T_{H} }$ are worth investigating, as otherwise the rate would be almost constant for all values of $T_H$
(since the beam pair would be updated before the channel  changes its large scale fading
parameters).

\begin{figure}[t!]
\centering
		\setlength{\belowcaptionskip}{0cm}
		\iftikz
		\setlength{\belowcaptionskip}{0cm}
		\setlength\fwidth{0.78\columnwidth}
		\setlength\fheight{0.43\columnwidth}
		\input{Figures/rate_vs_th.tex}
		\else
		\includegraphics[width = \textwidth]{Figures/rate_vs_th.tex}
		\fi
		\caption{Rate vs. channel update periodicity $T_H$, for different tracking procedures and for different values of the refinement periodicity $t_{\rm ref}$ (only for Scheme B). $T_{\rm PR} = 0.3$ s, $k_{\rm ref}=2$. }
		\vspace{-1.2em}
			\label{fig:rate_vs_th}
	\end{figure}



\subsection{Energy Consumption}





In this section we compute the energy $E_C$ consumed at the user's side to perform either a Scheme A or a Scheme B tracking operation during a simulation of $T_{\rm sim}=10$ s, for different values of $T_{\rm PR}$ and considering either an analog or a digital beamforming architecture.

According to Section \ref{sec:EC}, for Scheme A, $N_{\rm refresh}=\lfloor{T_{\rm sim}/T_{\rm PR}}\rfloor$ refresh events are performed during $T_{\rm sim}$, therefore  $E_C$ can be evaluated as:
\beq
E_{C_{\rm A}} = E_{C_{\rm refresh}}\cdot N_{\rm refresh} \overset{\mathrm{Eq. \eqref{eq:EC}}} {=} P_C \cdot\tfrac{ T_{\rm PR}}{L} \cdot N_{\rm refresh}.
\eeq
For Scheme B, $N_{\rm ref}=\lfloor{T_{\rm PR}/t_{\rm ref}}\rfloor$ refinement events are performed between two consecutive refresh operations, therefore  $E_C$ can be evaluated as:

\begin{align}
 E_{C_{\rm B}} &= \Big(E_{C_{\rm refresh}}\cdot N_{\rm refresh}\Big) + \Big(E_{C_{\rm ref}}\cdot N_{\rm ref} \cdot N_{\rm refresh}\Big)\notag = \\
&  \overset{\mathrm{Eq. \eqref{eq:EC}}} {=} P_C\cdot  N_{\rm refresh} \cdot \Big( \tfrac{T_{\rm PR}}{L} + \tfrac{t_{\rm ref}}{L}\cdot N_{\rm ref} \Big).
\end{align}
The value of $P_C$, whose expression can be found in Eqs. \eqref{eq:ABF} and \eqref{eq:DBF}, depends on the implemented BF architecture.


\begin{figure}[t!]
\centering
		\setlength{\belowcaptionskip}{0cm}
		\iftikz
		\setlength{\belowcaptionskip}{0cm}
		\setlength\fwidth{0.78\columnwidth}
		\setlength\fheight{0.43\columnwidth}
		\input{Figures/EC_ADBF.tex}
		\else
		\includegraphics[width = \textwidth]{Figures/rate_vs_th.tex}
		\fi
		\caption{Energy consumed for tracking, during a simulation of duration $T_{\rm sim}=10$ s, vs. refresh periodicity $T_{\rm RH}$, for different beamforming architecture (ABF or DBF). $t_{\rm ref} = 0.01$ s, $k_{\rm ref=}2$. Narrow bars refer to Scheme A (PR).}
		\vspace{-1.2em}
		\label{fig:EC_vs_ADBF}
	\end{figure}

It can be seen in Fig. \ref{fig:EC_vs_ADBF} that the DBF scheme is the most consuming in terms of energy, despite the fact that fewer directions need to be investigated during each refresh or refinement. 
Such commonly accepted conclusion that DBF suffers from high energy consumption is the result of implicitly assuming the use, at the user's side, of high resolution and wide band ADCs (usually considered the most power-hungry blocks), that therefore dominate the overall energy budget \cite{Waqas_EW2016}\footnote{As reported in Eq. \eqref{eq:DBF}, a digital configuration requires, at the user's side, a number of ADC blocks equal to twice the number of receiving antenna elements, making such configuration typically more power consuming than its analog counterpart in which just 2 ADCs are employed \cite{Waqas_EW2016}.}.
 On the other hand, DBF allows for faster and potentially more frequent tracking operations. Anyway, $E_C$ reduces as $T_{\rm PR}$ increases, since fewer refresh events are triggered within the same time window.
As expected, Scheme A always consumes less energy than its counterpart due to the absence of any refinement.
Moreover, the gap between the two configurations increases as $T_{\rm PR}$ increases, since more energy-consuming refinements are performed within two consecutive refreshes (keeping the same value of $t_{\rm ref}$). 
Interestingly, such gap is more remarkable when considering a DBF architecture, making it clear that, when employing a Scheme B tracking process, an analog approach should be preferred for~refinements. 


 

Finally, we observe how sometimes a Scheme B  procedure might still be an attractive option to perform tracking operations even in terms of energy consumption. 
For instance, from Figs. \ref{fig:rate_vs_trh} and \ref{fig:EC_vs_ADBF}, we observe that a rate of around $0.8$ Gbps can be achieved either through a Scheme A solution (with $T_{\rm PR} = 0.15$ s), which would consume $E_{C_A}\simeq 1.5$ J if an ABF architecture were applied, or through a Scheme B solution  (with $T_{\rm PR }= 0.3$ s), which would consume $E_{C_B}\simeq 2.359$ J, making the two options more coherent, in terms of energy consumption, than if a Scheme B approach (with $T_{\rm PR}=0.15$~s, as employed by Scheme A) were preferred. 
 We recall that the advantages of the PRaR scheme are  more remarkable when more unstable channels are~considered.

\subsection{$E_C$ and Rate vs. Refinement Factor}


	
	
As a last result, in Fig. \ref{fig:EC_vs_k} we investigate how the experienced rate and the energy consumption vary when varying the refinement factor $k_{\rm ref}$, that is the number of directions (adjacent to the current optimal one) that are scanned during a Scheme B refinement operation. 

According to Eqs. \eqref{eq:EC} and \eqref{eq:t_ref}, which link the value of $E_C$ to that of $k_{\rm ref}$, it is cleat that the energy consumed by the refining operations dramatically increases as $k_{\rm ref}$ increases, due to the increasing number of directions that need to be swept every time a refinement is triggered. 
Conversely, the gain (in terms of rate) arising from a more exhaustive refining procedure is limited and almost saturates as $k_{\rm ref}>8$. 
Therefore, as we already pointed out in our previous contribution \cite{Giordani_magazineIA_2016}, even though a refining procedure is vital to address the situation in which the direct path connecting the UE and the eNB does not correspond to good channel conditions or is obstructed,  increasing the number of scanning directions too much leads to a  considerable
increase of the energy consumption, while providing a limited
rate increase.

We finally observe that, since the Scheme A approach does not depend on $k_{\rm ref}$, the rate is constant at $R = 0.738$ Gbps (when $T_{\rm PR}=0.3$ s and $T_H=0.1$ s), and thus performs worse than any of the presented configurations in which a PRaR tracking scheme is employed.

\begin{figure}[t!]
\centering
		\setlength{\belowcaptionskip}{0cm}
		\iftikz
		\setlength{\belowcaptionskip}{0cm}
		\setlength\fwidth{0.78\columnwidth}
		\setlength\fheight{0.45\columnwidth}
		\input{Figures/EC_rate_v2.tex}
		\else
		\includegraphics[width = \textwidth]{Figures/rate_vs_th.tex}
		\fi
		\caption{Energy consumed for a single refinement operation vs. rate, for different values of $k_{\rm ref}$. $t_{\rm ref} = 0.05$ s, $T_{\rm PR}=0.3$ s, $T_H=0.1$ s. }
		\vspace{-1.2em}
			\label{fig:EC_vs_k}
	\end{figure}


\subsection{Final Comments}
To sum up, a trade-off between achievable data rate and energy consumption at the mobile terminal must be considered.
In certain situations, a tracking procedure in which both refinement and refresh operations are performed (Scheme B, PRaR) is able to provide some throughput gains, though at the cost of an increased energy consumption with respect to an implementation in which only refreshes are triggered (Scheme~A, PR).
We can conclude that a Scheme B approach might be a valid option (although being more energy-consuming):
\begin{itemize}
\item when the refresh events are deliberately kept sporadic, to reduce the system overhead and maintain low-latency, high-rate cellular services;
\item when considering  very dense mmWave environments, affected by highly unstable channels, for which refresh events are not sufficient, by themselves, to monitor the user with sufficiently good quality of service;
\item when considering very fast scenarios (e.g., vehicular environments), 
for which refinement operations guarantee continuous alignment between the endpoints, to support the massive demand for high (and stable) data rates expected by the next-generation automotive systems;
%\cite{MOCAST_2017};
\item when considering real-time applications (e.g., video streaming, online gaming, safety  services), which require a
long-term flat/steady channel to support a
consistent quality of experience for the users. As can be seen from Fig. \ref{fig:rate_example}, refinements help guarantee a more stable data rate and avoid undesired throughput~fluctuations.\end{itemize}

Finally, we highlighted how an analog beamforming configuration should be preferred when performing refining operations, while a digital architecture can still be implemented for refresh events,  for the purpose of reducing the exhaustive beam  sweep duration and increasing the refresh frequency over~time.



\section{Conclusion}
\label{sec:conclusion}

One of the major concerns for the feasibility of efficient mmWave cellular networks is the rapid channel dynamics that affect the propagation quality. 
This paper has attempted to develop some fundamental understanding in the context of one crucial problem -- namely, the tracking of a moving user over time. We have considered a realistic measurement-based mmWave channel model, together with an empirical mobility model, to test and compare the performance, in terms of experienced data rate and energy consumption, of two tracking schemes (one of which alternates periodic refinements of the optimal steering direction to sparser refresh events).
Our high level finding is that our proposed tracking technique is particularly attractive when considering severely variable mmWave channels.

Further work is still needed. In particular, due to the lack of temporally correlated mmWave
channel measurements, it is currently not possible to develop an accurate analytical model for
mobility-related scenarios, which on the other hand remains a very interesting and relevant item
for future research.


\bibliographystyle{IEEEtran}
\bibliography{biblio}

\end{document} 