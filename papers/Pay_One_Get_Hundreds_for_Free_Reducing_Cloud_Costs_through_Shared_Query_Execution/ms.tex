\documentclass[sigconf,natbib=false,screen]{acmart}

\pdfoutput=1

\usepackage{booktabs} % For formal tables


% Copyright
%\setcopyright{none}
%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}

%%%% for arvix %%%%%
\settopmatter{printacmref=false}
% \renewcommand\footnotetextcopyrightpermission[1]{} % removes footnote with conference information in first column
\pagestyle{plain}
\pagenumbering{gobble}
%%%%%%%%%%%%%%%%%%%%

\copyrightyear{2018} 
\acmYear{2018} 
\setcopyright{iw3c2w3}
%%%%%\setcopyright{acmcopyright}
\acmConference[SoCC '18]{SoCC '18: ACM Symposium on Cloud Computing    }{October 11--13, 2018}{Carlsbad, CA, USA}
\acmBooktitle{SoCC '18: ACM Symposium on Cloud Computing     (SoCC '18), October 11--13, 2018, Carlsbad, CA, USA}
\acmPrice{15.00}
\acmDOI{10.1145/3267809.3267822}
\acmISBN{978-1-4503-6011-1/18/10}

% These commands are optional
%\acmBooktitle{Transactions of the ACM Woodstock conference}
%\editor{Jennifer B. Sartor}
%\editor{Theo D'Hondt}
%\editor{Wolfgang De Meuter}

\usepackage{graphicx}
\usepackage{balance}  % for  \balance command ON LAST PAGE  (only there!)

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc} % for making umlauts and accents
\usepackage[american]{babel}
%\usepackage{csquotes}

\usepackage{todonotes}
\usepackage{hyperref}
\usepackage{listings}
%\usepackage{pxfonts}
\usepackage{float}
\usepackage{stfloats}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{xspace}
\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{mathtools}
\usepackage[binary-units]{siunitx}
\usepackage{amssymb}
\usepackage{pifont}
\usepackage{balance}

\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%

\newcommand{\ra}[1]{\renewcommand{\arraystretch}{#1}}
\newcommand{\specialcell}[2][c]{\begin{tabular}[#1]{@{}l@{}}#2\end{tabular}}

\PassOptionsToPackage{
    sortcites,
    maxcitenames=2,
    maxbibnames=8,
  }{biblatex}
\usepackage{biblatex}
\bibliography{biblio}

\renewcommand*{\bibfont}{\small}

% Define ETH colors
\usepackage{xcolor}
\definecolor{ETHa}{RGB}{31,64,122}      % ETH1 (dark blue)
\definecolor{ETHb}{RGB}{72,90,44}       % ETH2 (dark green)
\definecolor{ETHc}{RGB}{18,105,176}     % ETH3 (light blue)
\definecolor{ETHd}{RGB}{114,121,28}     % ETH4 (light green)
\definecolor{ETHe}{RGB}{145,5,106}      % ETH5 (dark pink)
\definecolor{ETHf}{RGB}{111,111,100}    % ETH6 (gray)
\definecolor{ETHg}{RGB}{168,50,45}      % ETH7 (dark red)
\definecolor{ETHh}{RGB}{0,122,150}      % ETH8 (turquoise)
\definecolor{ETHi}{RGB}{149,96,19}      % ETH9 (brown)

% Setup hyperref
\PassOptionsToPackage{pdfpagelabels=false}{hyperref}
\usepackage{hyperref}

\newcommand{\bigquery}{{\it Google Big Query}\xspace}
\newcommand{\athena}{{\it Amazon Athena}\xspace}
\newcommand{\sssl}{{\it Amazon Simple Storage Service}\xspace}
\newcommand{\sss}{{\it Amazon S3}\xspace}
\newcommand{\qaas}{{\it QaaS}\xspace}
\newcommand{\qaasl}{query-as-a-service\xspace}
\newcommand{\Qaasl}{Query-as-a-service\xspace}
\newcommand{\sql}{SQL\xspace}
\newcommand{\gsc}{Google Cloud Storage\xspace}
\newcommand{\qid}{{\texttt{query\_id}}\xspace}
\newcommand{\qset}{\texttt{query\_set}\xspace}

% Nice long variable names in math mode (copied from http://tex.stackexchange.com/a/196529)
\makeatletter
\DeclareRobustCommand{\varname}[1]{\begingroup\newmcodes@\mathit{#1}\endgroup}

\definecolor{darkgreen}{rgb}{0.18,0.54,0.34}
\definecolor{codegreen}{rgb}{0,0.6,0}

\lstdefinelanguage{SSQL}[]{SQL}{%
    deletekeywords={count, sum},
    morekeywords={OR, WITH, AND, ELSE, LIKE, GROUP, PARTITION, OVER, UNNEST, TOP},
    morekeywords=[2]{COUNT, SUM, CARDINALITY, ARRAY_REMOVE, ARRAY_INTERSECT, ARRAY,
                     MULTISET, BIGINT, TINYINT},
    morekeywords=[3]{query_set, query_id},
}

\lstset{literate=%
   *{0}{{{\color{red!50!brown}0}}}1
    {1}{{{\color{red!50!brown}1}}}1
    {2}{{{\color{red!50!brown}2}}}1
    {3}{{{\color{red!50!brown}3}}}1
    {4}{{{\color{red!50!brown}4}}}1
    {5}{{{\color{red!50!brown}5}}}1
    {6}{{{\color{red!50!brown}6}}}1
    {7}{{{\color{red!50!brown}7}}}1
    {8}{{{\color{red!50!brown}8}}}1
    {9}{{{\color{red!50!brown}9}}}1,
    belowcaptionskip=-0.5em,
    belowskip=-0.5em,
}

\lstdefinestyle{sql} {
    language=SSQL,
    basicstyle=\ttfamily,
    keywordstyle=\color{blue},
    keywordstyle=[2]\color{orange!50!black},
    keywordstyle=[3]\it,
    commentstyle=\color{codegreen},
    stringstyle=\color{red!50!brown},
    columns=fullflexible,
    keepspaces=true,
    float=tbp,
}

\lstdefinestyle{ssql}{
    style=sql,
    basicstyle=\ttfamily\small,
}

\settopmatter{authorsperrow=4}

\begin{document}
\title{Pay One, Get Hundreds for Free: \\
       Reducing Cloud Costs through Shared Query Execution}
\subtitle{Preprint}

\author{Renato Marroquín$^*$}
\email{marenato@inf.ethz.ch}
\affiliation{}

\author{Ingo Müller$^*$}
\email{ingo.mueller@inf.ethz.ch}
\orcid{0000-0001-8818-8324}
\affiliation{}

\author{Darko Makreshanski$^\dagger$}
\email{darko.makreshanski@oracle.com}
\affiliation{\hspace*{-9.1cm}\begin{minipage}[t]{\textwidth}\hspace*{\fill}$^*$Systems Group, Dept. of Computer Science, ETH Zürich\hspace*{\fill}$^\dagger$Oracle Labs\hspace*{\fill}\end{minipage}}

\author{Gustavo Alonso$^*$}
\email{alonso@inf.ethz.ch}
\affiliation{}

% The default list of authors is too long for headers.
\renewcommand{\shortauthors}{R. Marroquín, I. Müller, D. Makreshanski, G. Alonso}

\hypersetup{%
    colorlinks=true,%
    urlcolor=ETHg,%
    linkcolor=ETHc,%
    citecolor=ETHd,%
    breaklinks=true,%
    pageanchor=true,%
}

\begin{abstract}

    Cloud-based data analysis is nowadays common practice because of the lower
    system management overhead as well as the pay-as-you-go pricing model. The
    pricing model, however, is not always suitable for query processing as heavy
    use results in high costs. For example, in query-as-a-service systems, where
    users are charged per processed byte, collections of queries accessing the
    same data frequently can become expensive. The problem is compounded by the
    limited options for the user to optimize query execution when using
    declarative interfaces such as SQL.  In this paper, we show how,
    without modifying existing systems and without the involvement of the cloud
    provider, it is possible to significantly reduce the overhead, and hence the
    cost, of query-as-a-service systems. Our approach is based on query
    rewriting so that multiple concurrent queries are combined into a single
    query. Our experiments show the aggregated amount of work done by the shared
    execution is smaller than in a query-at-a-time approach. Since queries are
    charged per byte processed, the cost of executing a group of queries is
    often the same as executing a single one of them. As an example, we
    demonstrate how the shared execution of the TPC-H benchmark is up to 100x
    and 16x cheaper in \athena and bigquery than using a query-at-a-time
    approach while achieving a higher throughput.

    %At the same time, we achieve a throughput improvement of an order of
    %magnitude for both systems.  

\end{abstract}

%
% The code below should be generated by the tool at
% http://dl.acm.org/ccs.cfm
% Please copy and paste the code instead of the example below.
%
\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10002951.10002952.10003190.10003192.10003398</concept_id>
<concept_desc>Information systems~Query operators</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10002951.10002952.10003197.10010822.10010823</concept_id>
<concept_desc>Information systems~Structured Query Language</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10002951.10003227.10003241.10010843</concept_id>
<concept_desc>Information systems~Online analytical processing</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10002951.10002952.10003190.10003195.10010838</concept_id>
<concept_desc>Information systems~Relational parallel and distributed DBMSs</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10002951.10002952.10003212.10003214</concept_id>
<concept_desc>Information systems~Database performance evaluation</concept_desc>
<concept_significance>300</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Information systems~Query operators}
\ccsdesc[500]{Information systems~Structured Query Language}
\ccsdesc[500]{Information systems~Online analytical processing}
\ccsdesc[300]{Information systems~Relational parallel and distributed DBMSs}
\ccsdesc[300]{Information systems~Database performance evaluation}


\keywords{Data Warehouse, Shared Workload Execution, Query Processing, Cloud
    Computing, Serverless}


\maketitle

\input{introduction}
\input{relwork}
\input{mqe}
\input{rewriting}
\input{experiments_new}
\input{conclusions}

\balance
\printbibliography

\end{document}
