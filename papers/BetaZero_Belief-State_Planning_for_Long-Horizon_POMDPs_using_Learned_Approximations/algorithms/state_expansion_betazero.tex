\begin{algorithm}[H]
    \small
    \caption{BetaZero belief-state progressive widening.}
    \label{alg:betazero-state-pw}
    \begin{algorithmic}[1]
        \Function{BeliefStateExpansion$(b,a)$}{}
            \If {$|B(b,a)| \le kN(b,a)^\alpha$} \GrayComment{belief progressive widening} % \textbf{or} $B(b,a) = \emptyset$}
                \State $s \sim b(\cdot)$
                \State $s' \sim T(\cdot \mid s, a)$
                \State $o \sim O(\cdot \mid a, s')$
                \hspace*{4em}%
                \rlap{\raisebox{\dimexpr.5\normalbaselineskip+.5\jot}{\smash{$\left.\begin{array}{@{}c@{}}\\{}\\{}\\{}\end{array}\color{commentgray}\right\}%
                \color{commentgray}\begin{tabular}{l}$b' \sim T_b(\cdot \mid s, a)$\\from \cref{eq:tb_update}\end{tabular}$}}}
                \State $b' \leftarrow \textsc{Update}(b,a,o)$
                \State $B(b,a) \leftarrow B(b,a) \cup \{b'\}$ \GrayComment{add to visited beliefs}
            \Else
                \State $b' \sim B(b,a)$ \GrayComment{sample from belief-states in the tree}
            \EndIf
            \State $r \leftarrow R(b, a)$ or $r \leftarrow R(b, a, b')$
            \State \Return $b', r$
        \EndFunction
    \end{algorithmic}
\end{algorithm}