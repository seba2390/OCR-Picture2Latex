\def\CTeXPreproc{Created by ctex v0.2.9, don't edit!}
\documentclass[11pt]{article}
\usepackage{mathrsfs}
\newenvironment{proof}[1][Proof]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newcounter{example}
\newenvironment{example}[1][]{\refstepcounter{example}\par\medskip\noindent%
   \textbf{Example~\theexample. #1} \rmfamily}{\medskip}
\newtheorem{thm}{Theorem}[section]
\newtheorem{cor}{Corollary}
\newtheorem{lem}{Lemma}[section]
\newtheorem{rem}{Remark}
\newtheorem{prop}{Proposition}
\usepackage{latexsym}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{multirow}
\usepackage{enumerate}
\usepackage{cancel}
\usepackage{hyperref}
\usepackage{caption}  %use \captionof{figure / table}{caption1}x
\usepackage[usenames,dvipsnames]{color}
\usepackage[left, pagewise]{lineno}
\usepackage[ruled,vlined]{algorithm2e}
\usepackage{epstopdf}
\graphicspath{{./Figures/}{./Figures2/}}
%%BoundingBox:0 0 width height
\DeclareGraphicsRule{.jpg}{.eps}{.bb}{.png}{}
 \textheight 9.2in
\textwidth 6.4in \topmargin -15mm \oddsidemargin -3mm
\evensidemargin -3mm
\parskip 2mm
\setcounter{page}{1} \setlength\arraycolsep{2pt}
\renewcommand{\baselinestretch}{1.2}
\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\theequation}{\thesection.\arabic{equation}}
\renewcommand{\textfraction}{0.15}
\renewcommand{\topfraction}{0.85}
\renewcommand{\bottomfraction}{0.65}
\renewcommand{\floatpagefraction}{0.60}
\newcommand{\ud}{\mathrm{d}}
\newcommand\Tld{\widetilde}
\newcommand\Pat{\partial}
\newcommand\red{\textcolor{red}}
\newcommand\blue{\textcolor{blue}}
\newcommand{\mbr}{\mathbb{R}}
\newcommand{\bP}{{\bf P}}
\newcommand{\bF}{{\bf F}}
\newcommand{\bJ}{{\bf J}}

\DeclareMathOperator{\sech}{sech}
%\renewcommand{\arraystretch}{2}
\title{Structure-Preserving Galerkin POD-DEIM Reduced-Order Modeling of Hamiltonian Systems}
\author{Zhu Wang \thanks{ Corresponding author.
           Department of Mathematics, University of South Carolina, Columbia, SC 29208.
           Email: {wangzhu@math.sc.edu}. }
}
\date{}
\begin{document}
\maketitle
\begin{abstract}
A structure preserving proper orthogonal decomposition reduce-order modeling approach has been developed in \cite{gong2017structure} for the Hamiltonian system, which uses the traditional framework of Galerkin projection-based model reduction but modifies the reduced order model so that the appropriate Hamiltonian structure is preserved. However, its computational complexity for online simulations is still high if the Hamiltonian involves non-polynomial nonlinearities. In this paper, we apply the discrete empirical interpolation method to improve the online efficiency of the structure-preserving reduced order simulations. Since the reduced basis truncation can degrade the Hamiltonian approximation, we propose to use the basis vectors obtained from shifted snapshots. 
A nonlinear wave equation is used as a test bed and the numerical results illustrate the efficacy of the proposed method. 
% keeps appropriate structural properties.
% keeps the appropriate skew-symmetric structure of the coefficient matrix, thus keeps the energy a constant.
%Two ways are further proposed to improve the energy approximation: one introduces a new basis, the other uses the POD basis from shifted snapshots.
%Overall, the second approach outperforms the other ROMs.
%We further derive a rigorous {\em a priori} error estimate of the structure-preserving ROM and demonstrate its effectiveness in several numerical examples.
%This approach can be readily extended to dissipative Hamiltonian systems, port-Hamiltonian systems etc.
\end{abstract}

{\bf Keywords.}~Proper orthogonal decomposition; Discrete empirical interpolation method; model reduction; Hamiltonian systems; structure-preserving algorithms.

 {\bf AMS subject classifications.} 37M25, 65M99, 65P10, 93A15

\input{notation_old}
%============================================================
\section{Introduction}
%============================================================
\noindent \indent There are broad applications of Hamiltonian systems in engineering and scientific research.  For real-world problems, using numerical methods to simulate such systems often requires long-time integrations of large-scale discrete systems. Because the numerical error accumulates over time, preserving intrinsic properties of the systems has been a key criterion for developing stable numerical schemes.
So far, geometric integrators or structure-preserving algorithms have been introduced to exactly preserve structural properties of Hamiltonian systems. For instance, symplectic algorithms proposed in \cite{Hairer02,Feng03} has achieved a remarkable success in dealing with Hamiltonian ordinary differential equations (ODEs). They have been extended to Hamiltonian partial differential equations (PDEs) and preserve the multi-symplectic conservation law \cite{Bridges06,Wang2013}.
In recent years, there has been an increasing emphasis on constructing numerical methods to
preserve certain invariant quantities such as the total energy of dynamical systems.
Several discrete gradient methods have been proposed in the literature 
\cite{Gonzalez96,McLachlan99,Quispel08,Celledoni2012,Gong2014}. 


%Among them, the averaged vector field (AVF) method was proposed in \cite{Quispel08} for
%canonical Hamiltonian systems, in which accurate computation of
%integrals are required.
%The method is extended in \cite{Hairer10,Cohen11} to arbitrarily high order and non-canonical Hamiltonian
%systems.
%Based on the AVF method, a systematic energy-preserving or energy dissipation
%method is developed in \cite{Celledoni2012}.
%The discrete variational derivative method is developed in \cite{Furihata1999} that
%inherits energy conservation or dissipation properties for a large class of PDEs.
%The method is further generalized in \cite{Matsuo2001,Furihata2011} to complex-valued nonlinear PDEs.
%The concept of the discrete variational derivative and a general framework for deriving integral-preserving numerical
%methods for PDEs were proposed in \cite{Dahlby2011}.
%A class of new structure-preserving methods for multi-symplectic Hamiltonian PDEs was designed in \cite{Gong2014}.

To accelerate the long-time, large-scale numerical simulations of the Hamiltonian systems, reduced-order modeling has been considered. 
One such model reduction technique is the proper orthogonal decomposition (POD) method, which has been successfully applied to many time-dependent, nonlinear PDEs (\cite{bui2007goal,carlberg2011low,chaturantabut2010nonlinear,daescu2008dual,HLB96,iollo2000stability,KV01,sirisup2004spectral,lassila2014model}).
The POD method extracts orthogonal basis vectors from snapshot data, and use them to span the trial space. 
Based on different choices of test space, either Galerkin or Petrov-Galerkin projection can be used to build a reduced order model (ROM). Such a ROM is low-dimensional, but it does not possess the Hamiltonian structure. 
This issue has been recently recognized and structure-preserving ROMs (SP-ROMs) have been developed to resolve it. 
For instance, structure-preserving Petrov-Galerkin reduced models were introduced in \cite{beattie2011structure,chaturantabut2016structure} for port-Hamiltonian systems, in which the POD-based and $\mathcal{H}_2$-based projection subspaces were considered. 
A proper symplectic decomposition approach using the symplectic Galerkin projection was proposed in \cite{peng2016symplectic} for Hamiltonian PDEs with a symplectic structure. 
A structure-preserving POD-ROM was introduced in \cite{gong2017structure}, where the Galerkin projection-based ROM was modified so that appropriate Hamiltonian structure can be well kept. The approach has been applied to nonlinear Schr\"{o}dinger equation and shallow water equations in \cite{karasozen2018energy,karasozen2021structure,sockwell2019mass}. 
Meanwhile, when non-polynomial nonlinearities appear in SP-ROMs, their computational costs still depend on the number of spatial degrees of freedom in the full-order model. 
Thus, a hyper-reduction method such as the discrete empirical interpolation method (DEIM) \cite{chaturantabut2012state} has been employed as a remedy. 
It was combined with the Kronecker product in \cite{miyatake2019structure} to effectively reduce the complexity for evaluating the variable skew-symmetric coefficient matrix. In \cite{chaturantabut2016structure,karasozen2018energy}, two different ways for applying DEIM to the gradient of Hamiltonian functions were proposed, respectively. 
It is worth mentioning that other types of model reduction techniques such as reduced basis method have been introduced for Hamiltonian systems as well \cite{afkham2017structure,afkham2019structure,hesthaven2020rank,pagliantini2020dynamical}; and ROMs have been investigated for preserving different geometric properties such as the Lagrangian structures in \cite{carlberg2015preserving,farhat2015structure}.


In this paper, we consider the framework of the SP-ROM developed in \cite{gong2017structure} and extend it to the case in which the gradient of Hamiltonian involves non-polynomial nonlinearities. A structure-preserving POD-DEIM ROM is then proposed that possesses the appropriate Hamiltonian structure while reducing the online simulation cost. Due to the basis truncation, there may exist discrepancies in the Hamiltonian between the new ROM and the full-order model.
Therefore, we propose to use the POD basis and DEIM basis from shifted snapshots to improve the Hamiltonian approximation.

The rest of this paper is organized as follows.
In Section \ref{sec: alg}, we introduce the SP-ROMs for Hamiltonian systems including the SP-POD and SP-DEIM models;
The SP-ROMs are numerically investigated in Section \ref{sec: num};
A few concluding remarks are drawn in the last section.

%One usually uses the same numerical scheme in simulating the ROMs as the scheme for the FOM.
%When a Hamiltonian system is considered, a structure-preserving numerical method should be applied for the FOM simulation in order to be able to keep a desired physical quantity.
%When a ROM is generated by substituting the POD approximation of the state variable into the numerical scheme of the FOM, an intuitive thought is that the resulting ROM would be able to preserve the physical quantity exactly.
%However, this is not true because the Hamiltonian structure of the ROM will be destroyed.
%This has been seen in \cite{peng2016symplectic}, where the Hamiltonian PDEs with a symplectic structure are considered.
%============================================================
\section{Structure-Preserving Galerkin ROMs}\label{sec: alg}
%============================================================

\noindent \indent Consider a general Hamiltonian PDE system
\begin{equation}
\dot{\bu} = \mathcal{D}\, \frac{\delta \mathcal{H}}{\delta \bu},
\label{eq: ham_pde}
\end{equation}
where $\mathcal{D}$ is a differential operator and $\mathcal{H}(\bu)$ is the Hamiltonian, which often corresponds to the total energy of the system.
When $\mathcal{D}$ is a skew-adjoint operator with respect to the $L_2$ inner product, the PDE keeps $\mathcal{H}(\bu)$ invariant, which can be easily checked using the fact of  
$\int_{\Omega} \frac{\delta \mathcal{H}}{\delta \bu} \mathcal{D} \frac{\delta \mathcal{H}}{\delta \bu} dx = 0$. 
Note that when $\mathcal{D}$ is a constant negative semi-definite (or definite) operator with respect to the $L_2$ inner product, the system becomes dissipative and $\mathcal{H}(\bu)$, referred to as the Lyapunov function, would be non-increasing. In this paper, we are concerned with the former case, although the extension to the latter is natural. 


Since \eqref{eq: ham_pde} preserves the Hamiltonian when $\mathcal{D}$ is skew-adjoint, numerical methods for the PDE are expected to keep the same property at a discrete level. This has become a basic rule of thumb when designing a robust numerical scheme for the Hamiltonian PDE, especially for the purpose of long term simulations. Therefore, methods such as geometric integrators \cite{Hairer02,Feng03,Bridges06,Wang2013} or structure-preserving algorithms \cite{Quispel08,Hairer10,Cohen11,Celledoni2012,Dahlby2011,Gong2014} have been developed to preserve such structural properties. 
On the other hand, for large-scale numerical simulations, in order to reduce the computational complexity, structure-preserving reduced order modeling has been introduced. 
Next, we first briefly review the structure-preserving approach proposed in \cite{gong2017structure}, and then extend it to general nonlinear cases using the DEIM.


%\subsection{The proper orthogonal decomposition approximation}
%
%\noindent \indent The POD method extracts essential information from some snapshot data of a system, which is then used to form a global basis.
%The original state variable is then approximated in the space spanned by only a handful of dominant basis functions.
%
%
%Suppose the system is numerically discretized by using certain methods, in which the number of degrees of freedom (DOF) in space is $n$.
%Let $\by_i$ represent the numerical solution at time instance $t_i$.
%The snapshot data $\bY$ consists of numerical solutions at selected time instances $t_1, \ldots, t_m$, i.e., $\bY=[\by_1, \ldots, \by_m]\in \mathbb{R}^{n\times m}$.
%The POD method seeks an orthonormal basis $\{\bphi_1, \ldots, \bphi_r\}$ from the optimization problem
%\begin{equation*}
%\min_{Rank(\bPhi)= r} \sum_{j=1}^M
%  \Big\| \by_j - \bPhi \bPhi^\top \by_j \Big\|^2
%  \quad s. t. \quad
%  \bPhi^\top\bPhi= I_r,
% \label{eq:pod_h}
%\end{equation*}
%where $\bPhi= [\bphi_1, \ldots, \bphi_r]\in \mathbb{R}^{n\times r}$, $I_r$ is the $r\times r$ identity matrix, and
%$\|\cdot\|$ denotes the 2-norm in the Euclidean space throughout the paper.
%
%It is well-known that the POD basis vectors, $\bphi_1, \ldots, \bphi_r$, are the left singular vectors of $\bY$ corresponding to the first $r$ leading nonzero singular values $\sigma_1\geq \sigma_2\geq \ldots\geq \sigma_r>0$. When $\bY$ is low-and-fat ($n<<m$), the POD basis can be found by using the SVD algorithm. Conversely, if $\bY$ is tall-and-skinny ($n>>m$), the method of snapshots can be applied.
%When parallel computing is implemented in large-scale computing problems, one can use an approximate partitioned method of snapshots to further reduce the computational complexity and the communication volume for generating the POD basis \cite{Wang2015approximate}.
%
%\begin{prop}
%\label{pr:poderr_dis}
%Let $\bPhi$ be the $r$-dimensional POD basis, the rank of snapshot matrix $\bY$ be $d$ and $\sigma_1\geq \sigma_2\geq \ldots\geq \sigma_d>0$ be nonzero singular values of $\bY$.
%Then the POD projection error of the snapshot matrix satisfies (\cite{KV01,chaturantabut2012state})
%\begin{equation}
%\sum_{j=1}^M
%  \Big\| \by_j - \bPhi \bPhi^\top \by_j \Big\|^2
%  = \sum\limits_{j=r+1}^d \sigma_j^2.
% \label{eq:pod_herr}
%\end{equation}
%\end{prop}
%
%
%We shall also consider an ideal case, in which the entire continuous trajectory of the system is assumed to be available on the whole time interval $[0, T]$.
%%Thus there is no any errors on the POD approximation coming from either discretizations or the choice of snapshots.
%Taken the trajectory $\by(t)$ to be the snapshot, which is a continuous, vector-valued function in $\mathbb{R}^n$.
%The POD method is to find a set of optimal basis functions $\{\bphi_1, \ldots, \bphi_r\}$ by minimizing the projection error of $\by(t)$ onto the subspace spanned by the basis, i.e.,
%\begin{equation*}
%\min_{Rank(\bPhi)= r}\int_0^T
%  \Big\| \by(t) - \bPhi \bPhi^\top \by(t) \Big\|^2 \, d t
%  \quad s. t. \quad
%  \bPhi^\top\bPhi= I_r,
% \label{eq:pod}
%\end{equation*}
%where $\bPhi= [\bphi_1, \ldots, \bphi_r]\in \mathbb{R}^{n\times r}$ and $I_r$ is the identity matrix.
%The optimization solution is equivalent to find the first $r$ dominant eigenvectors of the snapshot covariant matrix ${\bf R}=\int_0^T \by(t)\by(t)^\top\, dt$.
%%Correspondingly, the error satisfies the following proposition.
%\begin{prop}
%\label{pr:poderr}
%%(\cite{KV01})
%Let $\bPhi$ be the $r$-dimensional POD basis, the rank of snapshot covariant matrix ${\bf R}$ be $d$ and $\lambda_1\geq \lambda_2\geq \ldots\geq \lambda_d>0$ be nonzero eigenvalues of ${\bf R}$.
%Then the POD projection error of the snapshot satisfies (\cite{KV01,chaturantabut2012state})
%\begin{equation}
%\int_0^T
%  \Big\| \by(t) - \bPhi \bPhi^\top \by(t) \Big\|^2 \, d t
%  = \sum\limits_{j=r+1}^d \lambda_j.
% \label{eq:poderr}
%\end{equation}
%\end{prop}

%============================================================
\subsection{The structure-preserving POD-ROM}\label{sec: sp-pod}
%============================================================
\noindent \indent Assume a suitable spatial discretization of (\ref{eq: ham_pde}) yields a finite $n$-dimensional Hamiltonian ODE system of the form  (e.g. see \cite{Celledoni2012}):
\begin{equation}
\dot{\bu} = \bD\, \nabla_{\bu} H(\bu)
\label{eq: ham_fom}
\end{equation}
with the initial condition $\bu(t_0)= \bu_0$ and appropriate boundary conditions, where the coefficient matrix $\bD\in \mathbb{R}^{n\times n}$ on the right-hand-side is skew symmetric. 
In our numerical experiments, we use the finite difference method for spatial discretization, in which $n$ frequently equals to the number of grid points; and $H: \mathbb{R}^n \rightarrow \mathbb{R}$ such that $H\Delta x$ provides a consistent approximation to the Hamiltonian $\mathcal{H}(\bu)$ associated to \eqref{eq: ham_pde}. 
Note that we slightly abuse the notation here: $\bu$ is used again to denote the discrete state variable in $\mathbb{R}^n$. 


Given the reduced basis matrix $\bPhi\in \mathbb{R}^{n\times r}$, the state variable $\bu$ can be approximated by $\bu_r(t) = \bPhi \ba(t)$, where $\ba(t)$ is the unknown, $r$-dimensional coefficient vector. The reduced basis vectors can be determined at an offline stage by different model reduction techniques such as the reduced basis methods, proper orthogonal decomposition (POD), dynamical mode decomposition, etc. Here, we choose the POD because it is relatively easy to use and has been applied to many practical engineering problems. 
A standard Galerkin projection-based reduced order model (G-ROM) reads: 
\begin{equation}
\dot{\ba} = \bPhi^\top\bD\, \nabla_{\bu} H(\bPhi \ba).
\label{eq: ham_rom1}
\end{equation}
It provides a low-dimensional surrogate to \eqref{eq: ham_fom} since one only solves $\ba(t)$ at the online stage and $\bu_r$ can be computed if needed once $\ba(t)$ is determined. However, this model does not provide a constant Hamiltonian approximation, which can be seen by checking the time derivate of $H_r(t) \equiv H(\bPhi \ba(t))$ as follows. 
\begin{eqnarray*}
\frac{d}{dt}H(\bPhi \ba)&=&[\nabla_\ba H(\bPhi \ba)]^\top \dot{\ba} \nonumber \\
				  &=&[\bPhi^\top \nabla_{\bu} H(\bPhi \ba)]^\top \bPhi^\top\bD\, \nabla_{\bu} H(\bPhi \ba) \nonumber \\
				  &=& \nabla_{\bu} H(\bPhi \ba)^\top \bPhi \bPhi^\top\bD\, \nabla_{\bu} H(\bPhi \ba),
\end{eqnarray*}
where we use the fact that
$
\nabla_{\ba} H(\bPhi \ba) = \bPhi^\top \nabla_{\bu} H(\bPhi \ba)
%\label{eq: ham_grad}
$.
%
Since $\bPhi$ is composed of the first $r$ left singular vectors of the snapshot matrix, $\bPhi\bPhi^\top\bD$ is not skew symmetric as $\bD$, hence, the time derivative of $H(\bPhi \ba)$ is not ensured to be zero.


The structure-preserving POD (SP-POD) reduced order model developed in \cite{gong2017structure} modifies the above approach such that the Hamiltonian is well preserved, which has the following form: 
\begin{equation}
\dot{{\ba}} = \bD_r\, \nabla_{\ba} H(\bPhi {\ba}),
\label{eq: ham_rom2}
\end{equation}
where 
$
\bD_r = \bPhi^\top \bD \bPhi 
%\label{eq: Sr}
$. 
For this reduced-order dynamical system, the time derivative of $H_r(t)$ is
\begin{equation}
	\begin{aligned}
	\frac{d}{dt}H(\bPhi  {\ba})&=[\nabla_{ {\ba}} H(\bPhi {\ba})]^\top \dot{ {\ba}} \nonumber \\
				  &=[\nabla_{ {\ba}} H(\bPhi  {\ba})]^\top \bD_r\, \nabla_{\ba} H(\bPhi  {\ba}) \nonumber \\
				  &= 0,\quad \text{ as $\bD_r$ is skew-symmetric.}
	\end{aligned}
\label{eq: dHdt}	
\end{equation}
Hence, this model possesses an invariant $H_r(t)$. With a structure-preserving time stepping, the discrete Hamiltonian $H_r \Delta x$ can be well preserved during long-term simulations.  


%============================================================
\subsection{The structure-preserving DEIM-ROM}\label{sec: sp_deim1}
%============================================================


Although \eqref{eq: ham_rom2} has a low dimension, its computational cost could still depend on the number of spatial degrees of freedom if $\bD= \bD(\bu)$ depends nonlinearly on $\bu$ or $\nabla_{\bu} H(\bu)$ includes non-polynomial nonlinearities. In either case, online simulations involve certain calculations to be performed at all the grid points. 
To overcome this issue, hyper-reduction methods such as the DEIM have been applied. 
For instance, DEIM is combined with tensor product and vectorization in \cite{miyatake2019structure} to effectively reduce the complexity for evaluating $\bD_r(\bu_r)$. 
We shall focus on the case in which $\nabla_{\bu} H(\bu)$ has non-polynomial nonlinearities in this work. 
For completeness of presentation, we next first present the DEIM algorithm, review existing DEIM Hamiltonian approximations, and then introduce a new approach.    

%\paragraph{The DEIM Algorithm.} 
In general, the DEIM employs the following ansatz on a nonlinear function $f(\bu(t))$:
\begin{equation}
f(\bu(t)) = \sum\limits_{j=1}^{s} \bpsi_j c_j(t),
\end{equation}
where $\bpsi_j$ is the $j$-th DEIM basis vectors generated from the nonlinear snapshots
$$[f(\bu(t_1)), f(\bu(t_2)), \ldots, f(\bu(t_m))].$$ 
%The method then selects certain spacial interpolation points and determines the coefficient $\bc(t)=[c_1(t), \ldots, c_{s}(t)]$.
%Similarly, consider the finite dimensional case and let the vector of nonlinear function value be ${\bF}(\bu)$.
The DEIM, as shown in Algorithm \ref{alg: DEIM}, selects a set of interpolation points $\wp := [\wp_1, \ldots, \wp_s]^{\intercal}$ in a greedy manner, in which $e_{\wp_i}$ be the $\wp_i$-th column of the identity matrix.

\begin{algorithm}\caption{DEIM}\label{alg: DEIM}
\SetKwInOut{Input}{input}\SetKwInOut{Output}{output}
\vspace{.3cm}
\Input{$\{\bpsi_{\ell}\}_{\ell=1}^{s} \subset \mbr^{s}$ linear independent}
\Output{$\wp = [\wp_1, \ldots, \wp_s]^{\intercal} \in \mbr^s$}
$[|\rho|,\, \wp_1] = \max\{|\bpsi_1|\}$\;
$\bPsi = [\bpsi_1], \bP = [{\bf e}_{\wp_1}], \wp = [\wp_1]$\;
\For{$\ell = 2$ \KwTo $s$}{
Solve $(\bP^{\intercal} \bPsi){\bf c} = \bP^{\intercal} \bpsi_{\ell}$ for $\bf c$ \;
${\bf r}=\bpsi_{\ell}- \bPsi {\bf c}$\;
$\left[ |\rho|, \wp_{\ell} \right] = \max\{|{\bf r}|\}$\;
$\bPsi \leftarrow [\bPsi \quad \bpsi_{\ell}], \bP\leftarrow [\bP\quad {\bf e}_{\wp_{\ell}}], \wp \leftarrow
\left[\begin{array}{c} \wp \\ \wp_{\ell}\end{array}\right]$\;
}
\end{algorithm}

The DEIM approximation of the nonlinear function is given by
\begin{equation}
f(\bu) \approx {\bf \Psi}(\bP^\intercal {\bf \Psi})^{-1} \bP^\intercal {f}(\bu),
\label{eq:deim}
\end{equation}
where $\bP = [e_{\wp_1}, \ldots, e_{\wp_s}]\in \mathbb{R}^{n\times s}$ and ${\bf \Psi} \in \mathbb{R}^{n\times s}$ is the DEIM basis matrix. Because the DEIM approximation only evaluate $f$ at $s$ points, it could greatly reduce the online computation. 
For a detailed description of the method, the read is referred to \cite{chaturantabut2010nonlinear}. 

%\paragraph{Existing DEIM Hamiltonian.} 
When the discrete Hamiltonian contains non-polynomial nonlinear functions of $\bu$, the gradient $\nabla_{\bu} H(\bu)$ usually includes non-polynomial nonlinearities as well. It makes the online computational complexity still depend on $n$, the number of degrees of freedom of the full-order model. To overcome this issue, a DEIM hamiltonian was proposed in \cite{chaturantabut2016structure}. 
It splits $H(\bu)$ into two parts: 
\begin{equation}
H(\bu) = \frac{1}{2} \bu^\intercal \bQ \bu + h(\bu).
\label{eq: ham}
\end{equation}
The first part is quadratic in $\bu$, where $\bQ\in \mathbb{R}^{n\times n}$ is constant and positive definite, which contributes the linear component of $\nabla_{\bu} H(\bu)$; the second one is the remainder, which is nonlinear and yields the nonlinearity of $\nabla_{\bu} H(\bu)$.  
It is natural to approximate $\nabla_{\bu} h(\bu)$ by a DEIM interpolation: 
$\nabla_{\bu} h(\bu(t)) \approx \bPsi (\bP^\intercal \bPsi)^{-1} \bP^\intercal\nabla_{\bu} h(\bu(t)) $. 
Denote the DEIM projection by $\mathbb{P} = \bPsi (\bP^\intercal \bPsi)^{-1} \bP^\intercal$, the DEIM Hamiltonian is defined in \cite{chaturantabut2016structure} by   
$$\widehat{H}(\bu) = \frac{1}{2} \bu^\intercal \bQ \bu + h(\mathbb{P}^\intercal \bu),
$$
whose gradient is 
$$\nabla_{\bu}\widehat{H}(\bu) = \bQ \bu + \mathbb{P} \nabla_{\bu} h(\mathbb{P}^\intercal \bu).
$$
Then it can be shown that $\widehat{H}_r(t)\equiv \widehat{H}(\bPhi \ba(t))$ is invariant. 
%$$\nabla_{\ba}\widehat{H}(\bPhi \ba) = \bPhi^\intercal Q \bPhi \ba + \bPhi^\intercal \mathbb{P} \nabla_{\bu} h(\mathbb{P}^\intercal \bPhi \ba).
%$$
However, $\bu$ is approximated by $\mathbb{P}^\intercal \bu$ in this approach but $\mathbb{P}$ is derived from the DEIM on $\nabla_{\bu} h(\bu)$, which could introduce errors.
%
In \cite{karasozen2018energy}, a nonlinear function in $\nabla_{\bu} H(\bu)$ denoted by $\nabla_{\bu} h(\bu)$ is directly approximated by its DEIM interpolation $\mathbb{P} \nabla_{\bu} h(\bu)$. This way could avoid approximating $\bu$ by $\mathbb{P}^\intercal \bu$, but there does not exist an explicit formula of the discrete Hamiltonian.  
As a result, this approach cannot preserve the discrete energy exactly.

%
%Suppose a nonlinear component in the gradient of the reduced order model is $\bPhi^\intercal \nabla_{\bu} h(\bPhi\ba)$, then the DEIM approximation reads
%$$\bPhi^\intercal \nabla_{\bu} h(\bPhi\ba)\approx \bPhi^\intercal \mathbb{P} \nabla_{\bu} h(\bPhi \ba).
%$$ 

%\paragraph{A new DEIM Hamiltonian.} 
Next, we propose a new way to deal with the nonlinearity in the gradient of $H(\bu)$ so that  
the computational complexity of nonlinear function evaluations is independent of $n$ while keeping the Hamiltonian invariant at the discrete level. 
The key idea is to apply DEIM to the Hamiltonian function, not to its gradient. 
To this end, we first recognize a discrete Hamiltonian function can usually be written as follows:  
$$
H(\bu) = \frac{1}{2} \bu^\intercal \bQ \bu + \bc^\intercal \bG (\bu), 
$$
where $\bG$ is a nonlinear vector-valued function of $\bu$, and $\bc^\intercal \bG (\bu)$ represents the non-polynomial nonlinearity. 
After collecting snapshots of $\bG(\bu)$, $[\bG(\bu(t_0), \ldots, \bG(\bu(t_m)]$, we generate the following DEIM interpolation for $\bG(\bu)$ by Algorithm \ref{alg: DEIM}:
\begin{equation*}
\bG(\bu) \approx \mathbb{P} \bG(\bu) = {\bPsi}(\bP^\intercal {\bPsi})^{-1} \bP^\intercal \bG(\bu).
\label{eq:deim_g}
\end{equation*}
The reduced Hamiltonian is then defined by  
\begin{equation}
H_r(\bPhi\ba) = \frac{1}{2} \ba^\intercal \bQ_r \ba + \bc^\intercal \mathbb{P} \bG (\bPhi \ba), 
\label{eq:deim_ham}
\end{equation}
with $\bQ_r = \bPhi^\intercal \bQ \bPhi$ and the associated gradient can be expressed as 
\begin{equation}
\nabla_{\ba}H_r(\ba) = \bQ_r \ba + \bPhi^\intercal \bJ_{\bG} (\bPhi \ba) \mathbb{P}^\intercal \bc, 
\label{eq:deim_gham}
\end{equation}
where $\bJ_{\bG}(\cdot)$ is the Jacobian matrix of $\bG(\bu)$. 
Plugging \eqref{eq:deim_gham} into \eqref{eq: ham_rom2}, we have a structure-preserving DEIM (SP-DEIM) model: 
\begin{equation}
\begin{aligned}
\dot{{\ba}} &= \bD_r\, \nabla_{\ba} H_r(\bPhi {\ba}) \\
			&= \bD_r\, \left[\bQ_r \ba + \bPhi^\intercal \bJ_{\bG} (\bPhi \ba) \mathbb{P}^\intercal \bc\right]. 
\label{eq: ham_rom3}
\end{aligned}
\end{equation}
Using the same argument as \eqref{eq: dHdt}, we can easily show the discrete Hamiltonian $H_r$ is a constant. 

\begin{remark} The philosophy of the proposed approach to treat the nonlinear Hamiltonian is similar to that of the way to treat nonlinear Lagrangian in \cite{carlberg2015preserving}: the reduction and hyper-reduction are first performed to approximate the key quantity, Lagrangian in \cite{carlberg2015preserving} or Hamiltonian in this work, and the SP-ROMs are then derived based on the reduced quantity. But \cite{carlberg2015preserving} is concerned with second-order dynamics, while we consider general energy-preserving systems. For classical mechanical systems, our approach could lead to SP-ROMs equivalent to reduced order Euler-Lagrangian equations. For instance, for the nonlinear wave equation tested in Section \ref{sec: SP-DEIM}, if the basis of $u$ is used for $v$ as well, the SP-DEIM has an equivalent second-order reduced-order dynamics that can be derived from \cite{carlberg2015preserving}. 
\end{remark} 
%-------------------------------------------------------
\subsection{Improvement of the Hamiltonian approximation}\label{sec: sp_deim2}
%-------------------------------------------------------
A small amount of POD basis functions captures most of the snapshot information, but the basis truncation would result in a loss of information. It could further result in a discrepancy in the Hamiltonian function approximation between the ROM and the FOM.
Since the proposed structure-preserving ROMs are able to keep a constant Hamiltonian, it is enough to correct the initial value of the discrete Hamiltonian to improve the approximation during the reduced-order simulations.
Therefore, we follow one approach developed in \cite{gong2017structure} that uses the POD basis generated from shifted snapshots. 

Instead of the snapshots of state variables, $\left[\bu(t_1), \ldots, \bu(t_M)\right]$, we consider a shifted snapshot set
\begin{equation}
\left[\bu(t_1)-\bu_0, \ldots, \bu(t_M)-\bu_0\right]
%\mu\nabla_{\bu} H(\bu(t_1), \ldots, \mu\nabla_{\bu} H(\bu(t_M)\right].
\label{eq: snap_shift}
\end{equation}
and obtain the POD basis $\bPhi$. The associated reduced approximation becomes
\begin{equation}
\bu_r(t)= \bPhi {\ba}(t) + \bu_0. 
\label{eq: pod_shift}
\end{equation}
Accordingly, we generate DEIM basis $\bPsi$ from a shifted nonlinear snapshot set 
\begin{equation}
\left[\bG(\bu(t_1))-\bG(\bu_0), \ldots, \bG(\bu(t_M))-\bG(\bu_0) \right].
%\mu\nabla_{\bu} H(\bu(t_1), \ldots, \mu\nabla_{\bu} H(\bu(t_M)\right].
\label{eq: nonlsnap_shift}
\end{equation}
The related DEIM approximation becomes
$
\mathbb{P} (\bG(\bu)-\bG(\bu_0)) + \bG(\bu_0)
$
with $\mathbb{P}$ the DEIM projection. The reduced Hamiltonian is 
\begin{equation}
H_r(t) = \frac{1}{2} (\bu_0^\intercal + \ba^\intercal \bPhi^\intercal) \bQ (\bPhi \ba+\bu_0) 
+ \bc^\intercal [\mathbb{P}\bG (\bPhi \ba+\bu_0) + (\mathbb{I}-\mathbb{P}) \bG(\bu_0)]. 
\label{eq:deim_ham_new}
\end{equation}
%
Substituting \eqref{eq:deim_ham_new} into \eqref{eq: ham_rom2}, we have
\begin{equation}
\begin{aligned}
\dot{{\ba}} &= \bD_r\, \nabla_{\ba} H_r(\bPhi \ba + \bu_0) \\
			&= \bD_r\, \left[\bQ_r \ba + \bPhi^\intercal \bQ \bu_0 + \bPhi^\intercal \bJ_{\bG} (\bPhi \ba + \bu_0) \mathbb{P}^\intercal \bc\right], 
\label{eq: ham_rom3}
\end{aligned}
\end{equation}
together with the initial condition ${\ba}(t_0) = \bf{0}$.
Since $\bD_r$ is skew symmetric, the model preserves the structural property and the reduced Hamiltonian would keep the same value as $H(\bu_0)$ during the reduced order simulations. 

%=====================================================
\section{Numerical experiments\label{sec: num}}
%=====================================================
\noindent \indent In this section, we use a nonlinear wave equation as an example of Hamiltonian PDEs to investigate the numerical performance of the structure-preserving ROMs. 
%\subsection{Nonlinear wave equation\label{sec: we}}
Consider a one-dimensional case with a constant moving speed $c$ and a nonlinear forcing term $g(u)$,
\begin{equation*}
u_{tt}= c^2 u_{xx} - g(u), \quad 0\leq x\leq l.
\end{equation*}
The equation can be written in the Hamiltonian formulation
\begin{equation}
\left[
\begin{array}{c}
\dot{u}\\
\dot{v}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & 1 \\
-1 & 0
\end{array}
\right]
\left[
\begin{array}{c}
\frac{\delta \mathcal{H}}{\delta u}\\
\frac{\delta \mathcal{H}}{\delta v}
\end{array}
\right],
\label{eq:lin_wave}
\end{equation}
which has a symplectic structure. The PDE system has a constant Hamiltonian that is also the total energy:  
\begin{equation*}
\mathcal{H}(t) = \int_0^l \left[\frac{1}{2}v^2+\frac{c^2}{2} u_x^2 + G(u)\right]\, dx,
\end{equation*}
where ${G}'(u) = g(u)$,
$\frac{\delta \mathcal{H}}{\delta u} = -c^2 u_{xx}+g(u)$ and $\frac{\delta \mathcal{H}}{\delta v} = v$.
After a spatial discretization using finite difference method with $n$ uniformly distributed grid points and the mesh size $\Delta x$, the semi-discrete system of \eqref{eq:lin_wave} reads: 
\begin{equation}
\left[
\begin{array}{c}
\dot{\bu}\\
\dot{\bv}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & \bI_n \\
-\bI_n & 0
\end{array}
\right]
\left[
\begin{array}{c}
-\bA \bu+\bg(\bu)\\
\bv
\end{array}
\right],
\label{eq: wavef}
\end{equation}
where $\bA$ is a discrete, scaled, one-dimensional second order differential operator.
The discrete Hamiltonian is $H\Delta x$ with 
$$
H(t) = \frac{1}{2} \bv^\intercal \bv - \frac{1}{2} \bu^\intercal \bA \bu + \bc^\intercal \bG(\bu),
$$   
where $\bc$ is the all-ones vector and $\bc^\intercal {\bG}({\bu})$ corresponds to the discretization of the integration of ${G}(u)$. 

The linear problem has been tested in \cite{peng2016symplectic,gong2017structure}. Here we focus on the nonlinear case $g(u) = \sin(u)$ and ${G}({u})= 1-\cos(u)$, then $[\bG(\bu)]_i= 1-\cos(u_i)$ and $[\bg(\bu)]_i = \sin(u_i)$ for $i=0, \ldots, n-1$.
%========= Nonlinear wave
In particular, $c= 0.1$, $x\in [0, 1]$, $t\in [0, 50]$, and periodic boundary conditions are selected in our setting.
The initial condition satisfies $u(0)=f(s(x))$ and $\dot{u}(0)=0$, where $f(s)$ is a cubic spline function defined by
\begin{equation*}
f(s) =
\left\{
\begin{array}{ll}
1-\frac{3}{2}s^2+\frac{3}{4}s^3 & \text{\quad if  \,\,} 0\leq s\leq 1, \\
\frac{1}{4}(2-s)^3 		       & \text{\quad if  \,\,} 1< s\leq 2, \\
0					       & \text{\quad if  \,\,} s> 2,
\end{array}
\right.
\end{equation*}
and $s(x)= 10|x-\frac{1}{2}|$.


In the full-order simulation, the spatial domain is partitioned into $n=500$ equal subintervals, thus the mesh size $\Delta x= 2\times 10^{-3}$.
We use the symplectic midpoint method for the time integration with the step size $\Delta t= 0.01$.
A three-point stencil finite difference method is taken for the spatial discretization of the 1D second order differential operator.
The full order solution at time $t_{k+1}$, $\bu_h^{k+1}$ and $\bv_h^{k+1}$, satisfies
\begin{equation*}
\left[
\begin{array}{c}
\frac{\bu_h^{k+1}-\bu_h^k}{\Delta t}\\
\frac{\bv_h^{k+1}-\bv_h^k}{\Delta t}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 &\bI_n \\
-\bI_n & 0
\end{array}
\right]
\left[
\begin{array}{c}
-\bA\frac{\bu_h^{k+1}+\bu_h^k}{2} + \bg\left(\frac{\bu_h^{k+1}+\bu_h^k}{2}\right)\\
\frac{\bv_h^{k+1}+\bv_h^k}{2}
\end{array}
\right],
\end{equation*}
where
\begin{equation*}
\bA= \frac{c^2}{\Delta x^2}
\left( \begin{array}{cccccc}
-2 & 1 & 0  & 0 & \cdots & 1 \\
1 & -2 & 1 & 0 & \cdots & 0 \\
   &     & \ddots & \ddots & \ddots &  \\
 0   &    \cdots&0          &  1 & -2  & 1 \\
 1 &    \cdots      &0     &  0  &  1 & -2
\end{array} \right),
\end{equation*}
the initial data $\bu_h^0$ has the $i$-th component equals $h(s(x_i))$ for $1\leq i\leq n$ and $\bv_h^0= {\bf 0}$.
The nonlinear system is solved by the Picard iteration.  
%

It takes 52.8~seconds to finish the full-order simulation. The time evolution of numerical solutions $\bu_h$ and $\bv_h$ and the discrete energy $H\Delta x$ are plotted in Figure \ref{Fig: lin_wave_full}.
It is seen that the discrete energy is around $1.258\times 10^{-1}$.  
%It is not exactly preserved due to the use of midpoint scheme.
\begin{figure}[htb]
\centering
\begin{minipage}[ht]{0.31\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveN500Nt5000_u.eps}
\end{minipage}
\begin{minipage}[ht]{0.31\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveN500Nt5000_v.eps}
\end{minipage}
\begin{minipage}[ht]{0.36\linewidth}
\vspace{1cm}
\includegraphics[width=1\textwidth]{./NonlinearWaveN500Nt5000_e.eps}
\end{minipage}
\caption{
Full-order simulation results: time evolution of $\bu_h$ (left), $\bv_h$ (middle), and discrete Hamiltonian $H\Delta x$ (right).
}\label{Fig: lin_wave_full}
\end{figure}
Since the exact solution is unknown, in what follows, the full-order simulation results will be served as benchmark solution for ROMs.


Next, we investigate the numerical performance of three types of ROMs: i) the G-POD model; ii) the SP-POD ROMs; iii) the SP-DEIM ROMs.
The criteria we shall use include: the maximum approximation error over the entire spatial-temporal domain,
$$\mathcal{E}_\infty= \max\limits_{k\geq 0} \max\limits_{0\leq i\leq n}  \sqrt{\left[(\bu_h^k)_i-(\bu_r^k)_i\right]^2+\left[(\bv_h^k)_i-(\bv_r^k)_i\right]^2},$$
the value of reduced-order Hamiltonian $H_r\Delta x$, 
and the CPU time $t_{cpu}$ for online simulations.


\subsection{Standard G-POD ROM.}
\noindent \indent Snapshots are collected from the full-order simulation every $50$ time steps.
Using the singular value decomposition, we find the $r$-dimensional POD basis $\bPhi_u$ and $\bPhi_v$ for $u$ and $v$, respectively.
The standard G-POD ROM is generated by substituting the POD approximation $\bu_r(t) = \bPhi_u \ba(t)$ and $\bv_r(t) = \bPhi_v \bb(t)$ into \eqref{eq: wavef} and applying the Galerkin projection, which can be written as: 
\begin{equation*}
\left[
\begin{array}{c}
\dot{\ba}\\
\dot{\bb}
\end{array}
\right] =
\left[
\begin{array}{c}
\bPhi_u^\top\bPhi_v \bb\\
 \bPhi_v^\top\bA \bPhi_u \ba - \bPhi_v^\intercal \bg(\bPhi_u \ba)
\end{array}
\right].
\label{eq:lin_wave_rom}
\end{equation*}
%
Using the same time integration method as the full order model, we have the POD basis coefficient at $t_{k+1}$, $\ba^{k+1}$ and $\bb^{k+1}$, satisfying
\begin{equation*}
\left[
\begin{array}{c}
\frac{\ba^{k+1}-\ba^{k}}{\Delta t}\\
\frac{\bb^{k+1}-\bb^{k}}{\Delta t}
\end{array}
\right] =
\left[
\begin{array}{c}
\bPhi_u^\top\bPhi_v \frac{\bb^{k+1}+\bb^{k}}{2}\\
\bPhi_v^\top\bA \bPhi_u \frac{\ba^{k+1}+\ba^{k}}{2}- \bPhi_v^\intercal \bg(\bPhi_u \frac{\ba^{k+1}+\ba^{k}}{2})
\end{array}
\right]
\label{eq:lin_wave_rom_dis}
\end{equation*}
with the initial condition $\ba^0 = \bPhi_u^\top \bu_0$ and $\bb^0 = \bPhi_v^\top \bv_0$.
%We first choose the number of POD basis to be $r=5$ in the standard ROM \eqref{eq:lin_wave_rom}, the approximation errors are shown in Figure \ref{Fig: lin_wave_red5_stand}

For $r=10$ and $20$, the respective CPU times for online simulations are 0.765~seconds and 0.979~seconds. The associated maximum errors of the reduced approximations are $\mathcal{E}_\infty= 3.291\times 10^{-2}$ and $8.288\times 10^{-3}$, respectively.
%The errors in $u$ and $v$ are shown in Figure \ref{Fig: lin_wave_red20_stand} (left and middle). 
The time evolution of Hamiltonian approximation errors for both cases is shown in Figure \ref{Fig: podg}. 
It is observed that the order of Hamiltonian approximation errors varies from $\mathcal{O}(10^{-5})$ when $r=10$ to $\mathcal{O}(10^{-7})$ when $r=20$. 
As $r$ increases, the discrete Hamiltonian becomes more accurate, but it is not time invariant as the standard G-POD ROM is not structure preserving. 


\begin{figure}[htb]
\centering
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROM_r110r210N500Nt5000ICshif0_e}
\end{minipage}
\hspace{.2cm}
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROM_r120r220N500Nt5000ICshif0_e}
\end{minipage}
\caption{
$H_r\Delta x-H\Delta x$ of the Standard POD-ROM: $r=10$ (left) and $r=20$ (right). 
}\label{Fig: podg}
\end{figure}


\subsection{The SP-POD Models.} 
Next, we consider the structure-preserving ROMs introduced in Section \ref{sec: alg}. Two SP-POD ROMs are applied: the first one uses the standard POD basis, named SP-POD-1; the other uses the POD basis generated from shifted snapshots, named SP-POD-2. 
%--------------------------------
%\paragraph{SP-POD with the standard POD basis.} 
%--------------------------------
\paragraph{SP-POD-1.}  This SP-ROM has the following form: 
\begin{equation*}
\left[
\begin{array}{c}
\dot{\ba}\\
\dot{\bb}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & \bPhi_u^\top \bPhi_v \\
-\bPhi_v^\top \bPhi_u & 0
\end{array}
\right]
\left[
\begin{array}{c}
-\bA_r \ba + \bPhi_u^\intercal \bg(\bPhi_u \ba) \\
\bb
\end{array}
\right],
\end{equation*}
where $\bA_r = \bPhi_u^\top \bA \bPhi_u$. 
The coefficient matrix on the right-hand-side of the system is skew-symmetric, which has the same structure as that of the full-order model.
Thus, we expect a constant discrete Hamiltonian in the reduced-order simulation. 
Using the symplectic midpoint scheme, the discrete system reads: 
\begin{equation}
\left[
\begin{array}{c}
\frac{\ba^{k+1}-\ba^{k}}{\Delta t}\\
\frac{\bb^{k+1}-\bb^{k}}{\Delta t}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & \bPhi_u^\top \bPhi_v \\
-\bPhi_v^\top \bPhi_u & 0
\end{array}
\right]
\left[
\begin{array}{c}
-\bA_r \frac{\ba^{k+1}+\ba^k}{2} + \bPhi_u^\intercal \bg(\bPhi_u \frac{\ba^{k+1}+\ba^k}{2}) \\
\frac{\bb^{k+1}+\bb^k}{2}
\end{array}
\right]
\end{equation}
with the initial condition $\ba^0 = \bPhi_u^\top \bu_0$ and $\bb^0 = \bPhi_v^\top \bv_0$.

\begin{figure}[htb]
\centering
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROMShift_r110r210N500Nt5000POD1ICshif0_e}
\end{minipage}
\hspace{1cm}
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROMShift_r120r220N500Nt5000POD1ICshif0_e}
\end{minipage}
\caption{
$H_r\Delta x-H\Delta x$ of the SP-POD-1: $r=10$ (left) and $r=20$ (right). 
}\label{Fig: sp-pod1}
\end{figure}

It takes $0.601$ seconds and $0.786$ seconds to complete the simulations of SP-POD-1 model with dimensions $r=10$ and $r=20$, respectively. The corresponding maximum errors of the reduced approximations is $\mathcal{E}_\infty= 3.291\times 10^{-2}$ and $8.298\times 10^{-3}$.
Errors of the Hamiltonian approximations in both cases are presented in Figure \ref{Fig: sp-pod1}. 
It is seen that $H_r\Delta x-H\Delta x$ possesses the same magnitude as that in the G-POD model of the same dimensions. 
This is because the POD truncation causes information loss, which results in the Hamiltonian approximation error. Therefore, we next correct the reduced Hamiltonian by using the POD basis from shifted snapshots. 

%--------------------------------
\paragraph{SP-POD-2.} This SP-ROM has the following form: 
%--------------------------------
\begin{equation}
\left[
\begin{array}{c}
\dot{\ba}\\
\dot{\bb}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & \bPhi_u^\top \bPhi_v \\
-\bPhi_v^\top \bPhi_u & 0
\end{array}
\right]
\left[
\begin{array}{c}
-\bA_r \ba -\bPhi_u^\top \bA \bu_0 + \bPhi_u^\intercal \bg(\bPhi_u \ba +\bu_0) \\
\bb + \bPhi_v^\intercal \bv_0
\end{array}
\right].
\end{equation}
Using the same symplectic midpoint method, we have the discrete system as follows. 
\begin{equation}
\left[
\begin{array}{c}
\frac{\ba^{k+1}-\ba^{k}}{\Delta t}\\
\frac{\bb^{k+1}-\bb^{k}}{\Delta t}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & \bPhi_u^\top \bPhi_v \\
-\bPhi_v^\top \bPhi_u & 0
\end{array}
\right]
\left[
\begin{array}{c}
-\bA_r \frac{\ba^{k+1}+\ba^k}{2} -\bPhi_u^\top \bA \bu_0 + \bPhi_u^\intercal \bg(\bPhi_u \frac{\ba^{k+1}+\ba^k}{2}+\bu_0) \\
\frac{\bb^{k+1}+\bb^k}{2}+ \bPhi_v^\intercal \bv_0
\end{array}
\right]
\end{equation}
with the initial condition $\ba^0 = {\bf 0}$ and $\bb^0 = {\bf 0}$.

\begin{figure}[htb]
\centering
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROMShift_r110r210N500Nt5000POD1ICshif1_e}
\end{minipage}
\hspace{1cm}
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROMShift_r120r220N500Nt5000POD1ICshif1_e}
\end{minipage}
\caption{
$H_r\Delta x-H\Delta x$ of the SP-POD-2: $r=10$ (left) and $r=20$ (right). 
}\label{Fig: sp-pod2}
\end{figure}

The CPU times of the simulations when $r=10$ and $20$ are $0.630$ seconds and $0.805$ seconds, respectively. The corresponding maximum errors are $\mathcal{E}_\infty= 3.711\times 10^{-2}$ and $1.015\times 10^{-2}$.
Figure \ref{Fig: sp-pod2} displays the time history of the discrete Hamiltonian approximation errors during the simulations in both cases. 
Compared with those obtained from SP-POD-1 model, the Hamiltonian approximation errors of SP-POD-2 shrink to $\mathcal{O}(10^{-10})$ and $\mathcal{O}(10^{-11})$ in these two cases. This illustrates the advantage of using POD basis from shifted snapshots for improving the energy approximation. 

\subsection{The SP-DEIM Models\label{sec: SP-DEIM}} The SP-POD models still have the computational complexity dependent on $n$ due to the nonlinearity of $\bg(\cdot)$. 
To reduce the computational cost, we utilize the SP-DEIM ROMs. Two models are applied: the first one is named by SP-DEIM-1 that uses the standard POD and DEIM basis, the other one is named SP-DEIM-2 that uses the POD basis from shifted state snapshots and DEIM basis generated from shifted nonlinear snapshots. 
In both models, we select the number of DEIM basis to be twice as many as that of POD basis. 

\paragraph{SP-DEIM-1.} This model has the following form: 
\begin{equation}
\left[
\begin{array}{c}
\dot{\ba}\\
\dot{\bb}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & \bPhi_u^\top \bPhi_v \\
-\bPhi_v^\top \bPhi_u & 0
\end{array}
\right]
\left[
\begin{array}{c}
-\bA_r \ba + \bPhi_u^\intercal \bg(\bPhi_u \ba)\mathbb{P}^\intercal C \\
\bb
\end{array}
\right].
\end{equation}
With the symplectic midpoint rule, we have 
\begin{equation}
\left[
\begin{array}{c}
\frac{\ba^{k+1}-\ba^{k}}{\Delta t}\\
\frac{\bb^{k+1}-\bb^{k}}{\Delta t}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & \bPhi_u^\top \bPhi_v \\
-\bPhi_v^\top \bPhi_u & 0
\end{array}
\right]
\left(
\left[
\begin{array}{c}
-\bA_r \frac{\ba^{k+1}+\ba^k}{2}+ \bPhi_u^\intercal \bg(\bPhi_u \frac{\ba^{k+1}+\ba^k}{2})\mathbb{P}^\intercal C\\
\frac{\bb^{k+1}+\bb^k}{2}
\end{array}
\right]
\right)
\end{equation}
with the initial condition $\ba^0 = \bPhi_u^\intercal \bu_0$ and $\bb^0 = \bPhi_v^\intercal \bv_0$.

For $r=10$ and $20$, it respectively takes $0.141$ seconds and $0.209$ seconds to complete the simulations. 
Correspondingly, the maximum errors of the reduced-order simulations are $\mathcal{E}_\infty= 3.364\times 10^{-2}$ and $8.473\times 10^{-3}$.
The errors of Hamiltonian function approximations in both cases are presented in Figure \ref{Fig: sp-deim1}. 
Their magnitudes are close to those obtained by the SP-POD-1 model.  

\begin{figure}[htb]
\centering
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROMShift_r110r210N500Nt5000POD0ICshif0_e.eps}
\end{minipage}
\hspace{1cm}
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROMShift_r120r220N500Nt5000POD0ICshif0_e.eps}
\end{minipage}
\caption{
$H_r\Delta x - H\Delta x$ in SP-DEIM-1: $r=10$ (left) and $r=20$ (right). 
}\label{Fig: sp-deim1}
\end{figure}


\paragraph{SP-DEIM-2.} To improve the discrete Hamiltonian, we use the POD basis generated from shifted state snapshots and the DEIM basis from shifted nonlinear snapshots. 
The model has the following form:
\begin{equation}
\left[
\begin{array}{c}
\dot{\ba}\\
\dot{\bb}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & \bPhi_u^\top \bPhi_v \\
-\bPhi_v^\top \bPhi_u & 0
\end{array}
\right]
\left[
\begin{array}{c}
- \bA_r \ba -\bPhi_u^\top \bA\bu_0 + \bPhi_u^\intercal \bg(\bPhi_u \ba + \bu_0)\mathbb{P}^\intercal C \\
\bb + \bPhi_v^\intercal \bv_0
\end{array}
\right].
\end{equation}
After applying the symplectic midpoint rule, we have 
\begin{equation}
\left[
\begin{array}{c}
\frac{\ba^{k+1}-\ba^{k}}{\Delta t}\\
\frac{\bb^{k+1}-\bb^{k}}{\Delta t}
\end{array}
\right] =
\left[
\begin{array}{cc}
0 & \bPhi_u^\top \bPhi_v \\
-\bPhi_v^\top \bPhi_u & 0
\end{array}
\right]
\left[
\begin{array}{c}
-\bA_r \frac{\ba^{k+1}+\ba^k}{2} -\bPhi_u^\top \bA  \bu_0 + \bPhi_u^\intercal \bg(\bPhi_u \frac{\ba^{k+1}+\ba^k}{2} + \bu_0)\mathbb{P}^\intercal C\\
\frac{\bb^{k+1}+\bb^k}{2} + \bPhi_v^\intercal \bv_0
\end{array}
\right]
\end{equation}
with the initial condition $\ba^0 = {\bf 0}$ and $\bb^0 = {\bf 0}$.

The CPU times for online simulations when $r=10$ and $20$ are $0.143$~seconds and $0.210$~seconds, respectively. The associated maximum errors are $\mathcal{E}_\infty= 3.490\times 10^{-2}$ and $1.311\times 10^{-2}$. 
The errors are bigger than those obtained from the SP-POD-2 model, which can be improved by increasing the number of DEIM basis and interpolation points. 
The Hamiltonian function approximation errors for both cases are presented in Figure \ref{Fig: sp-deim2}, whose magnitude are close to those in the SP-POD-2 simulations. It illustrates the SP-DEIM-2 model is able to preserve the discrete Hamiltonian.  



\begin{figure}[htb]
\centering
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROMShift_r110r210N500Nt5000POD0ICshif1_e.eps}
\end{minipage}
\hspace{1cm}
\begin{minipage}[ht]{0.45\linewidth}
\includegraphics[width=1\textwidth]{./NonlinearWaveROMShift_r120r220N500Nt5000POD0ICshif1_e.eps}
\end{minipage}
\caption{
$H_r\Delta x-H\Delta x$ in SP-DEIM-2: $r=10$ (left) and $r=20$ (right). 
}\label{Fig: sp-deim2}
\end{figure}

\subsection{Summary of numerical experiments}

We summarize the above test cases in Tables \ref{tab: ex1}-\ref{tab: ex2}. The results are benchmarked by the full order solutions:  
the discrete Hamiltonian value is $H\Delta x = 1.258\times 10^{-1}$ and the CPU time for the full order simulation is $t_{cpu}= 52.8$ seconds.
\begin{table}[htp]
\begin{center}
\caption{Nonlinear wave equations: comparison of ROMs (r=10)}
\label{tab: ex1}
\begin{tabular}{| c | c | c | c | c | c | c |} \hline
  {}                    &   G-ROM                 & SP-POD-1               & SP-POD-2                & SP-DEIM-1             & SP-DEIM-2 \\ \hline
  $\mathcal{E}_\infty$  &  $3.291\times 10^{-2}$  & $3.291\times 10^{-2}$  & $3.711\times 10^{-2}$   & $3.365\times 10^{-2}$ & $3.490\times 10^{-2}$   \\
  $H_r\Delta x-H\Delta x$    			& $\mathcal{O}(10^{-5})$  & $\mathcal{O}(10^{-5})$ & $\mathcal{O}(10^{-10})$ & $\mathcal{O}(10^{-5})$& $\mathcal{O}(10^{-10})$ \\     
  $t_{cpu}$ (s)    		& 0.755                   & 0.601                  & 0.630                   & 0.140                 & 0.143 \\ 
  \hline
  
\end{tabular}
\end{center}
\end{table}

\begin{table}[htp]
\begin{center}
\caption{Nonlinear wave equations: comparison of ROMs (r=20)}
\label{tab: ex2}
\begin{tabular}{| c | c | c | c | c | c |} \hline
  {}                    &   G-ROM                 & SP-POD-1               & SP-POD-2                & SP-DEIM-1             & SP-DEIM-2 \\ \hline
  $\mathcal{E}_\infty$  &  $8.288\times 10^{-3}$  & $8.298\times 10^{-3}$  & $1.152\times 10^{-2}$   & $8.473\times 10^{-3}$ & $1.311\times 10^{-2}$   \\
  $H_r\Delta x-H\Delta x$    			& $\mathcal{O}(10^{-7})$  & $\mathcal{O}(10^{-7})$ & $\mathcal{O}(10^{-11})$ & $\mathcal{O}(10^{-7})$& $\mathcal{O}(10^{-11})$ \\     
  $t_{cpu}$ (s)    		& 0.979                   & 0.786                  & 0.805                   & 0.209                 & 0.210 \\ 
  \hline
  
\end{tabular}
\end{center}
\end{table}

Based on the results, we can draw the following conclusions:
(i) the structure-preserving ROMs with basis from shifted snapshots (SP-POD-2 and SP-DEIM-2)  are able to preserve the energy, which achieve better Hamiltonian approximations than other ROMs;
(ii) using the SP-DEIM models reduces the CPU time of their SP-POD counterparts; The speedup factor could increase if the nonlinear function is more complicated or the dimension of the full order model is bigger; 
(iii) using the SP-DEIM models achieves approximation errors close to their SP-POD counterparts; Such differences would be negligible when more DEIM basis and interpolation points are included; 
and
(iv) overall, SP-DEIM-2 outperforms the other ROMs discussed in this paper in terms of discrete Hamiltonian approximation, the accuracy and efficiency of reduced order simulations.

\section{Conclusions}
\noindent \indent Energy preserving schemes have been developed for simulating Hamiltonian PDEs, for which one significant property is to preserve the Hamiltonian function. When model reduction techniques such as the POD method is applied, the standard Galerkin projection would destroy this property, thus the discrete Hamiltonian is not well preserved.  
In \cite{gong2017structure}, the structure-preserving POD have been developed that leads to a constant Hamiltonian approximation.  
However, the computational complexity of the SP-POD ROMs is still high when the gradient of Hamiltonian has non-polynomial  nonlinearities. 
In this paper, we introduce a new structure-preserving DEIM that improves the online efficiency while obtaining an accurate Hamiltonian approximation from the reduced order simulations. 
Numerical experiments demonstrate the efficacy of the proposed approach.

%
%%========================================
%\subsection{Korteweg-de Vries (KdV) equation\label{sec: kdv}}
%%========================================
%\noindent \indent The KdV equation
%\begin{equation*}
%u_t = \alpha uu_x + \rho u_x + \gamma u_{xxx},
%\end{equation*}
%defined in the spatial temporal domain $[-L, L]\times [0, T]$, has a bi-Hamiltonian form (see, e.g., \cite{Karasozen2013energy}).
%Here, we consider the first Hamiltonian formulation
%\begin{equation}
%u_t = \mathcal{S} \frac{\delta \mathcal{H}}{\delta u},
%\end{equation}
%where $\mathcal{S}= \partial_x$ denotes the first-order derivative with respect to space and the Hamiltonian function, which is the system energy,
%$$\mathcal{H}=\int_0^L \left(\frac{\alpha}{6}u^3+\frac{\rho}{2}u^2-\frac{\nu}{2}u_x^2 \right) \, dx.$$
%The other Hamiltonian formulation can be treated in the same manner.
%
%
%Consider a problem associated with the periodic boundary conditions $u(-L, t)= u(L, t)$ for $t\in [0, T]$ and initial condition $u(x, 0)=u_0(x)$. In the full-order simulation, the domain $[-L, L]$ is divided into $n$ uniform subdomains with the interior grid points $x_i= i\Delta x$ for $i= 1, \ldots, n$ and $\Delta x= \frac{2L}{n}$.
%Let $\bA$ and $\bB$ be the matrices associated to the discretization of the skew adjoint operator $\mathcal{S}$ and the second-order derivative by central differences, respectively, i.e.,
%\begin{equation}
%\bA= \frac{1}{2\Delta x}
%\left( \begin{array}{cccccc}
%0 & 1 & 0  & 0 & \cdots & -1 \\
%-1 & 0 & 1 & 0 & \cdots & 0 \\
%   &     & \ddots & \ddots & \ddots &  \\
% 0   &    \cdots&0          &  -1 & 0  & 1 \\
% 1 &    \cdots      &0     &  0  &  -1 & 0
%\end{array} \right),
%\qquad
%\bB= \frac{1}{\Delta x^2}
%\left( \begin{array}{cccccc}
%-2 & 1 & 0  & 0 & \cdots & 1 \\
%1 & -2 & 1 & 0 & \cdots & 0 \\
%   &     & \ddots & \ddots & \ddots &  \\
% 0   &    \cdots&0          &  1 & -2  & 1 \\
% 1 &    \cdots      &0     &  0  &  1 & -2
%\end{array} \right)
%\end{equation}
%and $\bu= (u_1, \ldots, u_n)^\top$,
%the semi-discrete KdV equation can be written in a vector form
%\begin{eqnarray}
%\frac{d\bu}{dt} &=& \bA \nabla_{\bu}H(\bu) \nonumber \\
%		      &=& \bA\left(\frac{\alpha}{2}\bu^2+\rho\bu+\nu\bB\bu\right),
%\label{eq: kdv_fom1}
%\end{eqnarray}
%where $H(\bu)= \sum_{j=1}^n\left[\frac{\alpha}{6}u_j^3 + \frac{\rho}{2}u_j^2 - \frac{\nu}{2}(\delta_x^+ u_j)^2\right]$ and $\delta_x^+ u_j$ is the forward finite differencing. The discrete energy $H\Delta x$ approximates to $\mathcal{H}$ as $\Delta x$ goes to zero. Since $\bA$ is skew-symmetric, this dynamical system conserves the discrete energy $H\Delta x$.
%
%
%In the rest of this subsection, we consider the test example, in which parameters $\alpha= -6$, $\rho= 0$, $\nu= -1$, $L= 20$ and $T=20$.
%The initial condition $u_0(x)= {\sech}^2\left(\frac{x}{\sqrt{2}}\right)$.
%Mesh sizes are chosen as $\Delta x= \Delta t= 0.02$ in the FOM simulation.
%%
%For the time integration, we use the method of AVF.
%At time $t_k$, the solution $\bu_h^k$ satisfies,
%\begin{equation}
%\frac{\bu_h^{k+1}-\bu_h^k}{\Delta t} = \bA\left[\frac{\alpha}{6}\left( (\bu_h^k)^2+\bu_h^k\bu_h^{k+1}+(\bu_h^{k+1})^2 \right) + \rho \bu_h^{k+\frac{1}{2}} + \nu\bB\bu_h^{k+\frac{1}{2}}\right],
%\label{eq: kdv_fom}
%\end{equation}
%where $\bu_h^{k+\frac{1}{2}}= \left(\bu_h^k+\bu_h^{k+1}\right)/2$
%and the initial data $\bu_h^0$ has the $i$-th component to be $u_0(x_i)$ for $1\leq i\leq n$.
%Due to the nonlinearity of the model, iterative methods such as the Picard's method is used when solving the system.
%%
%The evolution of the full-order simulation $u_h(x, t)$ and energy $\mathcal{H}(t)\approx -1.1317$ is shown in Figure \ref{Fig: kdv_fom}.
%\begin{figure}[htb]
%\centering
%\begin{minipage}[ht]{0.38\linewidth}
%\includegraphics[width=1\textwidth]{./KdvN500Nt500_u-eps-converted-to.pdf}
%\end{minipage}
%\hspace{1cm}
%\begin{minipage}[ht]{0.38\linewidth}
%\includegraphics[width=1\textwidth]{./KdvN500Nt500_e-eps-converted-to.pdf}
%\end{minipage}
%\caption{The full-order state solution $u$ (left) and energy $\mathcal{H}(t)$ (right).
%}\label{Fig: kdv_fom}
%\end{figure}
%%It is seen that the Hamiltonian function is a constant $H(t) \approx -1.1316580$.
%
%
%Next, we investigate the numerical behavior of ROMs.
%Since the exact solution is unknown, we regard the full-order results as a benchmark and compare the accuracy of standard G-POD ROMs and the proposed structure-preserving ROMs by measuring the error $\mathcal{E}_\infty= \max\limits_{k>0} \max\limits_{0\leq i\leq n} |(\bu_h^k)_i-(\bu_r^k)_i|$
%and the energy value in the reduced-order simulations, $\mathcal{H}_r(t)$.
%
%
%
%\subsubsection{Standard G-POD ROMs}
%\noindent \indent Considering the snapshots collected from the full-order simulation every $5$ time steps, we generate
%the $r$-dimensional POD basis matrix $\bPhi$. Replacing $\bu$ by its reduced-order approximation $\bu_r=\bPhi\ba$ in \eqref{eq: kdv_fom1}, multiplying $\bPhi^\top$ on both sides of the equation and using the fact that $\bPhi^\top\bPhi= I_r$, we have
%\begin{equation}
%\frac{d\ba}{dt} = \bPhi^\top \bA \nabla_{\bu}H(\bPhi \ba).
%\label{eq: kdv_rom1}
%\end{equation}
%Using the same AVF scheme, the discrete G-POD ROM reads
%\begin{equation}
%\frac{\ba^{k+1}-\ba^k}{\Delta t} =
%\bPhi^\top\bA\left[\frac{\alpha}{6}\left( (\bPhi\ba^k)^2
%+(\bPhi\ba^k)(\bPhi\ba^{k+1})
%+(\bPhi\ba^{k+1})^2 \right)
%+ \rho \bPhi \frac{\ba^k+\ba^{k+1}}{2}
%+ \nu\bB\bPhi \frac{\ba^k+\ba^{k+1}}{2}\right]
%\label{eq: kdv_rom_e1}
%\end{equation}
%with the initial condition $\ba^0= \bPhi^\top \bu^0$.
%This model is also nonlinear, thus the Picard's iteration is used in simulating the system.
%Since the nonlinear is quadratic, tensor manipulation can be used for efficiently evaluating the nonlinear term (see, e.g., in \cite{wang2011closure}).
%
%
%When $r= 40$, the maximum error $\mathcal{E}_\infty= 2.9637\times 10^{-2}$.
%The time evolution of energy is shown in Figure \ref{Fig: kdv_rom_r40} (left), which indicates the energy is not exactly conserved.
%It is because the coefficient matrix of the ROM is not skew-symmetric, thus the Hamiltonian structure is damaged.
%%When $r= 20$, the maximum error $\|u_h-u_{h, r}\|_\infty= 0.98694$.
%%Because the coefficient matrix of the ROM \eqref{eq: kdv_rom_e1}, $\bPhi^\top\bA$, is not skew-symmetric, the energy is not exactly conserved.
%%As seen in Figure \ref{Fig: kdv_rom_r20}, the energy is not accurately captured.
%%\begin{figure}[htb]
%%\centering
%%\begin{minipage}[ht]{0.38\linewidth}
%%\includegraphics[width=1\textwidth]{./KdvROMr20N500Nt500standard_u}
%%\end{minipage}
%%\hspace{1cm}
%%\begin{minipage}[ht]{0.38\linewidth}
%%\includegraphics[width=1\textwidth]{./KdvROMr20N500Nt500standard_e}
%%\end{minipage}
%%\caption{The standard reduced-order approximation ($r=20$) error $u_h-u_{h, r}$ (left) and energy $E_r(t)$ (right).
%%}\label{Fig: kdv_rom_r20}
%%\end{figure}
%%When the dimension is increased to $r=40$, the maximum error is reduced to $\|u_h-u_{h, r}\|_\infty= 0.029$, the energy approximation also gets improved, but the value varies from $-1.1314$ to $-1.1068$.
%\begin{figure}[htb]
%\centering
%%\begin{minipage}[ht]{0.38\linewidth}
%%\includegraphics[width=1\textwidth]{./KdvROMr40N500Nt500standard_u}
%%\end{minipage}
%\begin{minipage}[ht]{0.41\linewidth}
%\includegraphics[width=1\textwidth]{./KdvROMr40N500Nt500standard_e-eps-converted-to.pdf}
%\end{minipage}
%\hspace{1cm}
%\begin{minipage}[ht]{0.41\linewidth}
%\includegraphics[width=1\textwidth]{./KdvROMr60N500Nt500standard_e-eps-converted-to.pdf}
%\end{minipage}
%\caption{Time evolution of energy error in the standard reduced-order approximation: $r=40$ (left) and $r=60$ (right).
%}\label{Fig: kdv_rom_r40}
%\end{figure}
%
%When the dimension is increased to $r=60$, the maximum error is reduced to $\mathcal{E}_\infty= 2.4476\times 10^{-3}$, and the energy discrepancy decreases to $\mathcal{O}(10^{-4})$, but the value of the energy approximation still varies with time as shown in Figure \ref{Fig: kdv_rom_r40} (right).
%%\begin{figure}[htb]
%%\centering
%%\begin{minipage}[ht]{0.38\linewidth}
%%\includegraphics[width=1\textwidth]{./KdvROMr60N500Nt500standard_u}
%%\end{minipage}
%%\hspace{1cm}
%%\begin{minipage}[ht]{0.38\linewidth}
%%\includegraphics[width=1\textwidth]{./KdvROMr60N500Nt500standard_e}
%%\end{minipage}
%%\caption{The standard reduced-order approximation ($r=60$) error (left) and energy $E_r(t)$ (right).
%%}\label{Fig: kdv_rom_r60}
%%\end{figure}
%
%In the rest of this test, we will focus on the low dimensional case and aims to improve the accuracy of the SP-ROMs with $r= 40$.
%
%
%\subsubsection{SP-ROMs with standard POD basis}
%\noindent \indent The proposed structure-preserving ROMs possess a skew-symmetric coefficient matrix $A_r= \bPhi^\top \bA \bPhi$, and the dynamical system reads
%\begin{equation}
%\frac{d\ba}{dt} = \bA_r \nabla_{\ba}H(\bPhi \ba).
%\label{eq: kdv_rom2}
%\end{equation}
%The structure-preserving ROM with standard POD basis (SP-ROM-0) after the discretization reads
%\begin{equation}
%\frac{\ba^{k+1}-\ba^k}{\Delta t} =
%\bA_r\bPhi^\top\left[\frac{\alpha}{6}\left( (\bPhi\ba^k)^2
%+(\bPhi\ba^k)(\bPhi\ba^{k+1})
%+(\bPhi\ba^{k+1})^2 \right)
%+ \rho \bPhi \frac{\ba^k+\ba^{k+1}}{2}
%+ \nu\bB\bPhi \frac{\ba^k+\ba^{k+1}}{2}\right]
%\label{eq: kdv_rom3}
%\end{equation}
%with $\ba^0 = \bPhi^\top \bu^0$.
%
%
%%Motivated by the error analysis, we introduce the weighted gradient of the Hamiltonian function into the snapshot.
%We first study the impact of $\mu$, which is the weight of $\nabla_u H(u)$ in the snapshots, on the numerical performance of structure-preserving ROMs \eqref{eq: kdv_rom3} by varying the value of $\mu$.
%As a criterion, the error $\mathcal{E}_\infty$ is evaluated for accuracy.
%
%
%Figure \ref{Fig: lin_kdv_mu} shows the trend of $\mathcal{E}_\infty$ versus $\mu$ for $r= 40$ and $r= 60$.
%When $r= 40$, it is found that the minimum error is achieved at $\mu= 0$ and $\mathcal{E}_\infty= 0.0564$.
%But when the dimension of ROM increases to $r= 60$, the minimum error is achieved at $\mu= 1$ and $\mathcal{E}_\infty= 7.3064\times 10^{-4}$; when $\mu=0$, the error $\mathcal{E}_\infty= 7.3882\times 10^{-4}$.
%%
%\begin{figure}[htb]
%\centering
%\begin{minipage}[ht]{0.38\linewidth}
%\includegraphics[width=1\textwidth]{./KdvROMdataH_r40_mu-eps-converted-to.pdf}
%\end{minipage}
%\hspace{1cm}
%\begin{minipage}[ht]{0.38\linewidth}
%\includegraphics[width=1\textwidth]{./KdvROMdataH_r60_mu-eps-converted-to.pdf}
%\end{minipage}
%\caption{
%Maximum errors of the SP-ROM-0 simulation results versus the values of $\mu$: $r=40$ (left) and $r=60$ (right).
%}\label{Fig: lin_kdv_mu}
%\end{figure}
%
%It is observed that overall, the proposed structure-preserving ROM achieves better approximation as $r$ increases;
%it produces a good numerical solution when $\mu=0$ in general, and the results can be further improved by choosing $\mu$ optimally.
%However, to avoid the price paid for tuning the free parameter, in the rest of this example, we will focus on the case $\mu= 0$.
%
%\begin{figure}[htb]
%\centering
%%\begin{minipage}[ht]{0.41\linewidth}
%%\includegraphics[width=1\textwidth]{./KdvROMr40N500Nt500ICno_u}
%%\end{minipage}
%\begin{minipage}[ht]{0.41\linewidth}
%\includegraphics[width=1\textwidth]{./KdvROMr40N500Nt500ICno_e-eps-converted-to.pdf}
%\end{minipage}
%\hspace{1cm}
%\begin{minipage}[ht]{0.41\linewidth}
%\includegraphics[width=1\textwidth]{./KdvROMr60N500Nt500ICno_e-eps-converted-to.pdf}
%\end{minipage}
%\caption{Time evolution of the Hamiltonian function approximation error $\mathcal{H}_r(t)-\mathcal{H}(t)$ at $\mu= 0$: $r= 40$ (left) and $r= 60$ (right).
%Note that the error magnitudes do not change with time during the simulations.
%}\label{Fig: kdv_sprom0_r40}
%\end{figure}
%
%The time evolution of energy approximation errors in SP-ROM-0 with $\mu= 0$ are shown in Figure \ref{Fig: kdv_sprom0_r40} for $r= 40$ and $r= 60$, respectively.
%It is seen that, when the dimension increases from 40 to 60, the magnitude of the energy discrepancy reduces from $2.9817\times 10^{-4}$ to $9.1456\times 10^{-7}$.
%The associated maximum error $\mathcal{E}_\infty$ decreases from $0.0564$ to $7.3064\times 10^{-4}$ as expected.
%Since low dimensional cases are more interesting in practice, in the rest of this example, we will focus on improving the numerical performance of $40$-dimensional SP-ROMs by correcting the energy approximation.
%
%\subsubsection{SP-ROMs with corrected energy}
%%To correct energy, we consider two approaches as discussed in Section \ref{sec:imp}.
%\paragraph{Approach I. SP-ROMs with enriched POD basis (SP-ROM-1)}
%In this approach, one new basis function $\bpsi$ generated from the residual of the initial data is added to the basis set $\bPhi$, i.e., $\widetilde{\bPhi}= [\bPhi, \bpsi]$.
%
%The discrete structure-preserving ROM with enriched POD basis (SP-ROM-1) reads
%\begin{equation}
%\frac{\ba^{k+1}-\ba^k}{\Delta t} =
%\bA_r\widetilde{\bPhi}^\top\left[\frac{\alpha}{6}\left( (\widetilde{\bPhi}\ba^k)^2
%+(\widetilde{\bPhi}\ba^k)(\widetilde{\bPhi}\ba^{k+1})
%+(\widetilde{\bPhi}\ba^{k+1})^2 \right)
%+ \rho \widetilde{\bPhi} \frac{\ba^k+\ba^{k+1}}{2}
%+ \nu\bB\widetilde{\bPhi} \frac{\ba^k+\ba^{k+1}}{2}\right]
%\label{eq: kdv-sp-rom-1}
%\end{equation}
%with $\ba^0 = \widetilde{\bPhi}^\top \bu^0$.
%
%Since the residual information of initial data is included in the enriched basis, it is expected that the energy at initial time can be exactly captured, thus the structure-preserving ROM can preserve the exact energy.
%The $41$-dimensional SP-ROM-1 \eqref{eq: kdv-sp-rom-1} is simulated, whose energy approximation error is shown in Figure \ref{Fig: kdv_sprom1_r40} (left).
%It is observed that energy error $\mathcal{H}_r(t)-\mathcal{H}(t)\sim\mathcal{O}(10^{-12})$.
%Meanwhile, the maximum error $\mathcal{E}_\infty= 0.050168$.
%\begin{figure}[htb]
%\centering
%%\begin{minipage}[ht]{0.38\linewidth}
%%\includegraphics[width=1\textwidth]{./KdvROMr41N500Nt500ICenrich_u}
%%\end{minipage}
%\begin{minipage}[ht]{0.41\linewidth}
%\includegraphics[width=1\textwidth]{./KdvROMr41N500Nt500ICenrich_e-eps-converted-to.pdf}
%\end{minipage}
%\hspace{1cm}
%\begin{minipage}[ht]{0.41\linewidth}
%\includegraphics[width=1\textwidth]{./KdvROMr40N500Nt500ICshif_e-eps-converted-to.pdf}
%\end{minipage}
%\caption{Time evolution of energy error in the 41-dimensional SP-ROM-1 (left) and 40-dimensional SP-ROM-2 (right) when $\mu=0$. Note that the magnitude of $\mathcal{H}_r(t)-\mathcal{H}(t)$ is $\mathcal{O}(10^{-12})$, thus the energy is accurately captured in both models.
%}\label{Fig: kdv_sprom1_r40}
%\end{figure}
%
%
%\paragraph{Approach II. SP-ROMs with POD basis from shifted snapshots}
%In this approach, the POD basis is extracted from the shifted snapshots \eqref{eq: snap_shift}.
%The corresponding structure-preserving ROM with the new POD basis (SP-ROM-2) is to find $\ba^k$ satisfying
%\begin{eqnarray}
%\frac{\ba^{k+1}-\ba^k}{\Delta t} &=&
%\bA_r\bPhi^\top\Big[\frac{\alpha}{6}\left( (\bu_0+\bPhi\ba^k)^2
%+(\bu_0+\bPhi\ba^k)(\bu_0+\bPhi\ba^{k+1})
%+(\bu_0+\bPhi\ba^{k+1})^2 \right) \nonumber \\
%&+&  \rho (\bu_0+\bPhi \frac{\ba^k+\ba^{k+1}}{2})
%+ \nu\bB(\bu_0+\bPhi \frac{\ba^k+\ba^{k+1}}{2})\Big]
%\label{eq: kdv-sp-rom-2}
%\end{eqnarray}
%with $\ba^0 = {\bf 0}$.
%
%%We also expect the energy of the reduced-order approximation stays accurate.
%Consider the $r= 40$ case, the maximum error of the SP-ROM-2 simulation is $\mathcal{E}_\infty = 0.036574$.
%Time evolution of the energy error is plotted in Figure \ref{Fig: kdv_sprom1_r40} (right), which indicates no any visible discrepancy of the energy between the ROM and FOM since $\mathcal{H}_r(t)-\mathcal{H}(t)\sim \mathcal{O}(10^{-12})$.
%%the error of $u$ stays at the same magnitude and the approximation error of $v$ decreases comparing with the structure-preserving ROM with the standard POD basis.
%
%
%%\begin{figure}[htb]
%%\centering
%%\begin{minipage}[ht]{0.38\linewidth}
%%\includegraphics[width=1\textwidth]{./KdvROMr40N500Nt500ICshif_u}
%%\end{minipage}
%%\hspace{1cm}
%%\begin{minipage}[ht]{0.38\linewidth}
%%\includegraphics[width=1\textwidth]{./KdvROMr40N500Nt500ICshif_e}
%%\end{minipage}
%%\caption{The structure-preserving reduced-order approximation error (left) and Hamiltonian function $E_r(t)$ (right).
%%}\label{Fig: kdv_sprom_r40}
%%\end{figure}
%%%========================================
%%\subsection{Cahn-Hilliard (CH) Equation\label{sec: ch}}
%%%========================================
%%The Cahn-Hilliard equation arises as a phenomenological continuum model that describes the process of phase separation.
%%The equation is written as
%%\begin{equation}
%%u_t = \Delta (u^3-u-k\Delta u)
%%\end{equation}
%%defined in the domain $\Omega$ over time $[0, T]$.
%%The equation has the Hamiltonian formulation
%%\begin{equation}
%%u_t = \mathcal{N} \frac{\delta \mathcal{H}}{\delta u},
%%\label{eq: ch}
%%\end{equation}
%%where $\mathcal{N}$ is the Laplacian operator, $\mathcal{H}=\int_{\Omega} -\frac{u^2}{2}+\frac{u^4}{4}-\frac{\kappa}{2} u_x^2\, dx$.
%
%========================================
%\subsection{Summary of numerical experiments}
%%========================================
%We summarize the test cases in Tables \ref{tab: ex1}-\ref{tab: ex2}.
%\begin{table}[htp]
%\begin{center}
%\caption{Linear wave equations (Section \ref{sec: we}): comparison of ROMs (r=5)}
%\label{tab: ex1}
%\begin{tabular}{| c | c | c | c | c | c | c |} \hline
%  {}                              & FOM  &   G-ROM      & SP-ROM-0 ($\mu=0$)  & SP-ROM-1 ($\mu=0$)      & SP-ROM-2  ($\mu=0$) \\ \hline
%  $\mathcal{E}_\infty$ &  --      & 0.4591         & 0.2606         & 0.4138              & 0.1526      \\
%  $H_r$    			  & 0.075 & nonconst.    & 0.06788         & 0.075                & 0.075 \\     \hline
%\end{tabular}
%\end{center}
%\end{table}
%%
%\begin{table}[htp]
%\begin{center}
%\caption{Korteweg-de Vries equations (Section \ref{sec: kdv}): comparison of ROMs (r=40)}
%\label{tab: ex2}
%\begin{tabular}{| c | c | c | c | c | c | c |} \hline
%  {}                              & FOM  &   G-ROM      & SP-ROM-0  ($\mu=0$)  & SP-ROM-1 ($\mu=0$)    & SP-ROM-2 ($\mu=0$) \\ \hline
%  $\mathcal{E}_\infty$ &  --       & 0.02964         & 0.0564         & 0.05017              & 0.03657      \\
%  $H_r$    			  & -1.1317 & nonconst.    & -1.1314         & -1.1317                & -1.1317 \\     \hline
%\end{tabular}
%\end{center}
%\end{table}

%Based on the preceding two test experiments, we draw the following conclusions:
%(i) the structure-preserving ROMs (SP-ROM-0, SP-ROM-1, and SP-ROM-2) are able to keep the energy a constant;
%(ii) choosing an optimal weight $\mu$ in the snapshot set helps improve the accuracy of reduced-order approximations, but a more straightforward choice $\mu= 0$ can yields a good approximation without paying the price of tuning the free parameter;
%(iii) the structure-preserving ROMs with corrected energy (SP-ROM-1 and SP-ROM-2) are able to achieve  accurate Hamiltonian function; while SP-ROM-2 has the better accuracy in the state variable approximation than SP-ROM-1;
%(iv) overall, SP-ROM-2 obtains more accurate state variable solution and energy approximation, which outperforms the other ROMs discussed in this paper.
%
%\section{Conclusions}
%\noindent \indent One of the most important features of Hamiltonian PDE systems is possessing some invariant Hamiltonian functions, which represent important physical quantities such as the total energy of the system.
%The standard Galerkin projection-based POD-ROM is not able to inherit this property in its discretized system.
%In this paper, we develop new structure-preserving POD-ROMs for Hamiltonian PDE systems, which use the same Galerkin projection strategy, but keep the Hamiltonian constant by developing a new coefficient matrix for the reduced-order dynamical system.
%With the use of the POD basis from shifted snapshots, the structure-preserving ROM (SP-ROM-2) is able to produce an exact Hamiltonian and an accurate approximation of the state variables.
%Numerical experiments demonstrate the effectiveness of the proposed method.
%This approach can be easily extended to other systems such as port-Hamiltonian systems and dissipative gradient systems, which will be a explored in our future research.

%For deriving the {\em a priori} error estimate, we introduce the weighted gradient information of the Hamiltonian function into the snapshots.
%Our numerical results verifies by choosing an optimal weight, the SP-ROM is able to achieve the best accuracy.
%However, to avoid tuning the free parameter, we mainly focus on the case $\mu= 0$, which also performs well overall, although is not optimal.

%%============================================================
%\section{Choices on implementations\label{sec:imp}}
%%============================================================
%\noindent \indent In this section, we describe some details on the implementation.
%\subsection{Choice of snapshots}
%\noindent \indent Motivated by the error estimate in Section \ref{sec:err}, besides the collections of state variables $\bu(t_j)$ for $j=1, \ldots, M$, we also include in the snapshots weighted gradient information of the Hamiltonian function, $\mu \nabla_{\bu}H(\bu(t_j))$.
%Denote the snapshot matrix by
%\begin{equation}
%\bY=\left[\bu(t_1), \ldots, \bu(t_M), \mu\nabla_{\bu}H(\bu(t_1)), \ldots, \mu\nabla_{\bu}H(\bu(t_M))\right].
%\label{eq: snap}
%\end{equation}
%The POD basis $\bPhi$ functions are the dominant $r$ left singular vectors of the snapshot matrix.
%
%
%Correspondingly, based on Proposition \ref{pr:poderr}, we have the following POD projection errors under the assumption on the availability of the entire continuous trajectory:
%\begin{equation}
%\int_0^T
%  \Big\| \bu(t) - \bPhi \bPhi^\top \bu(t) \Big\|^2 \, d t
% +
%  \mu^2 \int_0^T
% \Big\| \nabla_{\bu}H(\bu(t)) - \bPhi \bPhi^\top \nabla_{\bu}H(\bu(t)) \Big\|^2 \, d t
%  = \sum\limits_{j=r+1}^d \lambda_j,
% \label{eq:poderr_h}
%\end{equation}
%where $\lambda_j$ is the $j$-th leading eigenvalue of the snapshot covariance matrix.
%
%
%
%%============================================================
%\section{Error estimate\label{sec:err}}
%%============================================================
%\noindent \indent In this section, we present an {\em a priori} error estimation of the SP-ROM \eqref{eq: ham_rom2}-\eqref{eq: Sr}.
%The derivation mainly follows the state space error estimation developed by Chaturantabut and Sorensen in \cite{chaturantabut2012state} for the POD-DEIM nonlinear model reduction.
%The difference lies in the structure of proposed SP-ROM and our choice of snapshots.
%In a sequel, we analyze the approximation error of the reduced-order simulation and we shall focus on the error caused by the POD truncation by suppressing the spatial and temporal discretization errors.
%
%
%Define the Lipschitz constant and logarithmic Lipschitz constant of a mapping $F: \mathbb{R}^n\rightarrow \mathbb{R}^n$, respectively, as follows:
%$$
%\mathcal{L}[F]= \sup_{\bu\neq \bv}\frac{\|F(\bu)-F(\bv)\|}{\|\bu-\bv\|},
%\quad \text{and} \quad
%\mathcal{M}[F]= \sup_{\bu\neq \bv}\frac{\left<\bu-\bv, F(\bu)-F(\bv)\right>}{\|\bu-\bv\|^2},
%$$
%where the Euclidian inner product $\left<\cdot, \cdot\right>: \mathbb{R}^d\times \mathbb{R}^d \rightarrow \mathbb{R}$ is for any positive integer $d$.
%The logarithmic Lipschitz constant could be negative, which was used in \cite{chaturantabut2012state} to show that the error of reduced-order solution is uniformly bounded on $t\in [0, T]$ when the map $F$ is uniformly negative monotonic.
%
%
%%\begin{lem}
%%Assume the entire continuous trajectory $\bu(t)$ is available on the whole time interval, the POD projection error of the snapshots satisfies
%%\begin{equation}
%%\int_0^T
%%  \Big\| \bu(t) - \bPhi \bPhi^\top \bu(t) \Big\|^2 \, d t
%%  +  \mu^2 \int_0^T
%%  \Big\| \nabla_{\bu}H(\bu(t)) - \bPhi \bPhi^\top \nabla_{\bu}H(\bu(t)) \Big\|^2 \, d t
%%  = \sum\limits_{j>r} \lambda_j,
%% \label{eq:poderr_new}
%%\end{equation}
%%where $\lambda_j$ is the $j$-th eigenvalue corresponding to $\phi_j$.
%%\end{lem}
%
%
%\begin{thm}
%Let $\bu(t)$ be the solution of the FOM \eqref{eq: ham_fom}, ${\ba}(t)$ be the solution of the SP-ROM  \eqref{eq: ham_rom2}-\eqref{eq: Sr} with the initial condition ${\ba}(t_0)= \bPhi^\top \bu(\cdot, 0)$, the POD approximation error satisfies
%$$
%\int_0^T \|\bu(t)-\bPhi{\ba}(t)\|^2\, dt \leq C(T, \mu)\sum\limits_{j=r+1}^{d} \lambda_j,
%$$
%where $\lambda_j$ is the $j$-th leading eigenvalue of the snapshot covariance matrix associated to the snapshots defined in \eqref{eq: snap}.
%\label{thm: 1}
%\end{thm}
%\begin{proof}
%Define the POD approximation error
%\begin{equation}
%\be= \bu-\bPhi {{\ba}} = \bu-\bPhi\bPhi^\top \bu+\bPhi\bPhi^\top \bu-\bPhi {{\ba}}= \rho+\theta,
%\label{eq:e0}
%\end{equation}
%where $\rho= \bu-\bPhi\bPhi^\top \bu$ and $\theta= \bPhi\bPhi^\top \bu-\bPhi {\ba}$.
%%Let ${\theta}= \bPhi^\top \bu- {\ba}$, then we have $\theta = \bPhi {\theta}$, and ${\theta}= \bPhi^\top \theta$ due to the orthogonality of the POD basis.
%%
%Note that
%\begin{equation}
%\frac{d}{dt}\|\theta\| = \frac{1}{2\|{\theta}\|}\frac{d}{dt}\|{\theta}\|^2= \frac{1}{\|{\theta}\|}\left<{\theta},\, \dot{{\theta}}\right>
%\label{eq:d_theta}
%\end{equation}
%and
%\begin{eqnarray}
%\dot{\theta} &=& \bPhi \bPhi^\top \dot{\bu} - \bPhi \dot{{\ba}} \nonumber \\
%		  &=& \bPhi \bPhi^\top \bD\, \nabla_{\bu} H(\bu)  - \bPhi \bD_r\, \nabla_{{\ba}} H(\bPhi {\ba}) \nonumber \\
%		  &=& \bPhi \bPhi^\top \bD\, \nabla_{\bu} H(\bu)  - \bPhi \bPhi^\top \bD\bPhi \bPhi^\top\, \nabla_{\bu} H(\bu) \nonumber \\
%		  &&+ \bPhi \bPhi^\top \bD\bPhi \bPhi^\top\, \nabla_{\bu} H(\bu) - \bPhi \bPhi^\top \bD\bPhi \bPhi^\top\, \nabla_{\bu} H(\bPhi \bPhi^\top\bu) \nonumber \\
%		  &&+\bPhi \bPhi^\top \bD\bPhi \bPhi^\top\, \nabla_{\bu} H(\bPhi \bPhi^\top\bu)-\bPhi \bPhi^\top \bD  \bPhi \bPhi^\top\nabla_{\bu} H(\bPhi {\ba}).
%\label{eq:d_theta00}		
%\end{eqnarray}
%Testing equation \eqref{eq:d_theta00} by $\theta$, we have, on the right-hand side of \eqref{eq:d_theta00},
%\begin{equation}
%\left<{\theta}, \bPhi \bPhi^\top \bD\, (I-\bPhi \bPhi^\top)\nabla_{\bu} H(\bu) \right>
% \leq \|\theta\|\, \|\bPhi \bPhi^\top \bD \|\, \|(I-\bPhi \bPhi^\top)\nabla_{\bu} H(\bu)\|,
% \label{eq:err_projH}
%\end{equation}
%\begin{equation}
%\left<{\theta}, \bPhi \bPhi^\top \bD\bPhi \bPhi^\top\, (\nabla_{\bu} H(\bu) - \nabla_{\bu} H(\bPhi \bPhi^\top\bu)) \right>
%\leq \|\theta\|\, \|\bPhi \bPhi^\top \bD \bPhi \bPhi^\top\|\, \mathcal{L}[\nabla_{\bu}H]\, \|(I-\bPhi \bPhi^\top)\bu\|,
% \label{eq:err_proju}
%\end{equation}
%\begin{equation}
%\left<{\theta}, \bPhi \bPhi^\top \bD\bPhi \bPhi^\top\, (\nabla_{\bu} H(\bPhi \bPhi^\top\bu) - \nabla_{\bu} H(\bPhi {\ba})) \right>
%\leq \mathcal{M}[ \bPhi \bPhi^\top \bD\bPhi \bPhi^\top\nabla_{\bu}H]\, \|\theta\|^2.
% \label{eq:err_MF}
%\end{equation}
%Let $C_1= \mathcal{M}[ \bPhi \bPhi^\top \bD\bPhi \bPhi^\top\nabla_{\bu}H]$,
%$C_2= \|\bPhi \bPhi^\top \bD \bPhi \bPhi^\top\|\, \mathcal{L}[\nabla_{\bu}H]$,
%and $C_3= \|\bPhi \bPhi^\top \bD \|$ and combine \eqref{eq:d_theta} with \eqref{eq:d_theta00}-\eqref{eq:err_MF}, we have
%\begin{equation*}
%\frac{d}{dt}\|\theta\| \leq C_1 \|\theta\| + C_2 \|\rho\| + C_3 \|\eta\|,
%\label{eq:d_theta0}
%\end{equation*}
%where $\eta= \nabla_{\bu} H(\bu)-\bPhi\bPhi^\top \nabla_{\bu} H(\bu)$.
%Applying Gronwall's lemma, for any $t\in [0, T]$, we get
%\begin{equation*}
%\|\theta(t)\| \leq \int_0^t e^{C_1 (t-\tau)} (C_2 \|\rho\| + C_3 \|\eta\|)\, d\tau,
%\label{eq:d_theta1}
%\end{equation*}
%where we used the fact that $\theta(0)=0$.
%Therefore, for any $t\in [0, T]$, we have
%\begin{equation*}
%\|\theta(t)\|^2 \leq \alpha(T)\left[C_2^2 \int_0^T \|\rho\|^2 dt+ C_3^2 \int_0^T \|\eta\|^2\, dt\right],
%\label{eq:d_theta2}
%\end{equation*}
%where $\alpha(T)= 2\int_0^T e^{2C_1 (T-\tau)}\, d\tau$.
%Hence,
%\begin{equation}
%\int_0^T\|\theta(t)\|^2\, dt \leq T \alpha(T)\left[C_2^2 \int_0^T \|\rho\|^2 dt+ C_3^2 \int_0^T \|\eta\|^2\, dt\right].
%\label{eq:d_theta3}
%\end{equation}
%A combination with \eqref{eq:poderr_h} and \eqref{eq:e0} indicates that the POD approximation error is bounded by
%$$
%\int_0^T \|\be(t)\|^2\, dt \leq C(T, \mu)\sum\limits_{j>r} \lambda_j,
%$$
%where $C(T, \mu)= 1+T\alpha(T)(C_2^2+C_3^2/\mu^2)$.
%\end{proof}
%
%
%\begin{thm}
%Let $\bu(t)$ be the solution of the FOM \eqref{eq: ham_fom} and ${\ba}(t)$ be the solution of the SP-ROM  \eqref{eq: ham_rom3} and \eqref{eq: Sr} with the initial condition ${\ba}(t_0)= {\bf 0}$, the POD approximation error satisfies
%$$
%\int_0^T \|\bu(t)-(\bu_0+\bPhi{\ba}(t))\|^2\, dt \leq C(T, \mu)\sum\limits_{j=r+1}^{d} \lambda_j,
%$$
%where $\lambda_j$ is the $j$-th leading eigenvalue of the snapshot covariance matrix associated to the shifted snapshots defined in \eqref{eq: snap_shift}.
%\end{thm}
%\begin{proof}
%Define $\bw= \bu-\bu_0$, we rewrite the FOM \eqref{eq: ham_fom} in terms of $\bw$ as follows.
%\begin{equation}
%\dot{\bw} = \bD\, \nabla_{\bu} H(\bu_0+\bw)
%\label{eq: ham_fom_v}
%\end{equation}
%with initial condition $\bw(t_0)= 0$.
%The approximation error of the SP-ROM \eqref{eq: ham_rom3} and \eqref{eq: Sr} is
%\begin{equation}
%\be= (\bu_0+\bw)-(\bu_0+\bPhi {{\ba}})= \bw-\bPhi {{\ba}},
%\end{equation}
%which can be analyzed in the same manner as that is done in Theorem \ref{thm: 1}.
%%\hfill $\blacksquare$
%\end{proof}


\section{Acknowledgements}
Z. Wang's research was partially supported by the National Science Foundation through grants DMS-1913073 and DMS-2012469, and by the US Department of Energy through grant SC0020270. 

%\nocite{*}
\bibliographystyle{abbrv} %plain
\bibliography{bib_structure,bib_thesis}
\end{document}
