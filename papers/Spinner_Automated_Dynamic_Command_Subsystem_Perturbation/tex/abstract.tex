\begin{abstract}
\noindent
Injection attacks have been a major threat to web applications. Despite the significant effort in \updated{fundamentally}{} thwarting injection attacks, protection against injection attacks remains challenging due to the sophisticated attacks that exploit the existing protection techniques' design and implementation flaws. 
In this paper, we develop \sysname, a system that provides general protection against \updated{command}{input} injection attacks, including OS/shell command, SQL, and XXE injection.
Instead of focusing on \updated{}{detecting} malicious inputs\updated{ and injected commands}{}, \sysname constantly randomizes underlying subsystems so that injected \updated{commands}{inputs (e.g., commands or SQL queries)} that are not properly randomized will not be executed, hence prevented. 
\updated{Further,}{} We revisit the design and implementation choices of previous randomization-based techniques and develop a more robust and practical \updated{randomization scheme to prevent}{protection against} various sophisticated \updated{command}{input} injection attacks.
\updated{}{To handle complex real-world applications,} we develop \updated{effective}{a bidirectional analysis that combines forward and backward} static analysis techniques \updated{that}{to} identify intended commands \updated{}{or SQL queries} \updated{in a target program}{} to ensure the \updated{intended commands are executed correctly}{correct execution of the randomized target program}. 
We implement \sysname for the shell command processor and two different database engines (MySQL and SQLite)\updated{}{ and in diverse programming languages including C/C++, PHP, JavaScript and Lua}. \updated{\sysname also supports diverse programming languages, including C/C++, PHP, JavaScript and Lua.}{}
Our evaluation results on \updated{32}{42} real-world applications including 27 vulnerable ones show that it effectively prevents a variety of \updated{command}{input} injection attacks with low \updated{}{runtime} overhead (\updated{3.74}{around 5}\%).

\end{abstract}
