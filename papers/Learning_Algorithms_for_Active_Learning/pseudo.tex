%
% Pseudo code for active learning loop.
%
%\begin{algorithmic}
%\begin{algorithm}[H]
%\SetAlgoLined
%\emph{\# encode items in S sets with context-sensitive encoder,} \\
%\emph{\# and encode items in E with context-free encoder} \\
%$S = \{(x, y)\}$, $S_0^u = \{(x, \cdot)\}$, $S_0^k=\emptyset$, $E = \{(\hat x, \hat y)\}$, $s_0$ \; \\
%\For{$t = 0 \ldots T-1$}{
%\emph{\# select next instance} \\
%$i \gets \texttt{SELECT}(S_{t}^u, S_{t}^k, s_{t})$\; \\
%\emph{\# read labeled instance and update controller} \\
%$(x_{i}, y_{i}) \gets \texttt{READ}(S, i)$\; \\
%$s_{t+1} \gets \texttt{UPDATE}(s_{t}, x_i, y_i)$ \\
%\emph{\# update known / unknown set} \\
%$S_{t+1}^k \gets S_{t}^k \cup \{(x_i, y_i)\}$ \\
%$S_{t+1}^u \gets S_{t}^u \setminus \{(x_i, y_i)\}$ \\
%\emph{\# perform fast prediction} \\
%$L_{t+1}^S \gets \texttt{FAST-PRED}(S, S_{t+1}^u, S_{t+1}^k, s_{t+1})$
%}
%\emph{\# perform slow prediction} \\
%$L_T^E \gets \texttt{SLOW-PRED}(E, S_{T}^u, S_{T}^k, s_T)$
%\caption{End-to-end active learning loop (for Eq.~\ref{eq:task_obj_training})}
%\label{alg:al_loop}
%\end{algorithm}
%\end{algorithmic}
%

\begin{algorithm}[H]
\begin{algorithmic}[1]
\STATE \# \emph{encode items in S with context-sensitive encoder}
\STATE \# \emph{and encode items in E with context-free encoder}
\STATE $S = \{(x, y)\}$, $S_0^u = \{(x, \cdot)\}$, $S_0^k=\emptyset$, $E = \{(\hat x, \hat y)\}$
\FOR{$t = 1 \ldots T$}
\STATE \emph{\# select next instance}
\STATE $i \gets \texttt{SELECT}(S_{t-1}^u, S_{t-1}^k, h_{t-1})$ 
\STATE \emph{\# read labeled instance and update controller}
\STATE $(x_{i}, y_{i}) \gets \texttt{READ}(S, i)$
\STATE $h_{t} \gets \texttt{UPDATE}(h_{t-1}, x_i, y_i)$
\STATE \emph{\# update known / unknown set}
\STATE $S_{t}^k \gets S_{t-1}^k \cup \{(x_i, y_i)\}$
\STATE $S_{t}^u \gets S_{t-1}^u \setminus \{(x_i, \cdot)\}$
\STATE \emph{\# perform fast prediction (save loss for training)}
\STATE $L_{t}^S \gets \texttt{FAST-PRED}(S, S_{t}^u, S_{t}^k, h_{t})$
\ENDFOR
\STATE \emph{\# perform slow prediction (save loss for training)}
\STATE $L_T^E \gets \texttt{SLOW-PRED}(E, S_{T}^u, S_{T}^k, h_T)$
\end{algorithmic}
\caption{End-to-end active learning loop (for Eq.~\ref{eq:task_obj_training})}
\label{alg:al_loop}
\end{algorithm}