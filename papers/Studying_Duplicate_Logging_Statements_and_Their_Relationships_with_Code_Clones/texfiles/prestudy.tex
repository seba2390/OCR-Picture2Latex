%\section{Preliminary Study}
\section{Identifying Duplicate Logging Statements for Manual Study}
\label{sec:prestudy}
%In this section, we describe how we define duplicate logging statements and how we identify them for conducting a manual study. We also introduce the studied systems. % from which duplicate logging statements will be studied.

\phead{Definition and how to identify duplicate logging statements.} %\ian{phead inconsistent, only first letter capital or every first letter of each word capital?}
We define duplicate logging statements as logging statements that have identical static text messages. We focus on studying the log message because such semantic information is crucial for log understanding and system maintenance~\cite{Shang:2014:ULL:2705615.2706065, Yuan:2012:CLP:2337223.2337236}. As an example, the two following logging statements are considered duplicate: ``{\em Unable to create a new ApplicationId in SubCluster}" {\em + \textbf{ subClusterId.getId()}}, and ``{\em Unable to create a new ApplicationId in SubCluster}" {\em + \textbf{ id}}.



To prepare for a manual study, we identify duplicate logging statements by analyzing the source code using static analysis. In particular, the static text message of each logging statement is built by concatenating all the strings (i.e., constants and values of string variables) and abstractions of the non-string variables.
We also extract information to support the manual analysis, such as the types of variables that are logged, and the log level (i.e., {\em fatal}, {\em error}, {\em warn}, {\em info}, {\em debug}, or {\em trace}). Log levels can be used to reduce logging overheads in production (e.g., only record {\em info} and more severe levels) and may target different phases of software maintenance (e.g., {\em debug} logs may be used for debugging and {\em info} logs may provide information for general audience)~\cite{Li2017, Yuan:2012:CLP:2337223.2337236}. If two or more logging statements have the same static text message, they are identified as duplicate logging statements. 
%We exclude logging statements with only one word since those logging statements usually do not contain much static information, and are usually used to record the value of a dynamic variable during system execution.

\begin{table}
    \caption{An overview of the studied systems. }
    \vspace{-0.2cm}
    \centering
    %\resizebox{\textwidth}{!} {
    \tabcolsep=6pt
    \begin{tabular}{lrrrrrrr}
        \toprule
        \textbf{System}& \textbf{Version}  & \textbf{LOC} & \textbf{NOL} &
        \textbf{NODL} & \textbf{NODS} \\
        %&&&&&&& \textbf{logs} & \textbf{logs}\\
        \midrule
        \textbf{Cassandra} & 3.11.1  & 358K & 1.6K &  113 (7\%)& 46 \\
        \textbf{CloudStack} & 4.9.3  & 1.18M & 11.7K &  2.3K (20\%)& 865 \\
        \textbf{Elasticsearch} & 6.0.0  & 2.12M & 1.7K & 94 (6\%)& 40 \\
        \textbf{Flink} & 1.7.1  & 177K & 2.5K &  467 (11\%)& 203 \\
        \textbf{Hadoop} & 3.0.0  & 2.69M & 5.3K & 496 (9\%)& 217 \\

        \midrule
        \textbf{Camel} & 2.21.1  & 1.68M & 7.3K &  2.3K (32\%)& 886 \\
        \textbf{Kafka} & 2.1.0  & 542K & 1.5K &  406 (27\%)& 104 \\
        \textbf{Wicket} & 8.0.0 & 381K & 0.4K &  45 (11\%)& 21 \\
        % cass non-dup median 7, 0.146 neg
        % cloud stack non-dup median 8, 0.045 neg
        % es non-dup median 7, 0.27 small
        % hadoop non-dup median 6, 0.08 neg
        \bottomrule
    \end{tabular}

    \noindent LOC: lines of code, NOL: number of logging statements, NODL: number of duplicate logging statements, NODS: number of duplicate logging statements sets.
    \vspace{-0.6cm}
    %}
    \label{table:systems}
\end{table}
\begin{comment}
\begin{table*}
    \caption{An overview of the studied systems. The top five systems are used for manual study in Section~\ref{sec:manual}. The bottom three systems are used for evaluating our duplicate logging code smell detection tool in Section~\ref{sec:results}.}
    \vspace{-0.2cm}
    \centering
    %\resizebox{\textwidth}{!} {
    \tabcolsep=7pt
    \begin{tabular}{lrrrrrrrr}
        \toprule
        \textbf{System}& \textbf{Version} & \textbf{Release date} & \textbf{LOC} & \textbf{Num$.$ of} &
        \textbf{Num$.$ of} & \textbf{Num$.$ of } & \textbf{Med$.$ words} & \textbf{Med$.$ words}\\
        &&&&\textbf{logs}&\textbf{dup$.$ logs} & \textbf{dup$.$ log sets} & \textbf{in dup$.$ logs} & \textbf{in non-dup$.$ logs}\\
        %&&&&&&& \textbf{logs} & \textbf{logs}\\
        \midrule
        \textbf{Cassandra} & 3.11.1 & Oct. 2017 & 358K & 1.6K &  113 (7\%)& 46 & 7 & 7\\
        \textbf{CloudStack} & 4.9.3 & Aug. 2017 & 1.18M & 11.7K &  2.3K (20\%)& 865 & 8 & 8\\
        \textbf{Elasticsearch} & 6.0.0 & Nov. 2017 & 2.12M & 1.7K & 94 (6\%)& 40 & 6 & 7\\
        \textbf{Flink} & 1.7.1 & Dec. 2018 & 177K & 2.5K &  467 (11\%)& 203 & 6 & 7\\
        \textbf{Hadoop} & 3.0.0 & Nov. 2017 & 2.69M & 5.3K & 496 (9\%)& 217 & 6 & 6\\

        \midrule
        \textbf{Camel} & 2.21.1 & Apr. 2018 & 1.68M & 7.3K &  2.3K (32\%)& 886 & 6 & 6\\
        \textbf{Kafka} & 2.1.0 & Nov. 2018 & 542K & 1.5K &  406 (27\%)& 104 & 5 & 7\\
        \textbf{Wicket} & 8.0.0 & May. 2018 & 381K & 0.4K &  45 (11\%)& 21 & 6 & 8\\
        % cass non-dup median 7, 0.146 neg
        % cloud stack non-dup median 8, 0.045 neg
        % es non-dup median 7, 0.27 small
        % hadoop non-dup median 6, 0.08 neg
        \bottomrule
    \end{tabular}
    \vspace{-0.6cm}
    %}
    \label{table:systems}
\end{table*}
\end{comment}
\phead{Studied systems.}
Table~\ref{table:systems} shows the statistics of the studied systems. We identify duplicate logging statements from the top five large-scale open source Java systems in the table for our manual analysis: Hadoop, CloudStack, Elasticsearch, Cassandra and Flink which are commonly used in prior studies for log-related research~\cite{Li2018, log_pattern_ICSE2017, DLFinderSRC,mehran_emse_2018,nemo_log_issue}. The studied systems also use popular Java logging libraries~\cite{nemo_logging_utility} (e.g., Log4j~\cite{log4j} and SLF4J~\cite{SLF4J}). Hadoop is a distributed computing framework, CloudStack is a cloud computing platform, Elasticsearch is a distributed search engine, Cassandra is a NoSQL database system, and Flink is a stream-processing framework. These systems belong to different domains and are well maintained. We study all Java source code files in the main branch of each system and exclude test files, since we are more interested in studying duplicate logging statements that may affect log understanding in production. In general, we find that there is a non-negligible number of duplicate logging statements in the studied systems (6\% to 20\%). 
%The median number of words in the duplicate logging statements are similar to that of non-duplicate logging statements (i.e., both range from 6 to 8 words). 
%The median number of words in the duplicate logging statements are similar to that of non-duplicate logging statements (i.e., both range from 6 to 8 words), which shows that they have a similar level of semantic information (in terms of the number of words).
