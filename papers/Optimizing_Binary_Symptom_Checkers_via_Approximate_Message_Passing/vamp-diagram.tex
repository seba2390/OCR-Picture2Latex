\begin{figure*}[ht!]
\centering
\begin{tikzpicture}[thick,scale=0.54, every node/.style={transform shape}]
%\begin{tikzpicture}
  % main blocs
  \node[block, fill=orange!15] (p_u) {\Large $p_\mathsf{\mathbf{d}}(\mathbf{d})$};
  \node[block, fill=blue!15, right= 5cm of p_u] (z_uv) {\Large $\mathbf{\mathsf{\mathbf{{z}}}=\mathbf{A}\,\mathsf{\mathbf{d}}}$};
  \node[block, fill=green!15, right= 5cm of z_uv,minimum width=3.5cm] (phi_z) {
  \mbox{\Large \hspace{-0.3cm}$\mathsf{\mathbf{{{s}}}} =\phi(\mathsf{\mathbf{{{z}}}} +\mathsf{\mathbf{{{w}}}})$}};
  %\node[blockV, fill=gray!15, above=5cm of z_uv] (p_v) {\Large $p_\textrm{\textbf{{\rv{V}}}}$};
  % extrinsic blocs
  \node[blockExt,right=of p_u, xshift=0.4cm, yshift=-1.5cm] (ext_pu_to_z_uv) {$\mathrm{\textbf{ext}}$};
  \node[blockExt,left=of z_uv, xshift=-0.4cm, yshift=1.5cm] (ext_z_uv_to_p_u) {$\mathrm{\textbf{ext}}$};
  \node[blockExt,right=of z_uv, xshift=0.4cm, yshift=-1.5cm] (ext_z_uv_to_y) {$\mathrm{\textbf{ext}}$};
  \node[blockExt,left=of phi_z, xshift=-0.4cm, yshift=1.5cm] (ext_y_to_z_uv) {$\mathrm{\textbf{ext}}$};
  %\node[blockExt,above=of z_uv, xshift=0.6cm, yshift=0.4cm] (ext_z_uv_to_v) {$\mathrm{\textbf{ext}}$};
  %\node[blockExt,below=of p_v, xshift=-0.6cm, yshift=-0.4cm] (ext_v_to_z_uv) {$\mathrm{\textbf{ext}}$};
  % Forward and backwward Arrows
  % P(U) to Z=XY
  \draw [-latex,very thick] ([yshift=-4.25em]p_u.east) -- 
  node [midway,below=0em,align=center ] { $\mathbf{\widehat{d}}^+_{\mathsf{p}}$}
  node [midway,below=1.6em,align=center ] {$\gamma_{\bm{\mathsf{d}}_{\mathsf{p}}}^+$}
  (ext_pu_to_z_uv.west);
  \draw [-latex,very thick] (ext_pu_to_z_uv) --
  node [midway,below=0em,align=center ] { $\mathbf{\widehat{d}}^+_{\mathsf{e}}$}
  node [midway,below=1.6em,align=center ] {$\gamma_{\bm{\mathsf{d}}_{\mathsf{e}}}^+$}
  ([yshift=-4.25em]z_uv.west)
  node [pos=0.25](ext_between_pu_z_uv){};
  % Z=XY to phi(Z)
  \draw [-latex,very thick] ([yshift=-4.25em]z_uv.east) --
  node [midway,below=0em,align=center ] { $\mathbf{\widehat{z}}^+_{\mathsf{p}}$}
  node [midway,below=1.6em,align=center ] {$\gamma_{\bm{\mathsf{z}}_{\mathsf{p}}}^+$}
  (ext_z_uv_to_y.west);
  \draw [-latex,very thick] (ext_z_uv_to_y) --
  node [midway,below=0em,align=center ] { $\mathbf{\widehat{z}}^+_{\mathsf{e}}$}
  node [midway,below=1.7em,align=center ] {$\gamma_{\bm{\mathsf{z}}_{\mathsf{e}}}^+$}
  ([yshift=-4.25em]phi_z.west)
  node [pos=0.25](ext_between_z_uv_y){};
  % phi(Z) to Z=XY
  \draw [-latex,very thick] ([yshift=4.25em]phi_z.west) --
  node [midway,above=0em,align=center ] { $\mathbf{\widehat{z}}^-_{\mathsf{p}}$}
  node [midway,above=1.6em,align=center ] {$\gamma_{\bm{\mathsf{z}}_{\mathsf{p}}}^-$}
  (ext_y_to_z_uv.east);
  \draw [-latex,very thick] (ext_y_to_z_uv) --
  node [midway,above=0em,align=center ] { $\mathbf{\widehat{z}}^-_{\mathsf{e}}$}
  node [midway,above=1.7em,align=center ] {$\gamma_{\bm{\mathsf{z}}_{\mathsf{e}}}^-$}
  ([yshift=4.25em]z_uv.east)
  node [pos=0.25](ext_between_y_z_uv){};
  % Z=XY to P(U)
  \draw [-latex,very thick] ([yshift=4.25em]z_uv.west) --
  node [midway,above=0em,align=center ] { $\mathbf{\widehat{d}}^-_{\mathsf{p}}$}
  node [midway,above=1.7em,align=center ] {$\gamma_{\bm{\mathsf{d}}_{\mathsf{p}}}^-$}
  (ext_z_uv_to_p_u.east);
  \draw [-latex,very thick] (ext_z_uv_to_p_u) --
  node [midway,above=0em,align=center ] { $\mathbf{\widehat{d}}^-_{\mathsf{e}}$}
  node [midway,above=1.7em,align=center ] {$\gamma_{\bm{\mathsf{d}}_{\mathsf{e}}}^-$}
  ([yshift=4.25em]p_u.east)
  node [pos=0.25](ext_between_z_uv_pu){};
  % Extrinsic Arrows
  \draw [-latex,very thick] (ext_between_pu_z_uv.center) --
  (ext_z_uv_to_p_u.south);
  \draw [-latex,very thick] (ext_between_z_uv_y.center) --
  (ext_y_to_z_uv.south);
  \draw [-latex,very thick] (ext_between_y_z_uv.center) --
  (ext_z_uv_to_y.north);
  \draw [-latex,very thick] (ext_between_z_uv_pu.center) --
  (ext_pu_to_z_uv.north);
  %\draw [-latex,very thick] (ext_between_z_uv_pv.center) --
  %(ext_v_to_z_uv.east);
  %\draw [-latex,very thick] (ext_between_pv_z_uv.center) --
  %(ext_z_uv_to_v.west);
\end{tikzpicture}
\caption{Block diagram of the generalized VAMP algorithm with its three modules: the prior modules $p_\mathsf{\mathbf{{{d}}}}(\bm{d})$, the linear minimum mean square estimator (LMMSE) module $\mathbf{\mathsf{\mathbf{{{z}}}}=\mathbf{A}\,\mathsf{\textbf{{{d}}}}}$ and the non linear block $\mathsf{\mathbf{{s}}} =\phi(\mathsf{\mathbf{{{z}}}} +\mathsf{\mathbf{{{w}}}})$. Each module uses the turbo principle (widely known in iterative decoding literature) to pass the extrinsic messages to its adjacent module.}
\label{fig:block-diagram}
\end{figure*}