%% LyX 2.3.7 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english,nofootinbib]{revtex4-2}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\setcounter{secnumdepth}{3}
\usepackage{color}
\usepackage{array}
\usepackage{booktabs}
\usepackage{textcomp}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{stackrel}
\usepackage{graphicx}
\usepackage{esint}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline
\providecommand{\tabularnewline}{\\}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage{babel}

\makeatother

\usepackage{babel}
\begin{document}
\title{Analysis for satellite-based high-dimensional extended B92 and high-dimensional
BB84 quantum key distribution}
\author{Arindam Dutta$^{1,2}$}
\email{arindamsalt@gmail.com}

\email{https://orcid.org/0000-0003-3909-7519}

\author{Muskan$^{1}$}
\email{muskan.1@iitj.ac.in}

\email{https://orcid.org/0009-0009-1630-8898}

\author{Subhashish Banerjee$^{1}$}
\email{subhashish@iitj.ac.in}

\email{https://orcid.org/0000-0002-7739-4680}

\author{Anirban Pathak$^{2\,}$}
\email{anirban.pathak@gmail.com}

\email{https://orcid.org/0000-0003-4195-2588}

\affiliation{$^{1}$Department of Physics, Indian Institute of Technology Jodhpur,
Jodhpur 342030, Rajasthan, India~\\
$^{2}$Department of Physics and Materials Science \& Engineering,
Jaypee Institute of Information Technology, A 10, Sector 62, Noida,
UP-201309, India}
\begin{abstract}
A systematic analysis of the advantages and challenges associated
with the satellite-based implementation of the high dimensional extended
B92 (HD-Ext-B92) and high-dimensional BB84 (HD-BB84) protocol is analyzed.
The method used earlier for obtaining the key rate for the HD-Ext-B92
is modified here and subsequently the variations of the key rate,
probability distribution of key rate (PDR), and quantum bit error
rate (QBER) with respect to dimension and noise parameter of a depolarizing
channel is studied using the modified key rate equation. Further,
the variations of average key rate (per pulse) with zenith angle and
link length in different weather conditions in day and night considering
extremely low noise for dimension ${\rm d}=32$ are investigated using
elliptic beam approximation. The effectiveness of the HD-(extended)
protocols used here in creating satellite-based quantum key distribution
links (both up-link and down-link) is established by appropriately
modeling the atmosphere and analyzing the variation of average key
rates with the probability distribution of the transmittance (PDT).
The analysis performed here has revealed that in higher dimensions,
HD-BB84 outperforms HD-Ext-B92 in terms of both key rate and noise
tolerance. However, HD-BB84 experiences a more pronounced saturation
of QBER in high dimensions. 
\end{abstract}
\maketitle

\section{introduction}

In an information-centric society, safeguarding communications and
data emerges as a fundamental necessity. This necessity spans various
applications, including but not limited to financial transactions,
upholding individual privacy, and preserving the integrity of vital
components within the Internet of Things. Cutting-edge classical cryptosystems
like Rivest-Shamir-Adleman (RSA) algorithm provide security that hinges
on the computational complexity of a problem and associated assumptions
about the computational power of the adversaries \cite{RSA83}. However,
these assumptions can be compromised once large-scale quantum computers
come into play \cite{XMZ+20}. The remedy for this challenge is provided
by a relatively recent cryptographic concept known as quantum key
distribution (QKD) \cite{BB84,E91,BBM92,SAR+04}. Its security remains
unaffected by algorithmic or computational progressions \cite{CJC+20}.
QKD enables the creation of symmetric keys between remote entities
or parties, ensuring a level of confidentiality that is inherently
constrained by the fundamental laws of physics \cite{P13,DP+22}.
The polarization of light (photons) is a degree of freedom that is
often utilized to realize different schemes for QKD and other schemes
for secure quantum communication \cite{PRM+14,VZJ+17,ZZW18,HS20,BO22,TKO+17,DP23,DP+23}.
Drifting qubits encoded in photons have the potential to be distributed
over a distance of at most a few hundred kilometers through optical
fibers \cite{IMT+13,BLH+15,WJS+20,SPC+09}. To extend these distances
further, the utilization of quantum repeaters has been proposed \cite{BDC+98,SSR+11},
but quantum repeaters are not yet commercially available. Further,
maintaining light polarization possesses practical difficulties in
long-distance QKD protocols. In the case of QKD protocols based on
optical fiber, the polarization state is susceptible to alterations
caused by random fluctuations of birefringence in the optical fiber
\cite{VR99,GK2000}. Further, the diminishing signal strength and
the interference from ambient noise experienced during QKD transmissions
via optical fibers hinder the attainment of substantial key rates
beyond networks of metropolitan proportions \cite{TTS+11,BAL17}.
An alternative solution involves the proper utilization of optical
satellite links, which can potentially overcome the limitations on
transmission distances encountered by ground-based photonic communication
schemes \cite{UJK+09,SWU13,SB19}. When dealing with open space conditions,
while polarization exhibits greater resilience against atmospheric
turbulence, in the reference frame of the satellite, variation of
polarization is observed due to the motion of the satellite. This
introduces a negative impact \cite{KSD+05,ZDD17,ZJF+21}, and it becomes
crucial to address these polarization fluctuations issues in both
free-space and fiber-based QKD systems \cite{P21,P+21}. Traditional
approaches for addressing this challenge encompass the utilization
of active polarization tracking devices \cite{XWF+09,TTS+11,DCC+17,LGL+18,NBB+22,LKB+22}.
An alternative approach through a proof-of-principle experiment was
proposed in 2023 \cite{CGC+23}. Here, quantum state tomography was
used to determine the optimal measurement bases for a single party.
Moreover, embedding quantum technology within space platforms offers
an avenue for conducting fundamental experiments in physics \cite{RJC+12,JPR+18}\textcolor{red}{{}
}and pioneering innovative concepts like quantum clock synchronization
\cite{GLM01,GLM+01,HLK09} and quantum metrology \cite{ABS+14}. Although
this endeavor presents significant technological challenges, a variety
of experimental investigations \cite{UTM+07,VJT+08,FUH+09,YRL+12,WYL+13,NMR+13,CLY+13,PKB+17}
alongside theoretical inquiries \cite{SWU13,BTD09} have showcased
the feasibility of this approach. These studies have demonstrated
the viability of this approach using state-of-the-art technology already
in use on the ground and approved for space operations \cite{TCT+22,VVM19}.
In fact, over the last decade, numerous experiments in free-space
conditions have been conducted to assess the practicality of QKD setups
on mobile platforms, encompassing diverse vehicles like hot-air balloons
\cite{WYL+13}, trucks \cite{BHG+15}, aircraft \cite{NMR+13,PKB+17},
and drones \cite{LTG+20}. Consequently, in what has been characterized
as the \emph{quantum space race} \cite{JH13}, multiple international
research groups in countries like Canada, Japan, Singapore, Europe,
and China have been actively participating and trying to establish
stable space-based communication channels \cite{BAL17,KHN+18}. Notably,
these efforts have seen the successful launch of satellites with payloads
capable of being used in quantum communication \cite{YCLL+17,LCL+17,TCF+17,LLR+17,YLL+20,YCL+17,RXY+17}.
The advancement of quantum technology has been greatly influenced
by the healthy competition among the researchers \cite{TCT+16,TCTC+16,SVF+16},
driving notable progress in quantum nonlinear optics, entangled photon
generation techniques, and single photon detection in recent years.
Given these remarkable technological strides, it is imperative to
reevaluate the enhanced performance aspects of QKD through typical
free-space connections. This reevaluation particularly focuses on
the considerable rise in secure key generation rates compared to earlier
experiments \cite{PYB+05,MLK+06,UTM+07,ECL+08,SUF+09} (see Figure
1 of Ref. \cite{ELH+21}). While this analysis (refer to Figure 1
of Ref. \cite{ELH+21}) does not incorporate field tests utilizing
prepare-and-measure schemes, it is worth noting that both terrestrial
\cite{MWF+07,DBD+23} and satellite-based \cite{LCL+17,LCH+18} studies
have effectively demonstrated decoy-state key exchange across free-space
links at high rates. Furthermore, entanglement-based QKD protocols
eliminate the necessity to place trust in the source of the satellite
in a dual down-link scenario. Motivated by these facts, in the present
work we wish to investigate the effectiveness of two specific protocols
for QKD for the long-distance free-space secure quantum communication
to be implemented with the assistance of a satellite. Before we specifically
mention the protocols selected here for the investigation, we would
like to briefly mention the logical evolution of the relevant protocols
that led to the protocols of our interest. 

The first protocol for QKD was proposed by Bennett and Brassard in
1984 (BB84 protocol) \cite{BB84}. From the introduction of the BB84
protocol, there has been a continuous progression in both theoretical
and practical aspects of QKD \cite{SPC+09,SPR17,PAB+20}. Nonetheless,
owing to the formidable challenges posed by the generation, maintenance,
and manipulation of quantum resources using current technologies,
there has been a concerted effort to formulate QKD protocols with
more straightforward conceptual frameworks such that the protocols
would require fewer quantum resources. For instance, the BB84 protocol
itself involves four quantum states and two measurement bases. In
1992, Bennett introduced a notably simpler QKD protocol named B92,
which relies solely on two non-orthogonal states and two measurement
bases \cite{B92}. However, B92 exhibits a heightened susceptibility
to noise in contrast to alternative protocols like BB84, as indicated
in the original paper \cite{B92}. Subsequently, in 2009, Lucamarini
et al. \cite{LGT09} introduced an extended version of B92 (Ext-B92),
incorporating two extra non-informative states to more effectively
constrain Eve's information gain. BB84, B92, and Ext-B92 protocols
and most of the other existing protocols for QKD utilize qubits, which
are two-dimensional systems, as the means of communication between
Alice and Bob. Nevertheless, there have been limited investigations
concerning the susceptibility of qudit-based schemes (i.e., schemes
utilizing key encoding on ${\rm d}$-level systems) to eavesdropping
in the case of high dimensional systems. Initiatives are currently
underway to establish and investigate qudit systems within laboratory
settings \cite{ZYW+22,MML+23}. Quantum systems with dimensions higher
than two have demonstrated numerous benefits and intriguing characteristics
compared to protocols based on qubits (as briefly discussed in \cite{DLB+19}).
There have been several studies related to their continuous variable
counterparts (\cite{PAT+19} and references therein). Further, certain
protocols have exhibited the ability to tolerate high levels of channel
noise as the system dimension expands, as evidenced by various studies
\cite{PT200,SS10,VKM+18,STP+16}. Motivated by these facts, in this
article, we assess the performance of the key rate under different
scenarios for the HD-Ext-B92 and HD-BB84 protocols. We calculate the
key rate of the HD-Ext-B92 scheme without the inclusion of extra independent
variables, in contrast to the method outlined in Ref. \cite{IK21},
which is explained further in Appendix A. We utilize the channel transmission
$\eta$ to evaluate our results, focusing on light propagation through
atmospheric links using the elliptic-beam approximation originally
presented by Vasylyev et al. \cite{VSV16,VSV+17}. Additionally, we
incorporate the generalized approach and varying weather conditions
introduced in \cite{LKB19}. Specifically, we investigate the applications
of these models in quantum communication using \emph{Low Earth Orbit}
(LEO) satellites. Here, it may be noted that the methodology proposed
in \cite{VSV16,VSV+17,LKB19} has a notable impact on the transmittance
value, which is influenced by beam parameters and the diameter of
the receiving aperture. 

Before delving into our main text, it is important to state that a
satellite-based link is of two distinct types: the up-link and the
down-link. These links should not be considered symmetrical due to
the crucial distinction in the order of signal beam traversal through
the atmosphere and space. In the up-link scenario, the signal beam
first encounters the atmosphere, where it is subject to the effects
of turbulence and scattering particles. It then proceeds into the
expanse of space over long distances, where beam broadening becomes
the dominant factor affecting its characteristics. Conversely, in
the down-link scenario, the beam travels through space first and then
through the atmosphere. In this scenario, the primary factor influencing
the signal beam's journey through extended space is the pointing error.
This contrast in the order of traversal results in unique requirements
for the receiving equipment on the ground and in space \cite{BSH+13,LKB19}.

This work is organized as follows. In Section \ref{sec:II}, we provide
a detailed overview of the underlying theory of the HD-Ext-B92 and
HD-BB84 protocols, as well as a comprehensive examination of the impact
of atmospheric conditions on satellite communication links and the
elliptical approximation of beam deformation at the receiver. Appendix
A is dedicated to the necessary calculations to derive the key rate
for the HD-Ext-B92 protocol. In Section \ref{sec:III}, an extensive
investigation is done on the performance of these two high-dimensional
protocols with the help of the appropriate illustration of the results
of the simulation. Finally, we summarize our paper with the findings
being consolidated and deliberated upon in Section \ref{sec:IV}.

\section{Preliminaries: High-dimensional B92 and BB84 protocols and Elliptic
beam approximation \label{sec:II}}

Numerous researchers have extensively investigated the unconditional
security of QKD-based protocols, and their research, (see for examples,
\cite{TKI03,M13}) has consistently revealed increasingly robust results.
For instance, in \cite{M13}, a noise tolerance of 6.5\% was reported
for the B92 protocol. Depending on the user's selected key encoding
states, the noise tolerance for this B92 protocol can extend up to
11\% in the asymptotic scenario, as demonstrated in \cite{LGT09}.
This level of noise tolerance is comparable to that of BB84. In scenarios
with a finite key length, as indicated in \cite{AK20}, the protocol
still maintains a minimum noise tolerance of 7\%. In this context,
we summarize the key-rate analysis for HD-Ext-B92 and HD-BB84 protocols.
We modify the calculation for HD-Ext-B92 using a theorem to eliminate
any additional free parameters (as detailed in Appendix A). Additionally,
we briefly delve into the methodology of elliptical beam approximation,
designed to encompass satellite-based connections while accounting
for signal losses in various real-world scenarios, including diverse
weather conditions. This methodology is particularly tailored for
application in LEO satellite contexts. 

\subsection{High-dimensional extended B92 protocol and high-dimensional BB84
protocol \label{subsec:HD-Ext-B92=000026HD-BB84}}

\subsubsection{HD-Ext-B92}

Here, we summarize the HD-Ext-B92 protocol and recap some important
steps involved in the parameter estimation process proposed in Ref.
\cite{IK21}. In fact, in this section, after briefly discussing the
HD-Ext-B92 protocol we modify the derivation of the asymptotic key
rate given in \cite{IK21}. Before explaining the protocol, we would
like to introduce the notations used and the methodology for achieving
key rate. $|m\rangle$ and $|n\rangle$ are the fixed states and defined
from d-dimensional computational basis states $\{Z\in|1\rangle,\cdots,|m\rangle,|n\rangle,\cdots,|{\rm d}\rangle\}$,
and $|\psi\rangle=\frac{1}{\sqrt{2}}\left(|m\rangle+|n\rangle\right)$
is a fixed state which is chosen from d-dimensional diagonal basis
($X$-basis) states.

\emph{State preparation and transmission: }Alice randomly chooses
key-round and test-round. The key-round is employed for generating
raw key bit and test-round is employed to estimate error for this
protocol. Alice prepares a sequence with states $|m\rangle$ and $|\psi\rangle$
to encode classical bit values $0$ and $1$ in key-round, respectively,
and sends it to Bob. The basis information is kept secret. If this
is a test-round, she uniformly prepares the states $|m\rangle$, $|n\rangle$,
or $|\psi\rangle$ with random choice and sends the sequence to Bob
keeping the basis information secret until he measures the sequence.

\emph{Measurement and classical announcement:} In a key-round, after
getting the sequence from Alice, Bob will measure each state of the
received sequence either with $Z$ basis or by a POVM bases defined
by $\left\{ |\psi\rangle\langle\psi|,I-|\psi\rangle\langle\psi|\right\} $
and referred to as POVM $X$,\textcolor{red}{{} }where $I$ denotes
d-dimensional identity operator. Bob sets the bit value as $1$ when
he observes $I-|m\rangle\langle m|$ by using measurement basis $Z$,
i.e., any measurement outcome in $Z$ basis other than $|m\rangle\langle m|$;
and he sets bit value $0$ when his measurement outcome using POVM
$X$ is other than $|\psi\rangle\langle\psi|$. All other results
are not taken into account as conclusive measurements. Alice and Bob
discard the iteration for inconclusive outcomes in key-round, and
determine the channel error rate in test-round by announcing their
basis choices and measurement results using an authenticated classical
channel. Finally, they run the error correction and privacy amplification
protocols to get the final secure key.

In their work \cite{IK21}, authors proposed a collective attack by
Eve in which she can independently and identically attack each round
of the protocol. Eve also can delay measurement on her register (quantum
memory) after completion of the protocol. The Devetak Winter key rate
equation \cite{DW05,RGK_05} is used to compute the key rate in the
asymptotic limit\footnote{For instance, we are interested in seeing the performance of satellite-based
communication in the infinitely generated raw key scenarios.}:

\begin{equation}
R\left(a,b,E\right)=\underset{N\longrightarrow\infty}{{\rm lim}}\frac{l}{N}={\rm inf}\left[S\left(a|E\right)-H\left(a|b\right)\right],\label{eq:Key-rate equantion}
\end{equation}
this analysis helps us to obtain the minimum value of the key rate
by subtracting conditional Shannon entropy $H\left(a|b\right)$ from
conditional von Neumann $S\left(a|E\right)$. Here, $S\left(a|E\right)$
is defined as the entropy or the uncertainty present in Alice's classical
register $a$ given Eve's quantum memory $E$ and $H\left(a|b\right)$
denotes the entropy present in Alice's register $a$ given Bob's classical
register $b$. Here, $l$ is determined as a number of secret key
bits over the transmission of $N$ number of raw key. In Eq. (\ref{eq:Key-rate equantion}),
$R$ elucidates the infimum value of key rate under all collective
attacks performed by Eve. We apply a \emph{Theorem }\cite{K16} and
analyze the \emph{parameter estimation} (see Ref. \cite{IK21}) to
derive $S(a|E)$ and $H(a|b)$. By utilizing these findings we can
determine the lower bound of key rate (see Appendix A). 

\subsubsection{HD-BB84}

In a two-level system, BB84 \cite{BB84} protocol is well studied
both in theoretical and experimental domains. Essentially two-dimensional
quantum states (qubits) are used to realize this scheme for QKD which
uses two mutually unbiased bases randomly. In a more general scenario,
higher dimensional systems (qudits) can be used to realize the same
task (i.e., QKD), and such a modified version of BB84 protocol is
referred to as \emph{qudit}- (i.e., a quantum state in ${\rm d}$-dimensional
Hilbert space) based BB84 protocol or HD-BB84 protocol. Here, we briefly
discuss the HD-BB84 protocol \cite{CBK+02} and the necessary formulae
to compute the secret key rate. In this protocol, sender Bob sends
a qudit sequence to the receiver Alice after preparing each qudit
randomly in one of the possible states where the basis is also selected
randomly between one of the two mutually complementary bases. Alice
also applies measurement operation on the qudit by randomly choosing
one of these two bases. Subsequently, they announce their bases choice
in a public authenticated classical channel \cite{CBK+02}) and obtain
correlated ${\rm d}$-ary random variables when they use the same
bases (considering noise-free quantum channel). With $\frac{1}{2}$
probability, Alice and Bob use different bases and yield uncorrelated
results which are considered as discarded data after key-sifting sub-protocol.
This method ensures that any effort made by an eavesdropper, Eve (who
is unaware of the chosen basis), to obtain information about Bob's
state will result in an error in transmission, which can subsequently
be detected by the legitimate parties.

To ensure a smooth comprehension of readers we would like to provide
a concise overview of key points discussed in Ref. \cite{BCC+10}.
in Ref. \cite{BCC+10}, authors have modified the Maassen and Uffink
bound \cite{K87,MU88} to establish a new bound on the uncertainties
associated with the measurement results, contingent on the amount
of entanglement between the measured particle $(A)$, and the quantum
memory ($B)$. This relationship can be expressed mathematically as,

\begin{equation}
S\left(Z|B\right)+S\left(X|B\right)\ge\log_{2}\frac{1}{C}+S\left(A|B\right),\label{eq:First_Bound}
\end{equation}
where, $Z$ and $X$ are two possible observable like measurement
bases and $A$ refers to the qudit measured by Alice which is sent
by Bob and $B$ refers to the qudit which represents the quantum memory
of Bob. $S$ represents von Neumann entropy and $S\left(A|B\right)$
quantifies the amount of entanglement between $A$ and $B$. $C:={\rm max_{i,j}|\langle\phi_{i}|\psi_{j}\rangle|^{2}}$,
where $|\phi_{{\rm i}}\rangle$ and $|\psi_{{\rm j}}\rangle$ are
the eigenvectors of $Z$ and $X$, respectively. Using a result established
by Devetak and Winter \cite{DW05}, the minimum limit on the quantity
of key that Alice and Bob can extract from each state can be expressed
as $S\left(Z|E\right)-S\left(Z|B\right)$\footnote{Here, Z and X can be employed in a similar manner or with a similar
effect.}. This limit is applied when the eavesdropper is trying to obtain
the key from the composite quantum system\footnote{Eve performs an entanglement operation using her ancillary state $E$
with Alice's state ($A$) and Bob's quantum memory ($B$).} $\rho_{ABE}$, where $A$ is Alice's particle, $B$ is Bob's quantum
memory, and $E$ is Eve's ancillary state. Equation (\ref{eq:First_Bound})
may be reformulated as $S\left(Z|E\right)+S\left(X|B\right)\ge{\rm \log_{2}}\frac{1}{C}$
(see Supplementary Information of \cite{BCC+10}), and the key rate
equation may be written as $r\left(A,B,E\right)\ge{\rm log}_{2}\frac{1}{C}-S\left(Z|B\right)-S\left(X|B\right)$.
Since ${\rm \log_{2}}\frac{1}{C}$ cannot exceed ${\rm \log_{2}}{\rm d}$
and using Fano's inequality\footnote{Fano's inequality: $S\left(Z|B\right)\le h\left(q\right)+q\log_{2}\left({\rm d}-1\right)$. },
we can obtain

\begin{equation}
\begin{array}{lcl}
r & \ge & \log_{2}{\rm d}-2\left(h\left(q\right)+q\log_{2}\left({\rm d}-1\right)\right)\end{array}.\label{eq:Key_rate_HD_BB84}
\end{equation}
For the binary encoding and decoding scheme the conditional entropy
of Alice's measurement outcome given Bob's measurement result is equal
to $h\left(\varepsilon\right)$, where $\varepsilon$ is quantum bit
error rate (QBER) \cite{CRE_04,BMA+09}. Here, $q$ is the depolarizing
channel parameter i.e., the probability that outcome of the $Z$ by
Alice and Bob is not equal and $h$ is binary entropy.

\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.5]{KeyRate_Noise_QBER}
\par\end{centering}
\caption{\label{fig:Keyrate_Noise_QBER}(Color online) Plot of variation of
key-rate and QBER with channel noise parameter (both plots share a
common legend): (a) key-rate and QBER analysis of HD-Ext-B92 protocol
with noise parameter (q) for different dimensions in Hilbert space
(the plot lines representing QBER for all dimensions are superimposed),
(b) key-rate and QBER analysis of HD-BB84 protocol with noise parameter
(q) for different dimensions in Hilbert space.}
\end{figure}

To analyze the behavior of the key rate per pulse and the QBER concerning
the noise parameter in both the above-discussed HD protocols, we utilize
the key rate equations (refer to Eqs. (\ref{eq:Key-rate equantion}),
(\ref{eq:Key_rate_HD_BB84}), and Appendix A) and the binary QBER
function $\left(h\left(\varepsilon\right)\right)$. Now, we analyze
the result illustrated in Figure \ref{fig:Keyrate_Noise_QBER} for
HD-Ext-B92 and HD-BB84 schemes. We can observe in the HD-Ext-B92 protocol
that events with mismatched bases are not disregarded, which occurs
when Alice and Bob employ different measurement bases. These events
can significantly enhance key generation rates \cite{IK21,BHP93,WMU08,MW08,TCK+14},
and therefore noise tolerance is also increased for this scheme which
is evident from the graph. We plot the variation of the key rate of
HD-Ext-B92 protocol with noise parameter (${\rm q}$) in a depolarizing
channel in the ${\rm d}$-dimensional Hilbert space; we also depict
the variation of QBER with the same noise parameter $({\rm q})$.
It may be observed that as the value of ${\rm d}$ increases, the
tolerance for noise also increases, showing a rise from $7\%$ to
$10\%$. It is apt to note that, the maximum tolerable noise is dependent
on the choice of both the depolarizing channel and of Eve's ancilla
state, since, these two factors significantly impact parameter estimation
and consequently affect the key rate. Nevertheless, our analysis is
confined to a specific choice of these two factors, which have been
outlined in Appendix A. In Figure \ref{fig:Keyrate_Noise_QBER} (a),
it becomes evident that the QBER remains constant across different
${\rm d}$ values. The plots representing the distinct ${\rm d}$
values (i.e., ${\rm d}=2,4,8,16,32$) overlap in QBER analysis, indicating
consistent outcomes for higher-dimensional cases of the HD-Ext-B92
protocol. Additionally, the graph (represented by a dotted line) demonstrates
that the QBER reaches a saturation point for a particular ${\rm q}$
value (for HD-Ext-B92). We have computed the initial point where the
QBER begins to rise for various ${\rm q}$ values and observed a physically
reasonable variation. For instance, when ${\rm q}$ is $\sim0.005$,
the QBER is approximately $0.015$. As the ${\rm q}$ value increases
to $\sim0.1$, the QBER saturates at approximately at $0.088$. Now,
we analyze the plots for HD-BB84 in Figure \ref{fig:Keyrate_Noise_QBER}
(b) and undertake a comprehensive comparison with HD-Ext-B92. A numerical
assessment reveals that the key rate increases as the value of ${\rm d}$
rises for HD-BB84. Conversely, in HD-Ext-B92, the minimum key rate
remains fairly consistent for all ${\rm d}$ values which is around
$0.7$. Further, the noise tolerance is increased significantly with
a greater value of ${\rm d}$ in HD-BB84. For instance, the tolerable
noise is $\sim11\%$ for ${\rm d}=2$ (for qubit) and with the increased
value of ${\rm d}=32$, this limit increases to $\sim32\%$. This
outcome demonstrates the advantage of opting for the HD-BB84 protocol
over HD-Ext-B92 when considering aspects like key rate and noise tolerance.
HD-BB84 surpasses the HD-Ext-B92 protocol. It is worth mentioning
that in the original scheme of HD-Ext-B92 \cite{IK21}, authors do
not employ two complete bases as HD-BB84 does. In their approach,
they utilize a simplified version in which Alice's requirement is
reduced to transmitting just three states, and Bob only needs to carry
out partial measurements within the second basis \cite{IK21}. Additionally,
it is important to highlight that they did not select an optimal basis
configuration. Alternate choices for the encoding state might yield
greater key rates for the HD-Ext-B92 protocol, as shown in cases involving
qubits \cite{LGT09,K16}. If we examine the QBER aspect within the
context of HD-BB84, it becomes apparent that the variation of QBER
with the noise parameter ($q$) rapidly converges to a saturation
value ($\sim0.25$) as the dimension of qudit increases. In contrast
to the HD-Ext-B92 protocol, the susceptibility of QBER to noise is
notably more vulnerable in the HD-BB84 protocol. Moreover, as depicted
in Figure \ref{fig:Keyrate_Noise_QBER}, when considering ${\rm d}=32$,
the saturation point of noise tolerance is attained in the HD-Ext-B92
protocol. In contrast, in the HD-BB84 protocol, the rate at which
noise tolerance increases becomes progressively lower as ${\rm d}$
increases. It is noteworthy that at ${\rm d}=32$, the QBER has not
yet reached its saturation point (for HD-BB84); this point will be
reached at higher values of ${\rm d}$.

\subsection{Satellite-based optical links: model used for the elliptic beam approximation\label{subsec:Elliptic_Beam_Model}}

In this article, we aim to analyze the performance of key rates in
various situations of HD-Ext-B92 and HD-BB84 protocols. The channel
transmission $\eta$ for the light propagation through atmospheric
links using elliptic-beam approximation as introduced by Vasylyev
et al. \cite{VSV16,VSV+17} will be employed to perform the analysis.
Further, in what follows, we impose the generalized approach\footnote{Using non-uniform link between a satellite and the ground station,
referred to in Eq. (\ref{eq:Down-Link and Up-Link condition}).} and different weather conditions as introduced in \cite{LKB19}.
This method yields an impact on the value of transmittance as the
transmittance is determined by beam parameters along with the diameter
of the receiving aperture. To provide readers with a clearer understanding
of both the elliptic beam approximation and its modified version in
a more comprehensive manner, in this section, we offer a succinct
explanation of the underlying theory.

Temporal and spatial fluctuations in temperature and pressure within
turbulent atmospheric flows result in random variations of the air's
refractive index. Consequently, the atmosphere introduces losses to
transmitted photons, which are detected at the receiver through a
detection module featuring a limited aperture. The transmitted signal
undergoes degradation due to phenomena like beam wandering, broadening,
deformation, and similar effects. We can examine this scenario by
focusing on a Gaussian beam propagating along the z axis, reaching
the aperture plane positioned at a distance $z={\rm L}$. The Gaussian
beam is directed through a link that spans both the atmosphere and
vacuum, originating from either a transmitter situated in orbit or
a ground station. The link is characterized by non-uniform conditions.
Generally, the varying intensity transmittance of such a signal (received
beam) via a circular aperture of radius $r$ of the receiving telescope
is expressed as follows \cite{VSV12,VSV16}:

\begin{equation}
\begin{array}{lcl}
\eta & = & \int_{\left|\rho\right|^{2}=r^{2}}{\rm d^{2}\boldsymbol{\rho}\left|u\left(\mathbf{\boldsymbol{\rho}},L\right)\right|^{2},}\end{array}\label{eq:Transmittance}
\end{equation}
where $u\left(\mathbf{\boldsymbol{\rho}},{\rm L}\right)$ represents
the beam envelope at the receiver plane, located at a distance ${\rm L}$
from the transmitter, and $\left|u\left(\mathbf{\boldsymbol{\rho}},{\rm L}\right)\right|^{2}$
is the normalized intensity with respect to full $\boldsymbol{\rho}$
plane, where $\boldsymbol{\rho}$ denotes the position vector within
the transverse plane. The vector parameter ${\rm \boldsymbol{v}}$
fully characterizes the state of the beam at the receiver plane (see
Figure \ref{fig:Elliptic_beam_impinge_circular_aperture}),

\begin{equation}
{\rm \boldsymbol{v}}=\left(x_{0},y_{0},\mathcal{W}_{1},\mathcal{W}_{2},\varphi\right),\label{eq:Vector of beam-parameters}
\end{equation}
$x_{0}$, $y_{0}$, $\mathcal{W}_{1/2}$, and $\varphi$ imply the
beam centroid coordinates, the principal semi-axes of the elliptic
beam profile, and the orientation angle of the elliptic beam, respectively.
The transmittance is determined by these beam parameters along with
the radius of the receiving aperture ($r$).

\begin{figure}[h]
\centering{}\includegraphics[scale=0.6]{Figure_1}\caption{\label{fig:Elliptic_beam_impinge_circular_aperture}(Color online)
Diagram illustrating the received beam and the receiving aperture.
${\rm L}$ is the total link-length in the propagation direction,
$r$ represents the radius of the receiving aperture, $\rho_{0}=(x_{0},y_{0})$
signifies the position of the beam centroid, $\mathcal{W}_{1}$ and
$\mathcal{W}_{2}$ are the principal semi axes of elliptic beam profile,
and $\varphi$ is the orientation angle of the elliptic beam.}
\end{figure}

In general, the atmosphere can be categorized into distinct layers,
each characterized by various physical parameters such as air density,
pressure, temperature, the presence of ionized particles, and more.
The arrangement of these layers varies according to location, particularly
concerning the extent of each layer's thickness. Without loss of generality,
we adopt a simplified model of a satellite-based optical link \cite{LKB19}.
This model entails a uniform atmosphere up to a specific altitude
denoted as $\overline{{\rm h}}$, beyond which a vacuum extends all
the way to the satellite situated at an altitude marked as $\overline{{\rm L}}$,
as illustrated in Figure \ref{fig:Non-uniform_free_space_link}. Rather
than dealing with a continuous range of values characterizing physical
quantities as a function of altitude, this approach involves just
two key parameters. These parameters encompass the value of the physical
quantity within the uniform atmosphere and the effective altitude
range, $\overline{{\rm h}}$. This simplification is likely to be
quite accurate because atmospheric influences are predominantly significant
only within the initial $10$ to $20$ kilometers above the Earth's
surface. This is particularly relevant considering that the standard
orbital height for LEO satellites is above 400 kilometers . In our
analysis, we set the value of $\overline{{\rm L}}$ to $500$ km,
and assume that the zenith angle falls within the range of $\left[0^{0},80^{0}\right]$.
Under these conditions, the range of the satellite's orbit suitable
for key distribution is approximately ${\rm L}\in\left[500,2000\right]$
km\footnote{The correlation between total link length and zenith angle is, ${\rm L}=\overline{{\rm L}}\sec\phi$.}.
The given context mandates that the effective atmospheric thickness
$\overline{{\rm h}}$ remains constant at 20 km, by the aforementioned
factors. We extend the discussion by maintaining the premise that
the parameters quantifying the influence of atmospheric effects remain
constant (with values greater than $0$) within the atmosphere and
are set to $0$ outside it. In this context, we can make use of the
assumption that,

\begin{equation}
\begin{array}{cl}
{\rm Down-link} & \begin{cases}
C_{n}^{2}\left(z\right) & =C_{n}^{2}\,\text{\textohm}\left(z-\left({\rm L}-{\rm h}\right)\right),\\
n_{0}\left(z\right) & =n_{0}\,\text{\textohm}\left(z-\left({\rm L}-{\rm h}\right)\right),
\end{cases}\\
\\
{\rm Up-link} & \begin{cases}
C_{n}^{2}\left(z\right) & =C_{n}^{2}\,\text{\textohm\ensuremath{\left({\rm h}-z\right)},}\\
n_{0}\left(z\right) & =n_{0}\,\text{\textohm}\left({\rm h}-z\right).
\end{cases}
\end{array}\label{eq:Down-Link and Up-Link condition}
\end{equation}
Here, $C_{n}^{2}$ represents the refractive index structure constant\footnote{Several altitude-dependent models describing the refractive index
structure constant $C_{n}^{2}$ have been documented \cite{V80,HS64,LC06,FSV+10}.
Among these, the parametric fit proposed by Hufnagel and Valley is
widely adopted and faithfully captures the characteristics of $C_{n}^{2}$
in climates characteristic of mid-latitudes \cite{HS64,V80}.}, and $n_{0}$ denotes the density of scattering particles \cite{TP88,T84}.
The function $\text{\textohm}\left(z\right)$ corresponds to the Heaviside
step-function\footnote{The value of this function is zero for negative arguments and one
for positive arguments. This function falls within the broader category
of step functions.}. As stated above, the parameter $z$ signifies the longitudinal coordinate,
while ${\rm L}$ stands for the overall length of the link. Additionally,
${\rm h}$ represents the distance covered within the atmosphere,
as illustrated in the accompanying Figure \ref{fig:Non-uniform_free_space_link}.

\begin{figure}[h]
\centering{}\includegraphics[scale=0.5]{figure_2}\caption{\label{fig:Non-uniform_free_space_link}(Color online) This figure
depicted that the non-uniform free-space link between the satellite
and the ground station. The diagram highlights key parameters, $\overline{{\rm h}}$
is the thickness of the atmosphere, $\overline{{\rm L}}$ is the altitude
of the satellite, ${\rm h}$ represents length of the propagation
of light inside atmosphere, ${\rm L}$ is the link length between
satellite and ground station, $\phi$ denotes the zenith angle. Up-link
(down-link) configuration represents the transmission of light from
ground station to satellite (satellite to ground station). }
\end{figure}

Now, let's consider the transmittance, as defined in Eq. (\ref{eq:Transmittance}),
for an elliptic beam that strikes a circular aperture with a radius
of $r$. This transmittance can be expressed as follows \cite{VSV16}:

\begin{equation}
\begin{array}{lcl}
\eta\left(x_{0},y_{0},\mathcal{W}_{1},\mathcal{W}_{2},\varphi\right) & = & \frac{2\,\chi_{{\rm ex}t}}{\pi\mathcal{W}_{1}\mathcal{W}_{2}}\int_{0}^{r}\rho\,{\rm d}\rho\int_{0}^{2\pi}{\rm d}\theta{\rm e^{-2A_{1}\left(\rho cos\theta-\rho_{0}\right)^{2}}}{\rm e^{-2A_{2}\rho^{2}sin^{2}\theta}}e^{-2{\rm A}_{3}\left(\rho{\rm cos}\theta-\rho_{0}\right)\rho{\rm sin}\theta}.\end{array}\label{eq:PDT Equation}
\end{equation}
In this context, $r$ represents the radius of the aperture, while
$\rho$ and $\theta$ denote the polar coordinates of the vector $\boldsymbol{\rho}$,

\[
\begin{array}{lcl}
x & = & \rho{\rm \,cos}\theta,\\
y & = & \rho{\rm \,sin}\theta,
\end{array}
\]
here, $\rho_{0}$ and $\theta_{0}$ represent polar coordinates corresponding
to the vector $\boldsymbol{\rho}_{0}$,

\[
\begin{array}{lcl}
x_{0} & = & \rho_{0}\,{\rm cos}\theta_{0},\\
y_{0} & = & \rho_{0}{\rm \,sin}\theta_{0},
\end{array}
\]
and

\[
\begin{array}{lcl}
{\rm A}_{1} & = & \left(\frac{{\rm cos}^{2}\left(\varphi-\theta_{0}\right)}{\mathcal{W}_{1}^{2}}+\frac{{\rm sin}^{2}\left(\varphi-\theta_{0}\right)}{\mathcal{W}_{2}^{2}}\right),\\
{\rm A}_{2} & = & \left(\frac{{\rm sin}^{2}\left(\varphi-\theta_{0}\right)}{\mathcal{W}_{1}^{2}}+\frac{{\rm cos}^{2}\left(\varphi-\theta_{0}\right)}{\mathcal{W}_{2}^{2}}\right),\\
{\rm A}_{3} & = & \left(\frac{1}{\mathcal{W}_{1}^{2}}-\frac{1}{\mathcal{W}_{2}^{2}}\right){\rm sin\,2\left(\varphi-\theta_{0}\right).}
\end{array}
\]
These expressions can be employed for numerical integration, as described
in Eq. (\ref{eq:PDT Equation}), through the Monte Carlo method or
another effective technique for the same purpose. To simplify the
process of integration using the Monte Carlo method, it requires the
generation of $N$ sets of values for the vector ${\rm \boldsymbol{v}}$
(see Eq. (\ref{eq:Vector of beam-parameters})). It is assumed that
the angle $\left(\varphi-\theta_{0}\right)$ follows a uniform distribution
over the interval $[0,\frac{\pi}{2}]$ and other parameters\footnote{To compute transmittance, first one has to evaluate $\mathcal{W}_{{\rm i}}$
from $\Theta_{{\rm i}}$ using relation $\begin{array}{lcl}
\Theta_{{\rm i}} & = & \ln\left(\frac{\mathcal{W}_{{\rm i}}^{2}}{\mathcal{W}_{{\rm 0}}^{2}}\right),\end{array}$ ${\rm i}=1,2.$ Here, $\mathcal{W}_{0}$ is the beam spot radius
at the transmitter.} ($x_{0},y_{0},\Theta_{{\rm 1}},\Theta_{{\rm 2}}$) follow the normal
distribution \cite{WHW+18}. Substitution of the simulated values
of ${\rm \boldsymbol{v}}$ into Eq. (\ref{eq:PDT Equation}) makes
it feasible to perform the numerical integration. The outcome of this
process also involves the \emph{extinction factor}\footnote{The parameter $\chi_{{\rm ext}}(\phi)$ denotes the extinction losses
caused by atmospheric back-scattering and absorption. It varies depending
on the elevation angle $\left(90^{\text{º}}-\phi\right)$ or zenith
angle $(\phi)$ \cite{BSH+13,VBB2000}.}\emph{,} $\chi_{{\rm ext}}$, thereby producing $N$ atmospheric transmittance
values, denoted as $\eta\left({\rm \boldsymbol{v}_{i}}\right)$, where
$i$ ranges from $1$ to $N$. The necessary parameters for simulation
are described in Appendix B which are calculated according to our
model. These expressions are different for up-link and down-link configuration
as different expressions mentioned in Eq. (\ref{eq:Down-Link and Up-Link condition})
are used for up-link and down-link configuration.

In the next section, we will evaluate the effectiveness of the HD
protocols selected by us in the satellite-based links. To conduct
this assessment, we need average key rates over the probability distribution
of the transmittance (PDT)\footnote{Some authors followed the relation $\eta_{\delta}=10^{-\frac{\delta}{10}}$
with $\delta=\alpha_{1}{\rm L}$ $[{\rm dB}]$ to represent the channel
transmittance with the form of attenuation, here, ${\rm L}$ total
link length and $\alpha_{1}$ is loss in the channel transmission
${\rm dB/km}$.} computed for different link lengths and configurations. The same
can be expressed as \cite{LKB19},

\begin{equation}
\begin{array}{lclcl}
\bar{R} & = & \intop_{0}^{1}R(\eta)\,P(\eta)\,{\rm d}\eta & = & \stackrel[{\rm i}=1]{N_{bins}}{\sum}R(\eta_{{\rm i}})\,P(\eta_{{\rm i}}),\end{array}\label{eq:Average key-rate}
\end{equation}
where, $\bar{R}$ represents the average key rate, while $R(\eta)$
signifies the key rate corresponding to a specific transmittance value.
The PDT is denoted as $P(\eta)$. To compute the integral average,
the interval $[0,1]$ is divided into $N_{bins}$ bins, each centered
at $\eta_{{\rm i}}$ for $i$ ranging from $1$ to $N_{bins}$, and
is evaluated by combining the weighted sum of the rates. The estimation
of $P(\eta_{{\rm i}})$ relies on random sampling, as explained in
the earlier paragraph.\textcolor{red}{{} }The formulations for the distinct
implementations key rates $R(\eta)$ can be found in Section \ref{subsec:HD-Ext-B92=000026HD-BB84}.

\section{Performance analysis of protocols after simulation \label{sec:III}}

In this section, we elaborately analyze the impact of PDT\footnote{See PDT in Figures 3 and 4 in Ref. \cite{LKB19} after random sampling
of beam parameters ${\rm \boldsymbol{v}}$ for a down-link and an
up-link, respectively.} on key rate after the weighted sum, as well as the probability distribution
of key rate (PDR) concerning the HD-Ext-B92 and HD-BB84 protocols.
The minimum separation between Alice and Bob (i.e., altitude of the
satellite) remains constant at a distance of $\overline{{\rm L}}=500$
km, as the primary focus is on scenarios involving LEO satellites
like the Chinese satellite Micius \cite{LCL+17,YCL+17,RXY+17,YCLL+17}.
We present outcomes of numerical simulation for satellite-based HD-Ext-B92
and HD-BB84 schemes under asymptotic conditions. The simulation incorporates
the experimental parameters outlined in Table \ref{tab:Parameters-associated-with-link-length}
\cite{MFR12,XXL14,LKB19}. The crucial factors in this scenario include
not only those associated with atmospheric influences but also the
radii of the transmitting and receiving telescopes, along with the
wavelength of the signal. For the satellite in orbit, we opted for
a radius of $r_{{\rm sat}}=15$ cm ($\mathcal{W}_{0}$), while the
ground station telescope has a radius of $r_{{\rm grnd}}=0.5$ m,
and the signal wavelength is $\lambda=785$ nm. Based on Eq. (\ref{eq:Down-Link and Up-Link condition}),
it is evident that a down-link pertains to satellite-to-ground communication,
where atmospheric effects become significant only in the latter part
of the propagation process, i.e., when $z$ exceeds $({\rm L-h})$.
On the other hand, for up-links, these effects are relevant only when
$z$ is below ${\rm h}$.

\begin{table}[h]
\begin{centering}
\begin{tabular}{>{\centering}p{2.5cm}>{\centering}p{4cm}>{\centering}p{5cm}}
\toprule 
Parameter & Value & Short description\tabularnewline
\midrule
$\mathcal{W}_{0}$ & 15 cm, 50 cm & Down-link, up-link\tabularnewline
$r$ & 50 cm, 15 cm & Down-link, up-link\tabularnewline
$\lambda$ & 785 nm & Wavelength of the signal light\tabularnewline
$\beta$ & 0.7 & Parameter in $\chi_{{\rm ext}}(\phi)$\tabularnewline
$\alpha$ & $2\times10^{-6}$ rad & Pointing error\tabularnewline
$\overline{{\rm h}}$ & 20 km & Atmosphere thickness\tabularnewline
$\overline{{\rm L}}$ & 500 km & Minimum altitude (at zenith)\tabularnewline
$n_{0}$ & 0.61 ${\rm m^{-3}}$ & Night-time condition 1\tabularnewline
$n_{0}$ & 0.01 ${\rm m^{-3}}$ & Day-time condition 1\tabularnewline
$n_{0}$ & 3.00 ${\rm m^{-3}}$ & Night-time condition 2\tabularnewline
$n_{0}$ & 0.05 ${\rm m^{-3}}$ & Day-time condition 2\tabularnewline
$n_{0}$ & 6.10 ${\rm m^{-3}}$ & Night-time condition 3\tabularnewline
$n_{0}$ & 0.10 ${\rm m^{-3}}$ & Day-time condition 3\tabularnewline
$C_{n}^{2}$ & $1.12\times10^{-16}$ ${\rm m^{-\frac{2}{3}}}$ & Night-time condition 1\tabularnewline
$C_{n}^{2}$ & $1.64\times10^{-16}$ ${\rm m^{-\frac{2}{3}}}$ & Day-time condition 1\tabularnewline
$C_{n}^{2}$ & $5.50\times10^{-16}$ ${\rm m^{-\frac{2}{3}}}$ & Night-time condition 2\tabularnewline
$C_{n}^{2}$ & $8.00\times10^{-16}$ ${\rm m^{-\frac{2}{3}}}$ & Day-time condition 2\tabularnewline
$C_{n}^{2}$ & $1.10\times10^{-15}$ ${\rm m^{-\frac{2}{3}}}$ & Night-time condition 3\tabularnewline
$C_{n}^{2}$ & $1.60\times10^{-15}$ ${\rm m^{-\frac{2}{3}}}$ & Day-time condition 3\tabularnewline
\bottomrule
\end{tabular}
\par\end{centering}
\caption{\label{tab:Parameters-associated-with-link-length}Parameters associated
with the optical and technical characteristics of the link and different
atmospheric weather conditions.}

\end{table}

From Appendix B, it becomes evident, as expected that the impact of
atmospheric effects is considerably more pronounced in the case of
up-links compared to down-links. The underlying phenomena at play
here, namely beam deflection and broadening, encompass angular effects.
These effects play a role in determining the ultimate size of the
beam, thus influencing the channel losses. Their magnitude is directly
proportional to the distance covered after the initiation of the effect
known as \emph{kick in effect}. For up-links, these effects manifest
near the transmitter, resulting in beam broadening spanning hundreds
of kilometers before detection at the satellite. Conversely, in the
down-link scenario, the majority of the beam's trajectory occurs within
a vacuum, with atmospheric effects coming into play only during the
final fifteen to twenty kilometers before reaching the receiver. A
secondary distinction lies in the origin of fluctuations in the position
of the beam centroid, denoted as $(x_{0},y_{0})$. In up-links, the
atmosphere-induced deflections tend to be significantly more influential
than pointing errors ($\varphi$), which is disregarded. On the other
hand, in down-links, the beam dimensions are already substantially
larger than any turbulent irregularities at the top of the atmosphere.
As a consequence, the resulting beam wandering due to atmospheric
effects can be neglected, rendering pointing errors the dominant contributing
factor.

\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.5]{AKR_Zenith_Different_Weather}
\par\end{centering}
\caption{\label{fig:AKR_Zenith_Different_Weather}(Color online) Plot of variation
of average key rate (per pulse) with zenith angle in different weather
conditions considering minimal noise (${\rm d}=32$), i.e., day-time
conditions 1, 2 and 3 correspond to not windy, moderate windy and
windy, respectively (described as Day-time condition 1/2/3) and night-time
conditions 1, 2, 3 correspond to clear, slightly foggy and moderate
foggy, respectively (described as Night-time condition 1/2/3). The
upper row corresponds to the up-link scenario and the lower row corresponds
to the down-link scenario: (a) Average key rate generated by HD-Ext-B92
protocol as a function of zenith angle for up-link configuration under
four different weather conditions (Day 1-2 and Night 1-2), (b) Average
key rate generated by HD-BB84 protocol as a function of zenith angle
for up-link configuration under four different weather condition (Day
1-2 and Night 1-2), (c) Average key rate generated by HD-Ext-B92 protocol
as a function of zenith angle for down-link configuration under six
different weather condition (Day 1-2-3 and Night 1-2-3), (d) Average
key rate generated by HD-BB84 protocol as a function of zenith angle
for down-link configuration under six different weather condition
(Day 1-2-3 and Night 1-2-3).}
\end{figure}

We aim to investigate the average key rate as a function of zenith
angle, considering minimal noise. Figures \ref{fig:AKR_Zenith_Different_Weather}
illustrate the average key rate using the PDT concerning the angle
relative to the zenith. This analysis is carried out for both up-links
and down-links across various weather conditions for dimension\footnote{The weather data information is used from Ref. \cite{LKB19}. We also
mention the required information in Table \ref{tab:Parameters-associated-with-link-length}.}, ${\rm d}=32$\textcolor{red}{{} }(see Table \ref{tab:Parameters-associated-with-link-length}).
Each data point on the graph is derived from $10,000$ parameter samples
in Eq. (\ref{eq:Vector of beam-parameters}) and computed using Eq.
(\ref{eq:PDT Equation}). In Figures \ref{fig:AKR_Zenith_Different_Weather}
(a) and \ref{fig:AKR_Zenith_Different_Weather} (b), the graphs reveal
that during daytime condition 1, the highest average key rate is yielded
in the zenith position ($\sim0.0012$ and $\sim0.008$) for HD-Ext-B92
and HD-BB84 protocols, respectively, in the up-link configuration.
Notably, the key rate\footnote{For ease of reference, we will refer to the average key rate as the
\textquotedbl key rate\textquotedbl .} is slightly greater for HD-BB84 which corresponds to the expected
result. For the same configuration, the key rate sharply diminishes
under other conditions (Day 2 and Night 1-2). Comparatively, for HD-Ext-B92,
the maximum value of the key rate ($\sim0.0002$) is nearly ten times
lower than that of the HD-BB84 protocol ($\sim0.002$) corresponding
to the day condition 2. A similar comparison holds for night 1/2 conditions.
For these conditions, the key rate becomes approximately zero at zenith
angle $50^{\text{º}}$. It may be noted that in night-time condition
1, the key rate is lower than in day-time condition 2 for both schemes
within the same configuration. Based on these observations, we can
infer that daytime transmission in the up-link configuration performs
more favorably than nighttime transmission. Due to the very low key
rate during night-time condition 2, we have chosen to negate condition
3, both in night-time and day-time, from the graphical representation.
The down-link configuration is depicted in Figures \ref{fig:AKR_Zenith_Different_Weather}
(c) and \ref{fig:AKR_Zenith_Different_Weather} (d). As previously
discussed, the influence of atmospheric effects is comparatively reduced
in the down-link configuration compared to the up-link configuration.
Consequently, the performance of the link transmittance is superior
for down-link as compared to up-link. This is supported by Figures
\ref{fig:AKR_Zenith_Different_Weather} (c) and \ref{fig:AKR_Zenith_Different_Weather}
(d), which further highlight the enhanced key rate. From these two
figures, the overall plot patterns can be seen to be (sequential arrangement
of plots representing different weather conditions) consistent for
both protocols. The sequence of different weather conditions that
yield higher key rate values follows this order: day-time condition
1, night-time condition 1, day-time condition 2, day-time condition
3, night-time condition 2, and night-time condition 3. Additionally,
it can be seen that similar to the up-link scenario, the daytime conditions
favor channel transmission over the nighttime conditions. This pattern
remains consistent across both scenarios. Of particular interest is
the comparison between operations during night-time and day-time.
During daylight hours, higher temperatures facilitate stronger winds
and heightened mixing across distinct atmospheric layers. This generates
more prominent turbulence effects. However, on average, clear days
witness a reduced moisture content in the lower atmosphere compared
to night-time conditions. Consequently, the scattering of particles
causes less pronounced beam spreading. Conversely, during night-time,
the cooler temperatures result in an atmosphere with lower turbulence
levels, coupled with the formation of mist and haze. In such circumstances,
scattering tends to have a more substantial impact at night-time than
the effects induced by turbulence at day-time. In the down-link scenario,
during day-time condition 1, the highest achievable key rates are
$0.165$ and $1.2$ for HD-Ext-B92 and HD-BB84 protocols, respectively.
Conversely, in night-time condition 3, the highest attainable key
rates are $0.125$ and $0.9$. The key rate ratio, in the down-link
scenario, between the HD-BB84 and HD-Ext-B92 protocols is $7.27$
for the maximum scenario and $7.2$ for the minimum scenario. This
observation substantiates the anticipated outcome that HD-BB84 consistently
outperforms HD-Ext-B92. Furthermore, the key rate decreases significantly
within the zenith angle range of $70^{\text{º}}$ to $80^{\text{º}}$
for the down-link scenario, whereas for the up-link scenario, this
reduction begins at a zenith angle of $50^{\text{º}}$. Intuitively,
down-link transmission exhibits a higher tolerance for larger zenith
angles compared to up-link transmission.

\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.5]{AKR_LinkLength_DownLink_Day1}
\par\end{centering}
\caption{\label{fig:AKR_LinkLength_DownLink_Day1}(Color online) Plot of variation
of average key rate (per pulse) with total link length under condition
Day-1 utilizing different dimensions of qudit (${\rm d}=2$ and ${\rm d}=8$):
(a) Average key rate generated by HD-Ext-B92 protocol as a function
of total link length (${\rm L}$) for down-link configuration, (b)
Average key rate generated by HD-BB84 protocol as a function of total
link length (${\rm L}$) for down-link configuration.}
\end{figure}

To obtain the best possible results, hereafter we focus on the down-link
configuration under optimal weather conditions where the average key
rate is highest (cf. Figure \ref{fig:AKR_Zenith_Different_Weather}).
Specifically, we analyze and illustrate the variation of key rate
with total link length (${\rm L}$) in day-time condition 1 within
down-link configuration, assuming an extremely low noise. In this
scenario, the HD-Ext-B92 protocol yields maximum key rates of 0.17
and 0.155 for qudit dimensions 8 and 2, respectively, as illustrated
in Figure \ref{fig:AKR_LinkLength_DownLink_Day1} (a). Notably, the
key rate of the HD-BB84 protocol exhibits notable fluctuations across
different dimensions. As can be seen from Figure \ref{fig:AKR_LinkLength_DownLink_Day1}
(b), for qudit dimensions 8 and 2, the maximum key rates are 0.7 and
0.24, respectively. This is consistent with the results in Figure
\ref{fig:AKR_Zenith_Different_Weather}.\textcolor{red}{{} }

\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.5]{Probability_Keyrate_Different_Noise}
\par\end{centering}
\caption{\label{fig:Probability_Keyrate_Different_Noise}(Color online) Plot
of the distribution of key-rate variation for different channel noise
parameters (q) at the zenith position under condition Day-1 utilizing
qudit of dimension 32: (a) Probability distribution of key-rate for
HD-Ext-B92 protocol, (b) Probability distribution of key-rate for
HD-BB84 protocol under down-link configuration.}
\end{figure}

In Figure \ref{fig:Probability_Keyrate_Different_Noise}, we present
the PDR with different values of noise parameter (${\rm q}$) at the
zenith position ($\phi=0^{\text{º}}$) under down-link configuration.
In this context, we employ the optimal performance scenario during
day-time condition 1 utilizing qudit dimension of 32. We have used
a data set of $10^{6}$ beam parameters to simulate the values of
the average key rate and approximate the results to six (five) decimal
places\footnote{This is a good choice of approximation to represent, well-suited for
PDR representation.} to get PDR plots for HD-Ext-B92 (HD-BB84). Within the HD-Ext-B92
protocol, comparing the cases of ${\rm q}=0.02$ and ${\rm q}=0.06$
(in Figure \ref{fig:Probability_Keyrate_Different_Noise} (a)), we
observe a higher key rate for ${\rm q}=0.02$, while the maximum value
of probability of key rate is greater for ${\rm q}=0.06$. The maximum
values of probability are consistently greater with greater values
of noise parameter. Notably, a higher key rate corresponds to a lower
value of probability of occurrence. A specific shape of PDT (as is
the case here) implies that the shape of the PDR would remain the
same with different noise parameters and different zenith angles (or
equivalently with different distances). For example, see that the
shape of the PDR remains same for HD-Ext-B92 protocol and HD-BB84
protocol, although the density of data points are more in the case
of HD-BB84 (see Figure \ref{fig:Probability_Keyrate_Different_Noise}
(a) and (b)). However, this protocol (HD-BB84) exhibits significantly
elevated key rate values as well as higher probabilities compared
to HD-Ext-B92. Subsequently, we also plot the PDR with different zenith
angles in Figure \ref{fig:Probability_Keyrate_Different_Zenith_Angle},
considering extremely low noise characterized by the parameter ${\rm q}\ll1$
at the zenith position under condition Day-1 with the same configuration
(down-link). Notably, the shapes of the PDR curves remain consistent
across both the protocols; however, the data points on the plot appear
more densely concentrated in the HD-BB84 protocol. In this case, we
have utilized a dataset of $10^{6}$ beam parameters to simulate the
values of the average key rate and approximate the results to six
(five) decimal places to get PDR plots for HD-Ext-B92 (HD-BB84). The
peak values of the probability of key rates in the PDR graph for distinct
zenith angles are different for both the protocols. Moreover, for
different zenith angles, the peak values of probability in the PDRs
are consistently greater in HD-BB84 compared to HD-Ext-B92. In conclusion,
we deduce that the PDR curves maintain a uniform shape across varying
zenith angles as PDT considered here has a fixed shape.

\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.5]{Probability_Keyrate_Different_Zenith_Angle}
\par\end{centering}
\caption{\label{fig:Probability_Keyrate_Different_Zenith_Angle}(Color online)
Plot of distribution of key-rate variation for different zenith angles
($\phi$) considering minimal noise, characterized by the parameter
${\rm q}\ll1$, under condition Day-1 utilizing qudit of dimension
32: (a) Probability distribution of key-rate for HD-Ext-B92 protocol,
(b) Probability distribution of key-rate for HD-BB84 protocol under
down-link configuration.}
\end{figure}


\section{Discussion\label{sec:IV}}

In this paper, we study two protocols for QKD in higher dimensions.
We analyze the key rates of these two higher dimensional protocols
in the context of satellite-based secure quantum communication. To
analyze the effectiveness of these schemes for satellite-based quantum
communication, we employ a robust method known as the elliptic beam
approximation \cite{VSV16}. By employing a generalized model using
this approach, we assess the performance of the HD-Ext-B92 and HD-BB84
protocols. The key rate per pulse and QBER are plotted against the
noise parameter. Notably, our findings reveal that, in higher dimensions,
HD-BB84 outperforms HD-Ext-B92 in terms of both key rate and noise
tolerance. However, HD-BB84 experiences a more pronounced saturation
of QBER in high dimensions. We deduce the key rate of the HD-Ext-B92
scheme without introducing any additional free parameters, as opposed
to the approach discussed in Ref. \cite{IK21}, and is elaborated
in Appendix A. Our analysis comprehensively demonstrates the impact
of link transmittance on the weighted sum of key rate under nominal
noise levels for both the schemes (HD-Ext-B92 and HD-BB84) under up-link
and down-link configurations. Moreover, we delve into the analysis
of PDR across different values of noise parameter (at the zenith position)
and zenith angle (with nominal noise amount). Remarkably, the PDR
exhibits consistent shapes across all scenarios. It is noteworthy
that the graphical points are denser for HD-BB84; as anticipated this
is because the HD-BB84 protocol makes use of two complete bases. Additionally,
the probability tends to be higher for lower key rate values compared
to higher ones. It may be noted that we employ normal and uniform
distributions to model beam parameters. Alternative distributions
may be employed to account for specific altitudes and atmospheric
conditions. Consequently, variations in key rate could differ in our
analysis, contingent on the consideration of atmospheric effects.
For greater accuracy and interest, utilizing empirical data to obtain
these results is recommended. 

Numerous theoretical studies have been focused on finding the analytical
probability distribution that best aligns with the experimentally
observed transmittance of optical links in free space. The prevalent
distributions employed are the log-normal \cite{LSA01,SNP+13}, Gamma-Gamma
\cite{HAP01}, and Double Weibull \cite{CSK+10} distributions. The
choice among these distributions depends on factors like turbulence
intensity, link distance, and the setup of the transmitting and receiving
telescopes. Conversely, the methodology employed in this study takes
a constructive approach, enabling the determination of the PDT based
on beam characteristics and atmospheric conditions. Further, our work
can be expanded by examining the performance of a cube-sat, such as
utilizing data from an existing satellite with an appropriate payload
(say, from the Chinese satellite \emph{Micius}), while optimizing
the source intensity. This optimization would lead to an enhancement
in the system's key rate and the ability to achieve longer link lengths
(even when tolerating higher zenith angles) \cite{DHC+22,LJ20}. Analysis
of finite key in any quantum communication scheme would be interesting.
Especially consideration of such effects is important in the context
of satellite-based quantum communication because the limited duration
of the connection between the ground station and the satellite would
always lead to a finite key. Thus, future work could involve directing
attention towards finite key analysis in scenarios involving higher
dimensions, as well as assessing key rate performance in relation
to atmospheric transmittance for satellite-based links. In summary,
our investigations into the performance of higher-dimensional QKD
protocols over satellite-based systems may have a substantial impact
on both theoretical and experimental aspects of satellite-based quantum
communication. Thus, the present work definitely establishes the advantages
of using higher dimensional states in satellite-based quantum communication;
but there are challenges associated with the experimental generation
and maintenance of the qudits. In the near future we would like to
address this technical issue and also to find the optimal choice of
dimension that can provide a desired key rate. 

\subsection*{Acknowledgment: }

Authors acknowledge support from the Indian Space Research Organisation
(ISRO) project no: ISRO/RES/3/906/22-23.

\section*{Availability of data and materials}

No additional data is needed for this work.

\section*{Competing interests}

The authors declare that they have no competing interests.

\bibliographystyle{apsrev}
\bibliography{Satellite_first}


\appendix
%dummy comment inserted by tex2lyx to ensure that this paragraph is not empty

\section*{Appendix A \label{sec:Appendix-A}}

We recap the security analysis proposed in Ref. \cite{IK21} and show
our important modification in the investigation of the minimum value
key rate (per pulse) for HD-Ext-B92 protocol. We elaborate the theorem
\cite{K16} which provides the lower bound of the conditional von
Neumann entropy of classical-quantum state $\rho_{aE}$ in Hilbert
space\footnote{Alice's register and Eve's quantum memory are represented in Hilbert
space $\mathcal{H}_{a}$ and $\mathcal{H}_{E}$, respectively.} $\mathcal{H}_{a}\otimes\mathcal{H}_{E}$.

\emph{Theorem }Let $\mathcal{H}_{a}$ and $\mathcal{H}_{E}$ are finite-dimensional
Hilbert space and consider the following state of Alice and Eve in
the form of density matrix,

\begin{equation}
\rho_{aE}=\frac{1}{M}\left(|0\rangle\langle0|_{a}\otimes\left[\sum_{x=1}^{{\rm d}}|E_{x}^{0}\rangle\langle E_{x}^{0}|\right]+|1\rangle\langle1|_{a}\otimes\left[\sum_{x=1}^{{\rm d}}|E_{x}^{1}\rangle\langle E_{x}^{1}|\right]\right),\label{eq:Classical-Quantum state of ALice and Bob}
\end{equation}
where $M(>0)$ is normalization factor, ${\rm d}$ has finite value,
and each state\footnote{Eve's states are not necessarily normalized, nor orthogonal; it might
be that $|E_{x}^{y}\rangle\equiv0$ also.} $|E_{x}^{y}\rangle\in\mathcal{H}_{E}$. Assuming $K_{x}^{y}=\langle E_{x}^{y}|E_{x}^{y}\rangle\geq0$,
then,

\[
S\left(a|E\right)_{\rho_{aE}}\geq\sum_{x=1}^{{\rm d}}\left(\frac{K_{x}^{0}+K_{x}^{1}}{M}\right)S_{x},
\]
where
\[
S_{x}=\begin{cases}
h\left(\frac{K_{x}^{0}}{K_{x}^{0}\,+\,K_{x}^{1}}\right)-h\left(\delta_{x}\right) & {\rm if}\,\,K_{x}^{0}\wedge K_{x}^{1}\geq0,\\
0 & {\rm otherwise},
\end{cases}
\]
and
\[
\delta_{x}=\frac{1}{2}+\frac{\sqrt{\left(K_{x}^{0}-K_{x}^{1}\right)^{2}+4{\rm Re^{2}}\langle E_{x}^{0}|E_{x}^{1}\rangle}}{2\left(K_{x}^{0}+K_{x}^{1}\right)}.
\]

The action of Eve's unitary operation $\mathcal{E}_{TE}$ on Alice's
transmitted state $|\Upsilon\rangle_{T}$ and Eve's ancilla state
$|\chi\rangle_{E}$ is described in the following,

\[
\mathcal{E}_{TE}|\Upsilon\rangle_{T}\otimes|\chi\rangle_{E}=\sum_{c=1}^{d}|c,E_{c}^{\Upsilon}\rangle_{TE},
\]
and

\[
\begin{array}{lcl}
\mathcal{E}_{TE}|\psi\rangle_{T}\otimes|\chi\rangle_{E} & = & \mathcal{E}_{TE}\frac{1}{\sqrt{2}}\left(|m\rangle+|n\rangle\right)_{T}\otimes|\chi\rangle_{E}\\
 & = & \frac{1}{\sqrt{2}}\stackrel[c=1]{d}{\sum}|c\rangle_{T}\otimes|F_{c}\rangle_{E},
\end{array}
\]
where $|F_{c}\rangle_{E}:=|E_{c}^{m}\rangle_{E}+|E_{c}^{n}\rangle_{E}$,
and $E_{c}^{\Upsilon}$ is an arbitrary state in Eve's ancillary basis
when Alice's transmitted state before and after Eve's operation are
$|\Upsilon\rangle_{T}$ and $|c\rangle_{T}$, respectively. As $\mathcal{E}_{TE}$
is a unitary operation the relation holds as $\stackrel[c=1]{d}{\sum}\langle E_{c}^{\Upsilon}|E_{c}^{\Upsilon}\rangle=1$.
After Eve's unitary operation on the classical-quantum state, $\rho_{aT}=\frac{1}{2}\left(|0\rangle\langle0|_{a}\otimes|m\rangle\langle m|_{T}+|1\rangle\langle1|_{a}\otimes|\psi\rangle\langle\psi|_{T}\right)$
is as following,

\begin{equation}
\begin{array}{lcl}
\rho_{aTE} & = & \mathcal{E}_{TE}\left(\rho_{aT}\right)\\
 & = & \frac{1}{2}\left[|0\rangle\langle0|_{a}\otimes P\left(\stackrel[c=1]{d}{\sum}|c,E_{c}^{m}\rangle_{TE}\right)+|1\rangle\langle1|_{a}\otimes P\left(\frac{1}{\sqrt{2}}\stackrel[c=1]{d}{\sum}|c,F_{c}\rangle_{TE}\right)\right],
\end{array}\label{eq:Alice-Transmitted-Eve's state}
\end{equation}
where $P\left(|\upsilon\rangle\right)=|\upsilon\rangle\langle\upsilon|$
is projection operator. After receiving the transmitted register $T$
Bob will apply the measurement operators $M_{0}=I_{a}\otimes\left(I-|\psi\rangle\langle\psi|\right)_{T}\otimes I_{E}$
and $M_{1}=I_{a}\otimes\left(I-|m\rangle\langle m|\right)_{T}\otimes I_{E}$
on $T$. Using Eq. (\ref{eq:Alice-Transmitted-Eve's state}) we can
write density state after Bob's operations,

\begin{equation}
\begin{array}{lcl}
\rho_{aTE}^{0} & = & M_{0}\left(\rho_{aTE}\right)M_{0}^{\dagger}\\
 & = & \frac{1}{2}\left[|0\rangle\langle0|\otimes P\left\{ \underset{c\ne m,c\ne n}{\sum}|c,E_{c}^{m}\rangle+\frac{1}{2}\,|m,E_{m}^{m}-E_{n}^{m}\rangle-\frac{1}{2}\,|n,E_{m}^{m}-E_{n}^{m}\rangle\right\} \right.\\
 & + & \left.|1\rangle\langle1|\otimes P\left\{ \frac{1}{\sqrt{2}}\left(\underset{c\ne m,c\ne n}{\sum}|c,F_{c}\rangle+\frac{1}{2}\,|m,F_{m}-F_{n}\rangle-\frac{1}{2}\,|n,F_{m}-F_{n}\rangle\right)\right\} \right]_{aTE},
\end{array}\label{eq:Alice-Transmit-Eve when Bob gets 0}
\end{equation}
and
\begin{equation}
\begin{array}{lcl}
\rho_{aTE}^{1} & = & M_{1}\left(\rho_{aTE}\right)M_{1}^{\dagger}\\
 & = & \frac{1}{2}\left[|0\rangle\langle0|\otimes P\left(\underset{c\ne m}{\sum}|c,E_{c}^{m}\rangle\right)+|1\rangle\langle1|\otimes P\left(\frac{1}{\sqrt{2}}\underset{c\ne m}{\sum}|c,F_{c}\rangle\right)\right]_{aTE}.
\end{array}\label{eq:Alice-Transmit-Eve when Bob gets 1}
\end{equation}
After Bob gets his outcomes Eqs. (\ref{eq:Alice-Transmit-Eve when Bob gets 0})
and (\ref{eq:Alice-Transmit-Eve when Bob gets 1}) may be traced out
the transit register $T$ and include Bob's classical register $b$
to keep his measurement result. Now the Eqs. (\ref{eq:Alice-Transmit-Eve when Bob gets 0})
and (\ref{eq:Alice-Transmit-Eve when Bob gets 1}) can be written
like,

\begin{equation}
\begin{array}{lcl}
\rho_{aEb}^{0} & = & \frac{1}{2}\left[|0\rangle\langle0|_{a}\otimes\left\{ \underset{c\ne m,c\ne n}{\sum}|E_{c}^{m}\rangle\langle E_{c}^{m}|+\frac{1}{2}\,|\left(E_{m}^{m}-E_{n}^{m}\right)\rangle\langle\left(E_{m}^{m}-E_{n}^{m}\right)|\right\} _{E}\otimes|0\rangle\langle0|_{b}\right.\\
 & + & \left.|1\rangle\langle1|_{a}\otimes\frac{1}{2}\left\{ \underset{c\ne m,c\ne n}{\sum}|F_{c}\rangle\langle F_{c}|+\frac{1}{2}\,|\left(F_{m}-F_{n}\right)\rangle\langle\left(F_{m}-F_{n}\right)|\right\} _{E}\otimes|0\rangle\langle0|_{b}\right],
\end{array}\label{eq:Alice-Eve-Bob-bit_0}
\end{equation}
and
\begin{equation}
\rho_{aEb}^{1}=\frac{1}{2}\left[|0\rangle\langle0|_{a}\otimes\sum_{c\ne m}|E_{c}^{m}\rangle\langle E_{c}^{m}|\otimes|1\rangle\langle1|_{b}+|1\rangle\langle1|_{a}\otimes\frac{1}{2}\sum_{c\ne m}|F_{c}\rangle\langle F_{c}|\otimes|1\rangle\langle1|_{b}\right].\label{eq:Alice-Eve-Bob-bit_1}
\end{equation}
Adding up Eqs. (\ref{eq:Alice-Eve-Bob-bit_0}) and (\ref{eq:Alice-Eve-Bob-bit_1}),
the non-normalized density operator which represents in one key-bit
generation round is,

\begin{equation}
\begin{array}{lcl}
\rho_{aEb} & = & \rho_{aEb}^{1}+\rho_{aEb}^{0}\\
 & = & \frac{1}{2}\,|0\rangle\langle0|_{a}\otimes\left[\left\{ \underset{c\ne m,c\ne n}{\sum}|E_{c}^{m}\rangle\langle E_{c}^{m}|+\frac{1}{2}\,|\left(E_{m}^{m}-E_{n}^{m}\right)\rangle\langle\left(E_{m}^{m}-E_{n}^{m}\right)|\right\} \otimes|0\rangle\langle0|_{b}+\underset{c\ne m}{\sum}|E_{c}^{m}\rangle\langle E_{c}^{m}|\otimes|1\rangle\langle1|_{b}\right]\\
 & + & \frac{1}{2}\,|1\rangle\langle1|_{a}\otimes\left[\frac{1}{2}\left\{ \underset{c\ne m,c\ne n}{\sum}|F_{c}\rangle\langle F_{c}|+\frac{1}{2}\,|\left(F_{m}-F_{n}\right)\rangle\langle\left(F_{m}-F_{n}\right)|\right\} \otimes|0\rangle\langle0|_{b}+\frac{1}{2}\underset{c\ne m}{\sum}|F_{c}\rangle\langle F_{c}|\otimes|1\rangle\langle1|_{b}\right]
\end{array}.\label{eq:Non-normalized density operator}
\end{equation}
For computing the conditional entropy $H\left(a|b\right)$, we will
show how the Eq. (\ref{eq:Non-normalized density operator}) is utilized
to get the statistics for all combinations of Alice's and Bob's sifted
key. Now, trace out Bob's register from Eq. (\ref{eq:Non-normalized density operator})
to keep the composite state of Alice's register and Eve's memory which
is important to calculate $S(a|E)$. The final expression of the required
density matrix is,

\begin{equation}
\begin{array}{lcl}
\rho_{aE} & = & \frac{1}{M}\left[|0\rangle\langle0|_{a}\otimes\left(\underset{c\ne m,c\ne n}{\sum}|E_{c}^{m}\rangle\langle E_{c}^{m}|+\frac{1}{4}\,|E_{m}^{m}\rangle\langle E_{m}^{m}|-\frac{1}{4}\,|E_{m}^{m}\rangle\langle E_{n}^{m}|-\frac{1}{4}\,|E_{n}^{m}\rangle\langle E_{m}^{m}|+\frac{3}{4}\,|E_{n}^{m}\rangle\langle E_{n}^{m}|\right)_{E}\right.\\
 & + & \left.|1\rangle\langle1|_{a}\otimes\left(\underset{c\ne m,c\ne n}{\sum}\frac{1}{2}\,|F_{c}\rangle\langle F_{c}|+\frac{1}{8}\,|F_{m}\rangle\langle F_{m}|-\frac{1}{8}\,|F_{m}\rangle\langle F_{n}|-\frac{1}{8}\,|F_{n}\rangle\langle F_{m}|+\frac{3}{8}\,|F_{n}\rangle\langle F_{n}|\right)_{E}\right],
\end{array}\label{eq:Alice-Eve required final expression}
\end{equation}
where $M$ is the normalization factor that can be calculated as,

\[
\begin{array}{lcl}
M & = & \underset{c\ne m,c\ne n}{\sum}\langle E_{c}^{m}|E_{c}^{m}\rangle+\frac{1}{2}\,\langle E_{n}^{m}|E_{n}^{m}\rangle+\frac{1}{4}\,\langle\left(E_{m}^{m}-E_{n}^{m}\right)|\left(E_{m}^{m}-E_{n}^{m}\right)\rangle\\
 & + & \frac{1}{2}\underset{c\ne m,c\ne n}{\sum}\langle F_{c}|F_{c}\rangle+\frac{1}{4}\,\langle F_{n}|F_{n}\rangle+\frac{1}{8}\,\langle\left(F_{m}-F_{n}\right)|\left(F_{m}-F_{n}\right)\rangle
\end{array}.
\]
We modify the derivation for $S(a|E)$ using $\rho_{aE}$ in comparison
with the seminal work \cite{IK21}. In our modified calculation, we
express the terms of $\rho_{aE}$ in Eve's two bases states, i.e.,
$\{E_{c}^{m}\}$ and $\{F_{c}\}$ which correspond to the bit values
(i.e., $0$ and $1$) in Alice's register\footnote{The above \emph{Theorem }allows our expression of Eq. (\ref{eq:Alice-Eve required final expression})
unlike the Eq. (5) in Ref. \cite{IK21}.}.

Applying this above \emph{theorem} we calculate the conditional von
Neumann entropy,

\begin{equation}
S(a|E)\ge\underset{c\ne m,c\ne n}{\sum}\left(\frac{K_{c}^{0}+K_{c}^{1}}{M}\right)S_{c}+\left(\frac{K_{m}^{0}+K_{m}^{1}}{M}\right)S_{m}+\left(\frac{K_{n}^{0}+K_{n}^{1}}{M}\right)S_{n},\label{eq:Value of S(A|E)}
\end{equation}
where

\[
\begin{array}{lclcclcl}
K_{c}^{0} & := & \langle E_{c}^{m}|E_{c}^{m}\rangle, &  &  & K_{c}^{1} & := & \frac{1}{2}\,\langle F_{c}|F_{c}\rangle,\forall\,c\ne m,n\\
\\
K_{m}^{0} & := & \frac{1}{4}\,\langle E_{m}^{m}|E_{m}^{m}\rangle, &  &  & K_{m}^{0} & := & \frac{1}{8}\,\langle F_{m}|F_{m}\rangle,\\
\\
K_{n}^{0} & := & \frac{3}{4}\,\langle E_{n}^{m}|E_{n}^{m}\rangle, &  &  & K_{n}^{1} & := & \frac{3}{8}\,\langle F_{n}|F_{n}\rangle.
\end{array}
\]
And
\[
\begin{array}{lcl}
S_{c} & = & h\left(\frac{K_{c}^{0}}{K_{c}^{0}\,+\,K_{c}^{1}}\right)-h\left(\frac{1}{2}+\frac{\sqrt{\left(K_{c}^{0}\,-\,K_{c}^{1}\right)^{2}+4\,{\rm Re^{2}}\langle E_{c}^{m}|\frac{1}{\sqrt{2}}F_{c}\rangle}}{2\,\left(K_{c}^{0}\,+\,K_{c}^{1}\right)}\right),\\
S_{m} & = & h\left(\frac{K_{m}^{0}}{K_{m}^{0}\,+\,K_{m}^{1}}\right)-h\left(\frac{1}{2}+\frac{\sqrt{\left(K_{m}^{0}\,-\,K_{m}^{1}\right)^{2}+4\,{\rm Re^{2}}\langle\frac{1}{2}E_{m}^{m}|\frac{1}{2\sqrt{2}}F_{m}\rangle}}{2\,\left(K_{m}^{0}\,+\,K_{m}^{1}\right)}\right),\\
S_{n} & = & h\left(\frac{K_{n}^{0}}{K_{n}^{0}\,+\,K_{n}^{1}}\right)-h\left(\frac{1}{2}+\frac{\sqrt{\left(K_{n}^{0}\,-\,K_{n}^{1}\right)^{2}+4\,{\rm Re^{2}}\frac{3}{4\sqrt{2}}\langle E_{n}^{m}|F_{n}\rangle}}{2\,\left(K_{n}^{0}\,+\,K_{n}^{1}\right)}\right).
\end{array}
\]
Here, we briefly describe the \emph{parameter estimation} for the
required statistics to get the values in the above equations. Let
$p_{\upsilon c}\,(p_{\upsilon\psi})$ be the observable parameter
when Bob's measurement outcome is $|c\rangle\,(|\psi\rangle)$ using
the $Z\,(X)$ basis when Alice sends state\footnote{Here, the generalized state is $|\upsilon\rangle\in\{|m\rangle,|n\rangle,|\psi\rangle\}$,
these statistics $\left(p_{\upsilon c(\psi)}\right)$ come from the
rounds where Alice and Bob do the same or different basis measurement
(see Table $1$ in Ref. \cite{IK21}).} $|\upsilon\rangle$. We may write in the form of the observable parameters
$K_{c}^{0}=p_{mc},$ $K_{c}^{1}=p_{\psi c},$ $K_{m}^{0}=\frac{1}{4}\,p_{mm},$
$K_{m}^{1}=\frac{1}{4}\,p_{\psi m},$ $K_{n}^{0}=\frac{3}{4}\,p_{mn},$
and $K_{n}^{1}=\frac{3}{4}\,p_{\psi n}.$

\[
\begin{array}{lcl}
{\rm Re\,}\langle E_{c}^{m}|\frac{1}{\sqrt{2}}F_{c}\rangle & = & \frac{1}{\sqrt{2}}\left(\frac{p_{mc}}{2}+p_{\psi c}-\frac{p_{nc}}{2}\right),\\
\\
{\rm Re\,}\langle\frac{1}{2}E_{m}^{m}|\frac{1}{2\sqrt{2}}F_{m}\rangle & = & \frac{1}{4\sqrt{2}}\left(\frac{p_{mm}}{2}+p_{\psi m}-\frac{p_{nm}}{2}\right),\\
\\
{\rm Re}\,\frac{3}{4\sqrt{2}}\langle E_{n}^{m}|F_{n}\rangle & = & \frac{3}{4\sqrt{2}}\left(\frac{p_{mn}}{2}+p_{\psi n}-\frac{p_{nn}}{2}\right).
\end{array}
\]

In our study, we take only the depolarizing channel to evaluate the
satellite-based effect of the HD-Ext-B92 protocol. Suppose the depolarizing
channel $\mathcal{D}_{q}(\rho)$ with parameter ${\rm q}$ acting
on a density operator $\rho$ on a Hilbert space of dimension ${\rm d}$.
$\mathcal{D_{{\rm q}}}(\rho)$ acts as follows,

\[
\mathcal{D}_{{\rm q}}(\rho)=\left(1-\frac{{\rm d}}{{\rm d}-1}{\rm q}\right)\rho+\frac{{\rm q}}{{\rm d}-1}I.
\]
In the above, we have already mentioned the required parameter to
calculate the key rate in terms of observable statistics. The observable
statistics may be written in the effect of depolarizing channel scenario,

\[
\begin{array}{lccclclcl}
 &  & p_{mm} & = & p_{nn} & = & p_{\psi\psi} & = & 1-{\rm q},\\
 &  & p_{mc} & = & p_{nc} & = & p_{\psi c} & = & \frac{{\rm q}}{{\rm d}-1},\\
p_{m\psi} & = & p_{n\psi} & = & p_{\psi m} & = & p_{\psi n} & = & \frac{1}{2}\left(1-\frac{{\rm q}\,{\rm d}}{{\rm d}-1}\right)+\frac{{\rm q}}{{\rm d}-1}.
\end{array}
\]
The above analysis is sufficient to evaluate $S(a|E)$ using Eq. (\ref{eq:Value of S(A|E)}),
and to get the key rate we need the value of $H(a|b)$ which is analyzed\footnote{Assuming $p_{ij}$ is the joint probability when Alice's and Bob's
raw bit are ``$i$'' and ``$j$'' given that not eliminating that
iteration \cite{DP22}.} in the following,

\begin{equation}
\begin{array}{lcl}
H\left(a|b\right) & = & H\left(p_{00},\,p_{01},\,p_{10},\,p_{11}\right)-h\left(p_{00}+p_{10}\right).\end{array}\label{eq:Value of H(a|b)}
\end{equation}
To compute Eq. (\ref{eq:Value of H(a|b)}), Alice and Bob use classical
sampling i.e., the values of observable probabilities under the simulated
channel. Using Eq. (\ref{eq:Non-normalized density operator}) with
normalization term $M$,

\[
\begin{array}{lcl}
p_{00} & = & \frac{1}{2M}\left(1-p_{m\psi}\right),\\
p_{01} & = & \frac{1}{2M}\left(1-p_{mm}\right),\\
p_{10} & = & \frac{1}{2M}\left(1-p_{\psi\psi}\right),\\
p_{11} & = & \frac{1}{2M}\left(1-p_{\psi i}\right).
\end{array}
\]
These are the needful analyses that we recap above for estimating
the minimum value of the key rate in Eq. (\ref{eq:Key-rate equantion}).

\section*{Appendix B\label{sec:Appendix-B}}

We may write the first and second moments of the beam parameters in
Eq. (\ref{eq:Vector of beam-parameters}) concerning the connection
detailed in Eq. (\ref{eq:Down-Link and Up-Link condition}). The angle
of orientation of the elliptical profile $\varphi$ is presumed to
have a uniform distribution within the interval $[0,\frac{\pi}{2}]$.
The mean value and the variance in the centroid position of the beam,
in the case of up-links, are consistent for both the $x$ and $y$
directions, and they are equal to\footnote{See for details Appendix C in Ref. \cite{VSV+17}.},

\[
\begin{array}{lclcl}
\left\langle x_{0}\right\rangle  & = & \left\langle y_{0}\right\rangle  & = & 0,\\
\left\langle x_{0}^{2}\right\rangle  & = & \left\langle y_{0}^{2}\right\rangle  & = & 0.419\,\sigma_{R}^{2}\mathcal{W}_{0}^{2}\Omega^{-\frac{7}{6}}{\rm \frac{h}{L}},
\end{array}
\]
in this context, the term \textquotedbl Rytov parameter\textquotedbl{}
represents the quantity $\sigma_{R}=1.23\,C_{n}^{2}k^{\frac{7}{6}}{\rm L}^{\frac{11}{6}}$,
while $\Omega=\frac{k\mathcal{W}_{0}^{2}}{2\,{\rm L}}$ stands for
the Fresnel number, $k$ is the optical wave number. The selected
reference frame is such that $\left\langle x_{0}\right\rangle =\left\langle y_{0}\right\rangle =0$.
The mean and (co) variance of $\mathcal{W}_{i}^{2}$ can be written
as,

\[
\begin{array}{lcl}
\langle\mathcal{W}_{i}^{2}\rangle & = & \frac{\mathcal{W}_{0}^{2}}{\Omega^{2}}\left(1+\frac{\pi}{8}\,{\rm L}n_{0}\mathcal{W}_{0}^{2}{\rm \frac{h}{L}}+2.6\,\sigma_{R}^{2}\Omega^{\frac{5}{6}}{\rm \frac{h}{L}}\right),\\
\langle\Delta\mathcal{W}_{i}^{2}\Delta\mathcal{W}_{j}^{2}\rangle & = & \left(2\delta_{ij}-0.8\right)\frac{\mathcal{W}_{0}^{4}}{\Omega^{\frac{19}{6}}}\left(1+\frac{\pi}{8}\,{\rm L}n_{0}\mathcal{W}_{0}^{2}{\rm \frac{h}{L}}\right)\sigma_{R}^{2}{\rm \frac{h}{L}}.
\end{array}
\]
The same type of expressions also applies to down-links when considering
the position of the beam centroid,

\[
\begin{array}{lclcl}
\left\langle x_{0}\right\rangle  & = & \left\langle y_{0}\right\rangle  & = & 0,\\
\left\langle x_{0}^{2}\right\rangle  & = & \left\langle y_{0}^{2}\right\rangle  & = & \alpha\,{\rm L},
\end{array}
\]
additionally, for the semi-major and semi-minor axes of the elliptical
beam profile,

\[
\begin{array}{lcl}
\langle\mathcal{W}_{i}^{2}\rangle & = & \frac{\mathcal{W}_{0}^{2}}{\Omega^{2}}\left(1+\frac{\pi}{24}\,{\rm L}n_{0}\mathcal{W}_{0}^{2}\left({\rm \frac{h}{L}}\right)^{3}+1.6\,\sigma_{R}^{2}\Omega^{\frac{5}{6}}\left({\rm \frac{h}{L}}\right)^{\frac{8}{3}}\right),\\
\langle\Delta\mathcal{W}_{i}^{2}\Delta\mathcal{W}_{j}^{2}\rangle & = & \left(2\delta_{ij}-0.8\right)\,\frac{3}{8}\,\frac{\mathcal{W}_{0}^{4}}{\Omega^{\frac{19}{6}}}\left(1+\frac{\pi}{24}\,{\rm L}n_{0}\mathcal{W}_{0}^{2}\left({\rm \frac{h}{L}}\right)^{3}\right)\sigma_{R}^{2}\left({\rm \frac{h}{L}}\right)^{\frac{8}{3}},
\end{array}
\]
here, $\alpha\approx2$ $\mu{\rm rad}$ refers to the angular pointing
error. Subsequently, the understanding of the probability distribution
concerning the elliptic beam parameters (Eq. (\ref{eq:Vector of beam-parameters}))
is applied to calculate the PDT utilizing Eq. (\ref{eq:PDT Equation})
and a process of random sampling which is mentioned in Section \ref{subsec:Elliptic_Beam_Model}.
\end{document}
