\documentclass[a4paper,11pt]{article}
% \pdfoutput=1 % if your are submitting a pdflatex (i.e. if you have
%              % images in pdf, png or jpg format)
\usepackage{jcappub} % for details on the use of the package, please
                     % see the JCAP-author-manual

\usepackage{graphicx}	% Including figure files
\usepackage{amsmath}	% Advanced maths commands
\usepackage{amssymb}	% Extra maths symbols
\usepackage[british]{babel}             % British English hyphenation
\usepackage{newtxtext}                  % Good fonts
\usepackage{bm}
\usepackage{physics}
\usepackage{academicons}
\usepackage[dvipsnames]{xcolor}
\usepackage{booktabs}
\usepackage{natbib}
\usepackage{times}
\usepackage{url}
\usepackage{appendix}
\usepackage{hyperref}
\usepackage[nolist]{acronym}
\usepackage{ulem}
\newacro{3D}{three-dimensional}
% usage: \ac{3D}
\newacro{MG}{modified gravity}
\newacro{FFT}{Fast Fourier Transformation}
\newacro{GR}{General Relativity}
\newacro{DGP}{Dvali-Gabadadze-Porrati}
\newacro{RSD}{redshift space distortion}

\newcommand{\Mpch}{\,h^{-1}{\rm Mpc}}
\newcommand{\Gpch}{\,h^{-1}{\rm Gpc}}
\newcommand{\Mpchc}{\,h^{-3}{\rm Mpc}^3}
\newcommand{\hMpc}{\,h\,{\rm Mpc}^{-1}}
\newcommand{\hMpcc}{\,h^3{\rm Mpc}^{-3}}
\newcommand{\Msh}{\,h^{-1}M_\odot}
\newcommand{\myvec}[1]{\boldsymbol{#1}}
\newcommand{\rd}{{\rm d}}

\newcommand{\ca}[2]{\textcolor{black}{\sout{#1}\, #2}}
\newcommand{\Ruan}[1]{\textcolor{black}{#1}}

\newcommand{\revision}[1]{\textcolor{black}{#1}}

\title{Fast full N-body simulations of generic modified gravity: conformal coupling models}

%% %simple case: 2 authors, same institution
%% \author{A. Uthor}
%% \author{and A. Nother Author}
%% \affiliation{Institution,\\Address, Country}

% more complex case: 4 authors, 3 institutions, 2 footnotes
\author[a]{Cheng-Zong Ruan,}
\author[b,c]{C\'{e}sar Hern\'{a}ndez-Aguayo,}
\author[a]{Baojiu Li,}
\author[a]{Christian Arnold,}
\author[a]{Carlton M. Baugh,}
\author[d]{Anatoly Klypin,}
\author[e]{and Francisco Prada}

% The "\note" macro will give a warning: "Ignoring empty anchor..."
% you can safely ignore it.

\affiliation[a]{Institute for Computational Cosmology, Department of Physics, Durham University, South Road, Durham DH1 3LE, UK}
\affiliation[b]{Max-Planck-Institut fur Astrophysik, Karl-Schwarzschild-Str 1, D-85748 Garching, Germany}
\affiliation[c]{Excellence Cluster ORIGINS, Boltzmannstrasse 2, D-85748 Garching, Germany}
\affiliation[d]{Astronomy Department, New Mexico State University, Las Cruces, NM 88001, USA}
\affiliation[e]{Instituto de Astrof\'{i}sica de Andaluc\'{i}a (CSIC), Glorieta de la Astronom\'{i}a, E-18080 Granada, Spain}

% e-mail addresses: one for each author, in the same order as the authors
\emailAdd{cheng-zong.ruan@durham.ac.uk}
\emailAdd{cesarhdz@MPA-Garching.MPG.DE}
\emailAdd{baojiu.li@durham.ac.uk}
\emailAdd{christian.arnold@durham.ac.uk}
\emailAdd{c.m.baugh@durham.ac.uk}
\emailAdd{aklypin@nmsu.edu}
\emailAdd{f.prada@csic.es}


\abstract{We present {\sc mg-glam}, a code developed for the very fast production of full $N$-body cosmological simulations in modified gravity (MG) models. We describe the implementation, numerical tests and first results of a large suite of cosmological simulations for three classes of MG models with conformal coupling terms: the $f(R)$ gravity, symmetron and coupled quintessence models.
Derived from the parallel particle-mesh code \textsc{glam}, {\sc mg-glam} incorporates an efficient multigrid relaxation technique to solve the characteristic nonlinear partial differential equations of these models. 
For $f(R)$ gravity, we have included new variants to diversify the model behaviour, and we have tailored the relaxation algorithms to these to maintain high computational efficiency. 
In a companion paper, we describe versions of this code developed for derivative coupling MG models, including the Vainshtein- and K-mouflage-type models. 
\textsc{mg-glam} can model the prototypes for most MG models of interest, and is broad and versatile. 
The code is highly optimised, with a tremendous speedup of a factor of more than a hundred compared with earlier $N$-body codes, while still giving accurate predictions of the matter power spectrum and dark matter halo abundance.
\textsc{mg-glam} is ideal for the generation of large numbers of MG simulations that can be used in the construction of mock galaxy catalogues and the production of accurate emulators for ongoing and future galaxy surveys.}



\begin{document}
\maketitle
\flushbottom

\input{Introduction}

\input{Theories}

\input{Implementations}

\input{CodeTests}

\input{CosmologicalRuns}

\input{DiscussionsAndConclusions}



\acknowledgments

%\paragraph{Note added.} 

C-ZR, CA and BL are supported by the European Research Council (ERC) through a starting Grant (ERC-StG-716532 PUNCA). BL and CMB are further supported by the UK Science and Technology Funding Council (STFC) Consolidated Grant No.~ST/I00162X/1 and ST/P000541/1. CH-A acknowledges support from the Excellence Cluster ORIGINS which is funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany's Excellence Strategy - EXC-2094-390783311. AK and FP thank the support of the Spanish Ministry of Science and Innovation funding grant PGC2018- 101931-B-I00.

This work used the DiRAC@Durham facility managed by the Institute for Computational Cosmology on behalf of the STFC DiRAC HPC Facility (\url{www.dirac.ac.uk}). The equipment was funded by BEIS via STFC capital grants ST/K00042X/1, ST/P002293/1, ST/R002371/1 and ST/S002502/1, Durham University and STFC operation grant ST/R000832/1. DiRAC is part of the UK National e-Infrastructure.

This work used the skun6@IAA facility (\url{www.skiesanduniverses.org}) managed by the Instituto de Astrof\'{i}sica de Andaluc\'{i}a (CSIC). The equipment was funded by the Spanish Ministry of Science EU-FEDER infrastructure grants EQC2018-004366-P and EQC2019-006089-P.


\appendix

\input{ResolutionTest}
%\input{Scaling}

\bibliographystyle{utphys}
\bibliography{MGGLAM_refs.bib}

\end{document}
