\section{Kalman's method}
\label{sec:exact}

We review Kalman's approach for dynamic least squares regression, which maintains an exact solution with $O(d^2)$ amortized update time per iteration. 


\begin{theorem}
There is an data structure with $O(d^{\omega})$ preprocessing time and $O(d^2)$ update time that maintains an exact solution of the dynamic least squares regression problem.
\end{theorem}
\begin{proof}
For any $t\in [T]$, the data structure maintains $\bH^{(t)} := ((\bA^{\ttop})^\top \bA^{\ttop})^{-1}$ and $ \bu^{(t)} := (\bA^{\ttop})^{\top} \bb^\ttop$. The later one costs $O(d)$ time to update. By the Woodbury identity, if a new row arrives, then the former one satisfies
\begin{align*}
    \bH^{(t)} =&~ ((\bA^{(t-1)})^\top \bA^{(t-1)} + \ba^{(t)} (\ba^{\ttop})^{\top} )^{-1}\\
    =&~ \bH^{(t-1)} - \bH^{(t-1)}\ba^{(t)} \big(1 + (\ba^{(t)})^{\top} \bH^{(t-1)}\ba^{(t)} \big)^{-1} (\ba^{(t)})^{\top} \bH^{(t-1)},
\end{align*}
and it can be updated in $O(d^2)$ time. It is similar when a row is deleted.


The optimal solution $\bx^{(t)}$ at step $t$ satisfies $\bx^{(t)}= ((\bA^{(t)})^{\top} \bA^{(t)})^{-1} (\bA^{(t)})^{\top}\bb^{(t)} = \bH^{(t)}\bu^{(t)}$, and it can be computed in $O(d^2)$ time given $\bH^{(t)}$ and $\bu^{(t)}$.
\end{proof}