% Summary plot of all cost data

%\pgfplotsset{every axis title/.append style={at={(0.5,1.05)}, anchor=base}}

\renewcommand{\autocorr}{5} %actually sqrt(2*iat)

\begin{tikzpicture}[baseline, trim left=(group c1r1.south west)]
% trim axis group left == trim left=(group c1r1.south west)

\begin{groupplot}[
	group style={
		group size=4 by 1,
		horizontal sep=0pt,
		yticklabels at=edge left,
		},
	ymin=0, ymax=60000,
	small,
	%footnotesize,
	width=4.5cm,
	height=8cm,
	%minor y tick num=3,
	scaled y ticks=base 10:-4,
	ytick scale label code/.code={},
	xtick=data,
	y errors,
%	title style={
%		at={(0.5,1.05)},
%		anchor=base,
%	},
	xlabel style={
		at={(0.5,-0.18)},
		anchor=mid,
	},
	ymajorgrids=true,
	]
	
% 2hasen
\nextgroupplot[
	title={2MP},
	xlabel={$\kappa_2$},
	ylabel={Cost},
	%legend entries={Total},
	%legend style={legend pos=outer north east,
	%	legend columns=1},
	only marks,
	%y errors,
	cycle list name=mstone_d,
	%mark options={scale=1.5},
	slanted xlabels,
	enlarge x limits=0.25,
	ytick scale label code/.code={$\cdot 10^{#1}$},
]

\renewcommand{\matrixopfile}{\figdir/data/witers_j134X.txt}

\addplot+[red, mark=*]
	table[
		x=rho2,
		y expr={\thisrow{iter_SF} + \thisrow{iter_F1} + \thisrow{iter_F2} + \thisrow{iter_F3}},
		y error expr={\thisrow{iter_tot_err}*\autocorr},
	]
	{\matrixopfile};


% pfhasen
\nextgroupplot[
	title={1PF-1MP},
	xlabel={$\kappa'$},
	%ylabel={$N_{mat}$},
	%legend entries={Total},
	%legend style={legend pos=outer north east,
	%	legend columns=1},
	only marks,
	xtick=data,
	%y errors,
	%error bars/y dir=both,
	%error bars/y explicit,
	cycle list name=mstone_d,
	%mark options={scale=1.5},
	slanted xlabels,
	enlarge x limits=0.25,
]

\renewcommand{\matrixopfile}{\figdir/data/witers_j137X1.txt}

\addplot+[red, mark=*]
	table[
		x=rho,
		y expr={\thisrow{iter_SF} + \thisrow{iter_F1} + \thisrow{iter_F2} + \thisrow{iter_F3}},
		y error expr={\thisrow{iter_tot_err}*\autocorr},
	]
	{\matrixopfile};



% 1pf2hasen
\nextgroupplot[
	title={1PF-2MP},
	xlabel={$\kappa_2$},
	%ylabel={$C$},
	only marks,
	cycle list name=mstone_d,
	slanted xlabels,
	enlarge x limits=0.25,
]

\renewcommand{\matrixopfile}{\figdir/data/witers_j1301X.txt}

\addplot+[red, mark=*]
	table[
		x=rho2,
		y expr={\thisrow{iter_SF} + \thisrow{iter_F1}
		+ \thisrow{iter_F2} + \thisrow{iter_F3}
		+ \thisrow{iter_F4}},
		y error expr={\thisrow{iter_tot_err}*\autocorr},
	]
	{\matrixopfile};


% 2pf1hasen
\nextgroupplot[
	title={2PF-1MP},
	xlabel={$\kappa'$},
	%ylabel={$N_{mat}$},
	%ymin=0, ymax=250000,
	only marks,
	cycle list name=mstone_d,
	slanted xlabels,
	enlarge x limits=0.25,
]

\renewcommand{\matrixopfile}{\figdir/data/witers_j1302X.txt}

\addplot+[red, mark=*]
	table[
		x=rho,
		y expr={\thisrow{iter_SF} + \thisrow{iter_F1}
		+ \thisrow{iter_F2} + \thisrow{iter_F3}
		+ \thisrow{iter_F4}},
		y error expr={\thisrow{iter_tot_err}*\autocorr},
	]
	{\matrixopfile};



\end{groupplot}
\end{tikzpicture}