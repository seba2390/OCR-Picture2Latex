% 2-filter weighted matrix op plots
\begin{tikzpicture}[baseline, trim left=(group c1r1.south west)]
% trim axis group left == trim left=(group c1r1.south west)

\begin{groupplot}[
	group style={
		group size=2 by 1,
		horizontal sep=0pt,
		yticklabels at=edge left,
		},
	ymin=0, ymax=70000,
	small,
	%footnotesize,
	minor y tick num=4,
	ymajorgrids,
	y errors,
	xlabel style={
		at={(0.5,-0.3)}, % shift by hand to ensure valign
		anchor=mid,
	},
	]


% 2pf
\nextgroupplot[
	title={2PF},
	xlabel={$p_2$},
	ylabel={Cost},
	only marks,
	xtick=data,
	xticklabels={$24$,$34$,$54$},
	cycle list name=mstone_d,
	enlarge x limits=0.25,
]

\renewcommand{\matrixopfile}{\figdir/data/witers_j132X.txt}
% Negligible contribution: omit
%\addplot
%	table[
%		x=rho,
%		y=iter_SF,
%		y error expr={\thisrow{iter_SF_err}*\autocorr},
%	]
%	{\matrixopfile};

%\foreach \i in {1,2,3} {
%\addplot	
%	table[
%		x=q,
%		y=iter_F\i,
%		y error expr={\thisrow{iter_F\i_err}*\autocorr},
%	]
%	{\matrixopfile};
%	}


\addplot+[red, mark=*]
	table[
		x=q,
		y expr={\thisrow{iter_SF} + \thisrow{iter_F1} + \thisrow{iter_F2} + \thisrow{iter_F3}},
		y error expr={\thisrow{iter_tot_err}*\autocorr},
	]
	{\matrixopfile};


% 2mp
\nextgroupplot[
	title={2MP},
	xlabel={$\kappa_2$},
	only marks,
	cycle list name=mstone_d,
	xticklabel style={
		rotate=45,
		anchor=east,
		/pgf/number format/precision=4,
	},
]

\renewcommand{\matrixopfile}{\figdir/data/witers_j134X.txt}
% Negligible contribution: omit
%\addplot
%	table[
%		x=rho2,
%		y=iter_SF,
%		y error expr={\thisrow{iter_SF_err}*\autocorr},
%	]
%	{\matrixopfile};

%\foreach \i in {1,2,3} {
%\addplot	
%	table[
%		x=rho2,
%		y=iter_F\i,
%		y error expr={\thisrow{iter_F\i_err}*\autocorr},
%	]
%	{\matrixopfile};
%}

\addplot+[red, mark=*]
	table[
		x=rho2,
		y expr={\thisrow{iter_SF} + \thisrow{iter_F1} + \thisrow{iter_F2} + \thisrow{iter_F3}},
		y error expr={\thisrow{iter_tot_err}*\autocorr},
	]
	{\matrixopfile};


\end{groupplot}
\end{tikzpicture}