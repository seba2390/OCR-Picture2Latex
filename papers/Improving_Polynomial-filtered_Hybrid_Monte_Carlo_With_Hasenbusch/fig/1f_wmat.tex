% 1-filter weigthed matrix op plots
\begin{tikzpicture}[baseline, trim left=(group c1r1.south west)]
% trim axis group left == trim left=(group c1r1.south west)

\begin{groupplot}[
	group style={
		group size=2 by 1,
		horizontal sep=0pt,
		yticklabels at=edge left,
		},
	ymin=0, ymax=120000,
	small,
	%footnotesize,
	%width=5.25cm,
	minor y tick num=3,
	scaled y ticks=base 10:-4,
	y errors,
	ymajorgrids,
	xlabel style={
		at={(0.5,-0.3)}, % shift by hand to ensure valign
		anchor=mid,
	},
	]


\nextgroupplot[
	title={Polynomial},
	xlabel={$p$},
	ylabel={Cost},
	%ylabel={$N_{mat}$},
	%ymin=0, ymax=250000,
	only marks,
	xtick=data,
	cycle list name=mstone_d,
	enlarge x limits=0.25,
]

\renewcommand{\matrixopfile}{\figdir/data/witers_j131X.txt}

%\foreach \i in {1,2} {
%\addplot	
%	table[
%		x=p,
%		y=iter_F\i,
%		y error expr={\thisrow{iter_F\i_err}*\autocorr},
%	]
%	{\matrixopfile};
%	}

% Negligible contrib, so don't plot
%\addplot	
%	table[
%		x=p,
%		y=iter_SF,
%		y error expr={\thisrow{iter_SF_err}*\autocorr},
%	]
%	{\matrixopfile};

\addplot+[red, mark=*]
	table[
		x=p,
		y expr={\thisrow{iter_SF} + \thisrow{iter_F1} + \thisrow{iter_F2}},
		y error expr={\thisrow{iter_tot_err}*\autocorr},
	]
	{\matrixopfile};




\nextgroupplot[
	title={Mass prec.\makebox[0pt]{\phantom{y}}}, % Ensures titles line up via a strut
	xlabel={$\kappa'$},
	only marks,
	%xtick=data,
	xtick={0.154, 0.1545, 0.155, 0.1555, 0.156},
	cycle list name=mstone_d,
	xticklabel style={
		rotate=45,
		anchor=east,
		/pgf/number format/precision=4,
	},
]


%\addplot	
%	table[
%		x=plot_var,
%		y=iter_SF,
%		%y error=iter_SF_err,
%	]
%	{\matrixopfile};

\renewcommand{\matrixopfile}{\figdir/data/witers_j133X.txt}
%\foreach \i in {1,2} {
%\addplot	
%	table[
%		x=rho,
%		y=iter_F\i,
%		y error expr={\thisrow{iter_F\i_err}*\autocorr},
%		%y error=iter_F\i_err,
%	]
%	{\matrixopfile};
%	}
	
% Negligible contrib, so don't plot
%\addplot	
%	table[
%		x=rho,
%		y=iter_SF,
%		y error expr={\thisrow{iter_SF_err}*\autocorr},
%	]
%	{\matrixopfile};
	
\addplot+[red, mark=*]
	table[
		x=rho,
		y expr={\thisrow{iter_SF} + \thisrow{iter_F1} + \thisrow{iter_F2}},
		y error expr={\thisrow{iter_tot_err}*\autocorr},
	]
	{\matrixopfile};


\end{groupplot}
\end{tikzpicture}