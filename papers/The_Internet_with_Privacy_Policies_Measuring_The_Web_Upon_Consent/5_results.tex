\section{Impact on Tracking}
\label{sec:tracking}

In this section, we characterize how the Web tracking ecosystem changes if observed with or without accepting the privacy policies. We break down results by Third-Party/Tracker, by country and website category. %Focusing on top popular websites per country and category, \TOOL finds and accepts the privacy policies on $57.3\%$ of them. 

%The percentage is not uniform across countries, and it is generally higher on European ($59-65\%$) and lower for US ($35\%$) websites - despite most keywords being in English. Differences are more pronounced across categories; \TOOL finds and accepts privacy policies on $87\%$ of News websites, while only on $20\%$ of Adult portals. For the sake of completeness, the per-country and per-category percentage of websites with a Consent Banner is reported on the top-$x$ labels of Figure~\ref{fig:ca_country_one} and~\ref{fig:ca_category_one}, respectively. These figures are in line with the percentages seen in Figures~\ref{fig:validation} and~\ref{fig:ca_vs_com}. 
%We verify that \TOOL does not report ``policy accepted'' for those websites that do not present any Consent Banner by running a manual verification on the $1\,000$ websites used for the first step of Section~\ref{sec:keywords}. We do not find cases of such misbehaviour.  

\subsection{Third-Party and Tracker Pervasiveness}

\begin{figure}
    \centering
    \includegraphics[width=0.6\columnwidth]{figures/cookieaccept_top_tp.pdf}
    \caption{Pervasiveness of the top-15 Third-Parties (percentage of sites they are in) on 10\,542 websites popular in Europe. Most of them are far more pervasive on the \AFTER. 95\% confidence intervals are reported on each bar. }
    \label{fig:ca_prevasiveness_top}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=0.5\columnwidth]{figures/cookieaccept_tracker_pervasiveness_log.pdf}
    \caption{Pervasiveness of the 342 identified Trackers (percentage of sites they are in) in 10\,542 websites popular in Europe. Note that the figure has log-log axes to better show the large variability of Tracker popularity. Also unpopular Trackers result more pervasive on the \AFTER.}
    \label{fig:ca_prevasiveness_all}

\end{figure}

We first study the pervasiveness of Third-Parties and Trackers and check how it varies when we measure it in a \BEFORE or \AFTER. \TOOL found and accepted a Consent Banner on $63.2\%$ of websites. Here, we aim at quantifying the impact of privacy policy acceptance on European websites ($10\,542$ in total) and we exclude those websites exclusively popular in the~US.

We first detail the top-15 most pervasive Third-Parties in Figure~\ref{fig:ca_prevasiveness_top}. The GDPR mandates to obtain informed consent before starting to collect any personal data. As such, Third-Parties may be seen as possibly offending services if activated before accepting the privacy policy.\footnote{Here, we do not enter into the debate of what can be considered a Tracker.} With little surprise, the most pervasive Third-Party is \texttt{google-analytics.com}. It grows from $61\%$ to $74\%$ in popularity on the \AFTER. This value is surprisingly similar to what Metwalley~\emph{et al.}~\cite{metwalley2016using} found in 2016, when they found \texttt{google-analytics.com} appearing in 71\% of websites. The growth is also sizeable for other Google services such as \texttt{googleadservices.com} and \texttt{googlesyndication.com}. Conversely, domains belonging to Content Delivery Networks, such as \texttt{cloudflare.com} and \texttt{cloudflare.net} do not increase their pervasiveness on the \AFTER, likely being not included in the mechanisms of Consent Banners. Interestingly, only 3 out of the top-15 Third-Parties are Trackers -- i.e., present in our tracker list and setting a persistent cookie. \texttt{doubleclick.net} and \texttt{facebook.com} are the most popular ones, with pervasiveness growing from $41\%$ to $58\%$ and from $24\%$ to $39\%$ on the \AFTER, respectively. They are present in more than twice the number of websites than their first competitor (\texttt{quantserve.com}).
In Figure~\ref{fig:ca_prevasiveness_top}, we also report 95\% confidence intervals. It results that the sample proportion (in percentage) of pervasiveness of Third-Parties is an unbiased estimator of the probability $p$ of a Bernoulli random variable. Therefore, by repeating a number of occurrences of a Bernoulli random variable equal to the number of samples, we obtain the number of successes of a binomial random variable. The confidence intervals become the classical binomial proportion confidence intervals. For the sake of completeness, we report error bars also in the following plots. Note, that, given the large number of samples, the confidence intervals are very narrow and not overlapping between \BEFORE and \AFTER, except for the case of \texttt{cloudflare.com}.


Focusing now on Trackers only, we show their pervasiveness in Figure~\ref{fig:ca_prevasiveness_all}. We count $342$ of them. The red curve shows the pervasiveness on the \BEFORE, which is what a naive crawler would report. The blue curve shows how the figure changes on the \AFTER. The Trackers on the $x$-axis are sorted in descending order according to their pervasiveness on the \BEFORE -- hence the \BEFORE curve is monotonically decreasing, while the \AFTER is not. The increase in pervasiveness is general and includes both popular and infrequent Trackers, reaching one order of magnitude in a some cases. On the \AFTER, the number of Trackers that are present on $1\%$ or more of websites grows from $40$ to $90$.
%Interestingly, the rank remains almost unchanged if we sort the \BEFORE and \AFTER Trackers by their pervasiveness.
Here, the Spearman's rank correlation is $0.90$, indicating that the Tracker popularity order is approximately the same before and after the privacy policy acceptance. The difference is that their pervasiveness increases.

As it emerges from Figure~\ref{fig:ca_prevasiveness_all}, many Trackers are widespread even on the \BEFORE. This hints at a possibly wrong implementation of the GPDR regulation, which mandates acquiring the visitor's explicit consent before activating any tracking mechanisms. To be precise, the presence of Trackers on the \BEFORE does not necessarily entail a violation of the law. An analysis of the most popular cookies reveals the presence of test cookies during the \BEFORE using a form similar to \texttt{test\_cookie = CheckForPermission}. Google Analytics is a notable example. These cookies are just a check for the possibility of installing profiling cookies upon the user's acceptance. It is thus possible that the \BEFORE pervasiveness of some Trackers includes cases in which only test cookies are actually used (curiously with expiration date longer than a month). Here we limit to observe that often Trackers set some (potentially) profiling cookies even on the \BEFORE.

\textbf{Take away:} 
\textit{Collecting measurements with or without consent to privacy policies leads to a largely different picture. Upon consent, Trackers are far more pervasive than it appears beforehand. \TOOL is instrumental for this goal, thanks to its ability to handle Consent Banners and accept website privacy policies.}


\subsection{Breakdown on Websites}

We now detail the impact of accepting privacy policies on the number of Trackers found in each website, breaking down our results by country and website category.

\subsubsection{Analysis by country}
\label{sec:trackers_country}

\begin{figure*}
    \centering
    \includegraphics[width=0.185\textwidth]{figures/cookieaccept_overall_tracker_nb_fr.pdf}
    \includegraphics[width=0.15\textwidth]{figures/cookieaccept_overall_tracker_nb_de.pdf}
    \includegraphics[width=0.15\textwidth]{figures/cookieaccept_overall_tracker_nb_it.pdf}
    \includegraphics[width=0.15\textwidth]{figures/cookieaccept_overall_tracker_nb_es.pdf}
    \includegraphics[width=0.15\textwidth]{figures/cookieaccept_overall_tracker_nb_uk.pdf}
    \includegraphics[width=0.15\textwidth]{figures/cookieaccept_overall_tracker_nb_us.pdf}
	\caption{Trackers per website seen on the landing page. Websites (top 2\,500 per country) are sorted by Tracker number on the \BEFORE (red curve). The blue points report the number of Trackers in the \AFTER for the same websites considered in the red curve, while the blue line represent a moving average with a 100-website window.}
	\label{fig:ca_countries}
\end{figure*}

\begin{figure}
    \centering
    \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=\columnwidth]{figures/cookieaccept_websites_with_trackers.pdf}
        \caption{Percentage of websites embedding Trackers. The top $x$-axis details the fraction of websites in such category where \TOOL found and accepted privacy policies.}
        \label{fig:ca_country_one}
    \end{subfigure}
    \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=\columnwidth]{figures/cookieaccept_trackers_per_website.pdf}
        \caption{Average number of Trackers per website.}
        \label{fig:ca_country_avg}
    \end{subfigure}
        \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=\columnwidth]{figures/cookieaccept_websites_with_trackers_separate.pdf}
        \caption{Percentage of websites embedding Trackers, splitting websites with and without a Consent Banner.}
        \label{fig:ca_country_one_sep}
    \end{subfigure}
        \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=\columnwidth]{figures/cookieaccept_trackers_per_website_separate.pdf}
        \caption{Average number of Trackers per website, splitting websites with and without a Consent Banner.}
        \label{fig:ca_country_avg_sep}
    \end{subfigure}
	\caption{Tracker penetration during different phases of a browsing sessions (top 2\,500 websites per country).  95\% confidence intervals are reported on each bar. On the \AFTER and \INTERNAL, we find many more Trackers.}
	\label{fig:ca_country}
\end{figure}

Figure~\ref{fig:ca_countries} shows websites sorted in descending order by the number of contacted Trackers as measured in the \BEFORE (red curve). This number tends to grow on the \AFTER (blue points), where we observe some websites that present 50-70 more Trackers. To increase readability, in Figure~\ref{fig:ca_countries}, the blue line reports the moving average (with a 100 window) of the number of contacted Trackers on the \AFTER. Curiously, some websites that already include Trackers in the \BEFORE include more Trackers in the \AFTER. This again may hint at a wrong implementation of the Consent Banner, which fails to hinder the presence of offending Trackers. The increase is less remarkable for US-popular websites -- mainly due to the less widespread presence of Consent Banners. 

To better quantify Tracker presence, we show the fraction of websites containing at least one Tracker in Figure~\ref{fig:ca_country_one}. As in Figure \ref{fig:ca_prevasiveness_top}, we report 95\% confidence interval on these sample proportions. About $50\%$ of websites popular in European countries already include at least one Tracker on \BEFORE. This happens more frequently in the UK ($63\%$) and less often in Germany ($44\%$). Again, note that a website embedding a Tracker on the \BEFORE does not necessarily represent a violation of the GDPR, even if this can often be the case~\cite{trevisan20194}. Interestingly, in the US this figure is higher than in European countries. Recalling that the probability of encountering a Consent Banner in the US is lower, this hints at a positive effect of the GDPR on popular European websites. The percentage of websites containing Trackers in the \AFTER grows for all European countries from a $+11\%$ increase in the UK to $+20\%$ for Germany. Confidence intervals never overlap. This increase is moderate ($+5\%$) in the US, given the lower fraction of those websites having a Consent Banner. We complete this analysis by reporting how this fraction increases when performing 5 \INTERNAL as recommended in~\cite{aqeel2020on}. Our results confirm this need, with the chance to observe at least one Tracker that further grows by $5\%$-$10\%$ in \INTERNAL when compared to the \AFTER. Note that, considering each country, none of the confidence intervals overlap between \BEFORE and \AFTER and between \AFTER and \INTERNAL.

We next investigate the quantity of Trackers contacted while visiting websites in Figure~\ref{fig:ca_country_avg}, which shows the average number of Trackers contacted on the websites, separately by country. Also in this case we report 95\% confidence intervals. The sample mean is an unbiased estimator of the true mean, and we can derive confidence intervals through central limit theorem. For all countries, the average amount of Trackers more than doubles on the \AFTER, and performing \INTERNAL further increases this figure (with non-overlapping confidence intervals). In Italy, for instance, this figure grows by a factor of $4$ when comparing \BEFORE and \INTERNAL. As previously noted, the behavior of US-popular websites differs from the European: before acceptance, the number of Trackers is already higher than in popular European websites, while it is comparable after. This hints that popular websites in the United States may be less receptive to GDPR indications. On the opposite side, German-popular websites appear to be the most observant of the regulations, installing Trackers only upon accepting the privacy policies. Afterwards, they reach levels comparable to the other countries. In summary, European websites use the same quantity of Trackers as US ones, although they are often contacted only after accepting the privacy policy. %Figure~\ref{fig:ca_country} show the variation of Trackers on the \BEFORE, \AFTER and \INTERNAL including all websites of the Similarweb list, regardless \TOOL found or not a Consent Banner. %To appreciate the variation in the number of trackers for websites implementing a Consent Banner, in the Appendix, we report in Figure~\ref{fig:ca_country_sep} the same metrics, showing separately websites for which \TOOL has found (or not) a Consent Banner. 


To appreciate the variation in the number of Trackers for those websites implementing a Consent Banner, we deepen the analysis by showing separately websites for which \TOOL has found (or not) a Consent Banner. Our goal is to show how Tracker number varies on the \BEFORE and \AFTER for those websites implementing the Consent Banner. Figure~\ref{fig:ca_country_one_sep} shows the percentage of websites with at least one Tracker, and Figure~\ref{fig:ca_country_avg_sep} shows the number of Trackers per website. The dark red bars and blue bars show results on the \BEFORE and \AFTER for those websites where \TOOL \emph{found} a Consent Banner.  As before, the increase of Trackers is sizeable. For completeness, the light red bars report the same measure for those websites where \TOOL \emph{did not} find any Consent Banner.

We finally observe that the probabilistic nature of Web tracking and bidding mechanisms results in a different number of Trackers contacted at each visit. To obtain the most reliable measurements, we test each website $5$ times, each time visiting $5$ internal pages. We note that measuring the fraction of websites containing at least one Tracker (as in Figure~\ref{fig:ca_country_one}) is moderately impacted by the number of tests. Indeed, when considering a single \AFTER per website, overall, we find $69.1\%$ of them containing one (or more) Trackers. Repeating $5$ times the test and considering whether we find at least one Tracker among all visits, this percentage increases only to $70.0\%$. Similarly, the average number of Trackers (as in Figure~\ref{fig:ca_country_avg}), increases from $6.5$ to $7.8$. We report additional details on this in the Appendix and in Figure~\ref{fig:visit_nb}.

\subsubsection{Analysis by category}

\begin{figure*}
    \centering
    \begin{subfigure}[t]{\textwidth}
        \includegraphics[width=\textwidth]{figures/cookieaccept_websites_with_trackers_category.pdf}
        \caption{Percentage of websites embedding Trackers. The top $x$-axis details the fraction of websites in such category where \TOOL found and accepted privacy policies.}
        \label{fig:ca_category_one}
    \end{subfigure}
    \begin{subfigure}[t]{\textwidth}
        \includegraphics[width=\textwidth]{figures/cookieaccept_trackers_per_website_category.pdf}
        \caption{Average number of Trackers per website.}
        \label{fig:ca_category_avg}
    \end{subfigure}
	\caption{Trackers penetration and number on websites (top 2\,500 per country) during different phases of a browsing session, separately by category. We sort categories from the highest to the lowest percentage of websites with Trackers in \BEFORE. 95\% confidence intervals are reported on each bar. In some cases (e.g., News and Media), on the \AFTER and \INTERNAL the increase is very pronounced.}
	\label{fig:ca_category}
\end{figure*}

We now break down the picture by category, showing the results in Figure~\ref{fig:ca_category}. We explicitly target websites of $24$ categories, each containing the top-$100$ websites for the considered countries.

Starting from Figure~\ref{fig:ca_category_one}, we report the percentage of websites of a given category that contain at least one Tracker. As before, there is a large increase from \BEFORE to \AFTER.  Exceptions are the \textit{Adult}, \textit{Law and Government} and \textit{Gambling} categories, where the confidence intervals overlap. For \textit{Adult} this is likely due to the low number of websites with Consent Banners ($20\%$) and confirms the peculiarity of the tracking ecosystem on Adult websites~\cite{vallina2019tales}. As previously observed in Figure~\ref{fig:ca_country_one}, performing \INTERNAL further increases the chance of encountering at least one Tracker, even though in this case the increase is limited and we observe some overlaps between \AFTER and \INTERNAL confidence intervals.

Moving to the number of trackers per website shown in Figure~\ref{fig:ca_category_avg}, we observe large increase in the \AFTER case, confirming that most Trackers appear only after the user accepts the privacy policies and when visiting internal pages. Here, differences across categories are all pronounced, with those categories that heavily depend on advertisements (\textit{News and Media}, \textit{Sports}, \textit{Games}, \textit{Arts and Entertainment}) that have to rely on a large number of Trackers to support behavioral advertisements. This is noticeable already on the \BEFORE. For example, access to a \textit{News} website leads to contact $5.7$ Trackers on average in \BEFORE. Here, \TOOL successfully accepts the privacy policies in $87\%$ of cases. Indeed, being \textit{News} websites very popular, they tend to correctly implement the privacy regulations and to show a well-configured Consent Banner. Upon acceptance, suddenly, the number of Trackers becomes almost 6 times higher ($30.9$ for \textit{News}) and 9 times higher when doing \INTERNAL ($47.7$ trackers on average). For \emph{Sport}, \emph{Food and Drink} and \emph{Arts and Entertainment} the average number of Trackers more than triples in \AFTER. Only for the \textit{Adult} category confidence intervals overlap.

These numbers are particularly interesting if read in the perspective of recent works. Englehardt~\emph{et al.}~\cite{englehardt2016online}, in 2016, measured an average of 35 Trackers per website on News websites. In 2021, we find similar numbers ($30.9$) on the \AFTER, while, due to the spread of Consent Banners, on the \BEFORE we would only find $5.7$, on average. On Sport category, Englehardt~\emph{et al.}~\cite{englehardt2016online} measured $27$ Trackers per website. In 2021, we find $21.0$ on the \AFTER, while only $4.6$ on the \BEFORE. These results well highlight the need for correctly handling the Consent Banners to observe the extensiveness of web tracking. %Without \TOOL, one would radically underestimate the footprint of the tracking and ads ecosystems on the Web. 
In a nutshell, thanks to \TOOL, we obtain the fundamentally different figure in the \AFTER and \INTERNAL. 

The case of \textit{Adult} websites is worth a specific comment. \TOOL finds the Consent Banner on only $20\%$ of them, and a manual check on $50$ of them confirms that the large majority of them do not offer any Consent Banner. Tracking is also limited upon acceptance, and the confidence intervals between \BEFORE and \AFTER even overlap. Similar results were previously found by Vallina~\emph{et al.}~\cite{vallina2019tales}, where the authors suggest that the specialized pornographic advertisement ecosystem may cause this behavior: usually, trackers and advertisers related to pornographic websites do not operate outside of them -- often evading popular tracker lists.

\textbf{Take away:} 
\textit{Upon consent, the number of Trackers embedded in websites increases by a factor of up to 4 times. European and US websites end up with a similar number of Trackers. The increase is particularly pronounced for certain website categories -- for example, News and media or Sport websites -- that rely on ads as revenue stream.}

\subsection{Visits from Outside Europe}

\begin{figure}[t]
    \centering
    \includegraphics[width=0.5\columnwidth]{figures/cookieaccept_compare_countries.pdf}
    \caption{Websites with Trackers (12\,277 from the Similarweb lists) when crawling from different countries. 95\% confidence intervals are reported on each bar. From non-European countries, \TOOL found fewer Consent Banners, but the amount of Trackers on the \AFTER is similar. Outside Europe, top-ranked websites tend to include more Trackers.}
    \label{fig:ca_us}
\end{figure}

We now consider additional measurement campaigns using crawling servers in the Amazon AWS data centers located in the US (Ohio and California), Japan and Brazil. Figure~\ref{fig:ca_us} summarizes our findings. First, notice how \TOOL accepted privacy policies on around $10\%$ fewer websites (about $1\,150-1\,200$) when run from outside Europe, as reported on top $x$-labels. 
%Investigating further, we find that the number of websites for which \TOOL can accept the Consent Banner when visited from Europe, but it fails when visited from not-EU countries, ranges between $1\,150$ and $1\,200$ according to the server location. 
%In fact, \TOOL fails in detecting the Consent Banner in $1\,150-1\,200$ websites when visiting them from not-EU countries.  
Checking the screenshot taken by \TOOL during the visit on a random subset of these websites, we confirm that no Consent Banner is displayed. We can conclude that some websites customize the Consent Banners based on visitors' properties, such as their location. If the visit comes from not EU country, no Consent Banner is shown.

This different behaviour of websites affects also the statistics of the fraction of websites that embed trackers in the \BEFORE and \AFTER visits. Visiting from outside Europe leads to an increase of Tracking on the \BEFORE in all cases, while, on the \AFTER, changes are limited.
%The percentage of websites that embed Trackers on the \BEFORE increases when visiting from outside Europe (up to $7.8\%$ more). On the \AFTER, these differences smooth out, revealing how \TOOL helps obtain user-centric measurements regardless of the presence or absence of Consent Banners on websites. %As a final note, we do not observe any significant difference visiting the websites from Ohio or California, despite the CCPA.\footnote{This figure may require further investigation since we are measuring from Amazon AWS servers whose location may not be correctly handled by the CMPs.}

\textbf{Take away:} 
\textit{The crawling location location has some impact on the results. This is mostly due to websites that show or not show the Consent Banner based on the user's location, thus not enabling or enabling tracking on the \BEFORE.}

\begin{figure}[!t]
    \centering
    \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=1.0\columnwidth]{figures/cookieaccept_tranco_rank_eu.pdf}
        \caption{Percentage of websites with a Consent Banner.}
        \label{fig:tranco_rank}
    \end{subfigure}
    \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=1.0\columnwidth]{figures/cookieaccept_tranco_rank_eu_tp_nb.pdf}
        \caption{Average number of Third-Parties per website.}
        \label{fig:tranco_tp}
    \end{subfigure}    
     \caption{Percentage of websites with a Consent Banner and average Third-Parties per website over the top-100 k websites in Tranco list, computed every $5\,000$ websites in the rank. Top websites are more likely to implement a Consent Banner in a \TOOL supported language.}
    \label{fig:tranco}   
\end{figure}

\section{Impact on Complexity and Performance on Top-100k Websites}
\label{sec:performance}

In this section, we measure the impact of accepting privacy policies on the webpage characteristics and loading performance. Trackers and Third-Party objects that the browser has to load and display upon consent may impact the amount of data to download and the rendering performance. Here, we do not restrict on a per-country or per-category analysis and use the crawl on the top-$100\,000$ websites according to the Tranco global list. 

For each website, we visit only the landing page, doing a \emph{Warm-up} visit to fill the browser cache, followed by a \BEFORE and \AFTER. We compare results on the latter two visits, considering only those websites for which \TOOL successfully accepted the privacy policy, which happens on $23$\% of websites. This is in line with the previous findings, as the Tranco list is a worldwide rank and includes (i) European websites in a language different from those for which we built the keyword list and (ii) websites based in non-European countries for which regulations do not apply. To give more insights, we detail the percentage of websites with a Consent Banner on the Tranco list in Figure~\ref{fig:tranco_rank}, computed every $5\,000$ websites in the rank. The solid red line reports the percentage for websites popular in the 5 European countries we target. Websites belong to this set if (i) they appear in the Similarweb ranks for the 5 countries or (ii) the Top-Level Domain belongs to the 5 countries.\footnote{The Tranco list does not provide a per-country rank.} Out of these $6\,917$ websites, \TOOL accepts the privacy policy on $3\,861$ ($55.8$\%), which is close to what we have obtained with the Similarweb ranks ($54.7\%$). This percentage does not change with website popularity. Conversely, for the remaining websites (blue dashed line), the share of websites where \TOOL found a Consent Banner is $32$\% for the top-ranked and then it settles around $20$\%, hinting that some globally popular websites tend to implement a Consent Banner even if they are based outside Europe, using a language supported by \TOOL (likely English). In 2020, Hills~\emph{et al.}~\cite{hills2020consent} found that popular CMPs are present on almost $10$\% of websites in the top-10 k Tranco list. Here, with \TOOL, we can affirm that Consent Banners (regardless the employed CMP) appear in more than $30$\% for the same set of websites.


The high number of Consent Banners found for the 5 European countries reflects in a large increase of the number of Third-Parties from the \BEFORE to the \AFTER, as shown in Figure~\ref{fig:tranco_tp}. The solid red line highlights that these websites already include, on average, $11.1$ Third-Parties in the \BEFORE. In the \AFTER, the average grows to $17.3$. Differently, the increase for the non-EU websites is smaller -- see the area between the blue solid and dashed lines. In the \BEFORE, Third-Parties are larger than for the 5 European countries if we compare the solid blue and red lines. This is due to the larger presence of non-EU websites, which do not have to implement a Consent Banner. In the \AFTER (dashed blue line), the increase is moderate, not reaching the values of the 5 European countries (red dashed line), potentially because \TOOL misses many \emph{Accept-button} in non-supported languages and of possible custom tracking domains not present in our lists. For the sake of completeness, in the Appendix, we report the same picture as in Figure~\ref{fig:tranco_tp} showing the number of Trackers instead of Third-Parties, providing similar insights.

\textbf{Take away:} 
\textit{For the five European countries considered, the percentage of websites with a Consent Banner (and the number of third parties) is approximately flat with respect to website rank. For the websites of the remaining countries, \TOOL may miss some \emph{Accept-button} due to the usage of local languages.}

\subsection{Impact on Page Objects and Size}

We focus on the webpage complexity in terms of  bytes and objects to download. We compute the ratio $R$ between the measurement on the \BEFORE and \AFTER, i.e., $R = x_{\textit{After}}/x_{\textit{Before}}$, where $x$ is the metric of interest. We show the results in Figure~\ref{fig:ca_perf_size}, separately for total downloaded bytes and objects. As expected, accepting the privacy policy increases the webpage size ($R>1$) by a sizeable factor. For instance, about $9$\% of websites download more than twice the objects, and about $5$\% of websites sees an increase of 3 times or more.

\begin{figure}[!t]
    \centering
    \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=\textwidth]{figures/cookieaccept_performance_tranco.pdf}
        \caption{Distribution of the page size (in bytes and objects) ratio over all websites.}
        \label{fig:ca_perf_size}
    \end{subfigure}
    \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=\textwidth]{figures/cookieaccept_tp_nb_tranco.pdf}
        \caption{Distribution of the number of Third Parties. Notice the log scales.}
        \label{fig:ca_perf_tp}
    \end{subfigure}
	\caption{Webpage characteristic before and upon consent to privacy policies (Tranco list). On the \AFTER webpages are larger and include more Third Parties.}
	\label{fig:ca_perf}
\end{figure}

Interestingly, we also observe some websites that are lighter in the \AFTER than in the \BEFORE. Investigating further, these cases are mostly due to the lack of additional content upon acceptance coupled with the saving of not loading the CMP objects on the \AFTER. This happens commonly on those websites that either add a Consent Banner despite not using tracking mechanisms, or that contact Trackers and Third-Parties even before the user has accepted the privacy policies. While the former might be seen as an excess of caution, the latter cases are likely violating the privacy regulations.

To better characterize the differences, we quantify the number of Third-Parties seen in the \BEFORE and \AFTER. We show the Empirical Complementary Cumulative Distribution Function (ECCDF) in Figure~\ref{fig:ca_perf_tp}. On median, websites rely on $12$ Third-Parties on the \BEFORE. This figure grows to $17$ on the \AFTER. The ECCDF highlights the tail of the distribution where we observe those websites that rely on a very large number of Third-Parties: the percentage of websites with more than $50$ grows from $1.8\%$ to $9.2\%$, with $3.0\%$ including more than 75 Third-Parties upon acceptance. This growth in the number of Third-Parties is mostly due to an increase of Trackers and objects related to advertisements that gets loaded after accepting the privacy policy. 
We also perform statistical tests to compare whether the mean and median of the two sample distributions are statistically different at level 0.05 (t-Test for the mean and Moodâ€™s test for the median). Both result statistically significant in \AFTER. 
In Appendix, we include the picture as above, plotting the number of Trackers instead of Third-Parties, leading to similar conclusions.

\textbf{Take away:} 
\textit{When the Consent Banner is accepted, websites are larger, with $9$\% of them containing more than twice as many objects. Websites including more than $50$ Third-Parties increase from $1.8\%$ to $9.2\%$.}

% \begin{figure}[!t]
%     \centering
%     \includegraphics[width=0.6\columnwidth]{figures/cookieaccept_onload_by_tracker_tranco.pdf}
%     \caption{OnLoad time of websites versus the increase of Third-Party number upon acceptance. The cardinality of each category is reported on the top axis.}
%     \label{fig:ca_onload}
% \end{figure}

\begin{figure}[!t]
    \centering
    \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=\textwidth]{figures/cookieaccept_onload_by_tracker_tranco.pdf}
        \caption{Warm Browser Cache.}
        \label{fig:ca_onload_warm}
    \end{subfigure}
    \begin{subfigure}[t]{0.495\columnwidth}
        \includegraphics[width=\textwidth]{figures/cookieaccept_onload_by_tracker_tranco_cold_cache.pdf}
        \caption{Cold Browser Cache.}
        \label{fig:ca_onload_cold}
    \end{subfigure}
    \caption{OnLoad time of websites versus the increase of Third-Party number upon acceptance (Tranco list). The cardinality of each category is reported on the top axis of the left-most figure. Website adding many Third Parties on the \AFTER are also slower to load. }
     \label{fig:ca_onload}
\end{figure}

\subsection{Impact on Page Load Time}

The Third-Party domains appearing after acceptance are generally devoted to advertisements, analytics and Web tracking. % -- see in Figure~\ref{fig:ca_prevasiveness_top} the most pervasive. 
Contacting them has direct implications on the page load time and, indirectly, on the users' QoE~\cite{da2018narrowing}. We thus expect this to cause an increase on the page load time because the browser has to resolve the server name via DNS and contact more servers. For instance, this ultimately limits the advantages offered by new protocols like the stream multiplexing and the header compression offered by HTTP/2 and HTTP/3.

To gauge this, we dissect the webpage load time in Figure~\ref{fig:ca_onload}, comparing separately visits with a warm cache (Figure~\ref{fig:ca_onload_warm}) and with a cold cache (Figure~\ref{fig:ca_onload_cold}). In case of warm cache, we run a \emph{Warm-up visit}, then the \BEFORE and \AFTER. In case of of cold cache, we run the \BEFORE without a \emph{Warm-up visit}. Then we erase the HTTP cache and socket pool, then we run the \AFTER.

We report the distributions of the \textit{onLoad} time for websites with similar number of additional Third-Parties that are loaded in the \AFTER. We use boxplots, where the boxes span from the first to the third quartile and whiskers from the $10^{th}$ to $90^{th}$ percentile. The central stroke represents the median. The number of websites in each set is detailed on the top the respective boxplot. As expected, the more Third-Parties are loaded upon acceptance, the larger the time needed to load the webpage and the larger its variability. Especially for the websites that add more than 10 Third-Parties, the distributions are remarkably different on the \BEFORE and \AFTER. Considering visits with cold browser cache (Figure~\ref{fig:ca_onload_warm}), those website with $20-50$ additional Third-Parties, the median \textit{onLoad} time passes from $0.91$ to $1.41$ seconds. The difference increases for the $632$ websites adding more than $50$ Third-Parties upon acceptance. Here, the median \textit{onLoad} time increases from $1.35$ to $3.38$ seconds, more than doubling. Notice also the tail of $25\%$ of websites loading in more than $4.8$\,seconds, which happens in less than $2\%$ of cases during the \BEFORE. We already observed such an increase in our previous study~\cite{traverso2017benchmark}, where we measured that median \textit{onLoad} time increases by $1.3s$ when cookies policies are accepted. 
We statistically compare all these couples of sample distributions between  \BEFORE and \AFTER, testing differences in the median at a significance level 0.05 (Mood's test). The test is passed in all cases, showing statistically significant differences.


Similar considerations hold for visits with a cold browser cache (Figure~\ref{fig:ca_onload_cold}). As expected, with the clean cache, websites load time increases -- compare values in Figures~\ref{fig:ca_onload_warm} and~\ref{fig:ca_onload_cold}. Those that do not add new Third-Parties tend to load slightly faster on the \AFTER, potentially due to the absence of the Consent Banner. In fact, differences are statistically significant in the median of the distributions between \BEFORE and \AFTER,  except for the group $1-10$ additional Third-Parties.
Again, we observe that those adding several Third-Parties after acceptance have much higher \textit{onLoad} time on the \AFTER than on the \BEFORE:  The median \textit{onLoad} time increases from $1.8$ to $5.2$ seconds. Finally, we observe that the \textit{onLoad} time values tend to be lower than what measured in older works, potentially because of the advances of content delivery network and increased hardware and software performance. Bocchi~\emph{et al.}~\cite{bocchi2016measuring} measured a median \textit{onLoad} time of 3s in 2016 on a similar albeit smaller set of websites.

\textbf{Take away:} 
\textit{Measuring the webpage load time of websites without considering the implications of accepting the Consent Banners would result in a very biased measurement. Websites that include many more Third-Parties upon acceptance are significantly slower to load.}