\chapter{Differential bundles}%
\label{ch:differential_bundles}

Our principal aim in this thesis is to provide an abstract tangent-categorical axiomatization for Lie algebroids.  To accomplish this, we must provide an axiomatization for Lie algebroids which is essentially algebraic (in the sense of \cite{Freyd1972}).  However, in the category of smooth manifolds, Lie algebroids are defined in terms of vector bundles and these are prima facie a highly non-algebraic notion.  

In addition to algebraic axioms which make it an $\R$-module in the slice over its base $M$, a vector bundle $q:E \to M$ satisfies a crucial topological requirement:  it must be locally trivial.  This means that the projection $q : E \to M$ must be locally isomorphic to a projection $\pi_0:U \x \R^n \to U$ for some open subset $U$ of $M$ and natural number $n$.  It is this property that permits calculations using local coordinates, an approach deeply enshrined in the culture of differential geometry.

\cite{Cockett2017} introduced the algebraic notion of a differential bundle.  Evidence that differential bundles are the appropriate generalization of vector bundles was provided by showing how classical results for vector bundles could be generalized to differential bundles in any tangent category  \cite{Cockett2017,Cockett2018}.  However, the precise relationship in the category of smooth manifolds between vector bundles and differential bundles was left open. The main result of this chapter (see \cite{MacAdam2021}) is that vector bundles and differential bundles coincide in the category of smooth manifolds.

The axiomatization of differential bundles focuses on another important property of vector bundles: given a vector bundle $q:E \to M$ and a vector $v$ in the fibre $E_x$ above $x \in M$, the tangent space $T_v(E_x)$ can be naturally identified with $E_x$.    This gives a lift map $\lambda:E \to TE$ which can be axiomatized.   While the lift map had long been noted in the differential geometry literature in the guise of the Euler vector field (see 6.11 of \cite{Kolar1993} and also Section 1 of \cite{Michor1996} which explicitly uses the term "lift"), it had not been adopted as the basis of an abstract axiomatization.  

More recently, in the differential geometry literature, \cite{Grabowski2009} and \cite{Bursztyn2016} realized that the multiplicative $\R^+$-action on the total space $E$ determines the vector bundle structure of $q:E \to M$, and conversely such a multiplicative action determines a vector bundle precisely when its Euler vector field (Definition \ref{def:evf}) satisfies an additional ``non-singular'' property.  This chapter extends these more recent observations on vector bundles to differential bundles.

The chapter begins by reviewing vector bundles, describing the Euler vector field construction that sends a vector bundle $q:E \to M$ to a "lift" map $\lambda:E \to TE$ from \cite{Grabowski2009}, whereas the rest of the chapter contains new results developed in collaboration with Matthew Burke. The second section establishes that these lifts are associative coalgebras for the weak comonad $(T,\ell)$, and that there is a fully faithful functor from vector bundles into the category of lifts for smooth manifolds. The third section identifies the universal property satisfied by the lift (or equivalently Euler vector field), while the fourth section shows that a non-singular lift corresponds precisely to a differential bundle. The fifth section proves the main theorem of the chapter: vector bundles are precisely differential bundles for smooth manifolds. The final section contains some remarks on extending affine connections to arbitrary differential bundles, which will be useful in Chapter \ref{ch:involution-algebroids}. 

\pagenote{Each chapter has been given a new introduction.}


\section{Vector bundles}%
\label{sec:vector-bundles}

A vector bundle over a manifold $M$ axiomatizes the notion of a smoothly varying family of vector spaces indexed by the points $m \in M$.
The driving example is that of the tangent bundle over a smooth manifold $M$, where the fibre above each point $m \in M$ is the tangent space $T_mM$.
The manifold structure guarantees that the projection is \emph{locally trivial}: given a chart $U \hookrightarrow M$, the next pullback splits as a product:
\[\input{TikzDrawings/Ch2/splitting-lem.tikz}\]
The local triviality of the tangent bundle is essential for various constructions and is part of the definition of a vector bundle.

\begin{definition}\label{def:vector-bundle}
  A \emph{vector bundle} is a tuple \[(q:E \to M, \xi:M \to E, +: E \ts{q}{q} E \to E, \cdot: \R \x E \to E)\] of morphisms in $\mathsf{SMan}$ so that
  \begin{enumerate}[(i)]
    \item the tuple $(q,\xi,+, \cdot)$ defines an $\R$-module in $\mathsf{SMan}/M$;
    \item the map $q:E \to M$ is locally trivial.
  \end{enumerate}
  The fibred $\R$-module structure means $E$ is a family of vector spaces indexed by $M$, $\{ E_m | m \in M \}$.
\end{definition}
It is important to note that the local triviality axiom guarantees that the projection of a vector bundle is a submersion (Definition \ref{def:submersion-sman}); thus pullback powers of $q:E \to M$ exist and are preserved by the tangent functor.\pagenote{This addresses a concern Kristine had raised about the preservation of $E_2$ by $T$.}
\begin{example}
    Consider the cylinder, defined as  the subset of $\R^3$ spanned by $C = \{ (x,y,z) | x^2 + y^2 = 1, z \in \R \}$:
    \input{TikzDrawings/Ch2/cylinder.tikz}
    Above each point $i \in S^1 = \{ (x,y) |  x^2 + y^2 = 1\}$ the fibre over $i$ is $\R$. For each point $i$, we can choose a sufficiently small $\epsilon$ and take the open set \[U_i = \{ (x,y) \in S^1 |  (i_x - x)^2 + (i_y - y)^2 \le \epsilon \},\] which may be flattened to $(-(1+\epsilon), 1+\epsilon) \x \R$.
    % \input{TikzDrawings/Ch2/flattened-cylinder-neighbourhood.tikz}
    % So the projection $C \to S^1$ is a vector bundle.
\end{example}
\pagenote{Carried forward the change in chapter 1 re:notation for $\chi(M)$, then defined the $C^\infty$ module structure for the sections of a vector bundle projection (this is a more appropriate place to introduce this notation than the Lie algebroids section)}
%NOTE: Carried forward the change in chapter 1 re:notation for \chi(M), then defined the C^\infty module structure for the sections of a vector bundle projection (this is a more appropriate place to introduce this notation than the Lie algebroids section)
The sections of a vector bundle also give rise to a $C^\infty(M)$-module, generalizing that aspect of the tangent bundle's fibred $\R$-module structure.
\begin{lemma}\label{lem:Cinfty-module-vbun}
  Given a vector bundle $q:E \to M$, write the set of sections of $q$ as $\Gamma(q)$; as, for example, $\Gamma(p.M) = \chi(M)$ (recall the notation from Definition \ref{def:operational-tang}). The set $\Gamma(q)$ has a $C^\infty(M)$-module structure in much the same way as $\chi(M)$:
  \[
      X +_{\Gamma(q)} Y := + \o (X,Y), \hspace{0.25cm}
      0_{\Gamma(q)} := \xi, \hspace{0.25cm}
      (f \cdot_{\Gamma(q)} X) (m) := f(m) \cdot X(m)
  \]
\end{lemma}
There are also a variety of general constructions that yield vector bundles.
\begin{example}
  ~\begin{enumerate}[(i)]
    \item The tangent bundle is a vector bundle: the construction in \Cref{sec:smooth-manifolds} makes it clear that the projection $p:TM \to M$ is a locally trivial, fibred $\R$-module over the base space $M$.
    \item A \emph{trivial} vector bundle over $M$ with fibres in $V$ is the product $M \x V$. In particular, every vector space is a trivial vector bundle above the one-point space $\{*\}$.
    \item Each $T_kM$ will be locally trivial; locally it looks like the $k$-fold product of the tangent space $p_k^{-1}(U) \cong U \x (\R^n)^k$ for an $n$-dimensional manifold $M$. More generally, one can take the fibrewise pullback $E_k = E \ts{q}{q} E \ts{q}{q} \dots \ts{q}{q} E$ and discover a vector bundle over $M$.
    \item The \emph{cotangent bundle} of $M$, $T^*M$,  has the \emph{dual} vector space of $T_mM$ above each point $M$: $T^*_m(M) = (T_mM)^*$. This space can be appropriately topologized to be smooth, and a set of sections of $\Gamma(T^*M)$ is isomorphic to the set of morphisms $TM \to \R$ that are linear in each fibre. This construction may be applied to any vector bundle and is called the dual vector bundle.
    \item Consider the space $\Lambda^n(E)$, the alternating tensor product of $E^*$. The set of sections of this vector bundle is equivalent to the alternating $n$-linear morphism $E_n \to \R$; when restricted to the tangent bundle, this is the space of differential $n$-forms.
  \end{enumerate}
\end{example}
There are two constructions on vector bundles that will be necessary to prove the main theorem of this section.
\begin{proposition}%
  \label{prop:retracts-reindexing-of-vbuns}
  Let $(q:E \to M, \xi, +_q, \cdot_q)$ be a vector bundle. 
  ~\begin{enumerate}[(i)]
    \item For any map $f:N \to M$, the $T$-reindexing of $q$ by $f$ is a vector bundle:
    \begin{equation}%
      \label{eq:reindex-vbun}
      \input{TikzDrawings/Ch2/reindex-vbun.tikz}
    \end{equation}
    % and the morphism $(\bar{f},f)$ is linear.
    \item Any retract of $q$ in the space of arrows is a vector bundle; that is, given
    \begin{equation}%
      \label{eq:ret-of-idemp}
      \input{TikzDrawings/Ch2/ret-of-idemp.tikz}
    \end{equation}
    if there is a vector bundle structure on $q$, then there is a vector bundle structure on $\pi$.
  \end{enumerate}
\end{proposition}

The category of vector bundles has ``locally linear'' bundle morphisms as its maps.
\begin{definition}
  A \emph{morphism of vector bundles} between $q:E \to M$ and $\pi:F \to N$ is a commuting square
  \input{TikzDrawings/Ch2/vbun-morphism.tikz}
  that is \emph{fibrewise linear}, so that above each fibre \[  f|_m: E_m \to F_{v(m)} \] is a linear morphism of vector spaces. This may equivalently be stated as a morphism of fibred $\R$-modules, so that the following diagrams commute:
  \[\input{TikzDrawings/Ch2/vbun-morphism-coh.tikz}\]
\end{definition}
\begin{example}
  ~\begin{enumerate}[(i)]
    \item For the pullback vector bundle in Diagram \ref{eq:reindex-vbun}, the pair $(\bar{f},f)$ is a linear bundle morphism.
    \item For the section/retract vector bundle structure from Diagram \ref{eq:ret-of-idemp}, the section and retract are linear morphisms. 
    Note that this is exactly the splitting of a linear idempotent on $q:E \to M$.
  \end{enumerate}
\end{example}

The lift on the tangent bundle was defined in Section \ref{sec:smooth-manifolds} as
\[
  [\gamma]_\sim \mapsto [\gamma \o \cdot_\R]_\sim. 
\]
Instead, consider the action of $\R$ on a tangent vector:
\[
  ([\gamma]_\sim, r) \mapsto [\gamma \o (r \cdot x)]_\sim.
\]
Note that $T.\cdot$ gives the equation
\[
  T.\cdot \o ([\omega \o (x,y)], [(a,b) \mapsto a + b\cdot x]) = (\omega \o (a \cdot x, a \cdot b\cdot y));
\]
so the lift map $\ell$ can be rederived as follows:
\[\input{TikzDrawings/Ch2/VBun/derive-lift-on-tm.tikz}\]
This general construction is known as the \emph{Euler vector field} of a multiplicative action by $\R^+$.
\begin{definition}%
  \label{def:evf}
  Consider a multiplicative monoid action $a:\R^+ \x E \to E$. The \emph{Euler vector field}\footnote{Somewhat confusingly, the Euler vector field is almost never a vector field.} of the action is the morphism $\lambda:E \to TE$ constructed as follows:
  \[
    \lambda:= E \xrightarrow[]{(id, 1^\R \o !)} E \x \R \xrightarrow{0 \x \lambda} TE \x T\R \cong T(E \x \R) \xrightarrow{T.a} TE.
  \]
  \pagenote{This definition has been tidied up so that is clear that $\lambda$ is defined by the diagram in the definition.}
\end{definition}
Local triviality for the tangent bundle is encoded by the universality of the vertical lift condition. A similar universality condition holds for vector bundles.
\begin{proposition}%
  \label{prop:ros-for-vbun}
  Let $q:E \to M$ be a vector bundle with corresponding Euler vector field $\lambda$.
  Then the following diagram is a $T$-pullback:
  \begin{equation*}
    \input{TikzDrawings/Ch2/ros-universal.tikz}
  \end{equation*}
\end{proposition}
Exploiting the fact that fibred $\R$-modules have subtraction, the following result holds.
\begin{corollary}%
  \label{cor:two-pullbacks-from-ros}
  The following two diagrams are T-equalizers:
  \[
    \input{TikzDrawings/Ch2/strong-cockett.tikz}
  \]
  (recall that $E_2$ is the pullback of a submersion along a submersion and is therefore guaranteed to exist and be preserved by the tangent functor).
\end{corollary}
\begin{proof}
  Given $v: X \to TE$ so that
  \[ T.q \o v = T.q \o 0 \o p \o v \]
  then 
  \[ p \o (v -_{T.q} 0 \o p \o v) =  p \o v -_q p \o v = \xi \o q \o v. \]
  So there is a unique $v'$ so that
  \[
    \lambda \o v' = (v -_{T.q} 0 \o p \o v)
  \]
  meaning that
  \[
    v = 0 \o p \o v  +_{T.q} \lambda \o v'  = \mu(0 \o p \o v, v')
  \] as required. The projection $q$ is a submersion, so the pullback $E_2$ is preserved by the tangent functor, as is the pullback in Proposition \ref{prop:ros-for-vbun}, and the same calculation may be applied for each $T^n$. The proof for $\nu$ follows by the same argument.
\end{proof}
Recall that the class of submersions forms a retractive display system in the category of smooth manifolds (Definition \ref{def:display-system}), so they are stable under reindexing and closed to retracts.\pagenote{
   I had originally used the fact that the pullback $E \ts{q}{q} E$ was preserved without explaining why it was preserved, so I have added a reference to the section on submersions and pointed out that vector bundle projections are submersions (as they are local projections).
}
We may now infer the following:
\begin{corollary}
  The projection for a vector bundle is a submersion.
\end{corollary}
\begin{proof}
  This follows from the fact that $\pi:TE \to E$ is a submersion, so that $q \o \pi_0: E \ts{q}{p} TM \to M$ is a submersion, so the map $q:E \to M$ is a retract of the projection $p.E:TE \to E$ in the arrow category.
\end{proof}
Preservation of the Euler vector field is also sufficient to guarantee that a morphism $f:E \to F$ determines a vector bundle morphism.
\begin{proposition}%
  \label{prop:evf-is-ff}
  Let $q: E \to M, \pi: F \to N$ be a pair of vector bundles with Euler vector fields $\lambda^E,\lambda^F$.
  Then a bundle morphism $(f,v):q \to \pi$ is a vector bundle morphism if and only if \[\lambda^F \o f = T.f \o \lambda^E\]
\end{proposition}
\begin{proof}
  Note that the $\nu^F$ map from Corollary \ref{cor:two-pullbacks-from-ros} is monic, and if $f$ preserves the lift, it preserves $\nu$:
  \[
    \nu^F \o (T.v, f) = + \o (T.\zeta \o T.v, \lambda^F \o f) = + \o (T.f \o T.xi, T.f \o \lambda^E) = T.f \o \nu^E. 
  \]
  Next, observe that $T.v \x f$ is the unique map making the following diagram commute:
  \[\input{TikzDrawings/Ch2/VBun/pres-nu-pres-lambda.tikz}\] 
  Now $\nu$ is a vector bundle morphism and monic, and $T.f$ is a vector bundle morphism, so it follows that $T.v \x f$ is a vector bundle morphism and hence $f$ is also a vector bundle morphism. The reverse implication is immediate.
\end{proof}



\section{Lifts for the tangent weak comonad}%
\label{sec:lifts}
%NOTE: Included some material on weak/semicomonads to clarify some confusion.
The lift $\ell: T \Rightarrow T^2$ gives rise to a \emph{weak comonad}.
% ---an endofunctor equipped with an associative comultiplication map:
% \[
%   \input{TikzDrawings/Ch2/ell-comonad.tikz}
% \]
Weak comonads were introduced in \cite{Wisbauer2013} and have a natural notion of an associative algebra\footnote{
This is not \emph{strictly} true. Wisbauer has a more nuanced hierarchy of almost-monads, and in his language $(T,\ell)$ would be an endofunctor with an associative product.
}. An associative coalgebra of the weak comonad $(T,\ell)$ is called a \emph{lift}; this chapter will demonstrate that lifts provide the essential structure necessary to formulate vector bundles.\pagenote{
Included some material on weak comonads to clear up confusion, as the map $p$ does have the right type for a counit it should be noted that it is not a counit in general.
}
\begin{definition}
  A weak comonad on a category $\C$ is an endofunctor $S: \C \to \C$ equipped with a coassociative map $\delta:S \Rightarrow S.S$:
  % https://q.uiver.app/?q=WzAsNCxbMCwwLCJGIl0sWzEsMCwiRi5GIl0sWzAsMSwiRi5GIl0sWzEsMSwiRi5GLkYiXSxbMCwxLCJcXGRlbHRhIiwxXSxbMCwyLCJcXGRlbHRhIiwxXSxbMSwzLCJGLlxcZGVsdGEiLDFdLFsyLDMsIlxcZGVsdGEuRiIsMV1d
  \[\begin{tikzcd}
    S & {S.S} \\
    {S.S} & {S.S.S}
    \arrow["\delta"{description}, from=1-1, to=1-2]
    \arrow["\delta"{description}, from=1-1, to=2-1]
    \arrow["{S.\delta}"{description}, from=1-2, to=2-2]
    \arrow["{\delta.S}"{description}, from=2-1, to=2-2]
  \end{tikzcd}\]
  An \emph{associative algebra} of a weak comonad is an object $E$ equipped with a map $\lambda:E \to SE$ so that
  % https://q.uiver.app/?q=WzAsNCxbMCwwLCJFIl0sWzEsMCwiRi5FIl0sWzAsMSwiRi5FIl0sWzEsMSwiRi5GLkYiXSxbMCwxLCJcXGxhbWJkYSIsMV0sWzAsMiwiXFxsYW1iZGEiLDFdLFsxLDMsIlxcZGVsdGEuRSIsMV0sWzIsMywiRi5cXGxhbWJkYSIsMV1d
  \[\begin{tikzcd}
    E & {S.E} \\
    {S.E} & {S.S.E}
    \arrow["\lambda"{description}, from=1-1, to=1-2]
    \arrow["\lambda"{description}, from=1-1, to=2-1]
    \arrow["{\delta.E}"{description}, from=1-2, to=2-2]
    \arrow["{S.\lambda}"{description}, from=2-1, to=2-2]
  \end{tikzcd}\]
  A morphism of these algebras is a map $f:(E,\lambda) \Rightarrow (D,\gamma)$ so that
  % https://q.uiver.app/?q=WzAsNCxbMCwwLCJFIl0sWzAsMSwiRkUiXSxbMSwwLCJEIl0sWzEsMSwiRkQiXSxbMCwyLCJmIiwxXSxbMSwzLCJGLmYiLDFdLFswLDEsIlxcbGFtYmRhIiwxXSxbMiwzLCJcXGdhbW1hIiwxXV0=
  \[\begin{tikzcd}
    E & D \\
    S.E & S.D
    \arrow["f"{description}, from=1-1, to=1-2]
    \arrow["{S.f}"{description}, from=2-1, to=2-2]
    \arrow["\lambda"{description}, from=1-1, to=2-1]
    \arrow["\gamma"{description}, from=1-2, to=2-2]
  \end{tikzcd}\]
\end{definition}
Recall that for a full (co)monad, there is an adjunction between the base category and the category of (co)algebras. That result is weakened in this case: 
\begin{lemma}
  For every weak comonad on a category $\C$, there is a free coalgebra functor
  \[
      F: \C \to \mathsf{CoAlg}(\C); E \mapsto (S.E, \delta:S.E \to S.S.E)
  \]  
  an underlying object functor
  \[
      U: \mathsf{CoAlg}(\C) \to \C; (E, \lambda) \mapsto E
  \]
  and a natural transformation
  \[
      \lambda:id \Rightarrow F.U; % https://q.uiver.app/?q=WzAsNCxbMCwwLCJFIl0sWzAsMSwiRkUiXSxbMSwwLCJEIl0sWzEsMSwiRkQiXSxbMCwyLCJmIiwxXSxbMSwzLCJGLmYiLDFdLFswLDEsIlxcbGFtYmRhIiwxXSxbMiwzLCJcXGdhbW1hIiwxXV0=
      \begin{tikzcd}
        E & S.E \\
        S.E & S.S.E
        \arrow["\lambda"{description}, from=1-1, to=1-2]
        \arrow["{S.\lambda}"{description}, from=2-1, to=2-2]
        \arrow["\lambda"{description}, from=1-1, to=2-1]
        \arrow["\delta"{description}, from=1-2, to=2-2]
      \end{tikzcd}
  \]
\end{lemma}
\begin{definition}\label{def:lift}
  A \emph{lift} in a tangent category $\C$ is an associative coalgebra of $(T,\ell)$, namely, a pair $(E, \lambda: E \to TE)$ so that the following diagram commutes:
  \[
    \input{TikzDrawings/Ch2/lift-diag.tikz}
  \]
  A morphism of lifts is a coalgebra morphism. The category of lifts and lift morphisms in a tangent category $\C$ is written $\mathsf{Lift}(\C)$.
\end{definition}
Note that the tangent bundle is \emph{not}, in general, a comonad: while the tangent projection has the correct type for a counit, $p:T \Rightarrow id$, it does not satisfy $p \o \ell = id$. In fact, if $p$ were a counit, this would force $id = p \o \ell = 0 \o p$ so that $0$ = $p^{-1}$, thus if $(T,\ell,p)$ is a comonad then $T$ is naturally isomorphic to the identity functor.
\begin{example}
  \label{ex:lift-examples}
  ~\begin{enumerate}[(i)]
    \item For every object $M$ in a tangent category $\C$, the pair $(TM, \ell:TM \to T^2M)$ is a lift, called the \emph{free lift} on $M$.
    \item Every object $M$ in a tangent category has a \emph{trivial} lift, $0:M \to TM$, where $T.0 \o 0 = \ell \o 0.$
    \item Every differential object has a lift $\lambda$; the coherence is equivalent to axiom $[D0.3]$ in Definition \ref{def:differential-object}. \pagenote{
        I have added the map $\lambda:E \to TE$ from the definition of a differential object, and the exact differential object axiom that makes it a lift.
    }
    \item %NOTE: 
    \pagenote{I moved the Euler vector field into the examples, fixed notation, and tried to clarify some points Kristine brought up. I make explicit use of the Kock-Lawvere axiom here, so that $T\R$ is $R[x]/x^2$ and $T^2\R$ is $R[x]/(x^2,y^2)$.}
    The Euler vector field of a multiplicative $\R^+$-action $h:R^+ \x E \to E$ in $\mathsf{SMan}$ is a lift.
    % \end{proposition}
    % \begin{proof}
      Recall that the \textit{Euler vector field} over the scalar action $s_M: TM \x \R \to \R$ induces the vertical lift on a manifold:
      \[
          \ell = T.s_M \o (0, \lambda^\R \o 1^{\R} \o !).
      \]
      In the category of smooth manifolds, $T\R \cong \R[x]/x^2$, where $\lambda(r) = [x \mapsto r\cdot x]$ corresponds to the map $\lambda'(r) = 0 + r\cdot x$. Similarly, there is an isomorphism $\R[x,y]/(x^2,y^2)$ so that for the maps $0.T and T.0$,
      \[
          0.T(a + r\cdot x) \cong a + r\cdot x + 0y + 0xy,\hspace{0.5cm}
          T.0(a + r\cdot x) \cong a + 0x + r\cdot y + 0xy.
      \]
      Since we know that $(0 + x)(0 + y) = (0 + xy)$ in $\R[x,y]/(x^2,y^2)$ (following \ref{ex:diffob-sman}), we can use these isomorphisms to see that
      % In the category of smooth manifolds, the scalar ring $\R$ has the following universal property on its lift:
      \[
          \ell \o \lambda^\R \o 1^\R \o != 
          (0.T \o \lambda^\R \o 1^\R \o !) \cdot_{T^2.\R} (T.0\o \lambda^\R\o 1^\R \o !).
      \]
      % following from the fact that $T^2\R$ is isomorphic as a ring to $R[x,y]/(x^2,y^2)$ and $(0 + x)(0 + y) = (0 + xy)$.
      % \footnote{This is in fact one of the axioms of synthetic differenta}
  
      Consider a monoid action $(\R^+, h)$ on a manifold $E$. The Euler vector field of this action, 
      \[
          \lambda: E \xrightarrow[]{(id, 1^\R \o !)} E \x \R \xrightarrow{(0,\lambda^\R)} TE \x T\R \xrightarrow{T.h} TE
      \]
      will define an algebra if the induced scalar action on $TE$ commutes with the natural scalar action:
      \begin{align*}
          T.\lambda \o \lambda
          &= T^2.h \o (T.0 \o\lambda, T.\lambda \o 0\o 1^\R \o !) \\
          &= T^2.h \o (T.0 \o T.h \o (0, \lambda \o 1^\R \o !), 0 \o \lambda \o 1^\R \o !) \\
          &= T^2.h \o (T^2.h\o (T0\o 0, T0 \o \lambda \o 1^\R \o !), 0 \o \lambda \o 1^\R \o !) \\
          &= T^2.h \o (T.0 \o 0, (T.0 \o \lambda \o 1^\R \o !) \cdot_{T^2.\R}( 0.T \o  \lambda \o 1^\R \o !) ) \\
          &= T^2.h \o (\ell \o 0, \ell \o \lambda \o 1^\R \o !)  \\
          &= \ell \o T.h \o  (0, \lambda \o 1^\R \o !) \\
          &= \ell \o \lambda.
      \end{align*}
      % so then any splitting of $p \o \lambda$ induces a pre-differential bundle (which corresponds to the image of $h \o (id, 0^\R)$). 
    % \end{proof}
    % \item Returning to the category $\mathsf{Lex}$, where $TE$ is the category of Beck modules in $E$ and $\ell$ sends a Beck module to the double Beck module:
    % \input{TikzDrawings/Ch2/dbl-Beck.tikz}
    % Now, a coalgebra is a map that sends an object in $E$ to a Beck module, so that $\ell \o \lambda = T.\lambda \o \lambda$:
    % \input{TikzDrawings/Ch2/beck-module-example.tikz}
    % It follows that $\lambda (X_1) = \lambda(X)$, and $\lambda(X_0) = 0(X_0)$. 
    % This means that a coalgebra sends an object $X$ to a Beck module $X_1 \to X_0$, so that the choice for $X_0$ is the identity bundle and the choice for $X_1$ is this bundle (e.g. it is the same as the original $X$).
  \end{enumerate}
\end{example}
\begin{observation}\label{obs:evf-is-ff}
  Recall that by Proposition \ref{prop:evf-is-ff}, morphisms preserve a monoid action if and only if they preserve the associated Euler vector field of the action. This means the Euler vector field construction gives a fully faithful functor from monoid actions to lifts in the category of smooth manifolds, and therefore from the category of vector bundles to the category of lifts in $\mathsf{SMan}$.
\end{observation}

The following proposition gives a pair of constructions on lifts---closure under the tangent functor and finite $T$-limits---that will be useful in this section.
\begin{lemma}%
  \label{lem:T-limits-of-lifts}
  Let $\C$ be a tangent category.
  ~\begin{enumerate}[(i)]
    \item The tangent functor lifts to an endofunctor on the category of lifts in $\C$.
    % The tangent functor preserves lift and lift morphisms: given a lift $\lambda:E \to TE$, then $c \o T.\lambda:TE \to TTE$ is a lift.
    \item Given a diagram \pagenote{
       I have clarified the statement and make the proof more concrete, I have also moved this result to a lemma and made the next result a proposition rather than corollary.
    }
    % Observe that for any diagram into the category of lifts:
    \[ D: \d \to \mathsf{Lift}(\C)\]
    in the category of lifts of $\C$, if the $T$-limit of $U.D$ exists in $\C$, then $\lim U.D$ has a natural lift $\lambda'$ associated to it so that $(\lim U.D, \lambda')$ is the limit of $D$ in $\mathsf{Lifts}(\C)$. (That is, $T$-limits of lifts are computed pointwise in the base category.)
    \pagenote{
       The proof for the 
    }
    % There will be a natural transformation:
    % \[\input{TikzDrawings/Ch2/nat-trans.tikz}\]
    % This induces a morphism:
    % \[
    %     \lim\lambda: \lim (U^\ell.D) \to \lim (T.U^\ell.D) \cong T.\lim(U^\ell.D)
    % \] that gives the induced lift on the limit of $\lim (U^\ell.D)$ - this lift is the limit $\lim D$. 
    % Finite limits of lifts are computed point-wise on the objects.
  \end{enumerate}
\end{lemma}
\begin{proof}
  ~\begin{enumerate}[(i)]
    \item Simply check that 
    \begin{gather*}
      T.(c \o T.\lambda) \o c \o T.\lambda = T.c \o T^2.\lambda \o c \o T.\lambda  = T.c \o c.T \o T^2.\lambda  \\= T.c \o c.T \o T.\ell \o T.\lambda = \ell.T \o c \o T.\lambda. 
    \end{gather*}
    \item 
    Concretely, a tangent terminal object will have a lift:
    \[
        (1, 1 \xrightarrow[]{0} T.1 \cong 1).
    \] 
    Given $(E,\lambda)$ and $(F,l)$, if the tangent product $E \x F$ exists there is a lift
    \[
      (E \x F, E \x F \xrightarrow[]{\lambda \x l} TE \x TF \cong T(E \x F)).
    \]
    Given the $T$-equalizer of a fork $f,g:(E,\lambda) \to (F,l)$, the equalizer has a lift induced as follows:
    \[
      \input{TikzDrawings/Ch2/eq-of-lifts.tikz}
    \]
    % And given a span of lifts: $(E,\lambda) \xrightarrow[]{f} (C,k) \xleftarrow[]{g} (F,l)$, if the $T$-pullback $E \ts{f}{g} F$ exists then the induced lift is 
    % \[
    %   (E \ts{f}{g} F, \lambda \x l:E \ts{f}{g} F \to T(E \ts{f}{g} F))
    % \]
  \end{enumerate}
\end{proof}
\begin{proposition}\label{prop:lifts-is-tangent}
  The category of lifts is a tangent category.
\end{proposition}
\begin{proof}
  The tangent functor sends 
  \[
    \infer{T.f: (TE, c \o T.\lambda) \to (TF, c \o T.l)}{f:(E,\lambda) \to (F,l)}.
  \]
  To see that this is still an algebra morphism, compute
  \[
    c \o T.l \o T.f = c \o T^2.f \o T.\lambda = T^2.f \o c \o T.\lambda
  \]
  The structure maps are the structure maps on the underlying object of the lift; the universality conditions follow by Proposition \ref{lem:T-limits-of-lifts}.
\end{proof}

% \begin{example}%
%   \label{ex:lex-dbun}
%   In the tangent category $\mathsf{Lex}$, where $TE$ is the category of Beck modules in $E$, the lift $\ell$ sends a Beck module to the double Beck module:
%   \input{TikzDrawings/Ch2/dbl-Beck.tikz}
%   Now, a coalgebra is a map that sends an object in $E$ to a Beck module, so that $\ell \o \lambda = T.\lambda \o \lambda$:
%   \input{TikzDrawings/Ch2/beck-module-example.tikz}
%   This diagram forces $\lambda (X_1) = \lambda(X)$, and $\lambda(X_0) = 0(X_0)$. Therefore, a coalgebra sends an object $X$ to a Beck module $X_1 \to X_0$, so that the choice for $X_0$ is the identity bundle and the choice for $X_1$ is this bundle (e.g. it is the same as the original $X$).
% \end{example}

The following idempotent is key in the theory of lifts and will be used in defining non-singular lifts (Definition \ref{def:non-singular-lift}), and its splitting will present the projection and zero-section of a vector bundle (Definition \ref{def:pdb}).

\begin{proposition}%
  \label{prop:idempotent-natural}
  The category of lifts in a tangent category $\C$ has a natural idempotent:
  \[
      e: id \Rightarrow id; e_{(E,\lambda)}: (E,\lambda) \xrightarrow[]{p \o \lambda} (E,\lambda).
  \]\pagenote{
      This proposition originally included some ambiguities, these have been handled by earlier changes that make the notiong of lift and lift-morphism more concrete. 
  }
\end{proposition}
\begin{proof}
  First, we see that $e = p \o \lambda$ is an idempotent:
  \[ p \o \lambda \o p \o \lambda
  = p\o p.T \o T.\lambda \o \lambda \\
  = p\o p.T \o\ell\o \lambda \\
  = p \o 0 \o p\o \lambda \\
  = p \o \lambda.\]
  Moreover, every $f:(E,\lambda) \to (F,l)$ preserves the idempotent:
  \[
    f \o p \o \lambda = p \o T.f \o \lambda = p \o l \o f.
  \]
  Finally, note that the idempotent is a lift morphism.:
  \[
    T.\lambda \o \lambda = \ell \o \lambda = c \o \ell \o \lambda = c \o T.\lambda \o \lambda
  \]
  which implies that 
  \[
    \lambda \o e = \lambda \o p \o \lambda = p \o T.\lambda \o \lambda = p \o c \o T.\lambda \o \lambda = T.p \o T.\lambda \o \lambda = T.e \o \lambda.
  \]
\end{proof}

% This idempotent is essential in characterizing Grabowski's non-singularity condition in Definition \ref{def:non-singular-r-module} in an arbitrary tangent category.
% While it is not immediate that this is equivalent to the notion of a non-singular $R$-algebra, this will be proved later in the chapter.

\section{Non-singular lifts}%
\label{sec:non-singular-lifts}
\cite{Grabowski2009} introduced the notion of a non-singular lift as a means to axiomatize the Euler vector field of a vector bundle's multiplicative $\R^+$-action. While it is not immediately clear that our definition is the same as Grabowski's, the results of Section \ref{sec:iso-vbun-dbun} will justify the use of this language as they are necessarily the same.
\begin{definition}%
  \label{def:non-singular-lift}
  A lift $(E,\lambda)$ in a tangent category $\C$ is \emph{non-singular} whenever the following diagram is a $T$-equalizer:
  \[
    \input{TikzDrawings/Ch2/reg-lift-eq.tikz}
  \]
  where $e.E = p \o \ell$ (the idempotent associated to the free lift on $E$) and $T.e = T.p \o T.\lambda$ (the image of the idempotent associated to $(E,\lambda)$ under the tangent functor). The category of non-singular lifts is written $\mathsf{NonSing}(\C)$.\pagenote{
  I have added comments clarifying what maps $e.E$ and $T.e$ are. 
  }
\end{definition}
The most prominent class of examples is given by the Euler vector field of the $\R$-action on a vector bundle.
\begin{proposition}%
  \label{prop:evf-vbun-is-nonsingular}
  The Euler vector field of a vector bundle is a non-singular lift.
\end{proposition}
\begin{proof}
  %NOTE: Attempted to clarify some points of confusion raised by Kristine
  \pagenote{I made it clear that the diagram being discussed is a $T$-limit, as it is not actually an equalizer diagram. I have tried to clarify the wording that ``one diagram is universal if and only if the other is''.}
  Let $(q:E \to M, +, \xi, \cdot)$ be a vector bundle with Euler vector field $\lambda$. By Proposition \ref{prop:ros-for-vbun}, the diagram \[\input{TikzDrawings/Ch2/ros-eq.tikz}\] is a $T$-limit. The $T$-universality of this diagram will hold if and only if the diagram is universal after each parallel pair of arrows is post-composed by a $T$-monic. A section is a $T$-monic, so the previous diagram is $T$-universal if and only if the following diagram is $T$-universal:
  % Using the fact that equalizers may be post-composed with $T$-monics, the following diagram is equivalent to the others' universality.
  \input{TikzDrawings/Ch2/ros-monic-postcompose.tikz}
  Now simplify this diagram using the fact that $T.(\xi \o q) = T.e, 0 \o p = e.E$:
  \input{TikzDrawings/Ch2/ros-new-double-eq.tikz}
  Note that the the two pairs of parallel arrows have a common arrow, implying that they may be pulled together into a single ternary equalizer. All that remains to check, then, is that for any $x:X \to TE$,
  \[
  (e.e \o x = T.e \o x = e.E \o x) \iff 
  (T.e \o x = e.E \o x). 
  \]
  The forward implication is trivial, so it remains to prove the reverse. 
  Suppose $T.e \o x = e.E \o x$; then
  \[
    e.e \o x = e.E \o T.e \o x = e.E \o e.E \o x = e.E \o x
  \]
  giving the result, namely that the diagram \[\input{TikzDrawings/Ch2/reg-lift-eq.tikz}\] is a $T$-equalizer.
\end{proof}
Every map $f:E \to F$ gives a map of free coalgebras $T.f: (TE,\ell) \to (TF,\ell)$ and the idempotent $e$ is a coalgebra morphism by Proposition \ref{prop:idempotent-natural}, so the following is immediate:
\begin{proposition}%
  \label{def:non-singular-lift-eq-of-lifts}
  A non-singular lift is an equalizer in the category of lifts:
  \[
    \input{TikzDrawings/Ch2/reg-lift-eq-lin.tikz}
  \]
\end{proposition}
% \begin{observation}%
%   \label{obs:fork-is-nat}
%   Note that the coalgebra definition means there is a natural transformation:
%   \[
%     \lambda: id \Rightarrow F.U    
%   \]
%   $U$ sends a lift to its underlying object in $\C$, $U(E,\lambda) = E$ and $F$ sends an object to its free lift $F(E) = (TE,\ell)$. By definition, 
%   \[
%     \input{TikzDrawings/Ch2/lift-diag.tikz}
%   \]
% exihibits $\lambda:(E,\lambda) \to (TE,\ell)$ as a coalgebra morphism.
%   Therefore, the fork defining non-singularity is natural (using that $F.U = id.F.U = F.U.id$):
%   \[
%     \input{TikzDrawings/Ch2/nat-fork-reg.tikz}
%   \]
% \end{observation}

Observe that the category of non-singular lifts is closed under finite limits in the category of lifts.
\begin{proposition}%
  \label{prop:nonsing-closed-under-t-limits}
  The category of non-singular lifts in $\C$ is closed under $T$-limits:
  \begin{enumerate}[(i)]
    \item The tangent functor on lifts preserves non-singular lifts, so that if $(E,\lambda)$ is non-singular then $(TE,c\o T.\lambda)$ is non-singular. \pagenote{
        I clarified that this was in fact referring to the tangent functor \emph{for the category of lifts}.
    }
    \item The trivial lift on an object, $0:M \to TM$, is non-singular. 
    % \item If $\C$ has a tangent terminal object is a non-singular lifts with $(1, 0:1 \cong T.1)$
    \item $T$-products of non-singular lifts are non-singular lifts.
    \item $T$-equalizers of non-singular lifts are non-singular lifts.
  \end{enumerate}
\end{proposition}
\begin{proof}
  ~\begin{enumerate}[(i)]
    \item This follows from the fact that the non-singularity condition is a $T$-limit.
    \item The zero map splits the idempotent $0 \o p$, so it is the equalizer of $0 \o p, p \o 0 = id$.
    \item This follows by stability of limits under products.
    \item The following diagram commutes by naturality:
    \[\input{TikzDrawings/Ch2/eq-pres-ros.tikz}\]
    Each horizontal diagram is a $T$-equalizer, and the two columns on the right are $T$-equalizers, so the column on the left is a $T$-equalizer.
  \end{enumerate}
\end{proof}


Finally, when a tangent category has certain $T$-equalizers, there is an idempotent monad on the category of lifts, whose algebras are non-singular lifts:
\begin{theorem}%
  \label{thm:idemp-monad-nonsingular}
  Let $\C$ be a tangent category with chosen $T$-equalizers of idempotents. Then the following equalizer determines a left-exact idempotent monad on the category of lifts, whose algebras are non-singular lifts.\pagenote{
      I have reworded this proposition to make it clear that the functor is defined by sending a lift to the lift defined by the equalizer in the following diagram.
  }
% https://q.uiver.app/?q=WzAsMyxbMCwwLCIoQyxsKSJdLFsxLDAsIihULkUsXFxlbGwpIl0sWzIsMCwiKFQuRSwgXFxlbGwpIl0sWzAsMV0sWzEsMiwiZS5FIiwwLHsib2Zmc2V0IjotMX1dLFsxLDIsIlQuZSIsMix7Im9mZnNldCI6MX1dXQ==
\[\begin{tikzcd}
	{(F,l)} & {(T.E,\ell)} & {(T.E, \ell)}
	\arrow[from=1-1, to=1-2]
	\arrow["{e.E}", shift left=1, from=1-2, to=1-3]
	\arrow["{T.e}"', shift right=1, from=1-2, to=1-3]
\end{tikzcd}\] 
\end{theorem}
\begin{proof}
  First, take the equalizer in $\mathsf{Lift}(\C)$; the functor sends $(E,\lambda)$ to the chosen limit $(F,l)$.The unit of the monad is the unique morphism from $(E,\lambda)$ to the equalizer $(F,l)$ induced by universality:
  \[\input{TikzDrawings/Ch2/idem-monad-unit.tikz}\]
  Note that non-singular lifts are closed under finite limits, so $(F,l)$ is a non-singular lift. If $(E,\lambda)$ is a nonsingular lift then $\lambda: (E,\lambda) \to (TE, \ell)$ equalizes the diagram, so there is a unique isomorphism $(F,l) \cong (E,\lambda)$, making the multiplication of the monad a natural isomorphism (and thus yielding an idempotent monad).
  The functor is defined as a $T$-limit and therefore preserves all $T$-limits of lifts, so it is left-exact.
\end{proof}
% \begin{remark}
%   It is unclear whether or not this equalizer always exists for the category of smooth manifolds.%something about transversality? Maybe this works!
% \end{remark}
In the category of smooth manifolds, $\ell$ is the Euler vector field of an $\R^+$-action, this guarantees that every $\lambda$ is the Euler vector field of a multiplicative $\R^+$-action.  We note the following corollary.
\begin{corollary}%
  \label{cor:non-singular-implies-ract}
  In the category of multiplicative $\mathbb{R}^+$ actions in $\mathsf{SMan}$, multiplication by $0$ is equivalent to the natural idempotent $e$ in the fully faithful functor sending an $\mathbb{R}^+$-action to its Euler vector field. By non-singularity, the following diagram is an equalizer, giving $E$ a multiplicative action by $\mathbb{R}^+$ whose Euler vector field is $\lambda$: 
  \[
    \input{TikzDrawings/Ch2/reg-induces-action.tikz}
  \]
  Moreover, $\lambda$ is the Euler vector field of this lift, and the following diagram commutes:
  \[
    \input{TikzDrawings/Ch2/induced-action-is-lift.tikz}
  \]
\end{corollary}





\section{Differential bundles}%
\label{sec:lifts-pdbs-dbs}

This section introduces (pre-)differential bundles, which provided the rest of the data for a vector bundle: namely the projection, the zero section, and the addition map. The zero section and projection data arise by splitting the natural idempotent $e: id \Rightarrow id$, and non-singularity will induce the addition map. Every differential bundle satisfies a pair of universality diagrams, linking this presentation of differential bundles to the original definition in \cite{Cockett2018}.

\begin{definition}%
  \label{def:pdb}
  ~\begin{enumerate}[(i)]
    \item A \emph{pre-differential bundle} is a lift $\lambda:E \to TE$ equipped with a chosen splitting of the natural idempotent $e = p \o \lambda$ from Proposition \ref{prop:idempotent-natural}. Pre-differential bundles are formally written $(q:E \to M, \xi, \lambda)$, where $q:E \to M$ is the retract, $\xi:M \to E$ the section, and $\lambda:E \to TE$ the lift (the types are only necessary for the projection as the rest may be inferred, and will generally be suppressed to save space).
    \item A \emph{differential bundle} is a pre-differential bundle $(q:E \to M, \xi, \lambda)$ with the properties that $\lambda$ is non-singular and $T$-pullback powers of $q$ exist.
  \end{enumerate}
  Morphisms of (pre-)differential bundles are exactly morphisms of their underlying lifts. The categories of (pre-)differential bundles are exactly (pre-)differential bundles and lift morphisms, and are written $\mathsf{Pre}(\C), \mathsf{DBun}(\C)$ respectively.\pagenote{
      The definition of differential bundles has been expanded so that it is clear that $\xi,q$ are and idempotent splitting of $p \o \lambda$, and the category names $\mathsf{Pre}(\C), \mathsf{DBun}(\C)$ are defined explicitly to help draw attention to the definition of bundle morphisms.
  }
\end{definition}

Recall that as $e$ is a natural idempotent in the category of lifts, any lift morphism will preserve $e$ and will consequently preserve its idempotent splitting. Preserving the idempotent means that every differential bundle morphism is a bundle morphism, where the base map is given by \[\input{TikzDrawings/Ch2/pdb-bundle-morphism.tikz}\]
We now look at the limits of (pre-)differential bundles.
\begin{observation}%
  \label{obs:T-limits-pdbs}
  ~\begin{enumerate}[(i)]
    \item The limit for a diagram of pre-differential bundles is the limit of the underlying lifts equipped with a chosen splitting of $p \o \lambda$ due to basic properties about idempotent splittings.
    \item The limit for a diagram of differential bundles is the limit in the category of pre-differential bundles (the lift will be universal by Proposition \ref{prop:nonsing-closed-under-t-limits}), so long as $T$-pullback powers of the resulting projection exist.
  \end{enumerate}
\end{observation}
Because there is a projection associated to a (pre-)differential bundle, the $T$-reindexing operation described in Proposition \ref{prop:submersion-properties} can now be applied. This gives a pullback differential bundle in a similar way to Proposition \ref*{prop:retracts-reindexing-of-vbuns}.
\begin{lemma}[\cite{Cockett2018}]%
  \label{lem:reindex-db}
  Let $(q:E \to M, \xi, \lambda)$ be a (pre-) differential bundle in a tangent category $\C$, and consider a $T$-pullback in $\C$:
  \[\input{TikzDrawings/Ch2/T-reind-dbun.tikz}\]
  Then the induced triple maps
  \[\input{TikzDrawings/Ch2/T-induce-maps.tikz}\]
  induce a (pre-)differential bundle $(u^*q: u^*E \to N, u^*\xi, u^*\lambda)$. If $\lambda$ is non-singular and $T$-pullback powers of $u^*q$ exist, then $(u^*q, u^*\xi, u^*\lambda)$ is a differential bundle.
\end{lemma}
\begin{proof}
  Note that a pre-differential bundle $(q:E \to M, \xi, \lambda)$ in $\C$ may also be regarded as a pre-differential bundle $(q: (E,\lambda) \to (M, 0), \xi, \lambda)$ in $\mathsf{Lift}(\C)$. Take the following pullback in $\mathsf{Lift}(\C)$:
  \[\input{TikzDrawings/Ch2/pullback-pdb.tikz}\]
  It follows by construction that $\iota \o u^*\lambda = \lambda \o \iota$. Thus the result holds.
\end{proof}

\begin{proposition}%
  \label{prop:induce-abun}
  Let $(q:E \to M, \xi, \lambda)$ be a non-singular pre-differential bundle in a tangent category $\C$, so that $T$-pullback powers of $q$ exist.
  Then there is an additive bundle structure $(q,\xi,+_q)$ so that the differential bundle morphisms are additive:
  \[
    (\lambda,\xi): (q,\xi,+_q) \to (p,0,+) \hspace{0.5cm}
    (\lambda,0): (q,\xi,+_q) \to (T.q,T.\xi,T.+_q).
  \]
  Furthermore, every differential bundle morphism preserves addition.
\end{proposition}
\begin{proof}
  Non-singularity forces the existence of an addition map: 
  \[
    \input{TikzDrawings/Ch2/regularity-induces-addition.tikz}
  \]
  Note that this diagram commutes because $T_2E$ is a pre-differential bundle whose lift is $\ell \x \ell$, and also $+$ is a linear morphism, so it commutes with the addition map $e\o a + e\o b = e \o (a\x b)$. Post-composition with $\lambda$ ensures that $\xi$ is the unit and that associativity holds. A differential bundle morphism will induce a morphism of the equalizer diagrams that induce each addition map to preserve addition.
\end{proof}

Recall that by Proposition \ref{prop:evf-vbun-is-nonsingular}, the Euler vector field for every vector bundle is a non-singular lift.\pagenote{
    The reference to Proposition \ref{prop:evf-vbun-is-nonsingular} has been put into the middle of the sentence to help. Also, rather than ``addition induced by singularity'', we give an explicit reference to the above proposition that constructs the additive bundle structure.
} If $TM \ts{q}{q} E$ exists, the map
\[
  \nu^E: TM \ts{p}{q} E \xrightarrow[]{T.\xi \x \lambda} T_2E \xrightarrow[]{+.E} TE
\] may be formed. Similarly, using the additive bundle structure from Proposition \ref{prop:induce-abun}, the $\mu$ map may be formed: 
\[
  \mu^E: E \ts{q}{q} E \xrightarrow[]{0 \x \lambda} T(E\ts{q}{q}E) \xrightarrow[]{T.+_q} TE
\]
Note that any differential bundle morphism will preserve $\mu$ and $\nu$.
\begin{lemma}%
  \label{lem:pre-mu-nu}
  Differential bundle maps preserve $\mu(x,y) := 0 \o x +_{T.q} \lambda \o y$ and $\nu(v,y) := T.\xi \o v +_p \lambda \o y$.\pagenote{
     The word linear had crept into this sentence in the original draft, it has been correct to ``differential bundle morphism''.
  }
\end{lemma}
\begin{proof}
  The following diagram demonstrates that lift maps preserve $\nu$:
  \[\input{TikzDrawings/Ch2/lin-pres-nu.tikz}\]
  Similarly, this diagram demonstrates that lift maps preserve $\mu$:
  \[\input{TikzDrawings/Ch2/lin-pres-mu.tikz}\]
\end{proof}

\begin{lemma}%
  \label{lem:univ-props}
  Consider the full subcategory of differential bundles in $\C$ whose objects are differential bundles $(E,\lambda)$ so that the forks
  \begin{equation}%
    \label{eq:universality}
    \input{TikzDrawings/Ch2/strong-cockett.tikz}
  \end{equation}
  are $T$-equalizers. This subcategory is closed under $T$-equalizers.\pagenote{
     The original wording for this lemma did not properly quantify the objects over which the theorem was stated for.
  }
\end{lemma}
\begin{proof} 
  Start with the $T$-equalizer of lifts:
  \[\input{TikzDrawings/Ch2/coeq-for-numu.tikz}\]
  Observe that $k$ is a lift map, so by Lemma \ref{lem:pre-mu-nu}, the following diagram commutes:
  \input{TikzDrawings/Ch2/lin-pres-nu-2.tikz}
  Next, since $k$ is a morphism of pre-differential bundles, by Lemma \ref{lem:pre-mu-nu} the following diagram commutes:
  \input{TikzDrawings/Ch2/eq-pres-mu.tikz}
  The top row follows because maps satisfying Rosicky's universality condition preserve $\mu$, and the bottom row by the naturality of $e.C$ and the fact that linear maps preserve the natural idempotent. Thus, if $E,F$ satisfy the universality diagrams in Diagram \ref{eq:universality}, the equalizer $C$ will as well, because $T$-equalizers are closed to $T$-limits in the category of fork diagrams.
\end{proof}
\begin{theorem}%
  \label{thm:universal-prop-differential-bundles}
  For every differential bundle $(q:E \to M, \xi,\lambda)$ in a tangent category, the diagram \[\input{TikzDrawings/Ch2/cc-equalizer.tikz}\] is a $T$-equalizer, and if $TM \ts{p}{q} E$ exists, then \[\input{TikzDrawings/Ch2/strong-eq.tikz}\] is a $T$-equalizer.
\end{theorem}
\begin{proof}
  The tangent bundle satisfies both universality conditions, and by Lemma \ref{lem:univ-props} every differential bundle will satisfy these conditions by the non-singularity of the lift.
\end{proof}
%   Recall that
%   \[
%     \nu^E: TM \ts{p}{q} E \xrightarrow[]{T.\xi \x \lambda} T_2E \xrightarrow[]{+.E} TE, \hspace{0.15cm}
%     \mu^E: E \ts{q}{q} E \xrightarrow[]{0 \x \lambda} T(E\ts{q}{q}E) \xrightarrow[]{T.+_q} TE
%   \]
\begin{corollary}%
  \label{cor:idemp-dbun}
  In a complete tangent category, the category of differential bundles is precisely the category of algebras of the monad in Theorem \ref{thm:idemp-monad-nonsingular} on pre-differential bundles.
\end{corollary}
\begin{remark}
  The universality conditions in Theorem \ref{thm:universal-prop-differential-bundles} demonstrate that this definition of differential bundle agrees with that of \cite{Cockett2018}.%, when combined with some results in \cite{MacAdam2021}.
  \pagenote{I have removed a reference to the published version of this chapter, it was unnecessary.}
\end{remark}
%NOTE: 
% This section bridges the gap between non-singular lifts and differential bundles and shows that these are the same. Every differential bundle has an underlying regular lift, which uniquely determines the rest of the structure of the differential bundle. Pre-differential bundles provide the first step towards reconciling differential bundles - a pre-differential bundle is to a differential bundle what a lift is to a non-singular lift.

\section{The isomorphism of categories}%
\label{sec:iso-vbun-dbun}
It is now straightforward to show that the main theorem of this chapter holds. First, observe that for every differential bundle $(q:E \to M, \xi, \lambda)$ in the category of smooth manifolds, the $T$-pullback $E \ts{p}{q} TM$ exists\pagenote{I have switched the order of the pullback for consistency}
, as $p$ is a submersion. Note that the universality of the two diagrams is equivalent:
\[
  \input{TikzDrawings/Ch2/strong-eq.tikz} 
  \hspace{0.15cm}
  \input{TikzDrawings/Ch2/strong-universality.tikz}
\]%NOTE 
Thus the following holds.
\begin{theorem}%
  \label{iso-of-cats-dbun-sman}
  There is an isomorphism of categories between vector bundles and differential bundles in smooth manifolds. 
\end{theorem}
\begin{proof}
  Note that Proposition \ref{prop:evf-vbun-is-nonsingular} gives a fully faithful functor from the category of vector bundles to differential bundles of smooth manifolds, as the lift associated to the vector bundle is non-singular and the projection and zero section give the rest of the structure of a differential bundle: as remarked after Definition \ref{def:vector-bundle}, local triviality guarantees that the projection is a submersion, so pullback powers of the projection exist, yielding a differential bundle.

  To see there is an isomorphism on objects, recall that every differential bundle is a fibred $\R$-module by Corollary \ref{cor:non-singular-implies-ract}, and that this identification is a bijective mapping (it recovers the original $\R$-action from the Euler vector field of the $\R$-action, and vice versa). Last, note that the universality condition
  \[\input{TikzDrawings/Ch2/strong-universality.tikz}\]
  along with Proposition \ref{prop:retracts-reindexing-of-vbuns} ensures the local triviality of $q$, so that the unique fibred $\R$-module structure associated to a differential bundle is indeed a vector bundle.
  \pagenote{I have added details to this proof to clarify that it does give a bijection on the classes of objects.}
  %NOTE: Changed the wording to make it more clear there is a bijection on objects between vector bundles and differential bundles 
\end{proof}
% And the promised relationship between non-singular lifts and non-singular $R$-algebras.
% \begin{corollary}
%   There is an isomorphism of categories between non-singular lifts and non-singular $R$-algebras.
% \end{corollary}
% \begin{proof}
%   By Corollary \ref{cor:non-singular-implies-ract}, each non-singular lift $(E,\lambda)$ has an $R$-algebra structure, and every splitting of $p\o \lambda$ is a differential/vector bundle, so the $R$-algebra must be non-singular.
% \end{proof}

\section{Connections on a differential bundle}%
\label{sec:connections-on-a-differential-bundle}

The connections discussed in this section generalize the notion of an affine connection to a differential bundle, giving a ``local coordinates'' presentation for $TE$ similar to the presentation of $T^2M$ as $T_3M$ induced by an affine connection. Chapter \ref{ch:involution-algebroids} makes extensive use of connections on vector bundles, so it is useful to set out the basic definitions before embarking on algebroid theory.  
\begin{definition}[\cite{Cockett2017}]%%
\label{def:lin-connection}
  Let $(q:E \to M, \xi, \lambda)$ be a differential bundle in a tangent category $\C$. 
  \begin{itemize}
    \item A vertical connection is a map $\kappa:TE \to E$ so that 
    \begin{enumerate}[(i)]      
      \item $\kappa$ is a vertical descent, and hence a retract of the lift; thus, $\kappa \o \lambda = id$;
      \item $\kappa$ is compatible with both differential bundle structures on $TE$, so that the maps
      \begin{gather*}
        \kappa: (TE,\ell) \to (E,\lambda) \\ \kappa:(TE, c\o T.\lambda) \to (E,\lambda)
      \end{gather*}
      are lift morphisms.
    \end{enumerate}
    \item A horizontal connection is a map $\nabla: E \ts{q}{p} TM \to TE$ so that
    \begin{enumerate}[(i)]
      \item $\nabla$ is a horizontal lift, and so is a retract of $(p.E, T.q):TE \to E \ts{q}{p} TM$\footnote{
        That $(p.E,T.q)$ land in the pullback $E \ts{q}{p} TM$ is a consequence of naturality, as $p \o T.q = q \o p$.
      }; thus, $(p, T.q)\o \nabla = id$;
      \item $\nabla$ is compatible with each pair of lifts, so that the maps
      \begin{gather*}
        \nabla: ( E \ts{q}{p} TM, \lambda \x \xi) \to (TE, c \o T.\lambda) \\
        \nabla: ( E \ts{q}{p} TM, 0 \x \ell) \to (TE, \ell)
      \end{gather*}
       are lift morphisms.
    \end{enumerate}
    \item A full connection is a pair $(\kappa,\nabla)$ that satisfies the following compatibility relations:\pagenote{
        I have extended the exposition on the compatibility relation between $\kappa, \nabla$ to make it clear that it is about constructing an isomorphism $TE \cong E_2\x TM$.
    }
    \begin{enumerate}[(i)]
      \item $\kappa \o \nabla = \xi \o q \o \pi_0$,
      \item $\nabla(p, T.q) +_{T.q} \mu(p, \kappa) = id$, so that there is an isomorphism $E \ts{q}{p} TM \ts{p}{q} E \cong TE$. \pagenote{caught a typo}
    \end{enumerate}
    
  \end{itemize}
\end{definition}
A notion that will be useful when dealing with classical differential geometry is that of a \emph{covariant derivative}, whose definition is equivalent to that of a vertical connection in the category of smooth manifolds.
\begin{definition}%
  \label{def:covariant-derivative}
  Let $(q:E \to M, \xi, \lambda, \kappa)$ be a vertical connection.\footnote{
     The definition of a covariant derivative only uses a vertical connection.
  }
  The \emph{covariant derivative} associated to $(\kappa,\nabla)$ is the map
  \[
      \nabla_{(-)}[=]:\Gamma(\pi) \x \Gamma(p) \to \Gamma(\pi); (A,X) \mapsto (\kappa \o TA \o X).
  \]
\end{definition}
\cite{LucyshynWright2018} drastically simplified the notion of a full connection by showing that it is exactly a vertical connection satisfying a universal property.
\begin{proposition}[\cite{LucyshynWright2018}]\label{prop:rory-connection}
  A connection on a differential bundle is equivalently specified by a vertical connection \[\kappa:TE \to E\] so that the following diagram exhibits $TE$ as a biproduct in the category of differential bundles over $M$:
  \input{TikzDrawings/Ch2/vcon.tikz}
\end{proposition}
% \begin{corollary}
%   The category of connections is equivalent to differential bundles equipped with an effective vertical connection and vertical connection-preserving linear maps.
% \end{corollary}
There is also a notion of flatness for connections that extends to vertical connections on a differential bundle.
\begin{definition}
  A connection $\kappa$ on a differential bundle $(q:E \to M, \xi, \lambda)$ is \emph{flat} whenever
  \[ 
    \kappa \o T.\kappa \o c = \kappa \o T.\kappa.
  \]
\end{definition}
We can see that connections are closed under similar constructions to differential bundles, in particular idempotent splittings and the reindexing construction from Lemma \ref{lem:reindex-db}.
\begin{lemma}%
  \label{lem:conn-const}
  Let $(q:E \to M, \xi, \lambda)$ be a differential bundle equipped with a vertical connection.\pagenote{
      I have reworded the second part of this lemma so that it no longer refers to effective vertical connections. The proof has also been streamlined.
  }
  \begin{enumerate}[(i)]
    \item Any linear retract of $(q,\xi,\lambda)$ will have a vertical connection. 
    \item The pullback differential bundle induced by pulling back $q$ along $f:N \to M$ will have a vertical connection.
  \end{enumerate}
  If the vertical connection is flat or is part of a full connection (that is, it satisfies the universality condition in Proposition \ref{prop:rory-connection}), then the induced connection will be as well.
\end{lemma}
\begin{proof}
  The universal property induces the vertical connection in each case. The construction will preserve flatness as it is an equational condition, and it preserves effectiveness by the commutativity of limits.
\end{proof}
There is no reason for every differential bundle in a tangent category to have a connection (for example, the tangent bundle in the free tangent category $\wone$ in Chapter \ref{chap:weil-nerve} is a differential bundle that does not have a connection). However, if the total space of a differential bundle has an affine connection, this induces a compatible connection on the differential bundle and its base space.
\begin{theorem}
  \label{thm:linear-connection-from-total-space}
  Let $(q:E \to M, \xi, \lambda)$ be a differential bundle in a tangent category in $\C$, where $E$ has a (flat) vertical connection. Then the total space $M$ and the differential bundle $(q,\xi,\lambda)$ each have a (flat) vertical connection. If the connection is full (so there is a compatible horizontal connection), then the induced connections are likewise full.
\end{theorem}
\begin{proof}
  By the strong universality condition for differential bundles, the differential bundle $(q\o\pi_0: E \ts{q}{p} TM \to M, (\xi, 0), \lambda \x \ell)$ is the pullback differential bundle of $p:TE \to E$ along $\xi:M \to E$. 
  This gives $(q\o\pi_0, (\xi,0), (\lambda,\ell))$, a (flat, effective) vertical connection by Lemma \ref{lem:conn-const}, and so it yields $(q:E \to M, \xi, \lambda)$ and $(p:TM \to M, 0, \ell)$ as (flat, effective) vertical connections by the idempotent splitting property.
\end{proof}
Every smooth manifold has an affine connection, thus inducing a connection on any vector bundle.
\begin{corollary}
  Every vector bundle has a connection.
\end{corollary}
\pagenote{Kristine mentioned it's a bit weird to end a chapter on a piece of notation, which I makes sense once it has been pointed out to me.}
% \begin{example}
%   Return to the category $\mathsf{Lex}$, and recall that every object has a (not-necessarily-effective) flat affine connection. Thus every differential bundle in the category has a (not-necessarily-effective) flat, affine connection. The vertical connection, of course, corresponds to the domain map $TE \to E$ that sends a Beck module to its total space (as the lift $\lambda$ must send $X$ to a Beck module with total space $X$). 
% \end{example}

% The following notation will be useful when working with linear morphisms between differential bundles equipped with a connection.
% \begin{definition}%
%   \label{def:nabla-notation}
%   Let $(q:E \to M, \xi, \lambda), (\pi:F \to N, \zeta, l)$ be a pair of differential bundles with connections $(\kappa,\nabla), (\kappa',\nabla')$. Given a linear bundle morphism, write the map:
%   \[
%     \nabla[f]: TM \ts{p}{q} E \xrightarrow[]{\nabla} TE \xrightarrow[]{T.f} TF \xrightarrow[]{\kappa'} F
%   \]
% \end{definition}
%NOTE: As Kristine mentioned, it's a bit weird to end a chapter on a piece of notation - I will re-introduce it later when necessary.


