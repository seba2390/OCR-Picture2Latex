% Use only LaTeX2e, calling the article.cls class and 12-point type.

\documentclass[12pt]{article}

% Users of the {thebibliography} environment or BibTeX should use the
% scicite.sty package, downloadable from *Science* at
% http://www.sciencemag.org/authors/preparing-manuscripts-using-latex 
% This package should properly format in-text
% reference calls and reference-list numbers.

%%%%%%%% PACKAGES/FUNCTIONS

\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{textcomp} %allow \textmu
\usepackage{siunitx} %dot in textmode for units.
\usepackage{amsmath}

\usepackage{navigator}

%\usepackage{hyperref} %causes problems with scicite package.
%\usepackage[all]{hypcap}    %for going to the top of an image when a figure reference is clicked
%following three to enable in text markers
\usepackage{color}
\usepackage{tikz}
\usepackage{ulem} %enable strike-through
\usetikzlibrary{shapes.geometric}

\makeatletter
\renewcommand{\fnum@figure}{\textbf{Fig. \thefigure}}
\makeatother

\newcommand{\Blaise}[1]{{\bf{\color{blue}#1}}} 
\newcommand*{\figref}[2][]{% set full link for figure references
  \hyperref[{fig:#2}]{%
    \ref*{fig:#2}%
    \ifx\\(#1)\\%
    \else
      \,(#1)%
    \fi
  }%
}
\newcommand{\Ernest}[1]{{\bf{\color{red}#1}}} 
\newcommand{\Michelle}[1]{{\bf[{\color{magenta}#1}]}} 

% Commands
\newcommand{\eqn}[1]{\begin{align}#1\end{align}}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\ps}[1]{\partial_{#1}}
\newcommand{\pare}[1]{\left( #1 \right) }
\newcommand{\corchete}[1]{\left[ #1 \right]}
\newcommand{\fr}[2]{\frac{#1}{#2}}
\newcommand{\wtil}[1]{\widetilde{#1}}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\avg}[1]{\langle #1 \rangle}
\newcommand{\tex}[1]{\mbox{\scriptsize{#1}}}
\newcommand{\crossout}[1]{{\color{red}\sout{#1}}}
\newcommand{\deleted}[1]{}
\newcommand{\textgreek}[1]{\begingroup\fontencoding{LGR}\selectfont#1\endgroup}
\newcommand{\what}[1]{\widehat{#1}}

% Markers in caption -> http://www.callumatkinsononline.com/adding-shape-and-symbol-to-figure-captions-in-latex/
\newcommand{\graycircle}{\raisebox{0.pt}{\tikz{\node[draw,scale=0.6,circle,white,fill=white!45!black](){};}}}
\newcommand{\blackcircle}{\raisebox{0.2pt}{\tikz{\node[draw,scale=0.6,circle,black,fill=black](){};}}}
\newcommand{\redcircle}{\raisebox{0.2pt}{\tikz{\node[draw,scale=0.6,circle,red,fill=red](){};}}}

\newcommand{\smallredcircle}{\raisebox{0.5pt}{\tikz{\node[draw,scale=0.3,circle,red,fill=red](){};}}}
\newcommand{\greentriangle}{\raisebox{0.8pt}{\tikz{\node[draw=black!60!green,scale=0.2,regular polygon, regular polygon sides=3,fill=black!60!green,rotate=0](){};}}}
\newcommand{\bluetriangle}{\raisebox{0.8pt}{\tikz{\node[draw=blue,scale=0.2,regular polygon, regular polygon sides=3,fill=blue,rotate=180](){};}}}

\newcommand{\opencircle}{\raisebox{0.2pt}{\tikz{\node[draw,scale=0.6,circle,fill=none](){};}}}
\newcommand{\opensquare}{\raisebox{0.2pt}{\tikz{\node[draw,scale=0.8,rectangle, fill=none](){};}}}
\newcommand{\opentriangle}{\raisebox{0.2pt}{\tikz{\node[draw,scale=0.4, regular polygon, regular polygon sides=3, color=blue](){};}}}
\newcommand{\opentriangleud}{\raisebox{0.2pt}{\tikz{\node[draw,scale=0.4, regular polygon, regular polygon sides=3, color=blue,rotate=180](){};}}}

\newcommand{\yellowline}{\raisebox{2pt}{\tikz{\draw[-,black!40!yellow,solid,line width = 1 pt](0,0) -- (3mm,0);}}}
\newcommand{\purpleline}{\raisebox{2pt}{\tikz{\draw[-,black!40!purple,solid,line width = 1 pt](0,0) -- (3mm,0);}}}
\newcommand{\greenline}{\raisebox{2pt}{\tikz{\draw[-,black!40!green,solid,line width = 1 pt](0,0) -- (3mm,0);}}}
\newcommand{\blueline}{\raisebox{2pt}{\tikz{\draw[-,black!40!blue,solid,line width = 1 pt](0,0) -- (3mm,0);}}}


\newcommand{\blackdashedline}{\raisebox{2pt}{\tikz{\draw[-,black!40!black,dashed,line width = 1 pt](0,0) -- (3mm,0);}}}

% Miscellaneous 
\def\dt{\Delta t}
\def\dd{\mathrm{d}}  
\def\kt{k_B T}
\def\bna{\bs{\nabla}}

% Bold symbols
\def\bC{\bs{C}}
\def\bD{\bs{D}}
\def\bX{\bs{X}}
\def\bx{\bs{x}}
\def\bXi{\bs{\Xi}}
\def\by{\bs{y}}
\def\bI{\bs{I}}
\def\bK{\bs{K}}
\def\bp{\bs{p}}
\def\bP{\bs{P}}
\def\bPi{\bs{\Pi}}
\def\bPsi{\bs{\Psi}}
\def\bM{\bs{M}}
\def\bR{\bs{R}}
\def\bomega{\bs{\omega}}
\def\bw{\bs{w}}
\def\bW{\bs{W}}
\def\bt{\bs{t}}
\def\bT{\bs{T}}
\def\btau{\bs \tau}
\def\bn{\bs{n}}
\def\bb{\bs{b}}
\def\bB{\bs{B}}
\def\be{\bs{e}}
\def\bu{\bs{u}}
\def\bU{\bs{U}}
\def\bv{\bs{v}}
\def\bV{\bs{V}}
\def\bl{\bs l}
\def\blambda{\bs{\lambda}}
\def\br{\bs{r}}
\def\bF{\bs{F}}
\def\bbf{\bs{f}}
\def\bphi{\bs{\phi}}
\def\bq{\bs{q}}
\def\bdq{\bs{\delta q}}
\def\bg{\bs{g}}
\def\bG{\bs{G}}
\def\ba{\bs{a}}
\def\bA{\bs{A}}
\def\bN{\bs{N}}
\def\bQ{\bs{Q}}

\def\bzero{\bs{0}}
\def\btheta{\bs \theta}
\def\bgamma{\bs \gamma}

%%%%%%%%


\usepackage{scicite}
\usepackage{times}

% The following parameters seem to provide a reasonable page setup.
\topmargin 0.0cm
\oddsidemargin 0.2cm
\textwidth 16cm 
\textheight 21cm
\footskip 1.0cm

%The next command sets up an environment for the abstract to your paper.
\newenvironment{sciabstract}{%
\begin{quote} \bf}
{\end{quote}}

% Include your paper's title here
\title{A simple catch: thermal fluctuations enable hydrodynamic trapping of microrollers by obstacles} 

% Place the author information here.  Please hand-code the contact
% information and notecalls; do *not* use \footnote commands.  Let the
% author contact information appear immediately below the author names
% as shown.  We would also prefer that you don't change the type-size
% settings shown here.

\author
{Ernest B. van der Wee$^{1,5\ast}$, Brendan C. Blackwell$^{1}$, Florencio Balboa Usabiaga$^{2}$,\\
Andrey Sokolov$^{3}$, Isaiah T. Katz$^{1}$, Blaise Delmotte$^{4\dagger\ast}$,\\
Michelle M. Driscoll$^{1\dagger\ast}$\\
\\
\normalsize{$^{1}$Department of Physics \& Astronomy, Northwestern University,}\\
\normalsize{Evanston, IL 60208, USA}\\
\normalsize{$^{2}$BCAM - Basque Center for Applied Mathematics, Mazarredo 14,}\\
\normalsize{E48009 Bilbao, Basque Country - Spain}\\
\normalsize{$^{3}$Materials Science Division, Argonne National Laboratory,}\\
\normalsize{Lemont, IL 60439, USA}\\
\normalsize{$^{4}$LadHyX, CNRS, Ecole Polytechnique, Institut Polytechnique de Paris,}\\
\normalsize{Palaiseau, 91120, France}\\
\normalsize{$^{5}$Current address: Department of Imaging Physics, Delft University of Technology, }\\
\normalsize{Lorentzweg 1, 2628 CJ Delft, the Netherlands}\\
\\
\normalsize{$\dagger$These authors contributed equally.}\\
\normalsize{$^\ast$To whom correspondence should be addressed; E-mail:  e.b.vanderwee@tudelft.nl,}\\
\normalsize{blaise.delmotte@ladhyx.polytechnique.fr, michelle.driscoll@northwestern.edu.}
}

% Include the date command, but leave its argument blank.
\date{}

%%%%%%%%%%%%%%%%% END OF PREAMBLE %%%%%%%%%%%%%%%%

\begin{document} 
% Double-space the manuscript.
\baselineskip24pt
% Make the title.
\maketitle 

% Place your abstract within the special {sciabstract} environment.

\begin{sciabstract} %should be 150 words, currently 146!

It is known that obstacles can hydrodynamically trap bacteria and synthetic microswimmers in orbits, where the trapping strength heavily depends on the swimmer flow field and thermal noise is needed for escape from the trap. Here, we use experiments and simulations to investigate the trapping of microrollers by obstacles. Microrollers have a prescribed propulsion direction and the flow field that drives their motion is quite different from previously-studied swimmers. The strength of the trap can be controlled by modifying the obstacle curvature or the colloid-obstacle repulsive potential. We detail the mechanisms of the trapping and find two remarkable features: the microroller is confined in the wake of the obstacle and, more importantly, it can only enter the trap \textit{with} Brownian motion. While noise is usually needed to escape traps in dynamical systems, here we show it is the only means to reach the hydrodynamic attractor.

%It is known that both bacteria and synthetic microswimmers can be hydrodynamically trapped in orbits around obstacles;  trapping strength heavily depends on the  swimmer flow field, and that thermal noise is needed to escape. Here, we use experiments and simulations to investigate the interaction of microrollers with obstacles. Microrollers have a prescribed propulsion direction and the flow field that drives their motion is quite different from previously-studied swimmers. We observe hydrodynamic trapping in our system, and find that the strength of the trap can be controlled by modifying the obstacle curvature or the colloid-obstacle repulsive potential.  We detail the mechanisms of the trapping  and find two remarkable features: it only happens in the wake of the obstacle and, more importantly, it can only occur \textit{with} Brownian motion. While noise is usually needed to escape traps in dynamical systems, here we show it is the only mean to reach a hydrodynamic attractor.  
\end{sciabstract}

% \begin{sciabstract} %should be 150 words, currently 243, so need to shorten!
%   In order to leverage colloidal swimmers in microfluidic and drug-delivery applications, it is crucial to understand their interaction with surface features such as obstacles. Previous studies have shown that this interaction can result in the hydrodynamic trapping in orbits around cylindrical obstacles, where the trapping strength heavily depends on the flow field of the swimmer, and that (thermal) noise is needed to escape the trap. Here, we use both experiments and simulations to investigate the interaction of driven microrollers with cylindrical obstacles. Microrollers have a prescribed propulsion direction and the flow field that drives their motion is quite different from previously-studied, bacteria-like or phoretic swimmers. We observe hydrodynamic trapping in our system, and find that the strength of the trap is tunable over three orders of magnitude either by modifying the obstacle curvature or the colloid-obstacle repulsive potential (Debye length). We detail the mechanisms of the trapping  and find two remarkable features: it only happens in the wake of the obstacle and, more importantly, it can only occur \textit{with} Brownian motion. While noise is usually needed to escape traps in dynamical systems, here we show it is the only mean to reach a hydrodynamic attractor.  This also suggests that the trapping as observed here vanishes for non-Brownian rollers of larger sizes. Our findings indicate that while hydrodynamic trapping of microswimmers by obstacles is generic, thermal fluctuations can play an unexpected role and are therefore important in the design of microfluidic and drug-delivery applications.
% \end{sciabstract}

% In setting up this template for *Science* papers, we've used both
% the \section* command and the \paragraph* command for topical
% divisions.  Which you use will of course depend on the type of paper
% you're writing.  Review Articles tend to have displayed headings, for
% which \section* is more appropriate; Research Articles, when they have
% formal topical divisions at all, tend to signal them with bold text
% that runs into the paragraph, for which \paragraph* is the right
% choice.  Either way, use the asterisk (*) modifier, as shown, to
% suppress numbering.

\section*{Introduction}

Colloidal-scale swimmers exhibit complex behaviors~\cite{elgeti2015physics,abbott2016active}, such as swarming~\cite{karani2019tuning}, hydro\-dy\-nam\-ically stabilized motile clusters~\cite{driscoll2017unstable}, oscillatory dynamics~\cite{keber2014topology}, and percolating network states~\cite{prymidis2015self}. 
These swimmers can be classified by the flow field they generate, which governs their propulsion as well as their behavior in complex environments, e.g.\ structured landscapes~\cite{bechinger2016active,kos2018elementary,morin2017distortion}.
There is a strong, applications-based interest in microswimmers, as they can be leveraged to advance both microfluidic applications (micromixing, local advective transport, etc.) and drug delivery systems; it is critical to both of these applications to control swimmer transport in a structured environment (e.g., junctions, the blood stream, porous materials)~\cite{tierno2021transport,martinezcalvo2021active}. The motility of these swimmers is coupled to the hydrodynamic flows they generate, and these flows are strongly modified by obstacles, nearby walls, and other structural features.  Thus, in order to learn how to manipulate and guide these microswimmers through more realistic environments, where they will encounter non-trivial geometries, we must develop a framework to understand how these structured environments modify the transport and propulsion of these particles. As a first step to build this understanding, it is important to study a model system: the interaction of a single swimmer with an obstacle~\cite{bechinger2016active,spagnolie2015geometric,takagi2014hydrodynamic,simmchen2016topographical,wykes2017guiding,sipos2015hydrodynamic,das2019colloidal,hoeger2021steric,chaithanya2021wall,Tahaka2022}.

It has been demonstrated that obstacles can be used to guide swimmer trajectories, both deflecting them~\cite{hoeger2021steric}, as well as trapping them in `bound' orbits~\cite{takagi2014hydrodynamic,simmchen2016topographical,wykes2017guiding,Tahaka2022,ketzetzi2022activity}.  By manipulating the geometry of these obstacles, one can gain control over both scattering and trapping.  For example, by using pillars of various sizes, approaching bacteria could be scattered at a particular angle~\cite{hoeger2021steric}, or for larger pillars, trapped in an orbit~\cite{sipos2015hydrodynamic,Tahaka2022}.  Similar trapping has been observed in artificial swimmers~\cite{takagi2014hydrodynamic,simmchen2016topographical,ketzetzi2022activity}, and by using more complex geometries, more exotic behaviors, such as directional trapping can be achieved~\cite{wykes2017guiding}. 

The mechanism behind this ensemble of geometry-mediated behaviors is set by the flow field of the microswimmer; this is a hydrodynamic effect.  Many microswimmers have a dipolar flow in the far-field, the direction of the flow classifies them as either `pushers' (\textit{E. Coli}) or `pullers' (alga \textit{Chlamydomonas}).  The scattering and orbital trapping of dipolar swimmers by spherical obstacles was captured in simulations and a semi-analytical far-field hydrodynamics model by Spagnolie et al.~\cite{spagnolie2015geometric}. Their work demonstrated that the trapping strength of the obstacles was directly set by the swimmer flow field: puller swimmers were trapped by much smaller obstacles than pusher swimmers.  Additionally, they demonstrated that fluctuations by Brownian motion were necessary for a trapped swimmer to exit the bound orbit. 

While swimmers inducing a dipolar flow field are common, there is another class of microswimmers which generate a quite different flow: microrollers, driven by rotation near a boundary~\cite{driscoll2017unstable}. The flow field around a microroller distinctly differs from the dipolar flow fields around more common pusher or puller swimmers~\cite{delmotte2017minimal,bechinger2016active,spagnolie2015geometric,liebchen2021interactions}: there is no fore-aft symmetry and the flow field is not axisymmetric.
Additionally, in the microroller system, the orientation of propulsion does not diffuse, but is prescribed by a rotating field, and can therefore be externally controlled. These rotating particles generate strong flows, which can lead to a tunable and hydrodynamically-mediated attraction between adjacent microrollers~\cite{driscoll2017unstable,martinez2018emergent,delmotte2019hydrodynamically}.  

Dense suspensions of microrollers give rise to interesting collective effects~\cite{driscoll2017unstable,sprinkle2017large,sprinkle2020active,junot2021collective}, such as the formation of hydrodynamically stabilized motile clusters composed of microrollers~\cite{driscoll2017unstable}.  These emergent structures show great promise in the transport of passive species using magnetic fields for microfluidic devices and drug transport, as the magnetic fields used for external control and are non-invasive to the human body~\cite{alapan2020multifunctional}.  

Just as with other kinds of swimmers, to realize the full potential of these systems requires building an understanding of how their transport is modified by a structured environment.  
As the interaction of a single dipolar swimmer with obstacles is very sensitive to (the sign of) its flow field~\cite{spagnolie2015geometric}, we can expect the microroller to similarly exhibit unique interactions with obstacles due to its particular flow field, as well as its prescribed direction. Therefore, studying the interaction of a single microroller with obstacles is needed for our understanding of microroller transport, but will also increase our knowledge of the generalized problem of hydrodynamics-governed interaction of microswimmers with structured environments.

Here, we study the interaction of a microroller with a cylindrical obstacle in experiments and through numerical simulations which include Brownian motion and  hydrodynamics~\cite{sprinkle2017large,balboa2017hydrodynamics}.  The microrollers we study are rotating colloidal particles confined by gravity at an equilibrium height above a bottom wall.  The (asymmetric) flow field created by the rotation of these microrollers leads to their propulsion (see Figs.~\ref{fig:setup}a-b). We note that these particles do not roll on the chamber floor, but are suspended at a finite height above it due to thermal fluctuations~\cite{driscoll2017unstable}.  This is what allows for such strong hydrodynamic effects in this system: unlike heavier rollers which touch the floor~\cite{karani2019tuning,chamolly2020irreversible,demirors2021magnetic,bozuyuk2022high}, the velocity of the fluid at the surface of these  microrollers is orders of magnitude higher than the self-induced velocity of the microrollers themselves (see Figs.~\ref{fig:setup}a-b). In experiments, the microrollers are realized by applying a rotating magnetic field (where the axis of rotation is parallel to the bottom wall) to suspended colloidal particles with a permanent magnetic moment~\cite{driscoll2017unstable,sprinkle2017large,sprinkle2020active,delmotte2017minimal,balboa2017brownian,balboa2017hydrodynamics,junot2021collective}. 

In this system, we observe trapping of the microroller by the obstacle, and demonstrate that this trapping emerges from hydrodynamics alone.  We find that the trapping strength is sensitive to the curvature of the obstacle, but also depends on the electrostatic repulsion between the obstacle and the microroller; these two control parameters offer unique possibilities for more exotic trapping behaviors.  To understand the mechanism of this trapping, we characterize the velocity field of the roller around the obstacle and find stagnation points (points of zero velocity) up- and downstream of the obstacle, which are connected by a separatrix encircling the obstacle. Near the upstream stagnation point the roller is repelled from the obstacle, whereas downstream the roller is drawn towards the obstacle, causing it to get trapped. The trapping mechanism we find is quite unique: to enter the basin of attraction of the obstacle, the particle must cross a seperatrix in the flow.  Thus, in contrast with dipolar swimmers, Brownian motion is necessary not only to leave the trap, but to enter it as well.  

\section*{Results}
\subsection*{Observations of microroller trapping}
We study the interaction of microrollers with cylindrical obstacles in an experimental system similar to Ref.~\cite{sprinkle2020active}, but with the addition of a 3D-printed cylindrical obstacle. The polymer microrollers with a radius $r = 1.05$ \textmu m contained a hematite cube with a magnetic moment (see Fig.~\ref{fig:setup}c). The obstacles were 3D printed on top of a cover glass, from which a sample chamber was built and subsequently filled with a water suspension containing the rollers. We imaged the fluorescently labeled rollers and autofluorescent obstacles using fluorescence microscopy, while applying a rotating magnetic field with the rotation axis parallel to the cover glass (see Fig.~\ref{fig:setup}d).

In Figs.~\ref{fig:trapping}a-b the interaction of a microroller with a printed obstacle with radius $R = 14.4$ \textmu m and height $H = 20$ \textmu m is shown (see also Vids. S1-2 of the Supplementary Material). We observe the trapping and eventual release of the microroller on the side of the roller (see Fig.~\ref{fig:trapping}a, Video S1), but another microroller passes the obstacle without being trapped (see Fig.~\ref{fig:trapping}b, Vid. S2).
As the electrostatic interaction between the microrollers and the 3D printed obstacles is purely repulsive as both are negatively charged~\cite{van2017preparation,baker2019shape}, the trapping of the microroller likely originates from hydrodynamics.

We also observed trapping in Brownian dynamics simulations~\cite{sprinkle2017large} of a microroller interacting with an obstacle. The roller and the cylindrical obstacle are modeled as a discrete set of blobs in a coarse-grained model called the rigid multiblob model~\cite{balboa2017hydrodynamics,sprinkle2017large,RigidMultiblobs} (see Figs.~\ref{fig:setup}e-f). A constant torque in the \textit{x-z}-plane is applied to the roller, whereas the obstacle is constrained at a fixed position on the bottom wall.
The microrollers were modeled with a hydrodynamic radius $r_h = $ 1 $\mu$m\cite{geometric} confined by gravity to the no-slip bottom wall. A smaller height of the obstacles ($H = 5.5$ \textmu m) was chosen to reduce the run-time of the simulations and its (minimal) effects on the results will be addressed in the Discussion. The roller, obstacle and wall interacted through a repulsive Yukawa potential. The simulation parameters were chosen similar to the experimental parameters and the work reported in Ref.~\cite{sprinkle2020active}.

We observed hydrodynamic trapping of the roller by the obstacle in our stochastic simulations (see Fig.~\ref{fig:trapping}c and Vid. S3). As in the experiments, the trapping does not always occur, as some rollers pass the obstacles without being trapped (see Fig.~\ref{fig:trapping}d and Vid. S4 of the Supplementary Material).


%here we discuss the interaction of the roller in experiments AND simulations. so new subheader
\subsection*{Microroller interaction with cylindrical obstacles}

To study the interaction of microrollers with obstacles in more detail, we measured heat maps (or 2D histograms) of the positions of the microroller around the obstacle, in both experiments (Fig.~\ref{fig:stoch}a) and stochastic simulations (Figs.~\ref{fig:stoch}b-c). In the experiments, we drove microrollers at low area fractions through an array of printed pillars ($r_h/R_h=0.07$) and imaged them by fluorescence microscopy. Using particle tracking~\cite{crocker1996methods,allan2014trackpy} we assigned the positions of the microrollers to the nearby obstacles and combined this data in a 2D histogram shown in Fig.~\ref{fig:stoch}a. 
Upstream ($x < 0$) a semicircle of low count is observed close to the pillar, indicating a repulsion from the obstacle. Downstream ($x>0$), however, two high count regions are found at about one and five o'clock close to the pillar, indicating an attraction to the obstacle where the roller gets trapped. Furthermore, the hydrodynamic trapping of the particles also results in a low-count zone further downstream of the obstacle. Upstream there is also a lower count around $y=0$, which is caused by the depletion of rollers due the adjacent pillars in the printed array (see Fig. S1 of the Supplementary Material).  

In the stochastic simulations 200 runs were performed with the roller at starting positions [$x=-20r_h,y=\{-10r_h,10r_h\}$], where $\Delta y = 0.1r_h$. The 2D histograms for $r_h/R_h=0.1$ and $0.33$ are shown in
Figs.~\ref{fig:stoch}b-c, respectively. We simulated smaller obstacles than used in the experiments, as the large pillar size used would have led to  long run times due to the number of blobs needed to construct the obstacle in simulations.
Upstream repulsion and downstream attraction are observed, similar to the experiments. 
For $r_h/R_h=0.1$ (see Fig.~\ref{fig:stoch}b), two high count regions are observed, but more downstream than in experiments. For $r_h/R_h=0.33$ (see Fig.~\ref{fig:stoch}c), the two high count regions are merged into a single high count region around $y=0$. 
Similar to the experiments, a depletion zone is found in the wake of the pillar. Furthermore, the width of this depletion zone decreases with increasing relative curvature $r_h/R_h$ (see Figs.~\ref{fig:stoch}b-c).  Interestingly, when the simulations are repeated without Brownian motion, using the deterministic Adams-Bashforth method~\cite{balboa2017brownian}, no trapping is observed (see Fig.~\ref{fig:stoch}d).  Instead, the particles are repelled from a low-count zone downstream of the obstacle. This indicates that Brownian motion is needed for the microroller to enter the hydrodynamic trap. 

% trap strength - escape time
To investigate the strength of the hydrodynamic trap, we ran stochastic simulations where the particles are placed in the attractive region behind the obstacle at contact [$x=R_h+r_h,y=0$] and the escape time (or first passage time) from the trap is measured (see
Fig.~\ref{fig:stoch}e)\cite{escape}. The escape time is defined as the time it takes the roller to pass $x = R_h + 5r_h$\cite{criterion} (see the red line in
Fig.~\ref{fig:stoch}e). % $-4.8 \pm 7.7 \%$} .
The rollers are found to explore the trap by thermal fluctuations and eventually escape (see Vid. S5 in the Supplementary Material).
 The distribution of escape times have a long tail towards longer escape times, as plotted in Fig. S2 of the Supplementary Material. As there is no model describing this process yet, we will resort to using the mean of the distributions to characterize them in further analysis. 

The mean escape time measured in simulations (corrected for the escape time without an obstacle present) $t^* = \langle t_{esc}\rangle - \langle t_{esc}^{no~obstacle} \rangle$\cite{freepassage} as a function of relative curvature $r_h/R_h$ is shown in Fig.~\ref{fig:stoch}f. We ran simulations for two different Debye lengths of the repulsive Yukawa potential \eqref{eq:yukawa}:  $b/r_h=0.1$ (\opentriangle) and $b/r_h=0.4$ (\opentriangleud). We find that the escape time strongly depends on the relative curvature of the obstacle, where low relative curvatures lead to long escape times, and therefore high trapping strengths. 
%This corresponds to the pronounced high count region in the wake of the obstacle in the stochastic simulations for $r_h/R_h=0.33$ and $r_h/R_h=1.00$ (see Figs.~\ref[b-c]{fig:stoch}). %Ernest: With the high count region splitting at 0.1 we do not have a figure to show this now. not a very crucial addition, this sentence.
Furthermore, the escape time decreases with an increase in the Debye length and therefore the range of the repulsive electrostatic interaction between the roller and the obstacle. 

To verify these findings, we measured the trapping strength of cylindrical obstacles in experiments. As we could not place the particles in the wake of the obstacles, we analyzed image sequences of microrollers interacting with cylindrical obstacles and measured the time between a microroller arriving behind the obstacle and it subsequently leaving the trap. Fig.~\ref{fig:stoch}f shows the mean escape time $t^*$ versus relative curvature $r_h/R_h$ data from the experiments for rollers suspended in pure water ($b/r_h \approx 0.3$~\cite{yethiraj2003colloidal}, \opencircle) and in a 0.14 mM LiCl solution ($b/r_h = 0.025$~\cite{sprinkle2020active}, \opensquare).

In the experiments a strong dependence of the mean escape time on the relative curvature is found, similar to the simulations. Moreover, the slopes of the data from the experiments and simulations are very similar. In addition, as in the simulations, an increase in Debye length results in a decrease of the mean escape time. While the escape time versus relative curvature data sets from the simulations and experiments overlap, they do so for different Debye lengths (see Fig.~\ref{fig:stoch}f). Fig.~\ref{fig:stoch}f demonstrates that the trapping strength can easily be tuned over multiple orders of magnitude in experiments by adjusting both the curvature of the obstacle and the Debye length of the microroller suspension. Both of these control parameters are easily accessible experiments by changing the printed obstacle size and/or tuning the salt concentration of the roller suspension.

  



\subsection*{Basin of attraction }

To understand the mechanism by which the microrollers are trapped by the obstacles, we calculated the deterministic velocity field of the microroller around the obstacles in simulations, allowing us to identify the basin of attraction. This was done by placing the particle on a grid and measuring its instantaneous velocity in the $x-y$ plane at that point, where the roller was placed at a height  $z/r_h = 1.29$, close to its bulk equilibrium height.
The roller velocity fields for relative curvatures $r_h/R_h=1.00$ and $r_h/R_h=0.33$ are shown in Figs.~\ref{fig:field}a-b. 
We only plot the roller velocities for $x^2+y^2>(R_h+r_h+d)^2$, where $d=0.8r_h$\cite{electro}, as the microroller velocity too close to the obstacle is dominated by the electrostatic repulsion between the roller and the obstacle.


Two stagnation points (points of zero velocity) are identified up- and downstream of the obstacles, as indicated by the red dots in Figs.~\ref{fig:field}a-b. Although the two stagnation points are symmetric with respect to the obstacle, they are tilted slightly with respect to the $x$-axis. This is a non-physical effect induced by the finite resolution of our simulations and the discretized nature of the roller and the obstacle. Although the magnitude of the velocities at the up- and downstream stagnation points are identical, the directions of the velocities are different (as indicated by the black and white arrows in Figs.~\ref{fig:field}a-b): 
while the microroller is pushed from the obstacle between the obstacle and the upstream ($x<0$) stagnation point, it is pulled into the obstacle downstream ($x>0$).
This explains the regions of low and high count, respectively, up- and downstream of the roller in the 2D histograms in Figs.~\ref{fig:stoch}a-c.

At a given height, the up- and downstream stagnation points lie on a seperatrix forming a circle around the obstacle, where for $x<0$ the flow direction converges at the separatrix, while for $x>0$ the flow diverges (see Fig. S3(b) in the Supplementary Material). This is why in the deterministic simulations of the rollers interacting with the obstacle (see Fig.~\ref{fig:stoch}d) no trapping is observed: as the microroller approaches the obstacle, it is kept from crossing the separatrix, and will never be able to cross the separatrix behind the pillar to reach the attractive flow field or basin of attraction. Thus, Brownian motion of the microroller is necessary to cross the separatrix, enter the basin of attraction, and thus be hydrodynamically trapped by the obstacle. 

%Ernest updated the manuscript up to here...!


We define the distance between the stagnation point and the surface of the obstacle as $\tilde{x}$:
\begin{equation}
\label{eq:stag_point}
    \tilde{x} = \frac{|x_s| - R_h}{r_h}
\end{equation}
where $x_s$ is the $x$-position of the stagnation point. In Fig.~\ref{fig:field}c $\tilde{x}$ is plotted as a function of relative curvature $r_h/R_h$, where $r_h/R_h=0$ corresponds to a wall ($R_h \to \infty$, 5.5 $\mu$m high, 10 $\mu$m long) where the stagnation point becomes a line parallel to the wall and $|x_s|$ is the distance between this stagnation line and the center of mass of the wall (see Fig. S3(c) in the Supplementary Material). $\tilde{x}$ is found to increase for lower curvature. 
This increase widens the basin of attraction, the area where the microroller is attracted to the obstacle (see Figs.~\ref{fig:field}a-b), and results in an increase in trapping strength, as observed by measuring the escape times (see Fig.~\ref{fig:stoch}f). As the basin of attraction grows, the thermal fluctuations due to Brownian motion are less likely to kick the roller out of the trap, resulting in longer escape times. 
%add remark escape criterion is > stagnation point.
%the choice of escape time is consistent with the particle passing the stagnation point?"
We should note that the stagnation point distances $\tilde{x}$ in Fig.~\ref{fig:field}c are smaller than the escape criterion ($x > R_h+5r_h$) used in the escape time measurements (see Fig.~\ref{fig:stoch}e). Therefore, the rollers pass the stagnation point in their escape for all relative curvatures.

In order to calculate the basin of attraction, we ran deterministic simulations for different initial positions around the obstacle and determined whether the microroller got trapped or was able to pass the obstacle. In Fig.~\ref{fig:field}d the basin of attraction (pink area) around an obstacle ($r_h/R_h=1.00$) is plotted. In addition, we plot the trajectories of rollers with initial positions at $x^2+y^2 = 9r_h$ and different heights, just outside the grey area where the electrostatic repulsion dominates the dynamics of the microroller (see Fig.~\ref{fig:field}d and the interactive 3D plot in File S1 of the Supplementary Material.
For the majority of initial positions, the roller cannot cross the separatrix and ends up into a convergence point  (as denoted by the black dot in Fig.~\ref{fig:field}d). We find that the roller converges to this point irrespective of its initial height.
Only for initial positions $|y|<0.8, x<0$, which lies outside of the basin of attraction, the hydrodynamic \textit{and} electrostatic repulsion acting on the roller are enough to cross the separatrix and the roller is able to pass the obstacle.

The convergence point is located on the edge of the area where the roller-pillar interaction is dominated by electrostatic repulsion, as indicated by the black circle in Figs.~\ref{fig:field}a-b and the grey circle in Fig.~\ref{fig:field}d. At this point, which is the attractor in this system, the hydrodynamic attraction and electrostatic repulsion acting on the roller are balanced. We can therefore conclude there are three points of zero velocity in this system: two stagnation (saddle) points (up- and downstream, see Figs.~\ref{fig:field}a-b) and one attractor (sink) or convergence point (downstream, see Fig.~\ref{fig:field}d). The two stagnation points result from the balance between the hydrodynamic interaction (repulsive or attractive) between the roller and the pillar, and the self-induced velocity (or propulsion) of the roller. The convergence point, however, is a result of the balance between  the self-induced velocity of the roller, the hydrodynamic interaction \textit{and} the electrostatic repulsion between the roller and the pillar.

When the Debye length is increased, the electric repulsion between the roller and the pillar will increase, resulting in a shift of the convergence point towards the stagnation point. The reduced distance between the convergence and stagnation point, and therefore the reduced size of the basin of attraction, will increase the probability of the roller leaving the trap due to thermal fluctuations. This agrees with the observed decrease in the measured escape times upon an increase in the Debye length in both experiments and simulations (see Fig.~\ref{fig:stoch}f).

%add a paragraph on the shape of the trap (aka discuss figure 5)
Surprisingly, although we find a single attractor in our system, we observe the formation of two high count regions for low relative curvature (see Figs.~\ref{fig:stoch}a-b), whereas for high relative curvature (see Fig.~\ref{fig:stoch}c) a single high count region is found, coinciding with the point of convergence (see Fig.~\ref{fig:field}d).
To explain this, we plot the radial and tangent velocity roller velocity fields for relative curvatures $r_h/R_h = 1.0$ and $0.1$ (see Figs.~\ref{fig:new_figure}a-d). In addition, we plot the radial and tangent velocities along the semi-circles in Figs.~\ref{fig:new_figure}a-d, for relative curvatures $r_h/R_h=1.0$, $0.33$, and $0.1$ (see Fig.~\ref{fig:new_figure}e). The semi-circles are placed downstream of the pillars, but exactly in between the stagnation point and the point of convergence. The radial velocity plot (Fig.~\ref{fig:new_figure}e, top) shows that for decreasing curvature the roller is drawn stronger towards the pillar than for higher curvature. This supports the increasing escape time with decreasing curvature (see Fig.~\ref{fig:stoch}f). 
Interestingly, the radial and tangent velocities seem to depend on the cosine and sine, respectively, of the angle between the roller-pillar vector and the direction of propulsion (see black dashed lines in Fig.~\ref{fig:new_figure}e).

We can now explain the difference in the number of high count regions for different curvatures when a roller is passing an obstacle (see Figs.~\ref{fig:stoch}a-c). 
For lower curvatures, the roller is more likely to enter and stay in the basin of attraction close to $|\theta / \pi | = 0.5$  for two reasons: (1) a higher radial attraction (see Fig.~\ref{fig:new_figure}e, top) and (2) smaller Brownian kicks due to a reduced mobility near a wall with low curvature.
Next, the time it takes the roller to reach the point of convergence increases for, again, two reasons: (1) the distance to the point of convergence increases linearly with the diameter of the obstacle and (2) the tangent attraction towards the point of convergence decreases with lower curvature (see Fig.~\ref{fig:new_figure}e, bottom). This increased travel time will thus make it more likely that before reaching the point of convergence, the roller is kicked out of the trap by Brownian motion. This is why for low curvature, two high count regions are observed, whereas for high curvature, a single high count region coincides with the point of convergence.




\subsection*{Mechanism of microroller trapping}
The existence of the stagnation points has a purely hydrodynamic origin. At the typical equilibrium height measured in simulations, the flow induced by the microroller is one to two orders of magnitude greater than the self-induced velocity $V_0$: on the roller surface the fluid velocity reaches $u \approx 30V_0$ and $u \approx 5 V_0$ a few radii away along the $x$-axis (see Fig.~\ref{fig:setup}a). As a result, when the obstacle is separated from the microroller at a given distance $d_x$ along the $x$-axis, it needs to cancel strong horizontal (Fig.~\ref{fig:flow_obstacle}a) and vertical (Fig.~\ref{fig:flow_obstacle}b) flows on its surface in order to satisfy the no-slip condition $\bu=0$ for the fluid velocity.  
To do so, it exerts a surface force distribution (called traction forces) that generates a velocity field opposite to the one induced by the microroller (see Figs.~\ref{fig:flow_obstacle}c-f).  Owing to the high magnitude of the surface velocities and to their slow decay at low Reynolds number, the cylinder hydrodynamic response is able to overcome the translation of the microroller at speed $V_0$. This explains why the rollers are attracted to the obstacle at the rear and, by symmetry, repelled at the front. The stagnation points therefore  correspond to the separation distances at which the cylinder-induced velocity on the microroller exactly balances $V_0$.  

Since the area of the cylinder surface exposed to strong flows increases with the cylinder radius $R_h$ (see Figs.~\ref{fig:flow_obstacle}a-b) the reflected flow gets stronger when $r_h/R_h$ decreases and the stagnation points move away from the cylinder (see Fig.~\ref{fig:field}c).  This phenomenon is visualized with the iso-contour  $u_x=-V_0$,  where the horizontal cylinder-induced fluid velocity  balances the microroller velocity, in the $x-y$ and $x-z$ plane (see Figs.~\ref{fig:flow_obstacle}c-f).  For a fixed horizontal separation distance $d_x=2r_h$, the area of this iso-contour around the microroller increases with $R_h$, leading to an enhanced hydrodynamic attraction. This is further quantified by measuring the volume $\mathcal{V}$ enclosed by the iso-surface $u_x=-V_0$ behind the obstacle: a threefold increase of $\mathcal{V}$ is observed between $r_h/R_h=2$ and  $r_h/R_h=0.1$ (see Fig. S4 in the Supplementary Material). 



As shown in Figs.~\ref{fig:field}a-b, the cylinder with $r_h/R_h = 0.33$ is able to attract the microroller, i.e.\ induce a negative microroller velocity along the $x$-axis, over a wider range of lateral positions (between $y \approx -2.25r_h$ and $y \approx 2.25r_h$) than for $r_h/R_h = 1$ (between $y \approx -1.25r_h$ and $y \approx 1.25r_h$). Such an increase in the attractive area with $r_h/R_h$ reduces the escape probability from Brownian motion and thus results in longer trapping times.  This increase  can again be explained by looking at the hydrodynamic response of the cylinder surface when it is laterally shifted from the microroller. As shown in Fig.~\ref{fig:Flow_obs_dy_2}a, for a given lateral shift $d_y = d_x = 2r_h$, the magnitude of the flow induced by the microroller at the position of the cylinder surface increases with $R_h$: the larger the cylinder radius, the closer its surface is to the microroller and to the maximal velocity located along the $x$-axis. 
The cylinder response for $d_y = d_x =2r_h$, shown in Figs.~\ref{fig:Flow_obs_dy_2}b-c, is therefore much stronger for $r_h/R_h=0.1$ than for $r_h/R_h=1$: the area of the iso-contour $u_x = -V_0$ does not enclose the microroller anymore for $r_h/R_h=1$, which allows it to escape, while the attractive flow of the largest cylinder is still able to surround  and trap the microroller. 
 In the limit $r_h/R_h\rightarrow 0$, where the cylinder is an infinite wall, the system is translationally invariant along the $y$-axis, the obstacle reflects the microroller flow independently of $d_y$ and the stagnation point becomes an infinite line (see Fig. S3(c) in the Supplementary Material).



\section*{Discussion}
\label{sec:discussion}
We observed that the escape time versus relative curvature data sets from the simulations and experiments overlap, but for different values of the Debye length (see Fig.~\ref{fig:stoch}f). To match the escape times measured in the experiments, we need to overestimate the Debye length in the simulations. In other words: in simulations a higher trapping strength is measured than in experiments for the same Debye length.         
We carefully matched the parameters in the simulations, such as the buoyant force, viscosity, and microroller-wall interactions, to the experiments in previous work on dense layers of microrollers~\cite{sprinkle2020active}. As the previous work was in the absence of obstacles,
the simulation parameters concerning the introduced obstacle could very well be the reason of the mismatch. Next, we will discuss the effect of the resolution in our coarse-grained simulations, the height of the pillar and the roller-to-obstacle interaction potential. 

In our simulations the number of blobs per roller of the rigid multiblob model~\cite{balboa2017hydrodynamics} is kept constant at $N=12$. This ensures that the run time of the simulations, where also the obstacles composed of similar sized blobs are present, remains acceptable. It is known, however, that a low resolution in the simulation of a microrollers, leads to an overestimate of its self-induced velocity~\cite{driscoll2017unstable}. Therefore, we also ran simulations with a higher number of blobs per roller ($N=42$) to measure the escape time of the roller for different relative curvatures $r_h/R_h$ (see Fig. S3a in the Supplementary Material). We find that the escape time of the high resolution roller is increased with respect to the low resolution roller. Instead of narrowing the gap between the measured escape times in the simulations and experiments, this further increases the mismatch.

The height of the pillar $H$ in the experiments was 20 \textmu m, while in the simulations we introduced obstacles with $H=5.5$ \textmu m; this value was chosen to significantly reduce the run-time of the simulations. To study the influence of the pillar height in the simulations, we measured the escape time for different pillar heights with $r_h/R_h=1$ (see Fig. S3(d) in the Supplementary Material). Although the trapping strength is reduced with a smaller pillar height, at $H=5.5$ \textmu m the escape time is reduced by only $\sim$15$\%$. As the limited pillar heights in the simulations lead to a reduction in the escape times, this cannot explain the larger trapping strength measured in the simulations.

We have used the same potential at contact $\epsilon$ for the microroller-to-wall (blob-to-wall, $\epsilon_{bw}$) and microroller-to-obstacle (blob-blob, $\epsilon_{bb}$) in the simulations. 
Although we know that the obstacle is negatively charged~\cite{baker2019shape}, just as the glass wall, we do not know the magnitude of the charge and therefore the correct value of $\epsilon_{bb}$. To investigate its influence on the measured escape times, we ran simulations while varying $\epsilon_{bb}$ and keeping $\epsilon_{bw}$ constant. 
In Fig.~S5(a) the mean escape times $t^*$ are plotted for different $\epsilon_{bb}$, simulated with relative curvature $r_h/R_h=1$ and Debye length $(br_h)^{-1}=0.1$. We have also plotted the corresponding interaction potentials in Fig.~S5(b).
The potential at contact $\epsilon_{bb}$ in this work was 0.03, which corresponds to the red point and line in Figs.~S5(a-b).
Clearly, an increase in $\epsilon_{bb}$ leads to a strong reduction of the escape time. 
This reduction can be explained as the screening of the basin of attraction as plotted in Fig.~\ref{fig:field}d, effectively expanding the black circle and making it more probable that the microroller can leave the basin of attraction by Brownian motion.
Therefore, the larger measured escape times in the simulations could very well be explained by an underestimate of the microroller-pillar potential at contact $\epsilon_{bb}$.
One possible way to measure this potential would be by using optical tweezers~\cite{grier1997optical}. Alternatively, the interaction potential can be estimated from zeta potential measurements of colloids fabricated by 3D-printing using the same resin~\cite{baker2019shape,saraswat2020shape,doherty2020catalytically}.

%Add a bit about possible offset due to different initial conditions.
% might affect offset in measured escape times, but will change physical outcome/phenomena observed.
Finally, another possible contribution to the offset in the measured escape times in experiments and simulations could be the different initial conditions in the escape time measurements. Where in the simulations the escape times are measured after placing the roller in the trap in the wake of the obstacle, in the experiments this is not possible and instead the escape times are measured after a roller enters the trap (most often on the side of the obstacle). As pointed out before, placing the roller in the trap in the simulations is done to reduce their run times. Although this might contribute to the offset in the measured escape times, it is unlikely this will change the trend in the escape times as a function of curvature as we observe.


The trapping of active particles has been studied in experiments~\cite{takagi2014hydrodynamic,simmchen2016topographical,wykes2017guiding,sipos2015hydrodynamic,ketzetzi2022activity} and simulations~\cite{spagnolie2015geometric,sharifi2017dynamics}, for bacteria~\cite{sipos2015hydrodynamic,Tahaka2022} and spherical~\cite{takagi2014hydrodynamic,simmchen2016topographical,spagnolie2015geometric,sharifi2017dynamics,ketzetzi2022activity,ketzetzi2022activity} and rod-shaped~\cite{takagi2014hydrodynamic,wykes2017guiding,spagnolie2015geometric} artificial microswimmers. 
The hydrodynamic trapping as reported in these studies is manifested in the orbit of the swimmers around round obstacles and along ridges above a critical relative curvature. 
The escape time of Brownian dipolar swimmers was found to depend on the curvature of the obstacle, as was also put to use in the elegant experiments by Davies-Wykes et al.~\cite{wykes2017guiding}. 
In all of these studies, it was found that Brownian motion only contributes to the \textit{escape} of the swimmers from these orbital traps.
The microrollers studied in our work differ from the swimmers in these studies (\textit{pushers} and \textit{pullers}) by both their flow field~\cite{delmotte2017minimal,kos2018elementary} (see Figs.~\ref{fig:setup}a-b) \textit{and} their restricted orientation as imposed by the plane of rotation of the magnetic field. 
This restriction in the direction of propulsion makes that the trapped microrollers do not orbit the cylindrical obstacle, but rather converge to a single point: the attractor. Moreover, Brownian motion is needed in order for the microrollers to \textit{enter} the basin of attraction, contrary to dipole swimmers, where thermal fluctuations only contribute to the release of the swimmer.

% A model for Brownian dipolar swimmers trapped by round obstacles was presented by Spagnolie \textit{et al.}~\cite{spagnolie2015geometric}. 
%They found that in some case the trapping time is governed by an Ornstein-Uhlenbeck process, arising from a balance between thermal fluctuations and hydrodynamic attraction stemming from the flow field of the swimmer. This results in escape time distributions resembling an inverse-Gaussian. Although we do not have a model for the escape process of microrollers, as there is no analytical expression for the flow of a rotlet above a wall and near an obstacle, the escape distributions we measured for $r_h/R_h>1$ seem to have the same shape  (see Fig. S1 in the Supplementary Material~\cite{Note3}).
%This suggests that the trapping of fluid pumping swimmers by obstacles is generic and makes it interesting to study swimmers with other flow fields and their interaction with obstacles.

%\section{Conclusions} %is this normal for PhysRev? - Yes, seen it in Phys Rev X papers (Ernest)
To conclude, we studied the interaction of microrollers with cylindrical obstacles using experiments and simulations including Brownian motion and hydrodynamic interactions. We found hydrodynamic trapping of the rollers downstream to the obstacle, where the trapping strength increases sharply for lower relative curvature. The trapping originates from the emergence of a basin of attraction with an attractor behind the obstacle which draws the roller towards the obstacle, which increases with increasing obstacle radius. We found three points of zero roller velocity: two stagnation points (up- and downstream) and one convergence point or attractor (downstream). Where the stagnation points originate from a balance of the self-induced velocity of the roller and the hydrodynamic interaction with the obstacle, the attractor adds the electrostatic repulsion between the obstacle and the roller to the balance. Brownian motion plays a double role in the trapping of the microroller: it is needed for the roller to cross a separatrix to enter the trap, but it also kicks the roller out of the trap. This is unlike dipolar microswimmers, such as bacteria (`pushers') and algae (`pullers'), where Brownian motion is only contributing to the escape of the swimmer from the trapped state.
We found an offset in the escape times in simulations and experiments, which we attribute to an underestimate of the obstacle-microroller potential at contact.
Finally, we note that the trapping is easily tunable over orders of magnitude in the laboratory by controlling the curvature of the obstacle and the Debye length of the microroller suspension.

In this work we were limited by the computation time to access higher resolution simulations or larger obstacles ($r_h/R_h \ll 1$), which could be explored in future work, as well as the incorporation of lubrication effects~\cite{sprinkle2020active}. Furthermore, a careful characterization of the microroller-obstacle electrostatic interaction could potentially close the gap in the trapping strength in the experiments and simulations.

Dense suspensions of microrollers exhibit interesting behavior such as %the formation of layers with different velocities~\cite{sprinkle2017large}, as well as 
the formation of hydrodynamically stabilized motile clusters~\cite{driscoll2017unstable}. It will be of interest to explore how these motile clusters interact with obstacles, as they are promising for the directed transport of passive cargo~\cite{driscoll2017unstable}. This would be a first step to understand their interaction with a complex environment. 
%but this will require substantially longer run times of the simulations due to the large amount of blobs in the simulations. 


Obstacles with more complex shapes can lead to other interesting hydrodynamic interactions. As shown by Davies Wykes et al.~\cite{wykes2017guiding}, obstacles with a variable curvature (such a teardrops) can lead to controlled release of the swimmer from the obstacle. In the case of the microrollers, this release can then be instigated by a change in the external magnetic field, resulting in switchable and externally controlled trapping. 
Furthermore, as the trapping strength depends on the relative curvature, it can potentially be used to sort microrollers by their size.
Finally, it is worthwhile to study the interaction of the microrollers with 3D obstacles where the obstacles distort the flow field above the microrollers. It will be interesting to extend this to the interaction of microrollers exploring a 3D environment, for instance porous architectures.


\section*{Materials and Methods}
\subsection*{Experiments}
The experimental system is similar to Ref.~\cite{sprinkle2020active}, but with the addition of a 3D-printed cylindrical obstacle. The microrollers are TPM (3-(trimethoxysilyl)propyl methacrylate) spheres with a diameter of 2.1 \textmu m with an embedded magnetic hematite cube\cite{TPM} (see Figs.~\ref{fig:setup}c-d) suspended in water. To control the Debye length $b$, lithium chloride (LiCl) was dissolved in the water. 
The obstacles were printed using a photo\-polymer resist (IP-Dip) on microscope cover slips using a Nano\-scribe Professional GT two-photon printer~\cite{nishiguchi2018engineering,reinken2020organizing}. The auto-fluorescent obstacles were printed as open cylinders with height $H= 20$ \textmu m, where the wall thickness was 2.5-2.8 \textmu m, in a periodic array with a square lattice, with a lattice constant of 100 \textmu m.
A sample chamber (${\sim}120$ \textmu m ${\times}~2$ cm~${\times}~2$ cm) was constructed from the cover slip with the printed pillars, two spacers and a microscope slide~\cite{sprinkle2020active}, which was filled with the microroller suspension and sealed using UV glue (Norland Adhesives, no.\ 68). 
We imaged the microrollers and obstacles using a bright field or fluorescence microscope (see Fig. S1 of the Supplementary Material) while applying a rotating magnetic field (40 G, 9 Hz, see Fig.~\ref{fig:setup}d) using the setup described in Ref.~\cite{sprinkle2020active}. 


\subsection*{Simulations}
To study the trapping of microrollers we performed Brownian dynamics simulations. The dynamics of a microroller satisfy the overdamped Langevin equations \cite{sprinkle2017large}
\begin{equation}
\frac{d\bq}{dt} = \bM \bF + \sqrt{2k_BT}\bM^{1/2}\bs{\mc{W}} + k_BT\partial_{\bq}\cdot\bM
\label{eq:langevin}
\end{equation}
 where $\bq = \{\bx,\btheta\}$ is the vector collecting the roller position $\bx$ and orientation $\btheta$ (here a quaternion). The first term in the RHS of  \eqref{eq:langevin} is the deterministic velocity of the microroller due to the external forces $\bbf$ (here gravity and electrostatic repulsion) and torques $\btau$ (from the rotating magnetic field in experiments)  applied on it, where $\bF=\{\bbf,\btau\}$. The mobility matrix $\bM(\bq(t))$  relates the velocity $\bV$ and rotation rate $\bomega$ to the forces and torques applied on the microroller  through  its hydrodynamic interactions with the wall and the obstacle. The second term is the velocity increment due to  Brownian motion, which involves a vector of independent white noise processes $\bs{\mc{W}}(t)$ and the square root of the mobility matrix $\bM^{1/2}$. The last  term is the stochastic drift  involving the divergence of the mobility matrix with respect to the particle positions and orientations, it  arises when taking the overdamped limit of the Langevin equations \cite{Grassia1996}. More details on the methods used to compute those stochastic terms are found in \cite{sprinkle2017large}.

We computed the mobility matrix $\bM$ by solving the first-kind integral formulation of the Stokes equations with a coarse-grained model called the rigid multiblob model \cite{balboa2017hydrodynamics}, where the continuous single layer potential is replaced by a discrete set of blobs, i.e.\ markers with a finite size, on the surface of the microroller and of the cylinder. These blobs are constrained to satisfy the rigid body motion on the obstacle and microroller surface through a set of Lagrange multipliers.
Hydrodynamic interactions between the blobs are given by a regularization of the Green's function of Stokes equations in the presence of a no-slip wall, called the wall-corrected Rotne-Prager-Yamakawa (RPY) tensor \cite{Swan2007}. The cylinder is constrained at a fixed position on the floor in order to satisfy the no-slip boundary condition for the fluid velocity $\bu=\bzero$ on its surface. 


We modeled the microrollers with a hydrodynamic radius $r_h = $ 1 $\mu$m\cite{geometric} confined by gravity to a no-slip bottom wall, while a constant torque is applied in the \textit{x-z}-plane (see Figs.~\ref{fig:setup}e-f)~\cite{balboa2017hydrodynamics,sprinkle2017large,RigidMultiblobs}. 
The microrollers are constructed of 12 blobs with radii $r_b = 0.416~\mu$m, while we vary the hydrodynamics radius $R_h$ of the cylindrical obstacles, which are constructed of blobs with an equal size as the rollers and have a height $H = 5.5$ \textmu m\cite{OVITOnote}. 
A smaller height was chosen in simulations to reduce the run-time of the simulations and its (minimal) effects on the results are addressed in the Discussion. %$5r_h$. 
%In contrast to the rollers, the obstacles are fixed to the bottom wall.

The blobs in the roller and pillar interact through a Yukawa potential
\begin{equation}
U(r) =
  \begin{cases}
    \epsilon - \epsilon \frac{r-l}{b}       & \quad \text{if } r < l \\
    \epsilon  e^{-\frac{r-l}{b}}  & \quad \text{if } r \geq l,
  \end{cases}
  \label{eq:yukawa}
\end{equation}
where $\epsilon=0.03$ pN$\mu$m $\approx 7.3$ kT is the repulsion strength at contact, $r$ the center-to-center distance between the blobs, $l$ twice the blob radius $r_b$ and $b/r_h=0.1$ the Debye length. For the interaction between a blob and the bottom wall we use the same potential, but with $l$ equal to the radius of a single blob $r_b$ and $r$ the distance from the wall to the center of the blob~\cite{balboa2017brownian}.
We used the stochastic Trapezoidal Slip method~\cite{sprinkle2017large} to integrate  \eqref{eq:langevin} with a time step $\Delta t / \tau_{self} = 2.25 \times 10^{-3}$, where $\tau_{self}=(6 \pi \eta r_h^3)/k T$, the time the roller takes to diffuse over its own radius in the absence of a driving field~\cite{goodwin2009colloids}. 

The parameters used in the simulations are listed in Tab.~S1 and are chosen similar to the experimental parameters and the work reported in Ref.~\cite{sprinkle2020active}.


\section*{Acknowledgments}
We thank Brennan Sprinkle and Aleksandar Donev for useful discussions, and Mena Youssef and Stefano Sacanna for providing the hematite/TPM particles.
\section*{Funding}
This work was supported by the National Science Foundation under award number CBET-1706562. F.B.U.\ is supported by la Caixa Foundation (ID 100010434), fellowship LCF/\-BQ/\-PI20/\-11760014, and from the European Unions Horizon 2020 research and innovation programme under the Marie Skodowska-Curie grant agreement No 847648. 
B.D.\ acknowledges support from the French National Research Agency (ANR), under award ANR- 20-CE30-0006. B.D.\ also thanks the NVIDIA Academic Partnership program for providing GPU hardware for performing some of the simulations reported here. The research efforts of A.S. were supported by the U.S. Department of Energy, Office of Science, Basic Energy Sciences, Materials Sciences and Engineering Division.

\section*{Author Contributions}
E.B.W. and M.M.D. conceived and designed research; 
E.B.W., F.B.U. and B.D. performed simulations;
F.B.U. implemented the obstacles into the Rigid Multiblob code;
E.B.W. and I.T.K. built experimental setup;
A.V.S. printed obstacles;
B.C.B., E.B.W. and I.T.K. performed experiments;
E.B.W., B.C.B., B.D. and M.M.D. analyzed data;
E.B.W., B.D. and M.M.D. wrote the manuscript.

\section*{Competing Interest}
The authors declare no competing interest.
\section*{Data and Materials Availability}
The datasets generated during and/or analysed during the current study are available from the corresponding authors upon reasonable request.
%Here you should list the contents of your Supplementary Materials -- below is an example. 
%You should include a list of Supplementary figures, Tables, and any references that appear only in the SM. 
%Note that the reference numbering continues from the main text to the SM.
% In the example below, Refs. 4-10 were cited only in the SM.     
\section*{Supplementary materials}
Supporting File Legends\\
Figs. S1 to S5\\
Tab. S1\\
Vids. S1 to S5\\
File S1\\
% Your references go at the end of the main text, and before the
% figures.  For this document we've used BibTeX, the .bib file
% scibib.bib, and the .bst file Science.bst.  The package scicite.sty
% was included to format the reference numbers according to *Science*
% style.

%BibTeX users: After compilation, comment out the following two lines and paste in
% the generated .bbl file. 
\bibliography{scibib}
\bibliographystyle{Science}


\newpage
\begin{figure}
 \centering
 \includegraphics[width=\textwidth]{figures/20220504_fig_1a.png}
\caption{
\label{fig:setup}
\textbf{Magnetic field driven microrollers.} Velocities and stream lines of the fluid flow field around a spherical particle rotating perpendicular to a nearby wall in the $x-z$ (a) and $x-y$ plane (b). Fluid velocities are normalized with the bulk velocity of the microroller.
(c) Scanning electron microscopy image of TPM spheres with an embedded hematite cube and an overlay of a schematic of the particles. The scale bar is 2 \textmu m.
(d) Schematic of a suspended microroller with magnetic moment $m$ confined above a glass wall by gravity $g$ and driven by a magnetic field $B$ rotating perpendicular to the glass wall. 
(e) Side view and (f) perspective view of a microroller (cyan)
with a hydrodynamic radius $r_h$ = 1 \textmu m, constructed as a rigid multiblob, approaching a cylindrical obstacle (magenta) with
a hydrodynamic radius $R_h$ composed of similar sized blobs. The roller is subject to an applied torque in the $x-z$ plane and Brownian motion, whereas the obstacle is frozen into place.}
\end{figure}
 
\begin{figure}
\centering
\includegraphics[width=\textwidth]{figures/20220406_fig_1b.png}
\caption{
\label{fig:trapping}
\textbf{The interaction of microrollers with cylindrical obstacles in experiments and simulations.}
(a-b) Temporal projections of a fluorescence microscopy image sequence of microrollers interacting with cylindrical obstacles ($H=20$ \textmu m, $R=14.4$ \textmu m), where the microroller is trapped and eventually released (a), or passes the obstacle (b). 
(c-d) Temporal projections of simulations of microrollers approaching cylindrical obstacles ($R_h=10$ \textmu m) where also the microrollers gets trapped and eventually released (c), or passes the obstacle (d).
Videos of the trapping in experiments and simulations are provided in the Supplementary Material.
The arrows denote the direction of propagation of the microrollers.
The scale bars are 10 \textmu m.}
\end{figure}

\begin{figure*}
\includegraphics[width=\textwidth]{figures/20220516_fig_2.png}
\caption{
\label{fig:stoch}
\textbf{Microrollers interacting with cylindrical obstacles. }
(a-d) 2D histograms (log-scale) of the [$x$,$y$] coordinates of a microroller interacting with a cylindrical obstacle in experiments (a) and simulations (b-d), for different relative curvatures: $r_h/R_h = 0.07$ (a), $r_h/R_h = 0.1$ (b) and $r_h/R_h = 0.33$ (c-d). In the simulations, the stochastic (b-c) or deterministic (d) methods were used. The roller is driven in the $x$ direction. In panel (a) the brown dotted circle is drawn as a guide to the eye to clearly show the upstream repulsion and downstream attraction near the obstacle. In panel (b-d), the solid magenta circle denotes the obstacle, the white dashed line the position of the roller at contact with the obstacle. 
(e) 2D histogram (log-scale) of the [$x$,$y$] coordinates of multiple runs where a microroller escapes the hydrodynamic trap of an obstacle ($r_h/R_h = 0.33$) from the starting point at [$x=R_h+r_h$,$y=0$] (white arrow) until the escape when $x>R_h+5r_h$ (red line). Video S5 of the Supplementary Material shows a single escape run.
%
%(e) 2D histogram (log-scale) of the [$x$,$y$] coordinates of a microroller in stochastic simulations, with relative curvature $r_h/R_h = 0.33$, escaping the hydrodynamic trap from the starting point at [$x=R_h+r_h$,$y=0$] (white arrow). The red line indicates the escape criterion ($x>R_h+5r_h$). Video S5 of the Supplementary Material~\cite{Note3} shows a single escape run.
(f) Log-log plot of the mean escape time $t^*$ as a function of relative curvature $r_h/R_h$ in simulations ($b/r_h=0.1$ (\protect\opentriangle) and $b/r_h=0.4$ (\protect\opentriangleud)) and experiments (no salt, $b/r_h \approx 0.3$ (\protect\opencircle) and added salt, $b/r_h = 0.025$ (\protect\opensquare)), where the error bars denote the standard error.}
\end{figure*}


\begin{figure*}
\includegraphics[width=\textwidth]{figures/20220406_fig_3.png}
\caption{
\label{fig:field}
\textbf{Identifying the basin of attraction.}
Deterministic microroller velocity fields in the \textit{xy} plane calculated around cylindrical obstacles with relative curvatures of (a) $r_h/R_h = 1.00$ and (b) $r_h/R_h = 0.33$. The instantaneous microroller velocities in the plots are normalized to the average velocity of the microroller in the absence of obstacles $V_0$. The filled magenta circles denote the obstacle, the white dashed circles the position of the roller at contact with the obstacle. The filled black circle of radius $R_h+r_h+d$, where $d=0.8$, is drawn to block out the region where the electrostatic repulsion dominates the dynamics of the roller. Two stagnation points ($V/V_0 = 0$, red dots) can be identified upstream and downstream from the obstacle, which differ in their surrounding flow field (white and black arrows): the flow between the point upstream and the obstacle repels the roller from the obstacle, while the point downstream attracts the rollers to the pillar. 
(c) The distance of the stagnation point to the obstacle surface $\tilde{x}$ (see Eq.~\ref{eq:stag_point}) as a function of the relative curvature $r_h/R_h$, where $r_h/R_h=0$ is a wall of height 5.5 $\mu$m. 
(d) 2D projection of the trajectories of a roller with different initial positions interacting with a cylindrical obstacle (magenta, $r_h/R_h = 1.00$) calculated using the deterministic Adams-Bashford method. An interactive 3D plot of this panel can be found in File S1 of the Supplementary Material. The initial positions at $x^2+y^2 = 9r_h$ are indicated by \protect\graycircle ~and the trajectories are colored according to the initial roller height $z/r_h$ = 0.9675 (\protect\purpleline), 1.29 (\protect\blueline), 2.58 (\protect\greenline) and 3.225 (\protect\yellowline). 
The grey circle denotes the area where the electrostatic repulsion dominates the dynamics of the roller.
The pink area, the basin of attraction, denotes the initial $xy$ positions of rollers with $z=1.29$ that are bound to converge into a single point (\protect\blackcircle) downstream of the obstacle.
This point of convergence is located on the edge of the grey circle (or black circles drawn in (a) and (b)). The fate of the roller (trapping or passing) is independent of the initial height of the roller.
Only the rollers with an initial position outside of the basin of attraction undergo a strong enough hydrodynamic \textit{and} electrostatic repulsion to push the roller around the basin of attraction and past the obstacle. %the roller passes the obstacle.
%Upstream at $|y|<0.8, x<0$ %0.776 is the initial y position
%the hydrodynamic \textit{and} electrostatic repulsion acting on the roller is enough to push the roller passed the stagnation point distance $\tilde{x}=2.5$ and the roller passes the obstacle. %For all other initial $xy$ positions the roller converges into a single point (\protect\blackcircle) downstream of the obstacle. 
}
\end{figure*}


\begin{figure*}
\includegraphics[width=\textwidth]{figures/20220516_new_figure.png}
\caption{
\label{fig:new_figure}
\textbf{Effect of relative curvature on the roller velocity field.}
%
The radial velocity $V_r$ (a-b) and tangent velocity $V_{\theta}$ (c-d) fields of a roller around obstacles with relative curvature $r_h/R_h = 1.0$ (a,c) and $r_h/R_h=0.1$ (b,d). The filled magenta circles denote the obstacle, the white dashed circles the position of the roller at contact with the obstacle. The filled black circle of radius $R_h+r_h+d$, where $d=0.8$, is drawn to block out the region where the electrostatic repulsion dominates the dynamics of the roller. The red dots (\protect\smallredcircle) denote the stagnation point of the roller velocity fields as in Figs.~\ref{fig:field}a-b. 
%
(e) The radial (top) and tangent (bottom) roller velocities along the black dotted semi-circles in (a-d) as a function of relative curvature $r_h/R_h$ = 1.0 (\protect\smallredcircle), 0.33 (\protect\greentriangle) and 0.1 (\protect\bluetriangle). The magenta lines correspond to $V_r/V_0 = -0.52 \cos \theta$ (top) and $V_{\theta}/V_0 = -0.61 \sin \theta$ (bottom).
The fluctuations of the curves for $r_h/R_h =$ 0.1 (\protect\bluetriangle) are due to a relative coarse resolution of the mesh used to calculate the roller velocity fields.
All velocities are normalized with the bulk roller velocity.
}
\end{figure*}

\begin{figure*}[t]
\includegraphics[width=\textwidth]{figures/Fig_flow_obstacle.pdf}
\caption{\textbf{Trapping mechanism: hydrodynamic response of the obstacle.} Fluid velocity field induced by an isolated roller at an equilibrium height $h = 1.29r_h$ in the $x-y$ plane (a) and $x-z$ plane (b). The shaded areas represent the position of an obstacle with relative curvature $r_h/R_h=1$ and $r_h/R_h=0.1$ separated by a horizontal distance $d_x=2r_h$. Streamlines are colored in white and the colorbar represents the magnitude of the flow parallel to the plane and is normalized with the self-induced velocity of a free roller $V_0$. The magnitude of the $x-z$ velocity is shown in log-scale due to the high velocity contrast between the rigid body motion on the roller surface ($u\sim 30V_b$) and the vanishing velocity on the bottom wall ($u=0$). (c)-(f) Fluid velocity field induced by the traction forces on the surface of the cylinder for two relative curvatures $r_h/R_h=1$ and $r_h/R_h=0.1$ in the $x-y$ plane (c,e) and $x-z$ plane (d,f). Solid orange line: iso-contour $u_x = -V_0$.
\label{fig:flow_obstacle}
}
\end{figure*}

\begin{figure*}
\includegraphics[width=\textwidth]{figures/Fig_obstacle_dy_2.pdf}
\caption{ \textbf{Effect of lateral shift on hydrodynamic trapping.} (a) Fluid velocity field induced by an isolated roller at an equilibrium height $h = 1.29r_h$ in the $xy$-plane. The shaded areas represent the position of an obstacle with relative curvature $r_h/R_h=1$ and $r_h/R_h=0.1$ separated by a horizontal distance $d_x=2r_h$ and lateral distance $d_y = 2r_h$. Streamlines are colored in white and the colorbar represents the magnitude of the flow parallel to the plane and is normalized with the self-induced velocity of a free roller $V_0$. (b)-(c) Fluid velocity field induced by the traction forces on the surface of the cylinder for two relative curvatures $r_h/R_h=1$ and $r_h/R_h=0.1$ in the $xy$-plane. Solid orange line: iso-contour $u_x = -V_0$. Insets: iso-contour $u_x = -V_0$ in the $xz$-plane going through the center of the microroller at $y=0$.
\label{fig:Flow_obs_dy_2}
}
\end{figure*}


\end{document}




















