\newcommand{\lowerbound}{
\begin{tikzpicture}[scale=1,transform shape]
%\draw [dashed] (0,0) rectangle (3, -3);
\node (h) [draw, color=gray, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (0,0) {};



\foreach \anchor/\placement/\label in
    {corner 1/above/$N$, corner 2/above left/$W_N$, corner 3/below left/$W_S$, corner 4/below/$S$, corner 5/below right/$E_S$, corner 6/above right/$E_N$}
\draw[shift=(h.\anchor)] plot[mark=x,mark size=1.9pt] coordinates{(0,0)} 
node [\placement] {{\scriptsize\label}};

\foreach \anchor/\placement/\label in
    {side 1/above/$n_w$, side 2/left/$w$, side 3/below/$s_w$, side 4/below/$s_e$, side 5/right/$e$, side 6/above/$n_e$}
\draw[shift=(h.\anchor)] plot coordinates{(0,0)} 
node [\placement] {{\scriptsize\label}};

\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}[scale=2]

%\draw [color=gray] (0,0) -- (0, 1.22) -- (2.15, 1.22) -- node [right] {\scriptsize $y$}(2.15, 0) -- (0, 0);
\node [draw, color=gray, shape border rotate=30, minimum size=2.2cm, regular polygon, regular polygon sides=6,label=-135:{{\color{gray}{$H_1$}}}] at (0.475,-.2044) (H) {};
\node [draw, color=gray, shape border rotate=30, minimum size=2.2cm, regular polygon, regular polygon sides=6,label=45:{{\color{gray}{$H_k$}}}] at (0.525,.7803) (H) {};


\node at (0, 0) [draw,fill, inner sep = 1pt, circle, label=180:{$p=p_0$}] (h) {};
\node at (0.95, -0.48) [draw,fill, inner sep = 1pt, circle, label=0:{$q_0$}] (l) {};

\draw (h) -- (l);

\foreach \x in {1, ..., 12}
{
  \node at (\x*0.004167, \x*0.0879) [draw, fill, inner sep = 1pt, circle] (h) {};
  \draw (h) -- (l);
  \draw (h) -- (\x*0.004167-0.004167, \x*0.0879-0.0879);
  \node at (\x*0.004167+0.95, \x*0.0879-0.48) [draw,fill, inner sep = 1pt, circle] (l) {};
  \draw (h) -- (l);
  \draw (l) -- (\x*0.004167-0.004167+0.95, \x*0.0879-0.0879-0.48);
}

\node at (0.05, 1) [inner sep = 1pt, circle, label=180:{$p_k$}] {};
\node at (1, 0.58) [inner sep = 1pt, circle, label=0:{$q=q_k$}] (h) {};
%\draw (h) -- (l);

%\draw [color=gray, dashed] (0.15, 3) -- (0.15, 1) -- (2.15, 1) -- (2.15, 3) -- node [below] {\scriptsize $1-\delta$} (0.15, 3);

%\draw [color=gray, dashed] (c2) -- node [above] {\scriptsize $1-\delta$} (0, -1.8) -- (0, 0.2) -- (2.01, 0.2) -- (c2);

\end{tikzpicture}\hspace{0.5cm}
\begin{tikzpicture}[scale=1.5]
%\draw [dashed] (0,0) rectangle (3, -3);
\node [draw, color=gray, shape border rotate=30, minimum size=1.18125in, regular polygon, regular polygon sides=6,label=-135:{{\color{gray}{$H_1$}}}] at (0.866025,-.5) (H) {};


\node at (0,-0.2) [fill, circle, inner sep=1.2pt, label=180:{$p=p_0$}] (a) {};
\path (a) ++(70:0.27) node (p1) [draw,circle,inner sep=1.2pt,fill=black,label=180:$p_1$] {};
\path [draw] (p1) ++(70:0.27) node (p2) [draw,circle,inner sep=1.2pt,fill=black,label=180:$p_2$] {};


\node at (1.73205,-1) [fill, circle, inner sep=1.2pt, label=0:$q_0$] (c2) {};
\path (c2) ++(70:0.27) node (q1) [draw,circle,inner sep=1.2pt,fill=black,label=0:$q_1$] {};
\path (q1) ++(70:0.27) node (q2) [draw,circle,inner sep=1.2pt,fill=black,label=0:$q_2$] {};

\draw (p2) -- (p1) -- (a) -- (c2) -- (p1) -- (q1) -- (p2) -- (q2) -- (q1) -- (c2);

%\draw [color=gray, dashed] (0,0) -- (3,0) -- (3, -3) -- node [below] {\scriptsize $1-\delta$} (0,-3) -- (0, 0);
%\node at (3.2, 0.2) [] {\color{gray}{$S_1$}};
%\draw [dashed] (0.25,0) rectangle (3.25, -3);
%\draw [color=gray, dashed] (0.25,0.7) rectangle (3.25, -2.3);

%\node at (3.25,-2.3) [fill, circle, inner sep=2pt, label=0:$q_1$] (q) {};
%\node at (0.25,0) [fill, circle, inner sep=2pt, label=115:$p_1$] (p1) {};
%\node at (0.5,0.7) [fill, circle, inner sep=2pt, label=115:$p_2$] (p2) {};

%\draw (q) -- (p2) -- (p1) -- (c2) -- (q) -- (p1) -- (a) -- (c2);

%\node at (-0.24,-0.24) [color=gray] {{\small $\delta$}};
\end{tikzpicture}
}


\newcommand{\regular}{
\begin{tikzpicture}[scale=1, transform shape]
\clip (0,-1.14) rectangle (8,3);


\node [color=red!25, shape border rotate=30, minimum size=0.7in, regular polygon, regular polygon sides=6] at (0,0.33) (Hm3) {};

\node [color=blue!25, shape border rotate=30, minimum size=0.58in, regular polygon, regular polygon sides=6] at (0.47,0.45) (Hm2) {};

\node [color=red!25, shape border rotate=30, minimum size=0.78in, regular polygon, regular polygon sides=6] at (1.53,-0.05) (Hm1) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.81in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]-120:{\color{blue!25}{$H_1$}}}] at (2,0.77) (H1) {};

\node at (1.7,0.7) {$T_1$};

%\node [draw,color=blue!25, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (1.73,0.61) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]120:{\color{red!25}{$H_2$}}}] at (2.93,1.18) (H2) {};

\node at (2.4,1.18) {$T_2$};

\node [draw,color=blue!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]-60:{\color{blue!25}{$H_3$}}}] at (3.99,0.71) (H3) {};

\node at (3.9,0.75) {$T_3$};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.35in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]85:{\color{red!25}{$H_4$}}}] at (4.1,0.9) (H4) {};

\node at (4.85,1.35) {$T_4$};

\node [draw, color=blue!25, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]-30:{\color{blue!25}{$H_5$}}}] at (5.675,1.47) (H5) {};

\node at (5.85,1.5) {$T_5$};

\node [color=red!25, shape border rotate=30, minimum size=1.43in, regular polygon, regular polygon sides=6] at (6.06,3.3) (H6) {};

\node [color=blue!25, shape border rotate=30, minimum size=1.6in, regular polygon, regular polygon sides=6] at (6.25,3.625) (H7) {};

\node [color=red!25, shape border rotate=30, minimum size=1.355in, regular polygon, regular polygon sides=6] at (7.24,3.36) (H8) {};

\node [color=blue!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6] at (7.6,3.27) (H9) {};

\node [color=red!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6] at (8,3.5) (H10) {};

\node at (Hm3.side 3) [yshift=.4cm,circle,inner sep=1.4pt] (s) {};

\node at (H10.side 6) [yshift=-3.1cm,circle,inner sep=1.4pt] (t) {};

%\node at (10,3.333) [draw,fill,circle,inner sep=1.4pt,label=180:{$t$}] (t) {};
\draw [gray, dotted] (s) -- (t);

\node at (Hm3.corner 6) (a) {};
\node at (Hm3.corner 1) (b) {};
\node at (Hm2.corner 1) (c) {};
\node at (Hm2.corner 2) (d) {};

\node at (intersection of a--b and c--d) [circle,inner sep=1.4pt] (h1) {};

\node at (Hm2.corner 4) (a) {};
\node at (Hm2.corner 5) (b) {};
\node at (Hm1.corner 2) (c) {};
\node at (Hm1.corner 3) (d) {};

\node at (intersection of a--b and c--d) [circle,inner sep=1.4pt] (l1) {};

\node at (1.11,0.8) [draw,fill,circle,inner sep=1.4pt,label=180:{$u_0$}] (h2) {};

\node at (H1.corner 1) (a) {};
\node at (H1.corner 2) (b) {};
\node at (H2.corner 2) (c) {};
\node at (H2.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_1$}] (h4) {};

\node at (H2.corner 3) (a) {};
\node at (H2.corner 4) (b) {};
\node at (H3.corner 2) (c) {};
\node at (H3.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=-90:{$l_0,l_1,l_2$}] (l3) {};

\node at (3.6,2.32) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_2,u_3$}] (h5) {};

\node at (H4.corner 6) (a) {};
\node at (H4.corner 1) (b) {};
\node at (H5.corner 1) (c) {};
\node at (H5.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=45:{$u_4$}] (h7) {};

\node at (H4.corner 5) (a) {};
\node at (H4.corner 6) (b) {};
\node at (H5.corner 3) (c) {};
\node at (H5.corner 4) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=-45:{$l_3,l_4,l_5$}] (l6) {};

\node at (6.78,1.9) [draw,fill,circle,inner sep=1.4pt,label=0:{$u_5$}] (l8) {};

\node at (4.48,3.6) [circle,inner sep=1.4pt] (h9) {};

\node at (H8.corner 6) (a) {};
\node at (H8.corner 1) (b) {};
\node at (H9.corner 1) (c) {};
\node at (H9.corner 2) (d) {};

\node at (intersection of a--b and c--d) [circle,inner sep=1.4pt] (h10) {};

\node at (8.34,1.85) [circle,inner sep=1.4pt] (l11) {};


\draw (l3) -- (h2) -- (h4) -- (l3) -- (h5) -- (h4);
\draw (l3) -- (l6) -- (h5) -- (h7) -- (l6) -- (l8) -- (h7); 

\node (tmp) at ($(h7)+(150:5)$) {};
\node (tmp2) at ($(h2)+(90:4)$) {};

\coordinate (z) at (intersection of h7--tmp and h2--tmp2);

%\draw [dashed, red] (h2) -- (z) -- (h7);

\node (tmp) at ($(h7)+(330:5)$) {};
\node (tmp2) at ($(l11)+(270:4)$) {};

\coordinate (z) at (intersection of h7--tmp and l11--tmp2);

%\draw [dashed, red] (l11) -- (z) -- (h7);



\end{tikzpicture}
}



\newcommand{\discretedNdS}{
\begin{tikzpicture}[scale=1]
\clip (-2.5,-1.55) rectangle (6.5,1.55);
\node (h) [draw, color=gray, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6,label={[label distance=-1.5cm]0:{\color{gray}{$H_i$}}}] at (0,0) {};

\node at (h.side 1) [xshift=-0.2cm,yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=90:{\color{blue}{\large +}}] (s1) {};
\node at (h.side 2) [draw,circle,fill,inner sep=1.4pt,label=135:{\color{blue}{\large +}}] (s2) {};
%\node at (h.side 3) [xshift=+0.2cm,yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=90:{\color{blue}{\large +}}] (s3) {};

\draw (s1) -- (h.corner 1) [->,>=stealth',blue,label=-45:{$+$}];
\draw ($(s2) + (-0.1cm,0)$) -- ($(h.corner 2) + (-0.1cm,0.052cm)$) -- ($(h.corner 1) + (0,0.1cm)$) [->,>=stealth',blue,label=-45:{$+$}];
%\draw ($(s3) + (0.052cm,0.1cm)$) -- ($(h.corner 3) + (0.1cm,0.052cm)$) -- ($(h.corner 2) + (0.1cm,-0.052cm)$) -- ($(h.corner 1) + (0,-0.1cm)$) [->,>=stealth',blue,label=-45:{$+$}];

\node at (h.side 6) [draw,circle,fill,inner sep=1.4pt,label=90:{\color{red}{\large --}}] (s1) {};
\node at (h.side 5) [yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=45:{\color{red}{\large --}}] (s2) {};
%\node at (h.side 4) [draw,circle,fill,inner sep=1.4pt,label=90:{\color{red}{\large --}}] (s3) {};

\draw (s1) -- (h.corner 1) [->,>=stealth',red];
\draw ($(s2) + (0.1cm,0)$) -- ($(h.corner 6) + (0.1cm,0.052cm)$) -- ($(h.corner 1) + (0,0.1cm)$) [->,>=stealth',red];
%\draw ($(s3) + (-0.052,0.1cm)$) -- ($(h.corner 5) + (-0.1cm,0.052cm)$) -- ($(h.corner 6) + (-0.1cm,-0.052cm)$) -- ($(h.corner 1) + (0,-0.1cm)$) [->,>=stealth',red];

\node (h) [draw, color=gray, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6,label={[label distance=-1.5cm]0:{\color{gray}{$H_i$}}}] at (5,0) {};

%\node at (h.side 1) [xshift=-0.2cm,yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=-90:{\color{blue}{\large +}}] (s1) {};
\node at (h.side 2) [draw,circle,fill,inner sep=1.4pt,label=-135:{\color{blue}{\large +}}] (s2) {};
\node at (h.side 3) [xshift=+0.2cm,yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=-90:{\color{blue}{\large +}}] (s3) {};

\draw (s3) -- (h.corner 4) [->,>=stealth',blue,label=-45:{$+$}];
\draw ($(s2) + (-0.1cm,0)$) -- ($(h.corner 3) + (-0.1cm,-0.052cm)$) -- ($(h.corner 4) + (0,-0.1cm)$) [->,>=stealth',blue,label=-45:{$+$}];
%\draw ($(s1) + (0.052cm,-0.09cm)$) -- ($(h.corner 2) + (0.1cm,-0.052cm)$) -- ($(h.corner 3) + (0.1cm,0.052cm)$) -- ($(h.corner 4) + (0,0.1cm)$) [->,>=stealth',blue,label=-45:{$+$}];

%\node at (h.side 6) [draw,circle,fill,inner sep=1.4pt,label=-90:{\color{red}{\large --}}] (s1) {};
\node at (h.side 5) [yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=-45:{\color{red}{\large --}}] (s2) {};
\node at (h.side 4) [draw,circle,fill,inner sep=1.4pt,label=-90:{\color{red}{\large --}}] (s3) {};

\draw (s3) -- (h.corner 4) [->,>=stealth',red];
\draw ($(s2) + (0.1cm,0)$) -- ($(h.corner 5) + (0.1cm,-0.052cm)$) -- ($(h.corner 4) + (0,-0.1cm)$) [->,>=stealth',red];
%\draw ($(s1) + (-0.052,-0.1cm)$) -- ($(h.corner 6) + (-0.1cm,-0.052cm)$) -- ($(h.corner 5) + (-0.1cm,0.052cm)$) -- ($(h.corner 4) + (0,0.1cm)$) [->,>=stealth',red];
\end{tikzpicture}\hspace{1.34cm}
\begin{tikzpicture}[scale=1]
\clip (-2.35,-1.45) rectangle (6.5,1.65);
\node (h) [draw, color=gray, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6,label={[label distance=-1.5cm]0:{\color{gray}{$H_i$}}}] at (0,0) {};

\node at (h.side 2) [draw,circle,fill,inner sep=1.4pt,label=180:{$u_{i-1}$}] (uj) {};
\node at (h.side 6) [draw,circle,fill,inner sep=1.4pt,label=0:{$u_i$}] (ujp) {};

\draw (uj) -- (h.corner 2) -- (h.corner 1) [->,>=stealth',blue];
\draw (ujp) -- (h.corner 1) [->,>=stealth',red];

\draw (uj) -- (ujp);

\node at (-1.45,1.1) [blue] {$p_N(u_{i-1},i)$};
\node at (1.05,1.45) [red] {$p_N(u_i,i)$};
\end{tikzpicture}
}



\newcommand{\definitions}{
\begin{tikzpicture}[scale=1, transform shape]
\clip (-2.2,-1.14) rectangle (12,5.66);


\node [draw, color=red!25, shape border rotate=30, minimum size=0.7in, regular polygon, regular polygon sides=6] at (0,0.33) (Hm3) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.58in, regular polygon, regular polygon sides=6] at (0.47,0.45) (Hm2) {};

\node [draw,color=red!25, shape border rotate=30, minimum size=0.78in, regular polygon, regular polygon sides=6] at (1.53,-0.05) (Hm1) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.81in, regular polygon, regular polygon sides=6] at (2,0.77) (H1) {};

%\node [draw,color=blue!25, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (1.73,0.61) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H2) {};

\node [draw,color=blue!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6] at (3.99,0.71) (H3) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.35in, regular polygon, regular polygon sides=6] at (4.1,0.9) (H4) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (5.675,1.47) (H5) {};

\node [draw,color=red!25, shape border rotate=30, minimum size=1.43in, regular polygon, regular polygon sides=6] at (6.06,3.3) (H6) {};

\node [draw,color=blue!25, shape border rotate=30, minimum size=1.6in, regular polygon, regular polygon sides=6] at (6.25,3.625) (H7) {};

\node [draw,color=red!25, shape border rotate=30, minimum size=1.355in, regular polygon, regular polygon sides=6] at (7.24,3.36) (H8) {};

\node [draw,color=blue!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6] at (7.6,3.27) (H9) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6] at (8,3.5) (H10) {};



\node at (Hm3.side 2) [yshift=-0.32cm,draw,circle,fill,inner sep=1.4pt,label=180:{$u_0,l_0,s$}] (s) {};

\node at (H10.side 5) [yshift=-0.6cm,draw,circle,fill,inner sep=1.4pt,label=0:{$t,u_{12},l_{12}$}] (t) {};

%\node at (10,3.333) [draw,fill,circle,inner sep=1.4pt,label=180:{$t$}] (t) {};
\draw [gray, dotted] (s) -- (t);

\node at (Hm3.corner 6) (a) {};
\node at (Hm3.corner 1) (b) {};
\node at (Hm2.corner 1) (c) {};
\node at (Hm2.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_1$}] (h1) {};

\node at (Hm2.corner 4) (a) {};
\node at (Hm2.corner 5) (b) {};
\node at (Hm1.corner 2) (c) {};
\node at (Hm1.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=-90:{$l_1,l_2$}] (l1) {};

\node at (1.11,0.7) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_2,u_3$}] (h2) {};

\node at (H1.corner 1) (a) {};
\node at (H1.corner 2) (b) {};
\node at (H2.corner 2) (c) {};
\node at (H2.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_4$}] (h4) {};

\node at (H2.corner 3) (a) {};
\node at (H2.corner 4) (b) {};
\node at (H3.corner 2) (c) {};
\node at (H3.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=-90:{$l_3,l_4,l_5$}] (l3) {};

\node at (3.6,2.32) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_5,u_6$}] (h5) {};

\node at (H4.corner 6) (a) {};
\node at (H4.corner 1) (b) {};
\node at (H5.corner 1) (c) {};
\node at (H5.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=45:{$u_7,u_8$}] (h7) {};

\node at (H4.corner 5) (a) {};
\node at (H4.corner 6) (b) {};
\node at (H5.corner 3) (c) {};
\node at (H5.corner 4) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=-45:{$l_6,l_7$}] (l6) {};

\node at (6.78,1.9) [draw,fill,circle,inner sep=1.4pt,label=-90:{$l_8,l_9,l_{10}$}] (l8) {};

\node at (4.48,3.6) [draw,fill,circle,inner sep=1.4pt,label=180:{$u_9$}] (h9) {};

\node at (H8.corner 6) (a) {};
\node at (H8.corner 1) (b) {};
\node at (H9.corner 1) (c) {};
\node at (H9.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_{10},u_{11}$}] (h10) {};

\node at (8.34,1.85) [draw,fill,circle,inner sep=1.4pt,label=-45:{$l_{11}$}] (l11) {};


\draw (h1) -- (s) -- (l1) -- (h1) -- (h2) -- (l1) -- (l3) -- (h2) -- (h4) -- (l3) -- (h5) -- (h4);
\draw (l3) -- (l6) -- (h5) -- (h7) -- (l6) -- (l8) -- (h7) -- (h9) -- (l8) -- (h10) -- (h9);
\draw (l8) -- (l11) -- (h10) -- (t) -- (l11); 

\node (tmp) at ($(h7)+(150:5)$) {};
\node (tmp2) at ($(h2)+(90:4)$) {};

\coordinate (z) at (intersection of h7--tmp and h2--tmp2);

\draw [dashed, red] (h2) -- (z) -- (h7);


\node (tmp) at ($(h4)+(150:5)$) {};
\coordinate (z) at (intersection of h4--tmp and h2--tmp2);
\draw [dotted, red] (h4) -- (z) -- (h2);

\node (tmp) at ($(h5)+(150:5)$) {};
\node (tmp2) at ($(h4)+(90:5)$) {};
\coordinate (z) at (intersection of h5--tmp and h4--tmp2);
\draw [dotted, red] (h4) -- (z) -- (h5);

\node (tmp) at ($(h7)+(150:5)$) {};
\node (tmp2) at ($(h5)+(90:5)$) {};
\coordinate (z) at (intersection of h7--tmp and h5--tmp2);
\draw [dotted, red] (h7) -- (z) -- (h5);




%%%%%%

\node (tmp) at ($(h7)+(330:5)$) {};
\node (tmp2) at ($(l11)+(270:4)$) {};

\coordinate (z) at (intersection of h7--tmp and l11--tmp2);

\draw [dashed, red] (l11) -- (z) -- (h7);


\node (tmp2) at ($(l8)+(270:5)$) {};
\coordinate (z) at (intersection of h7--tmp and l8--tmp2);
\draw [dotted, red] (l8) -- (z) -- (h7);

\node (tmp) at ($(l8)+(330:5)$) {};
\node (tmp2) at ($(l11)+(270:5)$) {};
\coordinate (z) at (intersection of l8--tmp and l11--tmp2);
\draw [dotted, red] (l8) -- (z) -- (l11);




\end{tikzpicture}
}




\newcommand{\infity}{
\begin{tikzpicture}[scale=1, transform shape]
\clip (0,-1.14) rectangle (8,3);


\node [color=red!25, shape border rotate=30, minimum size=0.7in, regular polygon, regular polygon sides=6] at (0,0.33) (Hm3) {};

\node [color=blue!25, shape border rotate=30, minimum size=0.58in, regular polygon, regular polygon sides=6] at (0.47,0.45) (Hm2) {};

\node [color=red!25, shape border rotate=30, minimum size=0.78in, regular polygon, regular polygon sides=6] at (1.53,-0.05) (Hm1) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.81in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]-120:{\color{blue!25}{$H_1$}}}] at (2,0.77) (H1) {};

\node at (1.7,0.7) {$T_1$};

%\node [draw,color=blue!25, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (1.73,0.61) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]120:{\color{red!25}{$H_2$}}}] at (2.93,1.18) (H2) {};

\node at (2.4,1.18) {$T_2$};

\node [draw,color=blue!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]-60:{\color{blue!25}{$H_3$}}}] at (3.99,0.71) (H3) {};

\node at (3.9,0.75) {$T_3$};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.35in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]85:{\color{red!25}{$H_4$}}}] at (4.1,0.9) (H4) {};

\node at (4.85,1.35) {$T_4$};

\node [draw, color=blue!25, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6, label={[label distance=-0.1cm]-30:{\color{blue!25}{$H_5$}}}] at (5.675,1.47) (H5) {};

\node at (5.85,1.5) {$T_5$};

\node [color=red!25, shape border rotate=30, minimum size=1.43in, regular polygon, regular polygon sides=6] at (6.06,3.3) (H6) {};

\node [color=blue!25, shape border rotate=30, minimum size=1.6in, regular polygon, regular polygon sides=6] at (6.25,3.625) (H7) {};

\node [color=red!25, shape border rotate=30, minimum size=1.355in, regular polygon, regular polygon sides=6] at (7.24,3.36) (H8) {};

\node [color=blue!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6] at (7.6,3.27) (H9) {};

\node [color=red!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6] at (8,3.5) (H10) {};

\node at (Hm3.side 2) [yshift=-0.32cm,circle,inner sep=1.4pt] (s) {};

\node at (H10.side 5) [yshift=-0.6cm,circle,inner sep=1.4pt] (t) {};

\draw [gray, dotted] (s) -- (t);

\node at (Hm3.corner 6) (a) {};
\node at (Hm3.corner 1) (b) {};
\node at (Hm2.corner 1) (c) {};
\node at (Hm2.corner 2) (d) {};

\node at (intersection of a--b and c--d) [circle,inner sep=1.4pt] (h1) {};

\node at (Hm2.corner 4) (a) {};
\node at (Hm2.corner 5) (b) {};
\node at (Hm1.corner 2) (c) {};
\node at (Hm1.corner 3) (d) {};

\node at (intersection of a--b and c--d) [circle,inner sep=1.4pt] (l1) {};

\node at (1.11,0.7) [draw,fill,circle,inner sep=1.4pt,label=180:{$u_0$}] (h2) {};

\node at (H1.corner 1) (a) {};
\node at (H1.corner 2) (b) {};
\node at (H2.corner 2) (c) {};
\node at (H2.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_1$}] (h4) {};

\node at (H2.corner 3) (a) {};
\node at (H2.corner 4) (b) {};
\node at (H3.corner 2) (c) {};
\node at (H3.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=-90:{$l_0,l_1,l_2$}] (l3) {};

\node at (3.6,2.32) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_2,u_3$}] (h5) {};

\node at (H4.corner 6) (a) {};
\node at (H4.corner 1) (b) {};
\node at (H5.corner 1) (c) {};
\node at (H5.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=45:{$u_4,u_5$}] (h7) {};

\node at (H4.corner 5) (a) {};
\node at (H4.corner 6) (b) {};
\node at (H5.corner 3) (c) {};
\node at (H5.corner 4) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=-45:{$l_3,l_4$}] (l6) {};

\node at (6.78,1.9) [draw,fill,circle,inner sep=1.4pt,label=0:{$l_5$}] (l8) {};

\node at (4.48,3.6) [circle,inner sep=1.4pt] (h9) {};

\node at (H8.corner 6) (a) {};
\node at (H8.corner 1) (b) {};
\node at (H9.corner 1) (c) {};
\node at (H9.corner 2) (d) {};

\node at (intersection of a--b and c--d) [circle,inner sep=1.4pt] (h10) {};

\node at (8.34,1.85) [circle,inner sep=1.4pt] (l11) {};


\draw (l3) -- (h2) -- (h4) -- (l3) -- (h5) -- (h4);
\draw (l3) -- (l6) -- (h5) -- (h7) -- (l6) -- (l8) -- (h7); 

\node (tmp) at ($(h7)+(150:5)$) {};
\node (tmp2) at ($(h2)+(90:4)$) {};

\coordinate (z) at (intersection of h7--tmp and h2--tmp2);

%\draw [dashed, red] (h2) -- (z) -- (h7);

\node (tmp) at ($(h7)+(330:5)$) {};
\node (tmp2) at ($(l11)+(270:4)$) {};

\coordinate (z) at (intersection of h7--tmp and l11--tmp2);

%\draw [dashed, red] (l11) -- (z) -- (h7);



\end{tikzpicture}
}

\newcommand{\infinity}{
\begin{tikzpicture}[scale=.8, transform shape]
\clip (-0.2,-0.2) rectangle (6.8,3.3);


\node [draw, color=blue!25, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (1.5,1.15) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=3.2in, regular polygon, regular polygon sides=6] at (2.29,-2.6) (H2) {};

\node [draw,color=blue!25, shape border rotate=30, minimum size=4.45in, regular polygon, regular polygon sides=6] at (3.65,-3.76) (H3) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=5.35in, regular polygon, regular polygon sides=6] at (4.96,-4.56) (H4) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=1.02in, regular polygon, regular polygon sides=6] at (5.13,2) (H5) {};

\node at (H1.corner 3) [xshift=-1.1cm,inner sep=1.4pt,label=180:{$s$}] (s) {};

\node at (H5.side 5) [xshift=+1.6cm,yshift=+0cm,inner sep=1.4pt,label=0:{$t,u_{12},l_{12}$}] (t) {};

\draw [gray, dotted] (s) -- (t);

\node at (H1.corner 3) (a) {};
\node at (H1.corner 4) (b) {};
\node at (H2.corner 1) (c) {};
\node at (H2.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=180:{$v_0$}] (v0) {};

\node at (H2.corner 1) (a) {};
\node at (H2.corner 6) (b) {};
\node at (H3.corner 1) (c) {};
\node at (H3.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=94:{$v_1$}] (v1) {};

\node at (H3.corner 1) (a) {};
\node at (H3.corner 6) (b) {};
\node at (H4.corner 1) (c) {};
\node at (H4.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=92:{$v_2$}] (v2) {};

\node at (H4.corner 1) (a) {};
\node at (H4.corner 6) (b) {};
\node at (H5.corner 5) (c) {};
\node at (H5.corner 6) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=0:{$v_3$}] (v3) {};

\node at (H1.side 1) [draw,fill,circle,inner sep=1.4pt] (v) {};
\node at (H5.side 6) [draw,fill,circle,inner sep=1.4pt] (w) {};

\node at (3.25,3) [draw,fill,circle,inner sep=1.4pt] (u) {};


\draw (v1) -- (v) -- (v0) -- (v1) -- (v2) -- (v3) -- (w) -- (v2);

\draw (v) -- (u) -- (w); 
\draw (v1) -- (u) -- (v2); 

\end{tikzpicture}\hspace{1.5cm}
\begin{tikzpicture}[scale=.8, transform shape]
\clip (-0.2,-0.2) rectangle (6.8,3.3);


\node [draw, color=blue!25, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (1.5,1.15) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=3.2in, regular polygon, regular polygon sides=6] at (2.29,-2.6) (H2) {};

\node [draw,color=blue!25, shape border rotate=30, minimum size=4.45in, regular polygon, regular polygon sides=6] at (3.65,-3.76) (H3) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=5.35in, regular polygon, regular polygon sides=6] at (4.96,-4.56) (H4) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=1.02in, regular polygon, regular polygon sides=6] at (5.13,2) (H5) {};

\node at (H1.corner 3) [xshift=-1.1cm,inner sep=1.4pt,label=180:{$s$}] (s) {};

\node at (H5.side 5) [xshift=+1.6cm,yshift=+0cm,inner sep=1.4pt,label=0:{$t,u_{12},l_{12}$}] (t) {};

\draw [gray, dotted] (s) -- (t);

\node at (H1.corner 3) (a) {};
\node at (H1.corner 4) (b) {};
\node at (H2.corner 1) (c) {};
\node at (H2.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=180:{$v_0$}] (v0) {};

\node at (H2.corner 1) (a) {};
\node at (H2.corner 6) (b) {};
\node at (H3.corner 1) (c) {};
\node at (H3.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=95:{$v_1$}] (v1) {};

\node at (H3.corner 1) (a) {};
\node at (H3.corner 6) (b) {};
\node at (H4.corner 1) (c) {};
\node at (H4.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=95:{$v_2$}] (v2) {};

\node at (H4.corner 1) (a) {};
\node at (H4.corner 6) (b) {};
\node at (H5.corner 5) (c) {};
\node at (H5.corner 6) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=0:{$v_3$}] (v3) {};

\node at (H1.side 1) [draw,fill,circle,inner sep=1.4pt] (v) {};
\node at (H5.side 6) [draw,fill,circle,inner sep=1.4pt] (w) {};

%\node at (3.25,3) [draw,fill,circle,inner sep=1.4pt] (u) {};



\draw (v1) -- (v) -- (v0) -- (v1) -- (v2) -- (v3) -- (w) -- (v2);

%\draw (v) -- (u) -- (w); 
%\draw (v1) -- (u) -- (v2); 

\draw (v0) -- ($(v0)+(-90:4)$);
\draw (v1) -- ($(v1)+(-90:4)$);
\draw (v2) -- ($(v2)+(-90:4)$);
\draw (v3) -- ($(v3)+(-90:4)$);

\end{tikzpicture}
}



\newcommand{\caseA}{
\begin{tikzpicture}[scale=.9, transform shape]
\clip (-0.3,-0.8) rectangle (10,4.3);

\coordinate (t) at (10,3.333);
\coordinate (s) at (0,0);
\draw [gray, dotted] (s) -- (t);



\node [draw, gray!25, shape border rotate=30, minimum size=0.58in, regular polygon, regular polygon sides=6] at (0.47,0.45) (Hm2) {};

\node [color=gray!50, dashed, shape border rotate=30, minimum size=0.78in, regular polygon, regular polygon sides=6] at (1.53,-0.05) (Hm1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=0.81in, regular polygon, regular polygon sides=6] at (2,0.77) (H0) {};

\node [color=gray!50, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (1.73,0.61) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H2) {};

\node [color=gray!50, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6] at (3.99,0.71) (H3) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.35in, regular polygon, regular polygon sides=6] at (4.1,0.9) (H4) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (5.675,1.47) (H5) {};

\node [color=gray!50, shape border rotate=30, minimum size=0.906in, regular polygon, regular polygon sides=6] at (5.775,2.27) (H6) {};

\node [draw, color=gray!25, shape border rotate=30, minimum size=0.906in, regular polygon, regular polygon sides=6] at (10.37,2.8) (H7) {};

%\node at (H0.corner 4) (a) {};
%\node at (H0.corner 5) (b) {};
%\node at (H1.corner 2) (c) {};
%\node at (H1.corner 3) (d) {};

%\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (l1) {};

\node at (1.11,0.7) [draw,fill,circle,inner sep=1.4pt,label=180:{$p=u_{r'}$}] (h0) {};

\node at (H1.corner 1) (a) {};
\node at (H1.corner 2) (b) {};
\node at (H2.corner 2) (c) {};
\node at (H2.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=-4:{$u_{r'+1}$}] (h1h2) {};

\node at (H2.corner 3) (a) {};
\node at (H2.corner 4) (b) {};
\node at (H3.corner 2) (c) {};
\node at (H3.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (l2l3) {};

\node at (3.6,2.32) [draw,fill,circle,inner sep=1.4pt,label=177:{$u_{r-1}$}] (h3h4) {};

\node at (H4.corner 6) (a) {};
\node at (H4.corner 1) (b) {};
\node at (H5.corner 1) (c) {};
\node at (H5.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_r$}] (h5h6) {};

\node at (6.78,1.9) [draw,fill,circle,inner sep=1.4pt,label=0:{$l_s$}] (l6) {};

\node at (H4.corner 5) (a) {};
\node at (H4.corner 6) (b) {};
\node at (H5.corner 3) (c) {};
\node at (H5.corner 4) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (l4l5) {};

\node (tmp) at ($(h3h4)+(90:4)$) {};
\node (tmp2) at ($(h5h6)+(150:4)$) {};

\coordinate (z3) at (intersection of h3h4--tmp and h5h6--tmp2);

\node (tmp) at ($(h3h4)+(150:4)$) {};
\node (tmp2) at ($(h1h2)+(90:4)$) {};

\coordinate (z2) at (intersection of h3h4--tmp and h1h2--tmp2);

\node (tmp) at ($(h1h2)+(150:4)$) {};
\node (tmp2) at ($(h0)+(90:4)$) {};

\coordinate (z1) at (intersection of h1h2--tmp and h0--tmp2);

\draw [dashed, red] (h5h6) -- (z3) -- (h3h4) -- (z2) -- (h1h2) -- (z1) -- (h0);
%\draw [dashed, red] (h3h4) -- (z2);
%\draw [dashed, red] (h1h2) -- (z1);

\node (tmp) at ($(h5h6)+(150:5)$) {};
\node (tmp2) at ($(h0)+(90:4)$) {};

\coordinate (z) at (intersection of h5h6--tmp and h1h2--tmp2);

\draw [dotted, red] (h5h6) -- (z) -- (h0);


%\node at (H5.corner 5) (a) {};
%\node at (H5.corner 6) (b) {};
%\node at (H6.corner 4) (c) {};
%\node at (H6.corner 5) (d) {};

%\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=270:{$l_5$}] (l5) {};




\draw [thick,red] (h0) -- (h1h2) -- (h3h4) -- (h5h6);
\draw (h0) -- (l2l3);
\draw (h1h2) -- (l2l3) -- (h1h2);
\draw (h3h4) -- (l2l3) -- (l4l5) -- (h3h4);
\draw (h5h6) -- (l4l5) -- (l6);
\draw [thick, blue] (l6) -- (h5h6);
%\draw (h3) -- (l4) -- (h1);


\coordinate (tmp) at ($(h5h6)+(-30:8)$);
\coordinate (tmp2) at ($(l6)+(-90:6)$);

\coordinate (z4) at (intersection of h5h6--tmp and l6--tmp2);

\draw [dashed, blue] (h5h6) -- (z4) -- (l6);

\coordinate (tmp) at ($(l6)+(-30:3)$);
\node at ($(tmp)+(90:2.25)$) [draw,fill,circle,inner sep=1.4pt,label=-135:{$l_{s'}=q$}] (tmp2) {};


\coordinate (tmp3) at ($(z4)+(-30:6)$);
\coordinate (tmp4) at ($(tmp)+(-90:4)$);

\coordinate (z5) at (intersection of z4--tmp3 and tmp--tmp4);

\draw [dotted, red] (h5h6) -- (z5) -- (tmp2);

\draw [dashed, red] (l6) -- (tmp) -- (tmp2);
\end{tikzpicture}
}





\def\tikzbox{
\clip (-0.42,-1.5) rectangle (4.05,3);
%\node at (0,0)  (s) [draw,fill,circle,inner sep=2pt,label=180:{$s$}] {};
\coordinate (t) at (4,2.5);
\coordinate (s) at (-.5,0);
%\node [draw, color=gray, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (1.1,0) (H1) {};


%\draw [shift=(H1.side 2)] plot[mark=*,mark size=1.9pt] coordinates{(0,0)} 
%node [left] (s) {{$s$}};

%\node [draw, color=gray, dashed, shape border rotate=30, minimum size=1.3in, regular polygon, regular polygon sides=6] at (1.8,.5) (H2) {};

%\node at (H1.corner 1) (a) {};
%\node at (H1.corner 2) (b) {};
%\node at (H2.corner 2) (c) {};
%\node at (H2.corner 3) (d) {};

%\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=175:{$u_1$}] (h1) {};

\node [transform shape,draw, color=red!25, shape border rotate=30, minimum size=0.7in, regular polygon, regular polygon sides=6] at (0.51,1.2) (H0) {};

%\node at (H0.side 3) [draw, circle, fill, inner sep=1.4pt,label=180:$s$] {};

\node at (0.16,0.51) [transform shape,inner sep=1.4pt, draw,circle,fill=red,label=180:{$u_r$}] (h0) {};

\draw [gray, dotted] (s) -- (t);


\node [transform shape,draw, color=blue!25, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (.87,1.35) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=0.95in, regular polygon, regular polygon sides=6] at (1.2,1.35) (H2) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.95in, regular polygon, regular polygon sides=6] at (1.3,1.41) (H3) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=0.75in, regular polygon, regular polygon sides=6] at (1.74,1.41) (H4) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.685in, regular polygon, regular polygon sides=6] at (1.96,1.53) (H5) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=0.6in, regular polygon, regular polygon sides=6] at (2.9,1.59) (H6) {};

%\node [draw, color=gray!50, shape border rotate=30, minimum size=0.906in, regular polygon, regular polygon sides=6] at (10.37,2.8) (H7) {};

\node at (H0.corner 4) (a) {};
\node at (H0.corner 5) (b) {};
\node at (H1.corner 3) (c) {};
\node at (H1.corner 4) (d) {};

\node at (intersection of a--b and c--d) [transform shape,draw,fill,circle,inner sep=1.4pt,label=270:{$l_{r+1}$}] (l1) {};

\node at (H0.corner 1) (az) {};
\node at (H0.corner 2) (bz) {};
\node at (H1.corner 2) (cz) {};
\node at (H1.corner 3) (dz) {};

\node at (intersection of az--bz and cz--dz) [transform shape,draw,fill,circle,inner sep=1.4pt] (h1) {};


\node at (.47,2.14) [draw,fill,circle,inner sep=1.4pt] (h2) {};

\node at (2.02,0.62) [draw,fill,circle,inner sep=1.4pt] (l2) {};

\node at (1.82,2.32) [draw,fill,circle,inner sep=1.4pt] (h3) {};

\node at (2.57,1.02) [draw,fill,circle,inner sep=1.4pt] (l3) {};

\node at (2.47,2.1) [transform shape,draw,fill,circle,inner sep=1.4pt,label=90:{$u_{s-1}$}] (h4) {};

\node at (3.45,2.03) [transform shape,draw,fill=red,circle,inner sep=1.4pt,label=0:{$l_s$}] (l4) {};


%\node at (H1.corner 1) (a) {};
%\node at (H1.corner 2) (b) {};
%\node at (H2.corner 2) (c) {};
%\node at (H2.corner 3) (d) {};

%\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=180:{$u_{r'}$}] (h1h2) {};

%\node at (H2.corner 3) (a) {};
%\node at (H2.corner 4) (b) {};
%\node at (H3.corner 2) (c) {};
%\node at (H3.corner 3) (d) {};

%\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (l2l3) {};


%\node at (H4.corner 6) (a) {};
%\node at (H4.corner 1) (b) {};
%\node at (H5.corner 1) (c) {};
%\node at (H5.corner 2) (d) {};

%\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=45:{$u_r$}] (h5h6) {};

%\node at (6.78,1.9) [draw,fill,circle,inner sep=1.4pt,label=45:{$l_s$}] (l6) {};

%\node at (H4.corner 5) (a) {};
%\node at (H4.corner 6) (b) {};
%\node at (H5.corner 3) (c) {};
%\node at (H5.corner 4) (d) {};

%\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (l4l5) {};

%\node (tmp) at ($(h0)+(90:10)$) [transform shape] {};
%\node (tmp2) at ($(l4)+(150:10)$) [transform shape] {};

%\coordinate (z) at (intersection of h0--tmp and l4--tmp2);
\coordinate (z) at (3.45, -1.39);

%\node (tmp) at ($(h3h4)+(150:4)$) {};
%\node (tmp2) at ($(h1h2)+(90:4)$) {};

%\coordinate (z2) at (intersection of h3h4--tmp and h1h2--tmp2);

\draw [transform shape, dashed, red] (h0) -- (z);
\draw [transform shape, dashed, red] (l4) -- (z);

%\node (tmp) at ($(h5h6)+(150:4)$) {};
%\node (tmp2) at ($(h1h2)+(90:3)$) {};

%\coordinate (z3) at (intersection of h5h6--tmp and h1h2--tmp2);

%\draw [dashed, red] (h5h6) -- (z3) -- (h1h2);

%\draw [thick,red] (h1h2) -- (h3h4) -- (h5h6);

%\draw (h1h2) -- (l1) -- (l2l3) -- (h1h2);
%\draw (h3h4) -- (l2l3) -- (l4l5) -- (h3h4);
%\draw (h5h6) -- (l4l5) -- (l6);
%\draw [thick, blue] (l6) -- (h5h6);
%\draw (h3) -- (l4) -- (h1);

\draw [blue,thick] (l1) -- (h0);
\draw (h0) -- (h1) -- (l1) -- (h2) -- (h1);
\draw (l1) -- (l2) -- (h2) -- (h3) -- (l2) -- (l3) -- (h3) -- (h4) -- (l3) -- (l4) -- (h4);

%\coordinate (z4) at (0,-0.5);

%\draw (t) -- (s) -- (z4);
%pic [draw=green!50!black, fill=green!20, angle radius=9mm,
%             "$\alpha$"] {angle = t--s--z4};

%\coordinate (tmp) at ($(h5h6)+(-30:8)$);
%\coordinate (tmp2) at ($(l6)+(-90:6)$);

%\coordinate (z4) at (intersection of h5h6--tmp and l6--tmp2);

%\draw [dashed, blue] (h5h6) -- (z4) -- (l6);

%\coordinate (tmp) at ($(l6)+(-30:3)$);
%\node at ($(tmp)+(90:2.25)$) [draw,fill,circle,inner sep=1.4pt,label=180:{$l_{s'}$}] (tmp2) {};

%\draw [dashed, red] (l6) -- (tmp) -- (tmp2);
}


\newcommand{\caseB}{
\begin{tikzpicture}
\begin{scope}
\tikzbox
\end{scope}
%\begin{scope}[shift={(6,-0.8)},yscale=-1,xscale=1,rotate=-60]
\begin{scope}[shift={(6,1.82)},yscale=1,xscale=1,rotate=-60]
\tikzbox
\end{scope}
\end{tikzpicture}
}


\newcommand{\othercase}{
\begin{tikzpicture}[scale=1, transform shape]
\clip (-0.42,-0.5) rectangle (4.05,2.9);
%\node at (0,0)  (s) [draw,fill,circle,inner sep=2pt,label=180:{$s$}] {};
\coordinate (t) at (4,2.5);
\coordinate (s) at (-.5,0);
%\node [draw, color=gray, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (1.1,0) (H1) {};


%\draw [shift=(H1.side 2)] plot[mark=*,mark size=1.9pt] coordinates{(0,0)} 
%node [left] (s) {{$s$}};

%\node [draw, color=gray, dashed, shape border rotate=30, minimum size=1.3in, regular polygon, regular polygon sides=6] at (1.8,.5) (H2) {};

%\node at (H1.corner 1) (a) {};
%\node at (H1.corner 2) (b) {};
%\node at (H2.corner 2) (c) {};
%\node at (H2.corner 3) (d) {};

%\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=175:{$u_1$}] (h1) {};

\node [transform shape,draw, color=red!25, shape border rotate=30, minimum size=0.7in, regular polygon, regular polygon sides=6] at (0.51,1.2) (H0) {};

%\node at (H0.side 3) [draw, circle, fill, inner sep=1.4pt,label=180:$s$] {};

\node at (0.16,0.51) [transform shape,inner sep=1.4pt, draw,circle,fill=red,label=180:{$u_r$}] (h0) {};

\draw [gray, dotted] (s) -- (t);


\node [transform shape,draw, color=blue!25, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (.87,1.35) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=0.95in, regular polygon, regular polygon sides=6] at (1.2,1.35) (H2) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.95in, regular polygon, regular polygon sides=6] at (1.3,1.41) (H3) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=0.75in, regular polygon, regular polygon sides=6] at (1.74,1.41) (H4) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.685in, regular polygon, regular polygon sides=6] at (1.96,1.53) (H5) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=0.6in, regular polygon, regular polygon sides=6] at (2.9,1.59) (H6) {};

%\node [draw, color=gray!50, shape border rotate=30, minimum size=0.906in, regular polygon, regular polygon sides=6] at (10.37,2.8) (H7) {};

\node at (H0.corner 4) (a) {};
\node at (H0.corner 5) (b) {};
\node at (H1.corner 3) (c) {};
\node at (H1.corner 4) (d) {};

\node at (intersection of a--b and c--d) [transform shape,draw,fill,circle,inner sep=1.4pt,label=270:{$l_{r+1}$}] (l1) {};

\node at (H0.corner 1) (az) {};
\node at (H0.corner 2) (bz) {};
\node at (H1.corner 2) (cz) {};
\node at (H1.corner 3) (dz) {};

\node at (intersection of az--bz and cz--dz) [transform shape,draw,fill,circle,inner sep=1.4pt] (h1) {};


\node at (.47,2.14) [draw,fill,circle,inner sep=1.4pt] (h2) {};

\node at (H4.corner 4) [draw,fill,circle,inner sep=1.4pt,label=-45:{$l_{t}$}] (l2) {};

\node at (1.82,2.32) [draw,fill,circle,inner sep=1.4pt,label=90:{$u_{t}$}] (h3) {};

\node at (2.57,1.02) [draw,fill,circle,inner sep=1.4pt] (l3) {};

\node at (2.47,2.1) [transform shape,draw,fill,circle,inner sep=1.4pt,label=90:{$u_{s-1}$}] (h4) {};

\node at (3.45,2.03) [transform shape,draw,fill=red,circle,inner sep=1.4pt,label=0:{$l_s$}] (l4) {};


\node (tmp) at ($(h0)+(-30:10)$) [transform shape] {};
\node (tmp2) at ($(l2)+(-90:10)$) [transform shape] {};

\coordinate (z) at (intersection of h0--tmp and l2--tmp2);

\draw [transform shape, dashed, red] (h0) -- (z);
\draw [transform shape, dashed, red] (l2) -- (z);


\node (tmp) at ($(l2)+(90:10)$) [transform shape] {};
\node (tmp2) at ($(h3)+(150:10)$) [transform shape] {};

\coordinate (z) at (intersection of l2--tmp and h3--tmp2);

\draw [transform shape, dashed, red] (l2) -- (z);
\draw [transform shape, dashed, red] (h3) -- (z);


\node (tmp) at ($(h3)+(-30:10)$) [transform shape] {};
\node (tmp2) at ($(l4)+(-90:10)$) [transform shape] {};

\coordinate (z) at (intersection of h3--tmp and l4--tmp2);

\draw [transform shape, dashed, red] (h3) -- (z);
\draw [transform shape, dashed, red] (l4) -- (z);




%\coordinate (z) at (3.45, -1.39);




%\node (tmp) at ($(h3h4)+(150:4)$) {};
%\node (tmp2) at ($(h1h2)+(90:4)$) {};

%\coordinate (z2) at (intersection of h3h4--tmp and h1h2--tmp2);


%\node (tmp) at ($(h5h6)+(150:4)$) {};
%\node (tmp2) at ($(h1h2)+(90:3)$) {};

%\coordinate (z3) at (intersection of h5h6--tmp and h1h2--tmp2);

%\draw [dashed, red] (h5h6) -- (z3) -- (h1h2);

%\draw [thick,red] (h1h2) -- (h3h4) -- (h5h6);

%\draw (h1h2) -- (l1) -- (l2l3) -- (h1h2);
%\draw (h3h4) -- (l2l3) -- (l4l5) -- (h3h4);
%\draw (h5h6) -- (l4l5) -- (l6);
%\draw [thick, blue] (l6) -- (h5h6);
%\draw (h3) -- (l4) -- (h1);

\draw [blue,thick] (l1) -- (h0);
\draw (h0) -- (h1) -- (l1) -- (h2) -- (h1);
\draw (l1) -- (l2) -- (h2) -- (h3) -- (l2) -- (l3) -- (h3) -- (h4) -- (l3) -- (l4) -- (h4);
\end{tikzpicture}
}



\newcommand{\notation}{
\begin{tikzpicture}[scale=1, transform shape]
\clip (0.6,-1.55) rectangle (6.5,3);

\coordinate (t) at (10,3.333);
\coordinate (s) at (0,0);
\draw [gray, dotted] (s) -- (t);

\node [color=gray!50, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (1.73,0.61) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6,label=135:{\color{red!25}{$H_i$}}] at (2.93,1.18) (H2) {};

\node [draw,circle,fill,color=red!25,inner sep=0.5pt,label=90:{\scriptsize\color{red!25}{$c_i$}}] at (2.93,1.18) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=1.45in, regular polygon, regular polygon sides=6,label=45:{\color{blue!25}{$H_{i+1}$}}] at (3.99,0.71) (H3) {};

\node [draw,circle,fill,color=blue!25,inner sep=0.5pt,label=90:{\scriptsize\color{blue!25}{$c_{i+1}$}}] at (3.99,0.71) {};

\node [draw, color=gray, shape border rotate=30, minimum size=1.245in, regular polygon, regular polygon sides=6,label={[label distance=-0.9cm]-80:{\color{gray}{$H(x)$}}}] at (3.7,0.8) (H25) {};

\node [color=red!25, shape border rotate=30, minimum size=1.35in, regular polygon, regular polygon sides=6] at (4.1,0.9) (H4) {};


\node [draw,circle,fill,color=gray,inner sep=0.5pt] at (3.7,0.8) (c) {};


\coordinate (cx) at (3.7,-1.1);
\draw [dashed,gray] (c) -- (cx); 
\node at (cx) [label={[gray]-90:{{\scriptsize $x$}}}] {};

\coordinate (wx) at ($(H25.corner 3) + (0,-1.105)$);
\draw [dashed,gray] (H25.corner 3) -- (wx); 
\node at (wx) [label={[label distance=-0.089cm,gray]-90:{{\scriptsize $w(x)$}}}] {};

\coordinate (ex) at ($(H25.corner 5) + (0,-1.105)$);
\draw [dashed,gray] (H25.corner 5) -- (ex); 
\node at (ex) [label={[label distance=-0.089cm,gray]-90:{{\scriptsize $e(x)$}}}] {};

\draw [gray,<->,{Stealth-Stealth},label=90:${\tt r}(x)$] ($(cx)+(0,0.2)$) -- ($(wx)+(0,0.2)$) node [midway, above] {\scriptsize ${\tt r}(x)$};
\draw [->] (1,-1.1) -- (6,-1.1);





\node at (H1.corner 1) (a) {};
\node at (H1.corner 2) (b) {};
\node at (H2.corner 2) (c) {};
\node at (H2.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=180:{\scriptsize $u_{i-1}$}] (h1h2) {};

\node at (H2.corner 3) (a) {};
\node at (H2.corner 4) (b) {};
\node at (H3.corner 2) (c) {};
\node at (H3.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=-135:{\scriptsize $\ell(x)=l_i$}] (l2l3) {};

\node at (3.6,2.32) [draw,fill,circle,inner sep=1.4pt,label={[label distance=0.2cm]90:{\scriptsize $u(x)=u_i$}}] (h3h4) {};

%\node at (H4.corner 5) (a) {};
%\node at (H4.corner 6) (b) {};
%\node at (H5.corner 3) (c) {};
%\node at (H5.corner 4) (d) {};

%\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=0:{\scriptsize $l_{i+1}$}] (l4l5) {};

\node at (H3.side 5) [draw,yshift=-.3cm,fill,circle,inner sep=1.4pt,label=0:{\scriptsize $l_{i+1}$}] (l4l5) {};

\draw (l2l3) -- (h1h2) -- (h3h4) -- (l4l5) -- (l2l3) -- (h3h4);
\end{tikzpicture}
}




\newcommand{\dNdS}{
\begin{tikzpicture}[scale=1]
\clip (-1.8,-1.55) rectangle (6.5,1.55);
\node (h) [draw, color=gray, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6,label={[label distance=-1.5cm]0:{\color{gray}{$H(x)$}}}] at (0,0) {};

\node at (h.side 1) [xshift=-0.2cm,yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=90:{\color{blue}{\large +}}] (s1) {};
\node at (h.side 2) [draw,circle,fill,inner sep=1.4pt,label=135:{\color{blue}{\large +}}] (s2) {};
%\node at (h.side 3) [xshift=+0.2cm,yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=90:{\color{blue}{\large +}}] (s3) {};

\draw (s1) -- (h.corner 1) [->,>=stealth',blue,label=-45:{$+$}];
\draw ($(s2) + (-0.1cm,0)$) -- ($(h.corner 2) + (-0.1cm,0.052cm)$) -- ($(h.corner 1) + (0,0.1cm)$) [->,>=stealth',blue,label=-45:{$+$}];
%\draw ($(s3) + (0.052cm,0.1cm)$) -- ($(h.corner 3) + (0.1cm,0.052cm)$) -- ($(h.corner 2) + (0.1cm,-0.052cm)$) -- ($(h.corner 1) + (0,-0.1cm)$) [->,>=stealth',blue,label=-45:{$+$}];

\node at (h.side 6) [draw,circle,fill,inner sep=1.4pt,label=90:{\color{red}{\large --}}] (s1) {};
\node at (h.side 5) [yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=45:{\color{red}{\large --}}] (s2) {};
%\node at (h.side 4) [draw,circle,fill,inner sep=1.4pt,label=90:{\color{red}{\large --}}] (s3) {};

\draw (s1) -- (h.corner 1) [->,>=stealth',red];
\draw ($(s2) + (0.1cm,0)$) -- ($(h.corner 6) + (0.1cm,0.052cm)$) -- ($(h.corner 1) + (0,0.1cm)$) [->,>=stealth',red];
%\draw ($(s3) + (-0.052,0.1cm)$) -- ($(h.corner 5) + (-0.1cm,0.052cm)$) -- ($(h.corner 6) + (-0.1cm,-0.052cm)$) -- ($(h.corner 1) + (0,-0.1cm)$) [->,>=stealth',red];

\node (h) [draw, color=gray, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6,label={[label distance=-1.5cm]0:{\color{gray}{$H(x)$}}}] at (5,0) {};

%\node at (h.side 1) [xshift=-0.2cm,yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=-90:{\color{blue}{\large +}}] (s1) {};
\node at (h.side 2) [draw,circle,fill,inner sep=1.4pt,label=-135:{\color{blue}{\large +}}] (s2) {};
\node at (h.side 3) [xshift=+0.2cm,yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=-90:{\color{blue}{\large +}}] (s3) {};

\draw (s3) -- (h.corner 4) [->,>=stealth',blue,label=-45:{$+$}];
\draw ($(s2) + (-0.1cm,0)$) -- ($(h.corner 3) + (-0.1cm,-0.052cm)$) -- ($(h.corner 4) + (0,-0.1cm)$) [->,>=stealth',blue,label=-45:{$+$}];
%\draw ($(s1) + (0.052cm,-0.09cm)$) -- ($(h.corner 2) + (0.1cm,-0.052cm)$) -- ($(h.corner 3) + (0.1cm,0.052cm)$) -- ($(h.corner 4) + (0,0.1cm)$) [->,>=stealth',blue,label=-45:{$+$}];

%\node at (h.side 6) [draw,circle,fill,inner sep=1.4pt,label=-90:{\color{red}{\large --}}] (s1) {};
\node at (h.side 5) [yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=-45:{\color{red}{\large --}}] (s2) {};
\node at (h.side 4) [draw,circle,fill,inner sep=1.4pt,label=-90:{\color{red}{\large --}}] (s3) {};

\draw (s3) -- (h.corner 4) [->,>=stealth',red];
\draw ($(s2) + (0.1cm,0)$) -- ($(h.corner 5) + (0.1cm,-0.052cm)$) -- ($(h.corner 4) + (0,-0.1cm)$) [->,>=stealth',red];
%\draw ($(s1) + (-0.052,-0.1cm)$) -- ($(h.corner 6) + (-0.1cm,-0.052cm)$) -- ($(h.corner 5) + (-0.1cm,0.052cm)$) -- ($(h.corner 4) + (0,0.1cm)$) [->,>=stealth',red];
\end{tikzpicture}\hspace{1.34cm}
\begin{tikzpicture}[scale=1]
\clip (-2.35,-1.45) rectangle (6.5,1.65);
\node (h) [draw, color=gray, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6,label={[label distance=-2cm]0:{\color{gray}{$H(x)=H_i$}}}] at (0,0) {};

\node at (h.side 2) [draw,circle,fill,inner sep=1.4pt,label=180:{$u_{i-1}$}] (uj) {};
\node at (h.side 6) [draw,circle,fill,inner sep=1.4pt,label=0:{$u_i$}] (ujp) {};

\draw (uj) -- (h.corner 2) -- (h.corner 1) [->,>=stealth',blue];
\draw (ujp) -- (h.corner 1) [->,>=stealth',red];

\draw (uj) -- (ujp);

\node at (-1.45,1.1) [blue] {$p_N(u_{i-1},x)$};
\node at (1.05,1.45) [red] {$p_N(u_i,x)$};
\end{tikzpicture}
}


\newcommand{\UandL}{
\begin{tikzpicture}[scale=1, transform shape]
\clip (-1.2,-1.3) rectangle (5.7,2.75);


\node [draw, color=red!25, shape border rotate=30, minimum size=0.7in, regular polygon, regular polygon sides=6] at (0,0.33) (Hm3) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.58in, regular polygon, regular polygon sides=6] at (0.47,0.45) (Hm2) {};

\node [draw,color=red!25, shape border rotate=30, minimum size=0.78in, regular polygon, regular polygon sides=6] at (1.53,-0.05) (Hm1) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.81in, regular polygon, regular polygon sides=6] at (2,0.77) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H2) {};

\node [draw, color=gray!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at ($(2.93,1.18)+ (1*0.3, -.577*0.3)$) (H3) {};

\node at (Hm3.side 2) [yshift=-0.32cm,draw,circle,fill,inner sep=1.4pt,label=180:{$p$}] (s) {};

\node at (10,3.333) [draw,fill,circle,inner sep=1.4pt,label=180:{$t$}] (t) {};

\draw [gray, dotted] (s) -- (t);

\coordinate (o) at (-1,-.8);
\coordinate (x) at (4,-.8);
\draw [->] (o) -- (x);

\coordinate (N) at (H3.corner 1);
\draw [gray, dashed] (N) -- (N |- 52,-.8);
\node at (N |- 52,-.8) [label={[label distance=-0.05cm]-90:{\color{gray}{$x$}}}] {};
\draw [gray, dashed] (s) -- (s |- 52,-.8);
\node at (s |- 52,-.8) [label={[label distance=-0.2cm]-90:{\color{gray}{${\tt x}(p)$}}}] {};


%\draw (ul) -- (l);




\node at (Hm3.corner 6) (a) {};
\node at (Hm3.corner 1) (b) {};
\node at (Hm2.corner 1) (c) {};
\node at (Hm2.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (h1) {};

\node at (Hm2.corner 4) (a) {};
\node at (Hm2.corner 5) (b) {};
\node at (Hm1.corner 2) (c) {};
\node at (Hm1.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (l1) {};

\node at (1.11,0.7) [draw,fill,circle,inner sep=1.4pt] (h2) {};

\node at (H1.corner 1) (a) {};
\node at (H1.corner 2) (b) {};
\node at (H2.corner 2) (c) {};
\node at (H2.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (h4) {};

\node at (H2.corner 3) (a) {};
\node at (H2.corner 4) (b) {};
\node at (H1.corner 4) (c) {};
\node at (H1.corner 5) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=0:{$\ell(x)=l_i$}] (l3) {};

\node at ($(3.6,2.32) + (1*0.4, -.577*0.4)$) [draw, fill,circle,inner sep=1.4pt,label=0:{$u(x)=u_i$}] (h5) {};




\draw (h1) -- (l1) -- (h2) -- (l3) -- (h4);
\draw (l3) -- (h5);
\draw [red,dashed] (s) -- (h1) -- (h2) -- (h4) -- (h5);
\draw [blue,dashed] (s) -- (l1) -- (l3);

\node at (H2.corner 2) [red,xshift=-1.25cm,yshift=-0.37cm] {$d_{T_{1i}}(p,u_i)$};
\node at (Hm1.corner 3) [blue,xshift=-.4cm,yshift=0cm] {$d_{T_{1i}}(p,l_i)$};


\draw (h5) -- (H3.corner 1) [->,>=stealth',red];
\node at (H3.side 6) [red,xshift=0.5cm,yshift=0.37cm] {$p_N(x) (-)$};

\draw (l3) -- (H3.corner 4) [->,>=stealth',blue];
\node at (H3.side 3) [blue,xshift=-0.5cm,yshift=-0.3cm] {$p_S(x) (+)$};


\end{tikzpicture}\hspace{-0.2cm}
\begin{tikzpicture}[scale=1, transform shape]
\clip (-1.4,-1.3) rectangle (5.7,2.75);


\node [draw, color=red!25, shape border rotate=30, minimum size=0.7in, regular polygon, regular polygon sides=6] at (0,0.33) (Hm3) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.58in, regular polygon, regular polygon sides=6] at (0.47,0.45) (Hm2) {};

\node [draw,color=red!25, shape border rotate=30, minimum size=0.78in, regular polygon, regular polygon sides=6] at (1.53,-0.05) (Hm1) {};

\node [draw, color=blue!25, shape border rotate=30, minimum size=0.81in, regular polygon, regular polygon sides=6] at (2,0.77) (H1) {};

\node [draw, color=red!25, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H2) {};

\node [draw, color=gray!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at ($(2.93,1.18)+ (1*0.3, -.577*0.3)$) (H3) {};

\node at (Hm3.side 2) [yshift=-0.32cm,draw,circle,fill,inner sep=1.4pt,label=180:{$p$}] (s) {};

\node at (10,3.333) [draw,fill,circle,inner sep=1.4pt,label=180:{$t$}] (t) {};

\draw [gray, dotted] (s) -- (t);

\coordinate (o) at (-1,-.8);
\coordinate (x) at (4,-.8);
\draw [->] (o) -- (x);

\coordinate (N) at (H3.corner 1);
\draw [gray, dashed] (N) -- (N |- 52,-.8);
\node at (N |- 52,-.8) [label={[label distance=-0.05cm]-90:{\color{gray}{$x$}}}] {};
\draw [gray, dashed] (s) -- (s |- 52,-.8);
\node at ($(s |- 52,-.8) + (-0.25,0)$) [label={[label distance=-0.2cm]-90:{\color{gray}{${\tt x}(p)$}}}] {};


%\draw (ul) -- (l);




\node at (Hm3.corner 6) (a) {};
\node at (Hm3.corner 1) (b) {};
\node at (Hm2.corner 1) (c) {};
\node at (Hm2.corner 2) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (h1) {};

\node at (Hm2.corner 4) (a) {};
\node at (Hm2.corner 5) (b) {};
\node at (Hm1.corner 2) (c) {};
\node at (Hm1.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (l1) {};

\node at (1.11,0.7) [draw,fill,circle,inner sep=1.4pt] (h2) {};

\node at (H1.corner 1) (a) {};
\node at (H1.corner 2) (b) {};
\node at (H2.corner 2) (c) {};
\node at (H2.corner 3) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt] (h4) {};

\node at (H2.corner 3) (a) {};
\node at (H2.corner 4) (b) {};
\node at (H1.corner 4) (c) {};
\node at (H1.corner 5) (d) {};

\node at (intersection of a--b and c--d) [draw,fill,circle,inner sep=1.4pt,label=0:{$\ell(x)=l_i$}] (l3) {};

\node at ($(3.6,2.32) + (1*0.4, -.577*0.4)$) [draw, fill,circle,inner sep=1.4pt,label=0:{$u(x)=u_i$}] (h5) {};




\draw (h1) -- (l1) -- (h2) -- (l3) -- (h4);
\draw (l3) -- (h5);
\draw (s) -- (h1) -- (h2) -- (h4) -- (h5);
\draw (s) -- (l1) -- (l3);

\draw [red,dashed] (s) -- (Hm3.corner 2) -- (Hm3.corner 1) -- (h1) -- (Hm2.corner 1) --(Hm2.corner 6) -- (h2) -- (H1.corner 2) -- (h4) -- (H2.corner 2) -- (H2.corner 1) -- (h5);  

\draw [red] (h5) --  ($(h5) + (0, 0.1cm)$);
\draw ($(h5) + (0, 0.1cm)$) -- ($(H3.corner 1) + (0, 0.1cm)$) [->,>=stealth',red];
%\node at (H3.side 6) [red,xshift=0.64cm,yshift=0.4cm] {$p_N(x) (-)$};

\draw [blue,dashed] (s) -- (Hm3.corner 3) -- (Hm3.corner 4) -- (l1) -- (Hm1.corner 3) --(Hm1.corner 4) -- (Hm1.corner 5) -- (l3);  

\draw (l3) -- (H3.corner 4) [->,>=stealth',blue];
%\node at (H3.side 3) [blue,xshift=-0.5cm,yshift=-0.37cm] {$p_S(x) (+)$};


\node at (H2.corner 2) [red,xshift=-1.25cm,yshift=-0.37cm] {$\bar{U}(x)-p_N(x)$};
\node at (Hm1.corner 3) [blue,xshift=-.3cm,yshift=-0.5cm] {$\bar{L}(x)-p_S(x)$};

\end{tikzpicture}
}





\newcommand{\transitiononezero}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 2) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 1) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitiononefive}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 2) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 6) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitiontwoone}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 3) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 2) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitiontwozero}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 3) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 1) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitiontwofive}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 3) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 6) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitiontwofour}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 3) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 5) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitionthreeone}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 4) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 2) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitionthreezero}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 4) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 1) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitionthreefive}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 4) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 6) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitionthreefour}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 4) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 5) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitionfourzero}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 5) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 1) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}

\newcommand{\transitionfourfive}{
\begin{tikzpicture}[scale=1]
\node (h) [draw, color=gray, shape border rotate=30, minimum size=0.22in, regular polygon, regular polygon sides=6] at (0,0) {};
\node at (h.side 5) [draw,circle,fill,inner sep=0.75pt] (s1) {};
\node at (h.side 6) [draw,circle,fill,inner sep=0.75pt] (s2) {};
\draw (s1)--(s2);
\end{tikzpicture}
}


\newcommand{\growth}{
\begin{tikzpicture}[scale=1, transform shape]
\clip (1.3,-1) rectangle (6,2.8);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H1) {};

\node [draw,circle,fill,color=red!50,inner sep=0.5pt] at (2.93,1.18) (c1) {};

\node [draw, color=blue!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (3.67,0.75) (H2) {};

\node [draw,circle,fill,color=blue!50,inner sep=0.5pt] at (3.67,0.75) (c2) {};


\node at (H2.side 6) [xshift=-0.3cm,yshift=0.18cm,draw,circle,fill,inner sep=1.4pt,label=0:{$u$}] (u) {};

\node at (H2.side 3) [xshift=-0.4cm,yshift=0.24cm,draw,circle,fill,inner sep=1.4pt,label=-180:{$l$}] (l) {};

\draw (u) -- (H2.corner 1) [->,>=stealth',blue];
\draw ($(u) + (-0.1cm,-0.052cm)$) -- ($(H1.corner 1) + (0,-0.1cm)$) [->,>=stealth',red];


\coordinate (c1r) at ($(c1)+(0:4)$);
\coordinate (c2u) at ($(c2)+(90:4)$);

\coordinate (z) at (intersection of c1--c1r and c2--c2u);

\draw [gray,<->,{Stealth-Stealth}] (c1) -- (z)  node [midway, above] {\scriptsize $\Delta x=1$};

\draw [densely dotted, gray] (c2) -- (z);

\coordinate (a) at (H1.corner 1);
\coordinate (b) at (H2.corner 1);

\draw [very thick,gray,<->,{Stealth-Stealth}] (a) -- (b)  node [midway, below left=-2pt] {\scriptsize $\Delta p_N(x)=\frac{2}{\sqrt{3}}$};

\coordinate (ar) at ($(a)+(0:4)$);
\coordinate (bu) at ($(b)+(90:4)$);

\coordinate (z) at (intersection of a--ar and b--bu);

\draw [gray,<->,{Stealth-Stealth}] (b) -- (z)  node [midway, right=-2pt] {\scriptsize $\Delta y(N(x)) = -\frac{1}{\sqrt{3}}$};


\coordinate (a) at (H1.side 2);
\coordinate (b) at (H2.side 2);

\coordinate (ar) at ($(a)+(0:4)$);
\coordinate (bu) at ($(b)+(90:4)$);

\coordinate (z) at (intersection of a--ar and b--bu);

\draw [gray,<->,{Stealth-Stealth}] (a) -- (z)  node [midway, below] {\scriptsize $\Delta w(x) = 1$};

\coordinate (a) at (H1.side 5);
\coordinate (b) at (H2.side 5);

\coordinate (ar) at ($(a)+(-90:4)$);
\coordinate (bu) at ($(b)+(180:4)$);

\coordinate (z) at (intersection of a--ar and b--bu);

\draw [gray,<->,{Stealth-Stealth}] (z) -- (b)  node [midway, below] {\scriptsize $\Delta e(x) = 1$};



\draw (l) -- (H2.corner 4) [->,>=stealth',blue];
\draw ($(l) + (0,-0.1cm)$) -- ($(H1.corner 4) + (0,-0.1cm)$) [->,>=stealth',red];

\coordinate (a) at (H1.corner 4);
\coordinate (b) at (H2.corner 4);

\draw [gray,<->,{Stealth-Stealth}] ($(H1.corner 4) + (0,-0.1cm)$) -- ($(H2.corner 4) + (0,-0.1cm)$)  node [midway, left=3pt] {\scriptsize $\Delta p_S(x)=\frac{2}{\sqrt{3}}$};

\coordinate (ar) at ($(a)+(0:4)$);
\coordinate (bu) at ($(b)+(90:4)$);

\coordinate (z) at (intersection of a--ar and b--bu);

\draw [gray,<->,{Stealth-Stealth}] ($(H2.corner 4) + (0,0.1cm)$) -- (z) node [midway, right=-2pt] {\scriptsize $\Delta y(S(x))=-\frac{3}{\sqrt{3}}$};
\end{tikzpicture}\hspace{-0.8cm}
\begin{tikzpicture}[scale=1, transform shape]
\clip (0.5,-1.55) rectangle (6.5,3.1);

\node [draw, color=red!50, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (2.7,1.3) (H1) {};

\node [draw,circle,fill,color=red!50,inner sep=0.5pt] at (2.7,1.3) (c1) {};

\node [draw, color=blue!50, shape border rotate=30, minimum size=1.54in, regular polygon, regular polygon sides=6] at (3.3,0.965) (H2) {};

\node [draw,circle,fill,color=blue!50,inner sep=0.5pt] at (3.3,0.965) (c2) {};


\node at (H2.side 1) [xshift=-0.3cm,yshift=-0.18cm,draw,circle,fill,inner sep=1.4pt,label=180:{$u$}] (u) {};

\node at (H2.side 2) [draw,circle,fill,inner sep=1.4pt,label=-135:{$l$}] (l) {};

\draw (u) -- (H2.corner 1) [->,>=stealth',blue];
\draw ($(u) + (0.1cm,-0.052cm)$) -- ($(H1.corner 1) + (0,-0.1cm)$) [->,>=stealth',red];


\coordinate (c1r) at ($(c1)+(0:4)$);
\coordinate (c2u) at ($(c2)+(90:4)$);

\coordinate (z) at (intersection of c1--c1r and c2--c2u);

\draw [gray,<->,{Stealth-Stealth}] (c1) -- (z)  node [midway, above] {\scriptsize $\Delta x=1$};

\draw [densely dotted, gray] (c2) -- (z);

\coordinate (a) at (H1.corner 1);
\coordinate (b) at (H2.corner 1);

\draw [very thick,gray,<->,{Stealth-Stealth}] ($(a) + (0,-0.1cm)$) -- ($(b) + (0,-0.1cm)$)  node [midway, right=3pt] {\scriptsize $\Delta p_N(x)=\frac{2}{\sqrt{3}}$};

\coordinate (ar) at ($(a)+(90:4)$);
\coordinate (bu) at ($(b)+(180:4)$);

\coordinate (z) at (intersection of a--ar and b--bu);

\draw [gray,<->,{Stealth-Stealth}] (a) -- (z)  node [midway, left=-2pt] {\scriptsize $\Delta y(N(x)) = \frac{1}{\sqrt{3}}$};


%\coordinate (a) at (H1.side 2);
%\coordinate (b) at (H2.side 2);

%\coordinate (ar) at ($(a)+(0:4)$);
%\coordinate (bu) at ($(b)+(90:4)$);

%\coordinate (z) at (intersection of a--ar and b--bu);

\node at ($(H1.side 2) + (0.1cm,0)$) [gray] {\scriptsize $\Delta w(x) = 0$};
%\draw [gray,<->,{Stealth-Stealth}] (a) -- (z)  node [midway, above] {\scriptsize $\Delta w(x) = 0$};

\coordinate (a) at (H1.side 5);
\coordinate (b) at (H2.side 5);

\coordinate (ar) at ($(a)+(-90:4)$);
\coordinate (bu) at ($(b)+(180:4)$);

\coordinate (z) at (intersection of a--ar and b--bu);

\draw [gray,<->,{Stealth-Stealth}] (z) -- (b)  node [midway, below] {\scriptsize $\Delta e(x) = 2$};

\draw (l) -- (H2.corner 3) -- (H2.corner 4) [->,>=stealth',blue];
\draw ($(l) + (-0.052cm,0)$) -- ($(H1.corner 3) + (-0.052cm,-0.1cm)$) -- ($(H1.corner 4) + (0,-0.1cm)$) [->,>=stealth',red];

\coordinate (a) at (H1.corner 4);
\coordinate (b) at (H2.corner 4);

\coordinate (ad) at ($(a)+(-90:4)$);
\coordinate (bl) at ($(b)+(150:4)$);

\coordinate (z) at (intersection of a--ad and b--bl);

\draw [gray,<->,{Stealth-Stealth}] ($(H1.corner 4) + (0,-0.1cm)$) -- ($(z) + (0,0.1cm)$) -- ($(H2.corner 4) + (0,0.1cm)$)  node [yshift=0.3cm, midway, left=5pt] {\scriptsize $\Delta p_S(x)=\frac{4}{\sqrt{3}}$};

\coordinate (ar) at ($(a)+(0:4)$);
\coordinate (bu) at ($(b)+(90:4)$);

\coordinate (z) at (intersection of a--ar and b--bu);

\draw [gray,<->,{Stealth-Stealth}] ($(H2.corner 4) + (0,0.1cm)$) -- (z) node [midway, right=-3pt] {\scriptsize $\Delta y(S(x))=-\frac{3}{\sqrt{3}}$};
\end{tikzpicture}\hspace{-1cm}
\begin{tikzpicture}[scale=1, transform shape]
\clip (1.1,-2.25) rectangle (5.9,2.5);

\node [draw, color=blue!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (3.94,-0.57) (H2) {};

\node [draw,circle,fill,color=blue!50,inner sep=0.5pt] at (3.94,-0.57) (c1) {};

\node [draw, color=red!50, shape border rotate=30, minimum size=1.66in, regular polygon, regular polygon sides=6] at (3.435,0.305) (H1) {};

\node [draw,circle,fill,color=red!50,inner sep=0.5pt] at (3.435,0.305) (c2) {};


\node at (H1.side 5) [yshift=-0.4cm,draw,circle,fill,inner sep=1.4pt,label=0:{$u$}] (u) {};

\node at (H1.side 3) [xshift=0.5cm,yshift=-0.29cm,draw,circle,fill,inner sep=1.4pt,label=180:{$l$}] (l) {};

\draw ($(u) + (0.052cm,0cm)$) -- ($(H1.corner 6) + (0.052cm,0.1cm)$) -- ($(H1.corner 1) + (0,0.1cm)$) [->,>=stealth',red];
\draw (u) -- (H2.corner 6) -- (H2.corner 1) [->,>=stealth',blue];


\coordinate (c1r) at ($(c1)+(0:4)$);
\coordinate (c2u) at ($(c2)+(90:4)$);

\coordinate (z) at (intersection of c1--c1r and c2--c2u);

\draw [gray,<->,{Stealth-Stealth}] (c1) -- (z)  node [midway, above] {\scriptsize $\Delta x=1$};

\draw [densely dotted, gray] (c2) -- (z);

\coordinate (a) at (H1.corner 1);
\coordinate (b) at (H2.corner 1);


\coordinate (ar) at ($(a)+(-30:4)$);
\coordinate (bu) at ($(b)+(90:4)$);

\coordinate (z) at (intersection of a--ar and b--bu);

\draw [very thick,gray,<->,{Stealth-Stealth}] (a) -- (z) -- (b)  node [near end, right=0pt] {\scriptsize $\Delta p_N(x)=\frac{6}{\sqrt{3}}$};

\coordinate (ad) at ($(a)+(-90:4)$);
\coordinate (bl) at ($(b)+(180:4)$);

\coordinate (z) at (intersection of a--ad and b--bl);

\draw [gray,<->,{Stealth-Stealth}] (a) -- (z)  node [midway, left=-1pt] {\scriptsize $\Delta y(N(x)) = -\frac{1}{\sqrt{3}}$};


\node at (H2.side 5) [gray] {\scriptsize $\Delta e(x) = 0$};

\coordinate (a) at ($(H1.side 2) + (0,-0.2cm)$);
\coordinate (b) at (H2.side 2);

\coordinate (ar) at ($(a)+(0:4)$);
\coordinate (bu) at ($(b)+(90:4)$);

\coordinate (z) at (intersection of a--ar and b--bu);

\draw [gray,<->,{Stealth-Stealth}] (z) -- (a)  node [midway, above] {\scriptsize $\Delta w(x) = 2$};

\draw (l) -- (H2.corner 4) [->,>=stealth',blue];

\draw ($(l) + (0,-0.1cm)$) -- ($(H1.corner 4) + (0,-0.1cm)$) [->,>=stealth',red];

\coordinate (a) at (H1.corner 4);
\coordinate (b) at (H2.corner 4);

\draw [gray,<->,{Stealth-Stealth}] ($(H1.corner 4) + (0,-0.1cm)$) -- ($(H2.corner 4) + (0,-0.1cm)$)  node [midway, above right=-3pt] {\scriptsize $\Delta p_S(x)=\frac{2}{\sqrt{3}}$};

\coordinate (ad) at ($(a)+(-90:4)$);
\coordinate (bl) at ($(b)+(180:4)$);

\coordinate (z) at (intersection of a--ad and b--bl);

\draw [gray,<->,{Stealth-Stealth}] ($(H1.corner 4) + (0,-0.1cm)$) -- ($(z) + (0,-0.1cm)$) node [midway, left=0pt] {\scriptsize $\Delta y(S(x))=-\frac{3}{\sqrt{3}}$};


\end{tikzpicture}
%\begin{tikzpicture}[scale=1, transform shape]
%\clip (1,-2) rectangle (5.7,2.8);

%\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H1) {};

%\node [draw,circle,fill,color=red!50,inner sep=0.5pt] at (2.93,1.18) (c1) {};

%\node [draw, color=blue!50, shape border rotate=30, minimum size=1.66in, regular polygon, regular polygon sides=6] at (3.435,0.305) (H2) {};

%\node [draw,circle,fill,color=blue!50,inner sep=0.5pt] at (3.435,0.305) (c2) {};


%\node at (H2.side 6) [xshift=-0.5cm,yshift=0.29cm,draw,circle,fill,inner sep=1.4pt,label=0:{$u$}] (u) {};

%\node at (H2.side 2) [yshift=0.4cm,draw,circle,fill,inner sep=1.4pt,label=-135:{$l$}] (l) {};

%\draw (u) -- (H2.corner 1) [->,>=stealth',blue];
%\draw ($(u) + (-0.1cm,-0.052cm)$) -- ($(H1.corner 1) + (0,-0.1cm)$) [->,>=stealth',red];


%\coordinate (c1r) at ($(c1)+(0:4)$);
%\coordinate (c2u) at ($(c2)+(90:4)$);

%\coordinate (z) at (intersection of c1--c1r and c2--c2u);

%\draw [gray,<->,{Stealth-Stealth}] (c1) -- (z)  node [midway, above] {\scriptsize $\Delta(x)=1$};

%\draw [densely dotted, gray] (c2) -- (z);

%\coordinate (a) at (H1.corner 1);
%\coordinate (b) at (H2.corner 1);

%\draw [very thick,gray,<->,{Stealth-Stealth}] (a) -- (b)  node [midway, below left=-2pt] {\scriptsize $\Delta p_N(x)=\frac{2}{\sqrt{3}}$};

%\coordinate (ar) at ($(a)+(0:4)$);
%\coordinate (bu) at ($(b)+(90:4)$);

%\coordinate (z) at (intersection of a--ar and b--bu);

%\draw [gray,<->,{Stealth-Stealth}] (b) -- (z)  node [midway, right=-2pt] {\scriptsize $\Delta y(N(x)) = -\frac{1}{\sqrt{3}}$};


%\node at ($(H1.side 2) + (0.2cm,0)$) [gray] {\scriptsize $\Delta w(x) = 0$};

%\coordinate (a) at (H1.side 5);
%\coordinate (b) at (H2.side 5);

%\coordinate (ar) at ($(a)+(0:4)$);
%\coordinate (bu) at ($(b)+(90:4)$);

%\coordinate (z) at (intersection of a--ar and b--bu);

%\draw [gray,<->,{Stealth-Stealth}] (z) -- (a)  node [midway, below] {\scriptsize $\Delta e(x) = 2$};

%\draw (l) -- (H2.corner 3) -- (H2.corner 4) [->,>=stealth',blue];
%\draw ($(l) + (-0.052cm,0)$) -- ($(H1.corner 3) + (-0.052cm,-0.1cm)$) -- ($(H1.corner 4) + (0,-0.1cm)$) [->,>=stealth',red];

%\coordinate (a) at (H1.corner 4);
%\coordinate (b) at (H2.corner 4);

%\coordinate (ad) at ($(a)+(-90:4)$);
%\coordinate (bl) at ($(b)+(150:4)$);

%\coordinate (z) at (intersection of a--ad and b--bl);

%\draw [gray,<->,{Stealth-Stealth}] ($(H1.corner 4) + (0,-0.1cm)$) -- ($(z) + (0,0.1cm)$) -- ($(H2.corner 4) + (0,0.1cm)$)  node [midway, left=6pt] {\scriptsize $\Delta p_S(x)=\frac{6}{\sqrt{3}}$};

%\coordinate (ar) at ($(a)+(0:4)$);
%\coordinate (bu) at ($(b)+(90:4)$);

%\coordinate (z) at (intersection of a--ar and b--bu);

%\draw [gray,<->,{Stealth-Stealth}] ($(H2.corner 4) + (0,0.1cm)$) -- (z) node [midway, right=-2pt] {\scriptsize $\Delta y(S(x))=-\frac{5}{\sqrt{3}}$};
%\end{tikzpicture}
}





\newcommand{\badintervals}{
\begin{tikzpicture}[scale=1, transform shape]
\clip (.6,-.67) rectangle (3.3,1.4);

\node [draw, color=red!50, shape border rotate=30, minimum size=0.6in, regular polygon, regular polygon sides=6] at (1.46,0.59) (H1) {};

\coordinate (c1) at (1.46,0.59);

\node [draw, color=blue!50, shape border rotate=30, minimum size=0.4in, regular polygon, regular polygon sides=6] at (2.83,0.49) (H2) {};

\coordinate (c2) at (2.83,0.49);

\node at (H1.side 6) [xshift=-0.15cm,yshift=0.09cm,draw,circle,fill,inner sep=1.4pt,label=0:{$u(x_l)$}] (ul) {};

\node at (H1.side 2) [yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=0:{$\ell(x_l)$}] (l) {};

\draw [->] (0.85,-0.35) -- (3.25,-0.35);

\coordinate (N1) at (H1.corner 1);
\coordinate (N2) at (H2.corner 1);

\draw [gray, dashed] (N1) -- (1.46,-0.35);
\draw [gray, dashed] (N2) -- (2.83,-0.35);

\node at (1.46,-0.35) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_l$}}}] {};
\node at (2.83,-0.35) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_r$}}}] {};

\draw (ul) -- (l);

\end{tikzpicture}\hspace{0.75cm}
\begin{tikzpicture}[scale=1, transform shape]
\clip (.6,-.67) rectangle (3.3,1.4);

\node [draw, color=red!50, shape border rotate=30, minimum size=0.6in, regular polygon, regular polygon sides=6] at (1.46,0.59) (H1) {};

\coordinate (c1) at (1.46,0.59);

\node [draw, color=blue!50, shape border rotate=30, minimum size=0.4in, regular polygon, regular polygon sides=6] at (2.83,0.49) (H2) {};

\coordinate (c2) at (2.83,0.49);

\node at (H1.side 2) [yshift=0.12cm,draw,circle,fill,inner sep=1.4pt,label=0:{$u(x_l)$}] (ul) {};

\node at (H1.side 4) [xshift=-0.15cm,yshift=-0.09cm,draw,circle,fill,inner sep=1.4pt,label=0:{$\ell(x_l)$}] (l) {};

\draw [->] (0.85,-0.35) -- (3.25,-0.35);

\coordinate (N1) at (H1.corner 1);
\coordinate (N2) at (H2.corner 1);

\draw [gray, dashed] (N1) -- (1.46,-0.35);
\draw [gray, dashed] (N2) -- (2.83,-0.35);

\node at (1.46,-0.35) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_l$}}}] {};
\node at (2.83,-0.35) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_r$}}}] {};

\draw (ul) -- (l);

\end{tikzpicture}\hspace{0.75cm}
\begin{tikzpicture}[scale=1, transform shape]
\clip (1,-.67) rectangle (3.6,1.4);

\node [draw, color=red!50, shape border rotate=30, minimum size=0.6in, regular polygon, regular polygon sides=6] at (2.83,0.49) (H2) {};

\coordinate (c1) at (1.46,0.59);

\node [draw, color=blue!50, shape border rotate=30, minimum size=0.4in, regular polygon, regular polygon sides=6] at (1.46,0.59) (H1) {};

\coordinate (c2) at (2.83,0.49);

\node at (H2.side 5) [yshift=0.12cm,draw,circle,fill,inner sep=1.4pt,label=180:{$u(x_r)$}] (ul) {};

\node at (H2.side 3) [yshift=-0.09cm,xshift=0.15cm,draw,circle,fill,inner sep=1.4pt,label=180:{$\ell(x_r)$}] (l) {};

\draw [->] (0.85,-0.35) -- (3.25,-0.35);

\coordinate (N1) at (H1.corner 1);
\coordinate (N2) at (H2.corner 1);

\draw [gray, dashed] (N1) -- (1.46,-0.35);
\draw [gray, dashed] (N2) -- (2.83,-0.35);

\node at (1.46,-0.35) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_l$}}}] {};
\node at (2.83,-0.35) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_r$}}}] {};

\draw (ul) -- (l);

\end{tikzpicture}\hspace{0.75cm}
\begin{tikzpicture}[scale=1, transform shape]
\clip (1,-.67) rectangle (3.6,1.4);

\node [draw, color=red!50, shape border rotate=30, minimum size=0.6in, regular polygon, regular polygon sides=6] at (2.83,0.49) (H2) {};

\coordinate (c1) at (1.46,0.59);

\node [draw, color=blue!50, shape border rotate=30, minimum size=0.4in, regular polygon, regular polygon sides=6] at (1.46,0.59) (H1) {};

\coordinate (c2) at (2.83,0.49);

\node at (H2.side 1) [xshift=0.15cm,yshift=0.09cm,draw,circle,fill,inner sep=1.4pt,label=180:{$u(x_r)$}] (ul) {};

\node at (H2.side 5) [yshift=-0.12cm,draw,circle,fill,inner sep=1.4pt,label=180:{$\ell(x_r)$}] (l) {};

\draw [->] (0.85,-0.35) -- (3.25,-0.35);

\coordinate (N1) at (H1.corner 1);
\coordinate (N2) at (H2.corner 1);

\draw [gray, dashed] (N1) -- (1.46,-0.35);
\draw [gray, dashed] (N2) -- (2.83,-0.35);

\node at (1.46,-0.35) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_l$}}}] {};
\node at (2.83,-0.35) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_r$}}}] {};

\draw (ul) -- (l);

\end{tikzpicture}
}








\newcommand{\gentlepath}{
\begin{tikzpicture}[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H1) {};

\coordinate (c1) at (2.93,1.18);

\node at (H1.side 6) [xshift=-0.3cm,yshift=0.18cm,draw,circle,fill,inner sep=1.4pt,label={[label distance=0pt]0:$u(x)$}] (ul) {};

\node at ($(ul)+(0,-0.85)$) [inner sep=0pt,outer sep=-0.2pt] (x) {};
\draw [gray,<->,{Stealth-Stealth}] (x) -- ($(x)+(0.95,0)$) node [below left] {\scriptsize $\delta_f(x)$};

\draw [gray,dashed] (ul) -- (ul |- 1, 1.65);

\node at (H1.side 2) [yshift=-0.24cm,draw,circle,fill,inner sep=1.4pt,label={[label distance=-3pt]135:$\ell(x)$}] (l) {};

\draw [thick] (ul) -- (l);

\node at (H1.corner 3) [draw,gray,circle,fill,inner sep=0.5pt,label=-180:{$w$}] (w) {};

\draw [->] (1,0.1) -- (4.5,0.1);

\coordinate (N1) at (H1.corner 1);

\node at (N1) [label={[label distance=-0.3cm]135:{\scriptsize $N(x)$}}] {};

\draw [gray] (ul) -- (w) -- (N1);

\draw [gray, dashed] (N1) -- (2.93,0.1);

\draw pic [draw=gray, "\color{gray}{\scriptsize $\theta$}", angle eccentricity=1.25,angle radius=1.05cm] {angle = ul--w--N1};


\node at (2.93,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{$x$}}}] {};

\draw [gray,<->,{Stealth-Stealth},label=90:${\tt r}(x)$] ($(w)+(2.64,0.2)$$) -- ($(w)+(1.32,0.2)$) node [midway, above] {\scriptsize ${\tt r}(x)$};

\draw (l) -- (H1.corner 3) -- (H1.corner 4) [->,>=stealth',blue,thick];
\draw (ul) -- (H1.corner 1) [->,>=stealth',red,thick];
%\draw ($(l) + (-0.052cm,0)$) -- ($(H1.corner 3) + (-0.052cm,-0.1cm)$) -- ($(H1.corner 4) + (0,-0.1cm)$) [->,>=stealth',red];

\node at (H1.side 6) [red,xshift=0.75,yshift=0.6cm] {$p_N(x) (-)$};

\node at (H1.side 3) [blue,xshift=-0.8cm,yshift=-0.2cm] {$p_S(x) (+)$};


\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H1) {};

\coordinate (c1) at (2.93,1.18);

\node [draw, color=blue!50, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (5.67,0.99) (H2) {};

\coordinate (c2) at (5.67,0.99);

\node at (H1.side 6) [xshift=-0.3cm,yshift=0.18cm,draw,circle,fill,inner sep=1.4pt,label=45:{$u(x_l)=u_i$}] (ul) {};

\node at (H1.side 2) [yshift=-0.24cm,draw,circle,fill,inner sep=1.4pt,label={[label distance=-3pt]135:$l_i = \ell(x_l)$}] (l) {};



%\node at (H1.side 6) [xshift=-0.3cm,yshift=0.18cm,draw,circle,fill,inner sep=1.4pt,label=45:{$u(x_l)$}] (ul) {};

%\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] ($(ul)+(0,-1.3)$) -- ($(ul)+(-0.36,-1.3)$) node [above right] {\scriptsize ${\tt r}(x_l)-\delta_f(x_l)$};

\draw [gray,<->,{Stealth-Stealth}] ($(ul)+(0,-1.5)$) -- ($(ul)+(0.95,-1.5)$) node [midway, below] {\scriptsize $\delta_f(x_l)$};

%\node at (H1.side 2) [yshift=-0.24cm,draw,circle,fill,inner sep=1.4pt,label=135:{$\ell(x_l)$}] (l) {};

%\node at (H2.side 6) [xshift=+0.3cm,yshift=-0.18cm,draw,circle,fill,inner sep=1.4pt,label=45:{$u_{i+s}=u(x_r)$}] (ur) {};

\node at (H1.corner 3) (w) {};

\draw [->] (1,0.1) -- (7,0.1);

\coordinate (N1) at (H1.corner 1);
\coordinate (N2) at (H2.corner 1);

%\draw (N1) -- ++(-30:0.65) -- ++(30:0.35) -- ++(-90:.25) -- ++ (-30:1.1) -- ++ (30:0.6);


\coordinate (N12) at ($(ul)+(30:0.25)$);
\coordinate (N13) at ($(N12)+(-30:0.5)$);
\coordinate (N14) at ($(N13)+(-90:.35)$);
\coordinate (N15) at ($(N14)+(-30:0.8)$);



%\draw [decorate,decoration={brace,amplitude=10pt},xshift=-4pt,yshift=0pt]
%(0.5,0.5) -- (0.5,5.0) node [black,midway,xshift=-0.6cm] 
%{\footnotesize $P_1$};

\coordinate (x) at ($(N15)+(30:.66)$);

\coordinate (xd) at ($(x)+(30:6)$);
\coordinate (N2d) at ($(N2)+(150:4)$);

\coordinate (z) at (intersection of N2--N2d and x--xd);

\draw [densely dotted,thick] (N1) -- (ul) -- (N12) -- (N13) -- (N14) -- (N15) -- (x) -- (z) -- (N2);



\coordinate (N1d) at ($(N1)+(-90:3)$);
\coordinate (ud) at ($(ul)+(-90:3)$);
\coordinate (N12d) at ($(N12)+(-90:3)$);
\coordinate (N15d) at ($(N15)+(-90:3)$);
\coordinate (zd) at ($(z)+(-90:3)$);
\coordinate (N2d) at ($(N2)+(-90:3)$);


\coordinate (N1b) at ($(N1)+(0,-0.9)$);
\coordinate (N1r) at ($(N1b)+(0:10)$);

\coordinate (z1) at (intersection of N1--N1d and N1b--N1r);
\coordinate (z2) at (intersection of ul--ud and N1b--N1r);
\coordinate (z3) at (intersection of N12--N12d and N1b--N1r);
\coordinate (z4) at (intersection of N15--N15d and N1b--N1r);
\coordinate (z5) at (intersection of z--zd and N1b--N1r);
\coordinate (z6) at (intersection of N2--N2d and N1b--N1r);

\draw [gray!50, densely dashed] (ul) -- ($(ul)+(0,-1.5)$);
\draw [gray!50, densely dashed] (N12) -- (z3);
\draw [gray!50, densely dashed] (z) -- (z5);
\draw [gray!50, densely dashed] (z4) -- (N15);


\draw [blue, very thick] (z1) -- (z2);
\draw [blue, very thick] (z3) -- (z4);
\draw [blue, very thick] (z5) -- (z6);





\node at (N1) [label={[label distance=-0.3cm]135:{\scriptsize $N(x_l)$}}] {};
\node at (N2) [label={[label distance=-0.3cm]45:{\scriptsize $N(x_r)$}}] {};

%\draw [gray] (ul) -- (w) -- (N1);

\draw [gray, dashed] (N1) -- (2.93,0.1);
\draw [gray, dashed] (N2) -- (5.67,0.1);

%\draw pic [draw=gray, "\color{gray}{\scriptsize $\Theta$}", angle eccentricity=1.25,angle radius=1.05cm] {angle = ul--w--N1};


\node at (2.93,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_l$}}}] {};
\node at (5.67,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_r$}}}] {};

\draw [gray,<->,{Stealth-Stealth},label=90:${\tt r}(x_l)$] ($(w)$) -- ($(w)+(1.32,0)$) node [midway, above] {\scriptsize ${\tt r}(x_l)$};


%\coordinate (lr) at ($(l)+(0:6)$);
%\coordinate (urd) at ($(ur)+(-90:4)$);

%\coordinate (z) at (intersection of l--lr and ur--urd);

%\draw [gray,<->,{Stealth-Stealth}] (ur) -- (z)  node [midway, right=2pt] {\scriptsize $y(u(x_r)) - y((x_l))$};

\draw (ul) -- (l);



\node at (H2.side 6) [xshift=+0.3cm,yshift=-0.18cm,draw,circle,fill,inner sep=1.4pt,label={[label distance=0pt]30:$u_{i+s} = u(x_r)$}] (ur) {};

\draw [densely dotted,thick] (N2) -- (ur);




\coordinate (lr) at ($(l)+(0:6)$);
\coordinate (urd) at ($(ur)+(-90:4)$);

\coordinate (z) at (intersection of l--lr and ur--urd);

\draw [gray,<->,{Stealth-Stealth}] (ur) -- (z)  node [midway, right=2pt] {\scriptsize $y(u(x_r)) - y(\ell(x_l))$};

\draw (ul) -- (l);

\end{tikzpicture}
}

\newcommand{\linearworstcase}{
\begin{tikzpicture}[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H1) {};

\coordinate (c1) at (2.93,1.18);

\node [draw, color=blue!50, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (5.67,0.99) (H2) {};

\coordinate (c2) at (5.67,0.99);



\node at (H1.side 6) [xshift=-0.3cm,yshift=0.18cm,draw,circle,fill,inner sep=1.4pt,label=0:{$u(x_l)$}] (ul) {};

\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] ($(ul)+(0,-1.1)$) -- ($(ul)+(0.96,-1.1)$) node [below left] {\scriptsize $\delta_f(x_l)$};

\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] ($(ul)+(-0.96,-1.1)$) -- ($(ul)+(0,-1.1)$) node [below left] {\scriptsize $\delta_f(x_l)$};

\draw [gray, dashed] (ul) -- ($(ul)+(0,-1.1)$);


\node at (H1.side 2) [yshift=-0.24cm,draw,circle,fill,inner sep=1.4pt,label=180:{$\ell(x_l)$}] (l) {};

\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] ($(l)+(0,-0.5)$) -- ($(l)+(0.36,-0.5)$) node [very near start, below] {\scriptsize ${\tt r}(x_l) - \delta_f(x_l)$};

% \draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] ($(l)+(0.36,-0.5)$) -- ($(l)+(0.72,-0.5)$) node [very near end, above] {\scriptsize $\theta_f(x)$};

%\draw [gray, dashed] ($(l)+(0.36,-0.1)$) -- ($(l)+(0.36,-0.5)$);

\node at (H2.side 5) [yshift=+0.18cm,draw,circle,fill,inner sep=1.4pt,label=45:{$u(x_r)$}] (ur) {};


%%%%%%%%%%%%%%%%%%%%%

\coordinate (N12) at ($(ul)+(30:0.25)$);

%\coordinate (N12d) at ($(N12)+(-90:3)$);
%\draw [gray, densely dashed] (N12) -- (N12d);

\coordinate (N13) at ($(N12)+(-30:0.35)$);
\coordinate (N14) at ($(N13)+(-90:.35)$);
\coordinate (N15) at ($(N14)+(-30:0.8)$);

%\coordinate (N15d) at ($(N15)+(-90:3)$);
%\draw [gray!50, densely dashed] (N15) -- (N15d);

\coordinate (x) at ($(N15)+(30:.66)$);

\coordinate (xd) at ($(x)+(30:6)$);
\coordinate (N2d) at ($(N2)+(150:4)$);

\coordinate (z) at (intersection of N2--N2d and x--xd);

\draw [densely dotted] (N1) -- (ul) -- (N12) -- (N13) -- (N14) -- (N15) -- (x) -- (z) -- (N2);





%\draw (ul) -- ++(-30:1) -- ++(30:0.5) -- ++(-30:.5) -- ++ (30:0.37) -- ++ (ur);

\draw [->] (1,0.1) -- (7,0.1);

\coordinate (N1) at (H1.corner 1);
\coordinate (N2) at (H2.corner 1);

%\node at (N1) [label={[label distance=-0.3cm]135:{\scriptsize $N(x_l)$}}] {};
%\node at (N2) [label={[label distance=-0.3cm]45:{\scriptsize $N(x_r)$}}] {};

%\draw [gray] (ul) -- (w) -- (N1);

\draw [gray, dashed] (N1) -- (2.93,0.1);
\draw [gray, dashed] (N2) -- (5.67,0.1);

%\draw pic [draw=gray, "\color{gray}{\scriptsize $\Theta$}", angle eccentricity=1.25,angle radius=1.05cm] {angle = ul--w--N1};


\node at (2.93,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_l$}}}] {};
\node at (5.67,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_r$}}}] {};

%\draw [blue,thick,<->,{Stealth-Stealth}] ($($(l)+(0.72,-0.1)$)$) -- ($($(l)+(2.36,0)$)+(2.59,-0.1)$) node [midway, above] {};

%\draw [red,thick,<->,{Stealth-Stealth},label=90:${\tt r}(x_l)$] ($($(l)+(0.36,-0.5)$)$) -- ($($(l)+(2.36,-0.5)$)+(1.7,0)$) node [midway, above] {};


\draw [blue,thick,<->,{Stealth-Stealth}] ($($(l)+(0.72,0)$)$) -- ($($(l)+(2.36,0.5)$)+(2.59,-0.5)$) node [midway, above] {};

\draw [red,thick,<->,{Stealth-Stealth},label=90:${\tt r}(x_l)$] ($($(l)+(0.36,-0.5)$)$) -- ($($(l)+(2.36,-0.5)$)+(1.7,0)$) node [midway, above] {};


%\coordinate (lr) at ($(l)+(0:6)$);
%\coordinate (urd) at ($(ur)+(-90:4)$);

%\coordinate (z) at (intersection of l--lr and ur--urd);

%\draw [gray,<->,{Stealth-Stealth}] (ur) -- (z)  node [midway, right=2pt] {\scriptsize $y(u(x_r)) - y((x_l))$};

\draw (ul) -- (l);
\end{tikzpicture}
\begin{tikzpicture}[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H1) {};

\coordinate (c1) at (2.93,1.18);

\node [draw, color=blue!50, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (5.67,0.99) (H2) {};

\coordinate (c2) at (5.67,0.99);



\node at (H1.side 6) [xshift=-0.3cm,yshift=0.18cm,draw,circle,fill,inner sep=1.4pt,label=0:{$u(x_l)$}] (ul) {};

%\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] ($(ul)+(0,-0.5)$) -- ($(ul)+(-0.36,-0.5)$) node [very near start, below] {\scriptsize $\theta_f(x_l)$};

\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] ($(ul)+(0,-1.65)$) -- ($(ul)+(0.96,-1.65)$) node [below left] {\scriptsize $\delta_f(x_l)$};
\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] ($(ul)+(-0.96,-1.65)$) -- ($(ul)+(0,-1.65)$) node [below left] {\scriptsize $\delta_f(x_l)$};


\draw [gray, dashed] (ul) -- ($(ul)+(0,-1.65)$);



\node at (H1.side 2) [yshift=-0.24cm,draw,circle,fill,inner sep=1.4pt,label=180:{$\ell(x_l)$}] (l) {};

%\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] ($(l)+(0.36,-0.5)$) -- ($(l)+(0,-0.5)$) node [above right] {\scriptsize ${\tt r}(x_l) - \delta_f(x_l)$};

\node at (H2.corner 2) [draw,circle,fill,inner sep=1.4pt,label=0:{$u(x_r)$}] (ur) {};


%%%%%%%

\coordinate (N12) at ($(N1)+(-30:0.1)$);

%\coordinate (N12d) at ($(N12)+(-90:3)$);
%\draw [gray, densely dashed] (N12) -- (N12d);

\coordinate (N13) at ($(N12)+(-90:1)$);
%\coordinate (N14) at ($(N13)+(-30:1.85)$);
%\coordinate (N15) at ($(N14)+(-30:1.85)$);

%\coordinate (N15d) at ($(N15)+(-90:3)$);
%\draw [gray!50, densely dashed] (N15) -- (N15d);

%\coordinate (x) at ($(N13)+(-30:1.66)$);

\coordinate (xd) at ($(N13)+(-30:6)$);
\coordinate (N2d) at ($(N2)+(-150:4)$);

\coordinate (z) at (intersection of N2--N2d and N13--xd);

\draw [densely dotted] (N1) -- (N12) -- (N13) -- (z) -- (N2);

\coordinate (zd) at ($(z)+(0,-5)$);
\coordinate (N2d) at ($(N2)+(6,0)$);

\coordinate (zzz) at (intersection of zd--z and N2--N2d);

\draw [red,dashed,thick,<->,{Stealth-Stealth}] (N2) -- (zzz);

\draw [gray, dashed] (z) -- (zzz);





%\draw (ul) -- ++(-30:1) -- ++(30:0.5) -- ++(-30:.5) -- ++ (30:0.37) -- ++ (ur);

\draw [->] (1,0.1) -- (7,0.1);

\coordinate (N1) at (H1.corner 1);
\coordinate (N2) at (H2.corner 1);

%\node at (N1) [label={[label distance=-0.3cm]135:{\scriptsize $N(x_l)$}}] {};
%\node at (N2) [label={[label distance=-0.3cm]45:{\scriptsize $N(x_r)$}}] {};

%\draw [gray] (ul) -- (w) -- (N1);

\draw [gray, dashed] (N1) -- (2.93,0.1);

\draw [gray, dashed] (N2) -- (5.67,0.1);

%\draw pic [draw=gray, "\color{gray}{\scriptsize $\Theta$}", angle eccentricity=1.25,angle radius=1.05cm] {angle = ul--w--N1};


\node at (2.93,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_l$}}}] {};
\node at (5.67,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_r$}}}] {};

\draw [blue,thick,<->,{Stealth-Stealth}] ($($(l)+(0.72,-0.5)$)$) -- ($($(l)+(1.47,-0.5)$)+(1.7,0)$) node [midway, above] {};


%\coordinate (lr) at ($(l)+(0:6)$);
%\coordinate (urd) at ($(ur)+(-90:4)$);

%\coordinate (z) at (intersection of l--lr and ur--urd);

%\draw [gray,<->,{Stealth-Stealth}] (ur) -- (z)  node [midway, right=2pt] {\scriptsize $y(u(x_r)) - y((x_l))$};

\draw (ul) -- (l);
\end{tikzpicture} 
\vspace{-0.5cm}\center{(a) \hspace{2.6in} (b)}
}





\newcommand{\induction}{
\begin{tikzpicture}[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);

\node at (0,0.5) [draw,circle,fill,inner sep=1.4pt,label=180:{$p$}] (p) {};
\coordinate (pu) at ($(p)+(0,1)$);

\draw [gray, dashed] (p) -- (pu);

\coordinate (c1) at (2.93,1.18);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (c1) (H1) {};

\node at (H1.side 6) [xshift=-0.3cm,yshift=0.18cm,draw,circle,fill,inner sep=1.4pt,label=0:{$u(x)$}] (ul) {};

\draw [gray,<->,{Stealth-Stealth}] ($(ul)+(0,-0.7)$) -- ($(ul)+(0.96,-0.7)$) node [below left] {\scriptsize $\delta_f(x)$};


\draw [gray, dashed] (ul) -- ($(ul)+(0,-0.7)$);


\node at (H1.side 2) [yshift=-0.24cm,draw,circle,fill,inner sep=1.4pt,label=180:{$\ell(x)$}] (l) {};

\coordinate (ld) at ($(l) + (0,-0.35)$);

%\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x)$] (ld) -- ($(ld)+(0.36,0)$) node [very near end, right] {\scriptsize $\theta_f(x)$};

%\coordinate (z) at ($(l)+(0.36,-0.35)$);
%\coordinate (z3) at ($(l)+(0.36,0.59)$);

%\draw [gray, dashed] (z2) -- (z);

\coordinate (z) at (1.97,1.5);
\coordinate (z2) at (2.93,1.377);

\draw [->] (-0.1,0.1) -- (4.5,0.1);

\coordinate (N1) at (H1.corner 1);

\draw [gray, dashed] (N1) -- (2.93,0.11);


\node at (2.93,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x$}}}}] {};

\draw [blue,thick,<->,{Stealth-Stealth}] (pu) -- (z) node [midway, above] {};
\draw [blue,dotted](pu) -- ($(pu)+(-0.25,0)$) node [label={[label distance=-0.15cm]180:$\frac{10}{\sqrt{3}} - 2$}]{};

\draw [blue,thick,<->,{Stealth-Stealth}] (z2) -- ($(z2)+(-0.96,0)$) node [below right] {\scriptsize $\delta_f(x)$};
\draw [blue,dotted](z2) -- ($(z2)+(1.64,0)$) node [label={[label distance=-0.15cm]0:$\frac{6}{\sqrt{3}}$}]{};

\draw [blue, dashed] (z) -- ($(z2) + (-0.96,0)$);

%\coordinate (wx) at ($(H1.corner 3) + (0,-0.305)$);
%\draw [dashed,gray] (H1.corner 3) -- (wx); 
%\node at (wx) [label={[label distance=-0.125cm,gray]-90:{{\scriptsize $w(x)$}}}] {};

%\coordinate (ex) at ($(H1.corner 5) + (0,-0.305)$);
%\draw [dashed,gray] (H1.corner 5) -- (ex); 
%\node at (ex) [label={[label distance=-0.125cm,gray]-90:{{\scriptsize $e(x)$}}}] {};

%\draw [gray,<->,{Stealth-Stealth}] ($(ul)+(0,-1.5)$) -- ($(ul)+(0.95,-1.5)$) node [midway, below] {\scriptsize ${\tt r}(x_l)-\theta_f(x_l)$};
\draw [gray,<->,{Stealth-Stealth}] ($(H1.side 5)+(0,-.5)$) -- ($(c1)+(0,-.5)$) node [midway, below] {\scriptsize ${\tt r}(x)$};

\end{tikzpicture}\hspace{0.65cm}\begin{tikzpicture}[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);

\node at (1,0.5) [draw,circle,fill,inner sep=1.4pt,label=180:{$p$}] (p) {};
\coordinate (pu) at ($(p)+(0,1)$);

\draw [gray, dashed] (p) -- (pu);

\coordinate (c1) at (2.93,1.18);

\coordinate (z) at (2.93, 1.5);
\coordinate (z3) at (3.89, .223);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (c1) (H1) {};

\node at (H1.side 1) [xshift=0.3cm,yshift=0.18cm,draw,circle,fill,inner sep=1.4pt,label=180:{$u(x)$}] (ul) {};

\draw [gray,<->,{Stealth-Stealth}] ($(ul)+(0,-0.6)$) -- ($(ul)+(-0.96,-0.6)$) node [below right] {\scriptsize $\delta_b(x)$};


\draw [gray, dashed] (ul) -- ($(ul)+(0,-0.6)$);


\node at (H1.side 5) [yshift=-0.24cm,draw,circle,fill,inner sep=1.4pt,label=0:{$\ell(x)$}] (l) {};

\coordinate (ld) at ($(l) + (0,+0.35)$);

%\draw [gray,<->,{Stealth-Stealth},label=0:$\theta_b(x)$] (ld) -- ($(l)+(-0.36,0.35)$) node [very near start, above right] {\scriptsize $\theta_b(x)$};

%\coordinate (z) at ($(l)+(-0.36,+0.35)$);
%\coordinate (z2) at ($(l)+(-0.36,0.35)$);

%\draw [gray, dashed] (z2) -- (z3);


\draw [->] (-0.1,0.1) -- (4.5,0.1);

\coordinate (N1) at (H1.corner 1);

\draw [gray, dashed] (N1) -- (2.93,0.11);


\node at (2.93,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x$}}}}] {};

\draw [blue,thick,<->,{Stealth-Stealth}] (pu) -- (z) node [midway, above] {};
\draw [blue,dotted](pu) -- ($(pu)+(-0.25,0)$) node [very near start, label={[label distance=0.1cm]180:$\frac{10}{\sqrt{3}} - 2$}]{};

\draw [blue,thick,<->,{Stealth-Stealth}] (z3) -- ($(z3)+(-0.96,0)$)  node [above right] {\scriptsize $\delta_b(x)$};
\draw [blue,dotted](z3) -- ($(z3)+(.8,0)$) node [label={[label distance=-0.15cm]0:$\frac{4}{\sqrt{3}}-2$}]{};

%\coordinate (wx) at ($(H1.corner 3) + (0,-0.305)$);
%\draw [dashed,gray] (H1.corner 3) -- (wx); 
%\node at (wx) [label={[label distance=-0.125cm,gray]-90:{{\scriptsize $w(x)$}}}] {};

% \coordinate (ex) at ($(H1.corner 5) + (0,-0.305)$);
% \draw [dashed,gray] (H1.corner 5) -- (ex); 
% \node at (ex) [label={[label distance=-0.125cm,gray]-90:{{\scriptsize $e(x)$}}}] {};

%\draw [gray,<->,{Stealth-Stealth}] ($(ul)+(0,-1.5)$) -- ($(ul)+(0.95,-1.5)$) node [midway, below] {\scriptsize ${\tt r}(x_l)-\theta_f(x_l)$};
\draw [gray,<->,{Stealth-Stealth}] ($(H1.side 2)+(0,-.5)$) -- ($(c1)+(0,-.5)$) node [midway, below] {\scriptsize ${\tt r}(x)$};

\end{tikzpicture}
\center{(a) \hspace{2.6in} (b)}

}



\newcommand{\proofA}{
\center\begin{tikzpicture}[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);


\draw [->] (1,0.1) -- (6.4,0.1);

\node at (0,0.5) [draw,circle,fill,inner sep=1.4pt,label=180:{$p$}] (p) {};
\coordinate (pu) at ($(p)+(0,1)$);

\draw [gray, dashed] (p) -- (pu);

\coordinate (c1) at (2.93,1.18);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (c1) (H1) {};

\node at (H1.side 6) [xshift=-0.3cm,yshift=0.18cm,draw,circle,fill,inner sep=1.4pt,label=45:{$u(x_l)$}] (ul) {};

\draw [gray,<->,{Stealth-Stealth}] ($(ul)+(0,-0.8)$) -- ($(ul)+(0.96,-0.8)$) node [above left] {\scriptsize $\delta_f(x_l)$};


\draw [gray, dashed] (ul) -- ($(ul)+(0,-0.6)$);


\node at (H1.side 2) [yshift=-0.24cm,draw,circle,fill,inner sep=1.4pt,label=180:{$\ell(x_l)$}] (l) {};

%\coordinate (ld) at ($(l) + (0,-0.35)$);

%\draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] (ld) -- ($(ld)+(0.36,0)$) node [very near end, right] {\scriptsize $\theta_f(x_l)$};

%\coordinate (z) at ($(l)+(0.36,-0.35)$);
\coordinate (z) at (1.97, 1.5);
\coordinate (z2) at (1.97, 1.38);
\coordinate (z3) at (2.93, 1.38);
\coordinate (z4) at (2.93, 1.5);
%\coordinate (z3) at ($(l)+(0.36,0.44)$);
%\coordinate (z4) at ($(l)+(0.36,-.7)$);

\draw [gray, dashed] (z) -- (z2);


%\draw [->] (-0.1,0.1) -- (4.5,0.1);

\coordinate (N1) at (H1.corner 1);

\draw [gray, dashed] (N1) -- (2.93,0.11);


\node at (2.93,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x_l$}}}}] {};

\draw [blue,thick,<->,{Stealth-Stealth}] ($(z)+(-1.96,0)$) -- (z) node [midway, above] {};
\draw [blue,dotted]($(z)+(-2.1,0)$) -- ($(z)+(-2,0)$) node [label={[label distance=-0.1cm]180:$\frac{10}{\sqrt{3}} - 2$}]{};

\draw [blue,thick,<->,{Stealth-Stealth}] (z2) -- (z3) node [below left] {\scriptsize $\delta_f(x_l)$};

%\coordinate (wx) at ($(H1.corner 3) + (0,-0.305)$);
%\draw [dashed,gray] (H1.corner 3) -- (wx); 
%\node at (wx) [label={[label distance=-0.125cm,gray]-90:{{\scriptsize $w(x_l)$}}}] {};

%\coordinate (ex) at ($(H1.corner 5) + (0,-0.305)$);
%\draw [dashed,gray] (H1.corner 5) -- (ex); 
%\node at (ex) [label={[label distance=-0.125cm,gray]-90:{{\scriptsize $e(x)$}}}] {};

%\draw [gray,<->,{Stealth-Stealth}] ($(ul)+(0,-1.5)$) -- ($(ul)+(0.95,-1.5)$) node [midway, below] {\scriptsize ${\tt r}(x_l)-\theta_f(x_l)$};
\draw [gray,<->,{Stealth-Stealth}] ($(H1.side 5)+(0,-.5)$) -- ($(c1)+(0,-.5)$) node [midway, above] {\scriptsize ${\tt r}(x_l)$};

\node [draw, color=blue!50, shape border rotate=30, minimum size=0.8in, regular polygon, regular polygon sides=6] at (5.67,0.99) (H2) {};

\coordinate (c2) at (5.67,0.99);


\coordinate (z5) at (4.78, 1.5);
\coordinate (z6) at (4.78, 1.38);
\coordinate (z7) at (5.67, 1.38);

\draw [red,thick,<->,{Stealth-Stealth}] (z4) -- (z5);

\draw [blue,dotted](z) -- (z4) node {};


\draw [red,dotted](z7) -- (z3) node {};
\draw [red,dotted](z7) -- ($(z7)+(1,0)$) node [label={[label distance=-0.15cm]0:$\frac{6}{\sqrt{3}}$}]{};


%\node at (H2.corner 2) [draw,circle,fill,inner sep=1.4pt,label=90:{$u(x_r)$}] (ur) {};

\node at (5.67,0.1) [label={[label distance=-0.2cm]-45:{\color{gray}{{\scriptsize $x_r$}}}}] {};
\draw [gray, dashed] (N2) -- (5.67,0.1);

\draw [red,thick,<->,{Stealth-Stealth}] (z6) -- (z7) node [below left] {\scriptsize ${\tt r}(x_r)$};

%\draw [red,dotted] ($(l)+(0.36,-0.7)+(1.7,0)$$) -- ($(l)+(1.47,-0.7)+(1.7,0)+(1.6,0)$) node [label={[label distance=-0.2cm]0:$\frac{4}{\sqrt{3}}-2$}]{};

\coordinate (rwx) at ($(H2.corner 3) + (0,-0.37)$);
\draw [dashed,gray] (H2.corner 3) -- (rwx); 
\node at (rwx) [label={[label distance=-0.125cm,gray]-90:{{\scriptsize $w(x_r)$}}}] {};

\end{tikzpicture}
}



\newcommand{\proofB}{
\begin{tikzpicture}[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);

\node at (0.4,0.5) [draw,circle,fill,inner sep=1.4pt,label=180:{$p$}] (p) {};
\coordinate (pu) at ($(p)+(0,1)$);

\draw [gray, dashed] (p) -- (pu);

\coordinate (c1) at (2.93,1.18);
\coordinate (c2) at ($(c1)+(.9,.5196)$);

%\coordinate (z1) at (1.93, 1.5);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (c1) (H1) {};

\node [draw, color=blue!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (c2) (H2) {};

 \node at (H2.corner 2) [draw,circle,fill,inner sep=1.4pt,label={[label distance=-0.15cm]135:{$u_s=u_t$}}] (u) {};

 \node at (H1.corner 5) [draw,circle,fill,inner sep=1.4pt,label={[label distance=0.15cm]0:$l_s$}] (l) {};


\coordinate (N1) at (H1.corner 1);
\coordinate (N1x) at (2.93,0.1);

\draw [gray, dashed] (N1) -- (N1x);


\node at (N1x) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x_l$}}}}] {};

\coordinate (N2) at (H2.corner 1);
\coordinate (N2x) at (3.83,0.1);

\draw [gray, dashed] (N2) -- (N2x);

\node at (N2x) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x_r$}}}}] {};

\draw [gray,<->,{Stealth-Stealth}] ($(u)+(0,-0.8)$) -- ($(u)+(-0.89,-0.8)$) node [midway,above] {\scriptsize $\delta_b(x_l)$};
\draw [gray, dashed] (u) -- ($(u)+(0,-0.8)$);

\draw [gray,<->,{Stealth-Stealth}] ($(l)+(0,0.8)$) -- ($(l)+(0.89,+0.8)$) node [midway,above] {\scriptsize $\delta_f(x_r)$};
\draw [gray, dashed] (l) -- ($(l)+(0,0.8)$);




\coordinate (pr) at ($(pu)+(0:6)$);
\coordinate (w1) at (H1.side 2);
\coordinate (w1u) at ($(w1)+(90:6)$);
\coordinate (ud) at ($(u)+(-90:6)$);
\coordinate (lu) at ($(l)+(90:6)$);

\coordinate (z1) at (intersection of w1--w1u and pu--pr);
\coordinate (z3) at (intersection of u--ud and pu--pr);
\coordinate (z4) at (intersection of N1--N1x and pu--pr);
\coordinate (z2) at ($(z1)+(z4)-(z3)$);
\coordinate (z5) at (intersection of N2--N2x and pu--pr);
\coordinate (z6) at (intersection of l--lu and pu--pr);

%\draw [gray,<->,{Stealth-Stealth}] ($(z1)+(0,-0.4)$) -- ($(z2)+(0,-0.4)$) node [near start, below] {\scriptsize $\theta_b(x_l)$};

%\draw [gray,<->,{Stealth-Stealth}] ($(z3)+(0,.4)$) -- ($(z4)+(0,.4)$) node [midway,label={[label distance=-.17cm]10:{\color{gray}{{\scriptsize $\theta_b(x_l)$}}}}] {};

%\draw [gray,<->,{Stealth-Stealth}] ($(z5)+(0,.4)$) -- ($(z6)+(0,.4)$) node [midway,label={[label distance=-0.25cm]45:{\color{gray}{{\scriptsize $\theta_f(x_r)$}}}}] {};

%\coordinate (z) at ($(n1)!.5!(n2) + (0.6,0.4)$);
%\node at (z) [label={[label distance=-0.15cm]90:{\color{gray}{{\scriptsize $\theta_b(x_l)=\theta_f(x_r)$}}}}] {};

%\draw [gray,dotted,->,>=Stealth] (n1) -- (z);


%\draw [gray, dashed] (z2) -- ($(z2)+(0,-0.4)$);

\coordinate (o) at (0.1,0.1);
\coordinate (x) at (4.5,0.1);
\draw [->] (o) -- (x);

\draw [very thick] ($(z4)+(0,-1.41)$) -- ($(z5)+(0,-1.41)$) node [midway, label={[label distance=-0.1cm]-90:$I$}]{};

\draw [blue,thick,<->,{Stealth-Stealth}] (pu) -- (z4) node [midway, above] {};
\draw [blue,dotted](pu) -- ($(pu)+(-0.2,0)$) node [very near start, label={[label distance=-0.1cm]90:$\frac{10}{\sqrt{3}} - 2$}]{};

\draw [blue,thick,<->,{Stealth-Stealth}] ($(z4)+(0,-1.28)$) -- ($(z5)+(0,-1.28)$) node [midway,above] {\scriptsize $\delta_b(x_l)$};
\draw [blue,dotted]($(z4)+(-1.3,-1.28)$) -- ($(z4)+(0,-1.28)$) node [very near start,label={[label distance=0cm]180:$\frac{4}{\sqrt{3}}-2$}]{};

\draw [red,thick,<->,{Stealth-Stealth}] ($(z4)+(0,-.45)$) -- ($(z5)+(0,-.45)$) node [midway,above] {\scriptsize $\delta_f(x_r)$};
\draw [red,dotted]($(z4)+(0,-.45)$) -- ($(z4)+(-.6,-.45)$) node [very near end, label={[label distance=-0.15cm]180:$\frac{4}{\sqrt{3}}$}]{};

\coordinate (e) at (H1.corner 5);
\coordinate (ed) at ($(e) + (0,-1)$);
\coordinate (ex) at (intersection of o--x and e--ed);

\coordinate (w) at (H2.corner 3);
\coordinate (wd) at ($(w) + (0,-1)$);
\coordinate (wx) at (intersection of o--x and w--wd);


% \draw [dashed,gray] (e) -- (ex); 
% \node at (ex) [label={[label distance=-0.35cm,gray]-40:{{\scriptsize $e(x_l)$}}}] {};
% 
% \draw [dashed,gray] (w) -- (wx); 
% \node at (wx) [label={[label distance=-0.35cm,gray]-135:{{\scriptsize $w(x_r)$}}}] {};

%\draw [gray,<->,{Stealth-Stealth}] ($(ul)+(0,-1.5)$) -- ($(ul)+(0.95,-1.5)$) node [midway, below] {\scriptsize ${\tt r}(x_l)-\theta_f(x_l)$};
%\draw [gray,<->,{Stealth-Stealth}] ($(H1.side 2)+(0,-.5)$) -- ($(c1)+(0,-.5)$) node [midway, below] {\scriptsize ${\tt r}(x)$};

\end{tikzpicture}\hspace{0.6cm}
\begin{tikzpicture}
\coordinate (c1) at (2.93,1.18);
\coordinate (c2) at ($(c1)+(2.9,-.15196)$);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (c1) (H1) {};

\node [draw, color=blue!50, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (c2) (H2) {};

 \node at (H1.side 6) [draw,shift={+(-0.075,0.0433cm)},circle,fill,inner sep=1.4pt,label={[label distance=0]180:{$u_i$}}] (ui) {};

 \node at (H1.side 2) [draw,yshift=-0.3cm,circle,fill,inner sep=1.4pt,label={[label distance=0cm]-135:$l_i$}] (li) {};

 \node at (H2.side 1) [draw,shift={+(0.15,0.0866cm)},circle,fill,inner sep=1.4pt,label={[label distance=0]90:{$u_j$}}] (uj) {};

 \node at (H2.side 5) [draw,circle,fill,inner sep=1.4pt,label={[label distance=0.15cm]0:$l_j$}] (lj) {};

\coordinate (o) at (1.5,0.1);
\coordinate (x) at (7.5,0.1);
\draw [->] (o) -- (x);

\coordinate (N1) at (H1.corner 1);
\coordinate (N1d) at ($(N1)+(-90:4)$);
\coordinate (N1x) at (intersection of o--x and N1--N1d);

\draw [gray, dashed] (N1) -- (N1x);

\node at (N1x) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x_l$}}}}] {};

\coordinate (N2) at (H2.corner 1);
\coordinate (N2d) at ($(N2)+(-90:4)$);
\coordinate (N2x) at (intersection of o--x and N2--N2d);


\draw [gray, dashed] (N2) -- (N2x);

\node at (N2x) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x_r$}}}}] {};

\node at (0.4,0.5) [draw,circle,fill,inner sep=1.4pt,label=180:{$p$}] (p) {};
\coordinate (pu) at ($(p)+(0,1)$);
\coordinate (pu2) at ($(p)+(0,0.88)$);
\coordinate (pu3) at ($(p)+(0,-0.28)$);
\draw [gray, dashed] (p) -- (pu);

\coordinate (pr) at ($(pu)+(0:6)$);
\coordinate (p2r) at ($(pu2)+(0:6)$);
\coordinate (p3r) at ($(pu3)+(0:6)$);

\coordinate (liu) at ($(li)+(90:6)$);
\coordinate (lid) at ($(li)+(-90:6)$);
\coordinate (uid) at ($(ui)+(-90:6)$);
\coordinate (ujd) at ($(uj)+(-90:6)$);
\coordinate (lju) at ($(lj)+(90:6)$);
\coordinate (ljd) at ($(lj)+(-90:6)$);

\coordinate (z1) at (intersection of li--liu and pu--pr);
\coordinate (z3) at (intersection of N1--N1x and pu--pr);
\coordinate (z4) at (intersection of ui--uid and pu--pr);
\coordinate (z2) at ($(z1)+(z4)-(z3)$);

\draw [blue,thick,<->,{Stealth-Stealth}] (pu) -- (z2) node [midway, above] {};
\draw [blue,dotted](pu) -- ($(pu)+(-0.2,0)$) node [very near start, label={[label distance=-0.1cm]90:$\frac{10}{\sqrt{3}} - 2$}]{};


\coordinate (z2d) at ($(z2)+(-90:6)$);
\coordinate (z5) at (intersection of z2--z2d and pu2--p2r);
\coordinate (z6) at (intersection of N1--N1x and pu2--p2r);

\draw [blue,thick,<->,{Stealth-Stealth}] (z5) -- (z6);
\draw [blue,dotted]($(z6)+(0.5,0)$) -- ($(z6)+(0,0)$) node [very near start,label={[label distance=-0.30cm]-30:$\frac{6}{\sqrt{3}}$}]{};

\coordinate (z7) at (intersection of N2--N2x and pu--pr);

\draw [red,thick,<->,{Stealth-Stealth}] (z3) -- (z7) node {};
\draw [red,dotted](z3) -- (z2) node {};

\coordinate (z8) at (intersection of z2--z2d and pu3--p3r);
\coordinate (z9) at (intersection of N1--N1x and pu3--p3r);

\draw [red,thick,<->,{Stealth-Stealth}] (z8) -- (z9) node [midway,above] {\scriptsize $\delta_f(x_l)$};
\draw [red,dotted]($(z9)+(0,0)$) -- ($(z9)+(1.1,0)$) node [very near end, label={[label distance=0.]0:$\frac{4}{\sqrt{3}}-2$}]{};
 


\coordinate (z10) at (intersection of uj--ujd and pu3--p3r);
\coordinate (z11) at (intersection of N2--N2x and pu3--p3r);
\coordinate (z12) at (intersection of lj--ljd and pu3--p3r);
\coordinate (z13) at ($(z12)-(z11)+(z10)$);

\draw [red,thick,<->,{Stealth-Stealth}] (z11) -- (z13) node [midway,above] {\scriptsize $\delta_b(x_r)$};
\draw [red,dotted]($(z11)+(0,0)$) -- ($(z11)+(-.5,0)$);

\coordinate (z13u) at ($(z13)+(90:6)$);

%\draw [red,dotted]($(z13)+(0,-.45)$) -- ($(z13)+(-.6,-.45)$) node [very near end, label={[label distance=-0.15cm]180:$\frac{4}{\sqrt{3}}-2$}]{};


\draw [gray,<->,{Stealth-Stealth}] ($(z4)+(0.74,0.15)$) -- ($(z4)+(0,0.15)$) node [midway,above] {\scriptsize $\delta_f(x_l)$};
%\draw [gray,<->,{Stealth-Stealth}] ($(z1)+(0,-0.25)$) -- ($(z2)+(0,-0.25)$) node [very near end,label={[label distance=-.1cm]-90:{\color{gray}{{\scriptsize $\theta_f(x_l)$}}}}] {};
%\draw [gray,<->,{Stealth-Stealth}] ($(z12)+(0,0.25)$) -- ($(z13)+(0,0.25)$) node [very near end,label={[label distance=-.1cm]92:{\color{gray}{{\scriptsize $\theta_b(x_l)$}}}}] {};
\draw [gray,<->,{Stealth-Stealth}] ($(z10)+(0,1.45)$) -- ($(z10)+(-0.7,1.45)$) node [midway, above]{\scriptsize $\delta_b(x_l)$};


\draw [gray, dashed] (z8) -- (z2);
\draw [gray, dashed] ($(z4)+(0,0.2)$) -- (ui);
%\draw [gray, dashed] ($(z13)+(0,.5)$) -- (z13);
\draw [gray, dashed] ($(z10)+(0,1.5)$) -- (uj);


\end{tikzpicture}
\center{(a) \hspace{2.6in} (b)}
}


\newcommand{\pathcost}{
\begin{tikzpicture}%[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);

\coordinate (c1) at (2.93,1.18);
\coordinate (c2) at ($(c1)+(2.9,-.15196)$);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (c1) (H1) {};

\node [draw, color=blue!50, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (c2) (H2) {};

 \node at (H1.side 6) [draw,circle,fill,inner sep=1.4pt,label={[label distance=-0.1cm]-85:{$u_i$}}] (ui) {};

 \node at (H1.side 2) [draw,yshift=-0.5cm,circle,fill,inner sep=1.4pt,label={[label distance=0cm]135:$l_i$}] (li) {};

 \node at (H2.side 1) [draw,shift={+(0.15,0.0866cm)},circle,fill,inner sep=1.4pt,label={[label distance=0]-90:{$u_j$}}] (uj) {};

 \node at (H2.side 5) [draw,circle,fill,inner sep=1.4pt,label={[label distance=0cm]45:$l_j$}] (lj) {};

\draw (li) -- (ui);
\draw (lj) -- (uj);

\coordinate (o) at (1.5,0.1);
\coordinate (x) at (7.5,0.1);
\draw [->] (o) -- (x);

\coordinate (N1) at (H1.corner 1);
\coordinate (N1d) at ($(N1)+(-90:4)$);
\coordinate (N1x) at (intersection of o--x and N1--N1d);

\draw [gray, dashed] (N1) -- (N1x);

\node at (N1x) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x_l$}}}}] {};

\coordinate (N2) at (H2.corner 1);
\coordinate (N2d) at ($(N2)+(-90:4)$);
\coordinate (N2x) at (intersection of o--x and N2--N2d);


\draw [gray, dashed] (N2) -- (N2x);

\node at (N2x) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x_r$}}}}] {};

%\coordinate (pr) at ($(pu)+(0:6)$);
%\coordinate (w1) at (H1.side 2);
%\coordinate (w1u) at ($(w1)+(90:6)$);
\coordinate (uid) at ($(ui)+(-90:6)$);
\coordinate (ujd) at ($(uj)+(-90:6)$);
%\coordinate (lu) at ($(l)+(90:6)$);

\coordinate (p1) at (0,1.3);
\coordinate (p2) at (7,1.3);

%\coordinate (z1) at (intersection of w1--w1u and pu--pr);
\coordinate (z3) at (intersection of ui--uid and p1--p2);
\coordinate (z4) at (intersection of N1--N1x and p1--p2);
%\coordinate (z2) at ($(z1)+(z4)-(z3)$);
\coordinate (z5) at (intersection of N2--N2x and p1--p2);
\coordinate (z6) at (intersection of uj--ujd and p1--p2);
%\coordinate (z6) at (intersection of l--lu and pu--pr);

%\draw [gray,<->,{Stealth-Stealth}] ($(z1)+(0,-0.4)$) -- ($(z2)+(0,-0.4)$) node [near start, below] {\scriptsize $\theta_b(x_l)$};

\draw [gray,<->,{Stealth-Stealth}] ($(z6)-(0.7,0)$) -- (z6) node [midway,below] {\scriptsize $\delta_b(x_l)$};

\draw [gray, dashed] (z6) -- (uj);
\draw [gray, dashed] (z3) -- (ui);

\draw [gray,<->,{Stealth-Stealth}] (z3) -- ($(z3)+(0.65,0)$) node [midway,below] {\scriptsize $\delta_f(x_r)$};

\node at (H1.side 2) [yshift=-0.5cm,inner sep=1.4pt,label=-135:{\color{blue}{\large +}}] {};
\node at (H1.side 6) [yshift=-0.05cm,inner sep=1.4pt,label=90:{\color{red}{\large $-$}}] {};
\node at (H1.side 3) [inner sep=1.4pt,label=-135:{\color{blue}{$p_S(l_i,x_l)$}}] {};
\node at (H1.side 6) [xshift=0.4cm, yshift=0.2cm,inner sep=1.4pt,label=90:{\color{red}{$p_N(u_i,x_l)$}}] {};
\node at (H2.side 5) [yshift=-0.3cm,inner sep=1.4pt,label=-45:{\color{red}{\large $-$}}] {};
\node at (H2.side 4) [inner sep=1.4pt,label=-45:{\color{red}{$p_S(l_j,x_r)$}}] {};
\node at (H2.side 1) [xshift=0.2cm,yshift=0.1cm,inner sep=1.4pt,label=90:{\color{blue}{\large $+$}}] {};
\node at (H2.side 1) [xshift=1.2cm,yshift=0.3cm,inner sep=1.4pt,label=90:{\color{blue}{$p_N(u_j,x_r)$}}] {};

\draw ($(li) + (-0.1cm,0)$) -- ($(H1.corner 3) + (-0.1cm,-0.052cm)$) -- ($(H1.corner 4) + (0,-0.1cm)$) [->,>=stealth',blue];
\draw ($(ui) + (0,0.1cm)$) -- ($(H1.corner 1) + (0,0.1cm)$) [->,>=stealth',red];
\draw ($(lj) + (0.1cm,0)$) -- ($(H2.corner 5) + (0.1cm,-0.052cm)$) -- ($(H2.corner 4) + (0,-0.1cm)$) [->,>=stealth',red];
\draw ($(uj) + (0cm,0.1cm)$) -- ($(H2.corner 1) + (0cm,0.1cm)$) [->,>=stealth',blue];

\node at ($(ui)+(30:0.25)$) [draw,circle,fill,inner sep=1.4pt,label={[label distance=0cm]0:{$u_{i+1}$}}] (u2) {};

\coordinate (u3) at ($(u2)+(-30:0.5)$);
\coordinate (u4) at ($(u3)+(30:.15)$);
\coordinate (u5) at ($(u4)+(-30:0.4)$);
\coordinate (x6) at ($(u5)+(30:2)$);
\coordinate (x7) at ($(uj)+(150:2)$);
\coordinate (u6) at (intersection of uj--x7 and u5--x6)
; 
\draw (ui) -- (u2) -- (u3) -- (u4) -- (u5) -- (u6) -- (uj);

%\coordinate (z) at ($(n1)!.5!(n2) + (0.6,0.4)$);
%\node at (z) [label={[label distance=-0.15cm]90:{\color{gray}{{\scriptsize $\theta_b(x_l)=\theta_f(x_r)$}}}}] {};

%\draw [gray,dotted,->,>=Stealth] (n1) -- (z);


%\draw [gray, dashed] (z2) -- ($(z2)+(0,-0.4)$);

\end{tikzpicture}
%%%  \hspace{0.6cm}
%%%  \begin{tikzpicture}[scale=1, transform shape]
%%%  %\clip (1.3,-1) rectangle (8,2.8);
%%%  
%%%  \node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (2.93,1.18) (H1) {};
%%%  
%%%  \coordinate (c1) at (2.93,1.18);
%%%  
%%%  \node at (H1.side 6) [draw,circle,fill,inner sep=1.4pt,label=0:{$u_i$}] (ul) {};
%%%  
%%%   
%%%  \node at (H1.corner 3) [draw,circle,fill,inner sep=1.4pt,label=180:$l_i$] (l) {};
%%%  
%%%  %\draw (l) -- (H1.corner 4) [->,>=stealth',blue,label=-45:{$+$}];
%%%  \draw ($(l) + (0,-0.1cm)$) -- ($(H1.corner 4) + (0,-0.1cm)$) [->,>=stealth',blue,label=45:{$p_S(\ell (x_l),x_l)$}];
%%%  
%%%  \draw ($(ul) + (0,0.1cm)$) -- ($(H1.corner 1) + (0,0.1cm)$) [->,>=stealth',red,label=-45:{$+$}];
%%%  
%%%  
%%%  
%%%  \draw [->] (1,0.1) -- (5,0.1);
%%%  
%%%  \coordinate (N1) at (H1.corner 1);
%%%  
%%%  \node at (N1) [label={[label distance=-0.3cm]135:{\scriptsize $N(x_l)$}}] {};
%%%  
%%%  \draw [gray] (ul) -- (l) -- (N1);
%%%  
%%%  \coordinate (N1x) at (2.93,0.1);
%%%  \draw [gray, dashed] (N1) -- (N1x);
%%%  
%%%  \draw pic [draw=gray, "\color{gray}{\scriptsize $\Theta$}", angle eccentricity=1.25,angle radius=1.05cm] {angle = ul--l--N1};
%%%  
%%%  
%%%  \node at (2.93,0.1) [label={[label distance=-0.15cm]-90:{\color{gray}{$x_l$}}}] {};
%%%  
%%%  \draw [gray,<->,{Stealth-Stealth},label=-90:${\tt r}(x_l)$] ($(N1) + (0,-2)$) -- ($(N1)+(1.32,-2)$) node [midway, below] {\scriptsize ${\tt r}(x)$};
%%%  
%%%  \coordinate (ud) at ($(ul)+(-90:4)$);
%%%  \coordinate (p1) at (0,1.3);
%%%  \coordinate (p2) at (7,1.3);
%%%  \coordinate (z1) at (intersection of ul--ud and p1--p2);
%%%  \coordinate (z2) at (intersection of N1--N1x and p1--p2);
%%%  
%%%  \draw [gray,<->,{Stealth-Stealth},label=90:$\theta_f(x_l)$] (z1) -- (z2) node [very near start, below] {\scriptsize $\theta_f(x_l)$};
%%%  
%%%  \draw [gray,dashed] (ul) -- (z1);
%%%  
%%%  \node at (H1.side 3) [inner sep=1.4pt,label=-135:{\color{blue}{$p_S(l_i,x_l)$}}] {};
%%%  \node at (H1.side 6) [shift={+(-0.15,0.0866cm)},inner sep=1.4pt,label=45:{\color{red}{$p_N(u_i,x_l)$}}] {};
%%%  \end{tikzpicture}
%%%  \center{(a) \hspace{2.6in} (b)}
}

\newcommand{\anotherpathcost}{
\begin{tikzpicture}%[scale=1, transform shape]
%\clip (1.3,-1) rectangle (8,2.8);

\coordinate (c1) at (2.93,1.18);
\coordinate (c2) at ($(c1)+(2.9,-.15196)$);

\node [draw, color=red!50, shape border rotate=30, minimum size=1.2in, regular polygon, regular polygon sides=6] at (c1) (H1) {};

\node [draw, color=blue!50, shape border rotate=30, minimum size=1in, regular polygon, regular polygon sides=6] at (c2) (H2) {};

 \node at (H1.side 6) [draw,circle,fill,inner sep=1.4pt,label={[label distance=-0.1cm]-85:{$u_i$}}] (ui) {};

 \node at (H1.side 2) [draw,yshift=-0.5cm,circle,fill,inner sep=1.4pt,label={[label distance=0cm]135:$l_i$}] (li) {};

 \node at (H2.side 1) [draw,shift={+(0.15,0.0866cm)},circle,fill,inner sep=1.4pt,label={[label distance=0]-90:{$u_j$}}] (uj) {};

 \node at (H2.side 5) [draw,circle,fill,inner sep=1.4pt,label={[label distance=0cm]45:$l_j$}] (lj) {};

\draw (li) -- (ui);
\draw (lj) -- (uj);

\coordinate (o) at (1.5,0.1);
\coordinate (x) at (7.5,0.1);
\draw [->] (o) -- (x);

\coordinate (N1) at (H1.corner 1);
\coordinate (N1d) at ($(N1)+(-90:4)$);
\coordinate (N1x) at (intersection of o--x and N1--N1d);

\draw [gray, dashed] (N1) -- (N1x);

\node at (N1x) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x_l$}}}}] {};

\coordinate (N2) at (H2.corner 1);
\coordinate (N2d) at ($(N2)+(-90:4)$);
\coordinate (N2x) at (intersection of o--x and N2--N2d);


\draw [gray, dashed] (N2) -- (N2x);

\node at (N2x) [label={[label distance=-0.15cm]-90:{\color{gray}{{\scriptsize $x_r$}}}}] {};

%\coordinate (pr) at ($(pu)+(0:6)$);
%\coordinate (w1) at (H1.side 2);
%\coordinate (w1u) at ($(w1)+(90:6)$);
\coordinate (uid) at ($(ui)+(-90:6)$);
\coordinate (ujd) at ($(uj)+(-90:6)$);
%\coordinate (lu) at ($(l)+(90:6)$);

\coordinate (p1) at (0,1.3);
\coordinate (p2) at (7,1.3);

%\coordinate (z1) at (intersection of w1--w1u and pu--pr);
\coordinate (z3) at (intersection of ui--uid and p1--p2);
\coordinate (z4) at (intersection of N1--N1x and p1--p2);
%\coordinate (z2) at ($(z1)+(z4)-(z3)$);
\coordinate (z5) at (intersection of N2--N2x and p1--p2);
\coordinate (z6) at (intersection of uj--ujd and p1--p2);
%\coordinate (z6) at (intersection of l--lu and pu--pr);

%\draw [gray,<->,{Stealth-Stealth}] ($(z1)+(0,-0.4)$) -- ($(z2)+(0,-0.4)$) node [near start, below] {\scriptsize $\theta_b(x_l)$};

%\draw [gray,<->,{Stealth-Stealth}] ($(z6)-(0.7,0)$) -- (z6) node [midway,below] {\scriptsize $\delta_b(x_l)$};

%\draw [gray, dashed] (z6) -- (uj);
%\draw [gray, dashed] (z3) -- (ui);

%\draw [gray,<->,{Stealth-Stealth}] (z3) -- ($(z3)+(0.65,0)$) node [midway,below] {\scriptsize $\delta_f(x_r)$};

\node at (H1.side 2) [yshift=-0.5cm,inner sep=1.4pt,label=-135:{\color{blue}{\large +}}] {};
\node at (H1.side 6) [yshift=-0.05cm,inner sep=1.4pt,label=90:{\color{red}{\large $-$}}] {};
\node at (H1.side 3) [inner sep=1.4pt,label=-135:{\color{blue}{$p_S(l_i,x_l)$}}] {};
\node at (H1.side 6) [xshift=0.4cm, yshift=0.2cm,inner sep=1.4pt,label=90:{\color{red}{$p_N(u_i,x_l)$}}] {};
\node at (H2.side 5) [yshift=-0.3cm,inner sep=1.4pt,label=-45:{\color{red}{\large $-$}}] {};
\node at (H2.side 4) [inner sep=1.4pt,label=-45:{\color{red}{$p_S(l_j,x_r)$}}] {};
\node at (H2.side 1) [xshift=0.2cm,yshift=0.1cm,inner sep=1.4pt,label=90:{\color{blue}{\large $+$}}] {};
\node at (H2.side 1) [xshift=1.2cm,yshift=0.3cm,inner sep=1.4pt,label=90:{\color{blue}{$p_N(u_j,x_r)$}}] {};

\draw ($(li) + (-0.1cm,0)$) -- ($(H1.corner 3) + (-0.1cm,-0.052cm)$) -- ($(H1.corner 4) + (0,-0.1cm)$) [->,>=stealth',blue];
\draw ($(ui) + (0,0.1cm)$) -- ($(H1.corner 1) + (0,0.1cm)$) [->,>=stealth',red];
\draw ($(lj) + (0.1cm,0)$) -- ($(H2.corner 5) + (0.1cm,-0.052cm)$) -- ($(H2.corner 4) + (0,-0.1cm)$) [->,>=stealth',red];
\draw ($(uj) + (0cm,0.1cm)$) -- ($(H2.corner 1) + (0cm,0.1cm)$) [->,>=stealth',blue];

\node at ($(ui)+(30:0.25)$) [draw,circle,fill,inner sep=1.4pt,label={[label distance=0cm]0:{$u_{i+1}$}}] (u2) {};

\coordinate (u3) at ($(u2)+(-30:0.5)$);
\coordinate (u4) at ($(u3)+(30:.15)$);
\coordinate (u5) at ($(u4)+(-30:0.4)$);
\coordinate (x6) at ($(u5)+(30:2)$);
\coordinate (x7) at ($(uj)+(150:2)$);
\coordinate (u6) at (intersection of uj--x7 and u5--x6)
; 
\draw (ui) -- (u2) -- (u3) -- (u4) -- (u5) -- (u6) -- (uj);

%\coordinate (z) at ($(n1)!.5!(n2) + (0.6,0.4)$);
%\node at (z) [label={[label distance=-0.15cm]90:{\color{gray}{{\scriptsize $\theta_b(x_l)=\theta_f(x_r)$}}}}] {};

%\draw [gray,dotted,->,>=Stealth] (n1) -- (z);


%\draw [gray, dashed] (z2) -- ($(z2)+(0,-0.4)$);

\end{tikzpicture}
}



\newcommand{\mickey}{
\begin{tikzpicture}

\node [draw, color=blue!50, shape border rotate=30, minimum size=2in, regular polygon, regular polygon sides=6] at (2,0) (H) {};



\node [draw, color=red!50, shape border rotate=30, minimum size=1.4641in, regular polygon, regular polygon sides=6,label=-90:{{\color{red!50}{$H_1$}}}] at (1.41,1.02) (L) {};

\node [draw, color=green!50, shape border rotate=30, minimum size=1.4641in, regular polygon, regular polygon sides=6,label=-87:{{\color{green!50}{$H_n$}}}] at (2.59,1.02) (R) {};

\node at (H.corner 1) [draw,circle,fill,inner sep=1.4pt] (u4) {};
\node at (H.corner 3) [draw,circle,fill,inner sep=1.4pt] (l2) {};
\node at (H.corner 4) [draw,circle,fill,inner sep=1.4pt] (l3) {};
\node at (H.corner 5) [draw,circle,fill,inner sep=1.4pt] (l4) {};

\node at (L.corner 3) [draw,circle,fill,inner sep=1.4pt,label=180:$l_1$] (l1) {};
\node at (R.corner 5) [draw,circle,fill,inner sep=1.4pt,label=0:$l_{n-1}$] (l5) {};

\node at (L.corner 2) [draw,circle,fill,inner sep=1.4pt,label=180:$u_1$] (u2) {};
\node at (L.corner 1) [draw,circle,fill,inner sep=1.4pt] (u3) {};
\node at (R.corner 1) [draw,circle,fill,inner sep=1.4pt] (u5) {};
\node at (R.corner 6) [draw,circle,fill,inner sep=1.4pt,label=0:$u_{n-1}$] (u6) {};


\node at (L.corner 4) (LN) {};
\coordinate (LNL) at ($(LN)+(-180:6)$);
\coordinate (m) at (intersection of LN--LNL and u2--l2);

\draw [gray, dashed] (m) -- (LN) node [midway, label={[label distance=-0.1cm]-90:{\color{gray}{$1$}}}] {};

\coordinate (l4L) at ($(l4)+(-180:6)$);
\coordinate (m) at (intersection of l4--l4L and u4--l3);

\draw [gray, dashed] (m) -- (l4) node [near start, label={[label distance=-0.1cm]-90:{\color{gray}{$\frac{\sqrt{3}}{2} + \frac{1}{2}$}}}] {};


\coordinate (h) at (u3);
\coordinate (l) at (l1);

\draw [very thick] (h) -- (l) node [midway, label={[label distance=-0.1cm]180:{\color{gray}{$2$}}}] {};

\foreach \x in {.8,.6,.4,.2}
{
  \node at ($\x*(l1)+(l2)-\x*(l2)$) [draw, fill, inner sep = 1.4pt, circle] (l) {};
  \draw (h) -- (l);
  \node at ($\x*(u3)+(u4)-\x*(u4)$) [draw, fill, inner sep = 1.4pt, circle] (h) {};
  \draw (h) -- (l);
}

\draw (h) -- (l2) -- (u4) -- (l3);


\coordinate (h) at (u5);
\coordinate (l) at (l5);

\draw [very thick] (h) -- (l);

\foreach \x in {.8,.6,.4,.2}
{
  \node at ($\x*(l5)+(l4)-\x*(l4)$) [draw, fill, inner sep = 1.4pt, circle] (l) {};
  \draw (h) -- (l);
  \node at ($\x*(u5)+(u4)-\x*(u4)$) [draw, fill, inner sep = 1.4pt, circle] (h) {};
  \draw (h) -- (l);
}

\draw (h) -- (l4) -- (u4);
\draw [very thick] (u4) -- (u5) -- (u6) -- (l5) -- (l4) -- (l3) -- (l2) node [near end,label={[label distance=0cm]-90:{\color{gray}{$1 + \frac{1}{\sqrt{3}}$}}}] {} -- (u2) -- (u3) node [near start,label={[label distance=0cm]90:{\color{gray}{$\frac{2}{\sqrt{3}}$}}}] {} -- (u4);

%\draw [gray,<->,{Stealth-Stealth}] (z5) -- (z6) node [very near start,label={[label distance=-.17cm]-135:{\color{gray}{{\scriptsize $\theta_b(x_l)$}}}}] {};


\node at ($0.133975*(u2)+(l1)-0.133975*(l1)$) [draw, fill, inner sep = 1.4pt, circle,label=175:$s$] (p) {};
\node at ($0.133975*(u6)+(l5)-0.133975*(l5)$) [draw, fill, inner sep = 1.4pt, circle,label=5:$t$] (q) {};

\draw [dashed] (p) -- (q);

\draw (u2) -- (p) node [midway,label={[label distance=0cm]180:{\color{gray}{$1$}}}] {};
\end{tikzpicture}
}
