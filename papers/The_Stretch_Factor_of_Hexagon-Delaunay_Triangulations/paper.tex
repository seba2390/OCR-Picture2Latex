\documentclass[11pt,USenglish]{article}
%\documentclass[letterpaper,USenglish,numberwithinsect,cleveref, autoref]{socg-lipics-v2019}
%This is a template for producing LIPIcs articles. 
%See lipics-manual.pdf for further information.
%for A4 paper format use option "a4paper", for US-letter use option "letterpaper"
%for british hyphenation rules use option "UKenglish", for american hyphenation rules use option "USenglish"
%for section-numbered lemmas etc., use "numberwithinsect"
%for enabling cleveref support, use "cleveref"
%for enabling cleveref support, use "autoref"


%\graphicspath{{./graphics/}}%helpful if your graphic files are in another directory


\bibliographystyle{plainurl}% the mandatory bibstyle

%\usepackage{microtype}%if unwanted, comment out or use option "draft"

%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{geometry}
\newgeometry{vmargin={1in}, hmargin={1in,1in}}  

\usepackage{tikz}
\usetikzlibrary{shapes,arrows,arrows.meta,shadows,positioning,matrix,patterns,decorations.markings,decorations.pathreplacing,svg.path,calc,angles,quotes} 
\usepackage{color}
\usepackage{amssymb}
\usepackage[integrals]{wasysym}
\usepackage{bm}
\usepackage{wrapfig}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amsfonts}
%\usepackage{xparse}
%\usepackage{comment}
\usepackage{tabu}
%\usepackage{wrapfig}
\usepackage{enumerate}
\usepackage[mathscr]{eucal}
\usepackage{caption}
\usepackage{authblk}
\usepackage{sectsty}

\usepackage{etoolbox}   % need for command \newtoggle
\newtoggle{abstract}    % flag to control whether output is abstract or full version
%\toggletrue{abstract}   % uncomment for abstract version
\togglefalse{abstract} % uncomment for full version


%\allsectionsfont{\normalfont\sffamily\bfseries}

\theoremstyle{plain}% default
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}{Corollary}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}

\def\cE{\mathscr{E}}
\newcommand{\sgn}{\operatorname{sgn}}

\def\eps{\varepsilon}
\def\cT{\frac{5}{\sqrt{3}}-1}
\def\cP{\frac{6}{\sqrt{3}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%


\title{The Stretch Factor of Hexagon-Delaunay Triangulations}


\author[1]{Michael Dennis\thanks{michael\_dennis@cs.berkeley.edu}}

\author[2]{Ljubomir Perkovi\'{c}\thanks{lperkovic@cs.depaul.edu (corresponding author)}}

\author[2]{Duru T\"{u}rko\u{g}lu\thanks{duru@cs.uchicago.edu}}


\affil[1]{Computer Science Division, University of California at Berkeley, Berkeley, CA, USA}
\affil[2]{School of Computing, DePaul University, Chicago, IL, USA}

\date{}

\input{figures.tex}


\begin{document}

%\definecolor{qqwuqq}{rgb}{0.,0.39215686274509803,0.}
%\definecolor{wwzzff}{rgb}{0.4,0.6,1.}

\maketitle

\begin{abstract}
The problem of computing the exact stretch factor (i.e., the tight bound on the
worst case stretch factor) of a Delaunay triangulation is one of the
longstanding open problems in computational geometry. Over the
years, a series of upper and lower bounds on the exact stretch factor have
been obtained but the gap between them is still large. An alternative approach
to solving the problem is to develop techniques for computing the exact stretch
factor of ``easier'' types of Delaunay triangulations, in particular those
defined using regular-polygons instead
of a circle. Tight bounds exist for Delaunay triangulations defined using
an equilateral triangle~\cite{Chew89} and a square~\cite{BGHP15}. In this paper,
we determine the exact stretch factor of Delaunay triangulations defined using
a regular hexagon: It is $2$.

We think that the main contribution of this paper are the two techniques we
have developed to compute tight upper bounds for the stretch factor of
Hexagon-Delaunay triangulations.% The two techniques correspond to the two
%different lower bound construtions which are equivalent to the two tightest
%known lower bound for traditional Delaunay triangulations.  
 %We think that the techniques
%we
%have developed in this paper will prove useful in future work on
%computing the exact stretch factor of classical Delaunay triangulations and
%other plane spanners.
\end{abstract}




%\clearpage
%\setcounter{page}{1}


\section{Introduction}
\label{sec:intro}
\input{introduction.tex}

\section{Preliminaries}
\label{sec:prelim}
\input{preliminaries.tex}

\section{Main result}
\label{sec:main}
\input{main.tex}

\section{Proof of (Gentle Path) Lemma~\ref{le:boundedGentelSections}}
\label{sec:gentle}
\iftoggle{abstract}
{The main idea behind the proof of the Gentle Path lemma is that a gentle path
between $u_r \in U$ and $l_s \in L$ (where, say, $r \leq s$ and 
${\tt x}(u_r) < {\tt x}(u_s)$) in $T_{1n}$ can 
be extended using edge $(u_{r-1},u_r)$, unless $r=0$ or $u_r$ is a right
induction vertex of $T_{r}$, or using edge $(l_{s},l_{s+1})$, unless $s=n$ or
$l_s$ is a left induction vertex of $T_{s+1}$. 
In other words, a gentle path from $r$ to $s$ is either canonical
or can be extended to a canonical path from $u_{r'}$ to $l_{s'}$ as illustrated
in Fig.~\ref{fig:caseA}.

\begin{figure}[h]
\center{\caseA}
\caption{Illustration of the proof of 
Lemma~\ref{le:boundedGentelSections} in the case when the gentle path from $u_r$ to $l_s$ is just a gentle
edge. For every $i$ such that $r' < i \leq r$ and $u_i$ is
the right vertex of $H_i$, hexagon $H_i$ and the edge $(u_{i-1},u_i)$ are shown
in red. Each edge $(u_{i-1},u_i)$ has slope greater than $-\frac{1}{\sqrt{3}}$
and therefore has length bounded by
$\sqrt{3}d_x(u_{i-1},u_i) - ({\tt y}(u_{i-1})-{\tt y}(u_i))$, a value equal
to the total length of the two intersecting, red, dashed segments going north
from $u_{i-1}$ and north-west from $u_i$. The total length of the two dashed
blue segments is an upper bound on the length of the edge $(u_r,l_s)$ and
the total length of the dotted red line segments represent the upper bound
$\sqrt{3}d_x(p,q) - ({\tt y}(p)-{\tt y}(q))$ on the length of the path 
$p=u_{r'}, \dots, u_r, l_{s}, l_{s+1}, \dots, l_{s'}=q$.}
\label{fig:caseA}
\end{figure}

}
{\input{gentle.tex}}

\section{Proof of (Technical) Lemma \ref{le:mainlemmaA}}
\label{sec:proofA}
\iftoggle{abstract}
{We prove this lemma via a framework that uses continuous versions
of the discrete functions ($p_N$, $p_S$, etc.) informally introduced in
Subsection~\ref{sub:keylemma}. We start by defining functions $H(x)$, $T(x)$, $u(x)$,
$\ell(x)$, ${\tt r}(x)$, $w(x)$, and $e(x)$ for
${\tt x}(p) \leq x \leq {\tt x}(q)$ as illustrated in
Fig.~\ref{fig:notation}.

\begin{figure}[h]
\center{\notation}
\caption{Let point $c_i$ be the center of hexagon $H_i$, for $i=1,\dots,n$. For $x$ such that
${\tt x}(c_i) \leq x < {\tt x}(c_{i+1})$, $H(x)$ is the hexagon whose center has abscissa
$x$ and that has points $u_i=u(x)$ and $l_i=\ell(x)$ on its boundary.
Intuitively, function $H(x)$ from $x= {\tt x}(c_i)$ to $x= {\tt x}(c_{i+1})$
models the ``pushing''
of hexagon $H_i$ through $u_i$ and $l_i$ up until it becomes $H_{i+1}$. Function
${\tt r}(x)$ is the minimum radius of $H(x)$ and $w(x) = x-{\tt r}(x)$ and
$e(x) = x + {\tt r}(x)$ are the abscissas of the $w$ and $e$ sides, respectively,
of $H(x)$. Finally, we define $T(x) = T_{1i}$ when ${\tt x}(c_i) \leq x < {\tt x}(c_{i+1})$.} % $N(x)$ and $S(x)$ are the vertices $N$ and $S$ of $H(x)$.}
\label{fig:notation}
\end{figure}

For a point $o$ on a side of $H(x)$, we define functions $p_N(o, x)$ and 
$p_S(o, x)$ as the {\em signed} shortest distances around the perimeter of
$H(x)$ to the $N$ vertex and $S$ vertex, respectively, with sign 
$\sgn(x - x(o))$. As Fig.~\ref{fig:dNdS}-(a) and Fig.~\ref{fig:dNdS}-(b)
illustrate, these signs are positive for $o$ on the $n_w$, $w$, or $s_w$
sides of $H(x)$ and negative for $o$ on $n_e$, $e$, or $s_e$ sides. 
We omit $o$ and use the shorthand notation $p_N(x)$ if $o = u(x)$ and
$p_S(x)$ if $o = \ell(x)$. 

\begin{figure}
\dNdS

\hspace{1.45cm} (a) \hspace{4.35cm} (b) \hspace{4.55cm} (c)
\caption{(a) The values of $p_N(o, x)$ are shown, for various points $o$
lying on the boundary of $H(x)$, as signed hexagon arc lengths. (b) The 
values of $p_S(o, x)$ are shown similarly. (c) The length of edge
$(u_{i-1},u_i)$, with $u_{i-1},u_i$ lying on the boundary of $H(x)=H_i$, 
is bounded by $p_N(u_{i-1}, x) - p_N(u_i,x)$.}
\label{fig:dNdS}
\end{figure}



Functions $U(x)$ and $L(x)$, used to bound the length of the shortest path from $p$ to $q$ and illustrated in Fig.~\ref{fig:UandL}-(a), are defined as follows for ${\tt x}(p) \leq x \leq {\tt x}(q)$:
\begin{align*}
& U(x) = d_{T(x)}(p,u(x)) + p_N(x) \mbox{\hspace{2cm}} L(x) = d_{T(x)}(p,\ell(x)) + p_S(x)
\end{align*}
We note that $U({\tt x}(q))+L({\tt x}(q))$ is exactly twice the distance in 
$T_{1n}$ from $p$ to $q$. We will compute an upper bound for function $U+L$ 
by bounding its growth rate.

Functions ${\bar U}(x)$ and ${\bar L}(x)$, used to bound the lengths of the upper and lower paths in $T_{1n}$ and illustrated in Fig.~\ref{fig:UandL}-(b), are defined as follows for ${\tt x}(c_i) \leq x \leq {\tt x}(c_{i+1})$:

\begin{figure}[!b]
\begin{center}\UandL

(a) \hspace{6cm} (b)
\end{center}
\caption{(a) Definition of $U(x)$ and $L(x)$. For example, $U(x)$ for 
${\tt x}(c_i) \leq x < {\tt x}(c_{i+1})$ is the sum
of the length of the shortest path from $p$ to $u_i$ in $T_{1i}$ 
(illustrated as the red dashed path) and $p_N(x)$ (of negative value and 
represented as a red arrow). (b) Definition of $\bar{U}(x)$ and $\bar{L}(x)$. 
When ${\tt x}(c_i) \leq x < {\tt x}(c_{i+1})$ for example,
$\bar{U}(x) - p_N(x)$ is an upper bound (equal to the length of the 
sequence of red dashed
hexagon arcs going from $p$ to $u_i$) on the length
of the upper path $p, u_0, u_1, \dots, u_{i-1}, u_i$.}
\label{fig:UandL}
\end{figure}


\begin{align*}
\bar{U}(x) & = \sum_{j=1}^{i} (p_N(u({\tt x}(c_{j-1})), {\tt x}(c_{j})) - p_N(u({\tt x}(c_{j})),{\tt x}(c_{j}))) + p_N(x) \\
\bar{L}(x) & = \sum_{j=1}^{i} (p_S(\ell({\tt x}(c_{j-1})), {\tt x}(c_{j})) - p_S(\ell({\tt x}(c_{j})),{\tt x}(c_{j}))) + p_S(x)
\end{align*}



Functions ${\bar U}(x)$ and ${\bar L}(x)$, 
as well as $U(x)$ and $L(x)$, have rates of growth when
${\tt x}(c_i) < x < {\tt x}(c_{i+1})$ that depend solely on the
last term ($p_N(x)$ or $p_S(x)$).
%For ${\tt x}(c_i) < x < {\tt x}(c_{i+1})$, the terms 
%$d_{T_{1i}}(p,u_i)$ and $d_{T_{1i}}(p,l_i)$ in the definitions of 
%$U(x)$ and $L(x)$, respectively, are constant. 
%This means that for such $x$ the rate of growth of
%functions $U(x)$ and $L(x)$ is determined solely by the terms 
%$p_N(x)$ and $p_S(x)$, respectively. 
We show that functions $p_N$ and 
$p_S$ are monotonically increasing piecewise linear 
 and bound the rate of growth of $p_N$ and $p_S$ using elementary geometric 
arguments illustrated in Fig.~\ref{fig:growth}. Figure~\ref{fig:growth}-(c)
illustrates a case when the growth rate of $p_N+p_S$, and therefore also of 
${\bar U}+{\bar L}$ and of $U+L$, is $\frac{8}{\sqrt{3}}$.
%with respect to horizontal
%distance $\Delta x$
%, which is also the growth
%rate of ${\bar U} + {\bar L}$ and also $U+L$ when 
%${\tt x}(c_i) < x < {\tt x}(c_{i+1})$, is at most  
%Figure~\ref{fig:growth} illustrates the the proof.

\begin{figure}
\growth

\hspace{2cm} (a) \hspace{3.8cm} (b) \hspace{4.2cm} (c)
\caption{Constructions demonstrating growth rates, with respect to 
$\Delta x = 1$, of $p_N$, $p_S$ and other
functions for three different placements of $u(x)=u$ and $\ell(x)=l$ on the
boundary of $H(x)$. 
%Note that the growth
%$\Delta p_N(x)$ when $t(x)$ is a single transition can be represented using
%a piecewise linear curve of length $\Delta p_N(x)$.
}
\label{fig:growth}
\end{figure}



}
{\input{proofA.tex}}

\section{Proof of (Amortization) Lemma~\ref{le:mainlemmaB}}
\label{sec:proofB}
\iftoggle{abstract}
{The proof of the lemma builds on the framework discussed in the previous
section and on a careful analysis of the growth rates of $p_N$ and $p_S$
when $T_{1n}$ contains no gentle path.  We show that in that case
the average growth rate of $U+L$ is at most $2\left(\cT\right)$. 

Our main approach is to spread (i.e., amortize) the 
``extra'' $\frac{2}{\sqrt{3}}$ of the $\frac{8}{\sqrt{3}}$ growth rate
over wider intervals of time that, as we show, include time intervals during
which the growth rate is smaller. To achieve our tight bound of 
$2\left(\cT\right)$, however, we need to do more and also include 
``cross-edges'' $(l_i,u_i)$ as illustrated in Fig.~\ref{fig:pathcost}.


\begin{figure}[h]
\center{\anotherpathcost}

\caption{Illustrated is a situation in which the growth rate of $p_S(x)$ is 
$\frac{6}{\sqrt{3}}$ between $x=x_l$ and $x=x_r$. In that case 
the growth rate of $p_N(x)$ is $\frac{2}{\sqrt{3}}$. For large enough such
intervals $[x_l,x_r]$,  
the path $l_i,u_i,u_{i+1},\dots,u_j,l_j$ is a shortcut for 
$l_i, l_{i+1}, \dots,l_j$ and therefore $L(x_r)$ is smaller than what the growth
rate of $p_S(x)$ would indicate. The stretch factor bound
we obtain is the result of a min-max optimization between the two subpaths 
from $l_i$ to $l_j$, and it is tight as we show in Section~\ref{sec:conclusion}.
% (a) Illustration of path $P$: $l_i,u_i,u_{i+1},\dots,u_j,l_j$.
% (b) $-p_S(l_i,x_l) + |l_iu_i|$ is maximized when $l_i$ is the SW corner
% of $H(x_l)$.
}
\label{fig:pathcost}
\end{figure}

%The growth rate of $U(x)+L(x)$ at a
%particular time $x$ (we will find it useful to use the time intuition and think of
%$x$ as time going from time ${\tt x}(p)$ to time ${\tt x}(q)$) 
%is one of $\frac{4}{\sqrt{3}}$, $\frac{6}{\sqrt{3}}$, or
%$\frac{8}{\sqrt{3}}$. 
%Our goal is to spread (i.e., amortize) the 
%``extra'' $\frac{2}{\sqrt{3}}$ of the $\frac{8}{\sqrt{3}}$ growth rate
%over wider intervals of time that, as we show, include time intervals during
%which the growth rate is smaller. To achieve our tight bound of
%$2\left(\cT\right)$ 


% to show that the
%average growth rate of $P(x)$ is at  most $2\left(\cT\right)$. 
}
{\input{proofB.tex}}

\section{Conclusion}
\label{sec:conclusion}
\input{conclusion.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section*{References}
%\bibliographystyle{alpha}
\bibliography{paper}

\end{document}
