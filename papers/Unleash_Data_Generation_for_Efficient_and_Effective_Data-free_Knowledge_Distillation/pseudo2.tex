\documentclass[11pt]{article}
\usepackage[margin=3cm]{geometry}
\usepackage[ruled,linesnumbered]{algorithm2e}
\SetKwComment{Comment}{/* }{ */}
\SetKwInput{kwInput}{Input}
\RestyleAlgo{ruled}
\begin{document}

\begin{algorithm}[hbt!]
\caption{NLDFKD}\label{alg:two}
\SetAlgoLined
\kwInput{$\mathcal{T}_{\theta_\mathcal{T}}$, $\mathcal{S}_{\theta_\mathcal{S}}$, $\mathcal{G}_{\theta_\mathcal{G}}$, $\mathcal{C}$, $\mathcal{M}$, $\mathcal{E}_{max}$, $\mathcal{E}_{wp}$, $g$, $s$, $I$, $r$, $Y$, $|Y|$, $b$\;}
\Comment{Embedding Label using CLIP}
$e_y = \mathcal{C}(Y)$\;
$\mathcal{E} \gets 1$\;
\While{$\mathcal{E} < \mathcal{E}_{max}$}{
    \Comment{Reinitilizing Generator for each $r$ epoches}
    \If{$\mathcal{E} \% r = 0$}{
        $\mathcal{\theta_\mathcal{G}} \gets \mathcal{\theta_\mathcal{G}} \sim N(0, 1)$\;         
    }
    \Comment{Training Generator $\mathcal{G}_{\theta_\mathcal{G}}$}
    \For{$I$ \textit{iterations}}{
            \Comment{Initilizing A Linear Layer Z for each group of samples}
        $\mathcal{Z} = \{\}$\;    
        \For{$b/|Y|$ \textit{iterations}}{
            $\mathcal{Z} \gets \mathcal{Z} \cup Z_{\theta_{Z}} \sim N(0, 1)$\;
        }
        \For{$g$ \textit{iterations}}{
            $V \gets \emptyset$\;
            \ForEach{$Z \in \mathcal{Z}$}{
                $V \gets V$ \textbf{concat} $Z(e_y)$\;
            }
            $\hat{x} = \mathcal{G}(V)$\;
            $\mathcal{L}_{\mathcal{G}} = CE(\mathcal{T}(\hat{x}), Y)-\mathcal{D}(\mathcal{T}(\hat{x}),\mathcal{S}(\hat{x}))$\;
            $\theta_{\mathcal{G}} \gets \theta_{\mathcal{G}} - \alpha_{\mathcal{G}}\nabla_{\theta_\mathcal{G}}\mathcal{L}_{\mathcal{G}}$\;
            \ForEach{$Z \in \mathcal{Z}$}{
                $\theta_{Z} \gets \theta_{Z} - \alpha_{\mathcal{G}}\nabla_{\theta_Z}\mathcal{L}_{\mathcal{G}}$\;
            }
        }
        $\mathcal{M} \gets \mathcal{M} \cup \hat{x}$\;
    }
    \Comment{Training Student $\mathcal{S}_{\theta_\mathcal{S}}$}
    \If{$\mathcal{E} > \mathcal{E}_{wp}$}{
        \For{$s$ \textit{iterations}}{
        $\hat{x} \sim \mathcal{M}$\;
        $\mathcal{L}_{\mathcal{S}} = \mathcal{D}(\mathcal{T}(\hat{x}),\mathcal{S}(\hat{x}))$\;
        $\theta_{\mathcal{S}} \gets \theta_{\mathcal{S}} - \alpha_{\mathcal{S}}\nabla_{\theta_\mathcal{S}}\mathcal{L}_{\mathcal{S}}$\;
    }
    }
    $\mathcal{E} \gets \mathcal{E} + 1$\;
}
\end{algorithm}





\end{document}
