

%version of September 4, 2008

\documentclass{article}
%\documentstyle[12pt]{article}\cite{}
%\usepackage{UTF8}{ctex}
\pdfoutput=1
%\usepackage{ctex}
\usepackage{epstopdf}
\usepackage{graphicx, amssymb, amsmath}
\usepackage{amsthm}
%\usepackage{indentfirst}
\usepackage{mathrsfs}
%\usepackage{amsmath}
%\usepackage{amsfonts}
\usepackage{color}
%\usepackage{graphicx}
%\usepackage{booktabs}
\usepackage{caption}
%\usepackage{amssymb}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{upgreek}
\usepackage{subfigure}
\usepackage{color,soul}
\usepackage[colorlinks,
            linkcolor=blue,
            anchorcolor=blue,
            citecolor=blue]{hyperref}
\usepackage{subfigure}
\usepackage{setspace}
\sethlcolor{blue}
% 设置图片位置
\usepackage{float}
\usepackage{natbib}
\usepackage{diagbox}
%\usepackage{CJK}
\setcitestyle{numbers,square}

% the package"amsthm" can add "." in the end of the "bianhao"

\setlength{\topmargin}{-.6in} \setlength{\oddsidemargin}{0.125in}
\setlength{\textheight}{9.0in} \setlength{\textwidth}{6.25in}
\baselineskip=20pt

\def\u{\parindent=0pt \vskip 1ex}
\def\uu{\parindent=0pt \vskip 0.1ex}
%\def\v{\parindent=0pt \vfill}
\def\w{\noalign{\vskip 1ex}}
\def\k{\kern .5em}
\def\er{\kern .2em}
\def\p{\parindent=20pt}
\def\pz{\parindent=0pt}

\begin{document}
%\begin{CJK}{GBK}{kai}


\date{}
\author{}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\ba}{\begin{array}}
\newcommand{\ea}{\end{array}}
%\newcommand{\bea}{\begin{eqnarray*}}
%\newcommand{\eea}{\end{eqnarray*}}
%\newcommand{\bean}{\begin{eqnarray}}
%\newcommand{\eean}{\end{eqnarray}}
\newcommand{\beas}{\begin{eqnarray*}}
\newcommand{\eeas}{\end{eqnarray*}}
\newcommand{\bea}{\begin{eqnarray}}
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\ome}{\Omega}
%%\newcommand{\lab}{\label}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{remark}{Remark}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{definition}{Definition}[section]
\newtheorem{corollary}{Corollary}[section]
%\newtheorem{algorithm}{Algorithm}[section]

%\newcommand{\bth}{\begin{theorem}}
%\newcommand{\eth}{\end{theorem}}
%\newcommand{\elth}{\end{theorem}}
%\newcommand{\blem}{\begin{lemma}}
%\newcommand{\elem}{\end{lemma}}
%\newcommand{\bprop}{\begin{proposition}}
%\newcommand{\eprop}{\end{proposition}}

\newtheorem{theo}{Theorem}[section]
\newtheorem{lemm}{Lemma}[section]
\newcommand{\blem}{\begin{lemma}}
\newcommand{\elem}{\end{lemma}}
\newcommand{\bthe}{\begin{theorem}}
\newcommand{\ethe}{\end{theorem}}
\newtheorem{prop}{Proposition}[section]
\newcommand{\bprop}{\begin{proposition}}
\newcommand{\eprop}{\end{proposition}}
\newtheorem{defi}{Definition}[section]
\newtheorem{coro}{Corollary}[section]
\newtheorem{algo}{Algorithm}[section]
\newtheorem{rema}{Remark}[section]
\newtheorem{property}{Property}[section]
\newtheorem{assu}{Assumption}[section]
\newtheorem{exam}{Example}[section]


\renewcommand{\theequation}{\arabic{section}.\arabic{equation}}
\renewcommand{\thetheorem}{\arabic{section}.\arabic{theorem}}
\renewcommand{\thelemma}{\arabic{section}.\arabic{lemma}}
\renewcommand{\theproposition}{\arabic{section}.\arabic{proposition}}
\renewcommand{\thedefinition}{\arabic{section}.\arabic{definition}}
\renewcommand{\thecorollary}{\arabic{section}.\arabic{corollary}}
\renewcommand{\thealgorithm}{\arabic{section}.\arabic{algorithm}}
\newcommand{\lan}{\langle}
\newcommand{\curl}{{\bf curl \;}}
\newcommand{\rot}{{\rm curl}}
\newcommand{\grad}{{\bf grad \;}}
\newcommand{\dvg}{{\rm div \,}}
\newcommand{\ran}{\rangle}
\newcommand{\bR}{\mbox{\bf R}}
\newcommand{\bRn}{{\bf R}^3}
\newcommand{\Coinf}{C_0^{\infty}}
%\newcommand{\square}{\hfill$\Box$\vspace{2ex}}
\newcommand{\disp}{\displaystyle}
%\newcommand{\proof}{\vspace{1ex}\noindent{\em Proof}. \ }
\newcommand{\ra}{\rightarrow}
\newcommand{\Ra}{\Rightarrow}
\newcommand{\ud}{u_{\delta}}
\newcommand{\Ed}{E_{\delta}}
\newcommand{\Hd}{H_{\delta}}
\newcommand\varep{\varepsilon}
\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}
% 表格中强制换行
%\renewcommand{\theequation}{\arabic{section}.\arabic{equation}}
\newcommand{\tabincell}[2]{\begin{tabular}{@{}#1@{}}#2\end{tabular}}
%\theoremstyle{plain}\newtheorem{theo}{Theorem}
\title{The Existence the Solution of Nonlinear Discrete Schemes and Convergence of a Linearized Iterative Method for time-dependent PNP Equations}
 %on General Polygonal Meshes}
%\author{\textbf {Ying Yang}
%\thanks{School of  Mathematics and Computational Science, Guangxi Colleges and Universities Key Laboratory of Data Analysis and Computation, Guilin University of Electronic Technology, Guilin, 541004, Guangxi, P.R. China. E-mail: yangying@lsec.cc.ac.cn}}
%\author{\textbf {Ying Yang}
%\affiliation{School of  Mathematics and Computational Science, Guangxi Colleges and Universities Key Laboratory of Data Analysis and Computation, Guilin University of Electronic Technology, Guilin, 541004, Guangxi, P.R. China. E-mail: yangying@lsec.cc.ac.cn}}
%作者
\author{*
	\and *
	\and *
}
%\author{Ying Yang $^{1}$
%	\and Ya Liu $^2$
%	\and Yang Liu $^3$
%	\and Shi Shu $^{3,*}$
%     }
\author{Yang Liu $^{1}$
	\and Shi Shu $^{2,*}$
%	\and Huayi Wei $^3$
	\and Ying Yang $^{3}$
}
\footnotetext[1]
{School of Mathematics and Computational Science, Xiangtan University,
	Xiangtan, 411105, P.R. China. E-mail: liuyang@smail.xtu.edu.cn
}

\footnotetext[2]
{$^{*}$\textbf{Corresponding author.} School of Mathematics and Computational Science, Xiangtan University,
	Xiangtan, 411105, P.R. China. E-mail: shushi@xtu.edu.cn }

\footnotetext[3]
{School of  Mathematics and Computational Science, Guangxi Colleges and Universities Key Laboratory of Data Analysis and Computation, Guangxi Applied Mathematics Center (GUET), Guilin University of Electronic Technology, Guilin, 541004, Guangxi, P.R. China. E-mail: yangying@lsec.cc.ac.cn }
%
%\footnotetext[2]
%{School of Mathematics and Computational Science, Guilin University of Electronic Technology, Guilin, 541004, Guangxi, P.R. China. E-mail: 979504374@qq.com }
%
% }
%%
%%
%\footnotetext[3]
%{$^{*}$\textbf{Corresponding author.} School of Mathematics and Computational Science, Xiangtan University,
%	Xiangtan, 411105, P.R. China. E-mail: shushi@xtu.edu.cn }

%\date{Received: date / Accepted: date}
\maketitle

\noindent
{\bf Abstract}\quad 
%We establish the existence theory of several commonly used finite element (FE) nonlinear fully discrete solutions, and the convergence theory of a linearized iteration. First, it is shown for standard FE, SUPG and edge-averaged method respectively that the stiffness matrix is a column M-matrix under certain conditions, and then the existence theory of these three FE nonlinear fully discrete solutions is presented by using Brouwer's fixed point theorem.
% Second, the contraction of a commonly used linearized iterative method, Gummel iteration, has been proven, and then the convergence theory is established for the iteration. At last, a numerical experiment is shown to verifies the theories.
We establish the existence theory of several commonly used finite element (FE) nonlinear fully discrete solutions, and the convergence theory of a linearized iteration. First, it is shown for standard FE, SUPG and edge-averaged method respectively that the stiffness matrix is a column M-matrix under certain conditions, and then the existence theory of these three FE nonlinear fully discrete solutions is presented by using Brouwer's fixed point theorem.
Second, the contraction of a commonly used linearized iterative method--Gummel iteration is proven, and then the convergence theory is established for the iteration. At last, a numerical experiment is shown to verifies the theories.

\noindent
{\bf Keywords}:  Poisson-Nernst-Planck equations, finite element method, Gummel iteration, existence theory and convergence theory, SUPG method, edge-averaged method

\noindent
{\bf AMS(2000) subject classifications}\quad 65N15, 65N30.


\section{Introduction}\label{sec1}
\noindent

% The virtual element method (VEM) could be seen as a deformation of the classical mimetic finite difference method,  %\cite{Brezzi2005Convergence, Brezzi2008Mimetic},
\vskip 0.3cm
The Poisson-Nernst-Planck (PNP) equations, which are coupled by the Poisson equation and the Nernst-Planck equation, were first proposed by Nernst \cite{nernst1889elektromotorische} and Planck \cite{planck1890ueber}. They are often used to describe the ion mass conservation and electrostatic diffusion reaction process, and have been widely used in the numerical simulations of biological ion channel \cite{tu2013parallel,wang2021stabilized,eisenberg1998ionic,singer2009poisson}, semiconductor devices \cite{markowich1985stationary,van1950theory,brezzi2005discretization,miller1999application}, and nanopore systems \cite{xu2018time,daiguji2004ion}.

Due to the strong coupling and nonlinearity, it is difficult to find the analytic solution except a few cases. The finite element (FE) method has been applied to solve PNP equations and is popular since it is flexible and adaptable in dealing with the irregular interface. Comparing with the plenty of work in the FE computation of PNP equations (see e.g. \cite{J.W.Jerome1991, lu2007electrodiffusion, lu2010poisson, xie2020effective,  zhang2022class}) , the theoretical analysis of FE method seems limited, especially for the existence of the discrete solution. Prohl and Schmuck \cite{prohl2009convergent} propose two classes of FE schemes for the time-dependent PNP equations and show the existence and uniqueness, and convergence of the FE solutions. In recently years, some work on error analyis has been appeared for the FE solution of PNP equations. For example, Yang and Lu  \cite{yang2013error} presented some error bounds for a piecewise FE approximation to the steady-state practical PNP problems and gave serveral numerical examples including biomolecular problems to support the analyisis. The a priori error estimates of both semi- and fully discrete FE approximation for time-dependent PNP equations are presented in \cite{sun2016error}, in which the optimal convergence order in $L^{\infty}(H^1)$ and $L^2(H^1)$ norms are obtained with a linear element FE discretization. The error estimates in $H^1$ norms for the FE approximation to the nonlinear PNP equations are shown in \cite{yang2020superconvergent}. The superconvergence results are also presented for this model by using the gradient recovery technique, which are successfully applied to improve the efficiency of the Gummel iteration for a practical ion channel problem. Recently, a generilized FE method--virtual element method is applied to solve PNP equations on arbitrary polygons or polyhedrons, the error estimates of which are shown in \cite{liu22, degh23}.
% Due to the strong coupling, strong convection dominance, nonlinearity, and multiscale characteristics of PNP practical problems, it is difficult to construct numerical methods with good approximation, stability, and efficiency.
\vskip 0.3cm
There exist problems such as the poor stability or the bad approximation when using standard FE method to discretize pratical PNP equations. Therefore, some improved FE methods have emerged. The SUPG method is applied  to a class of modified PNP equations in ion channel in \cite{tu2015stabilized} to improve the robustness and stability of the standard FE algorithm. A new stable FE method--SUPG-IP was proposed in \cite{SUPG-IP} for the steady-state PNP equations in ion channel, which has better robustness than the standard~FE and~SUPG methods. The inverse average finite element method was constructed for a class of steady-state PNP equations in nanopore systems in \cite{zhang2021inverse}, which effectively solves the problems of non physical pseudo oscillations caused by convection dominance. In \cite{zhang2022class}, four FE methods with averaging techniques were used to discrete
steady-state PNP equations in semiconductor, which is more stable than standard FE method.
Although these improved FE method have show good efficiency in the computation of PNP equations, the theoretical analysis for the discrete solution is very limited. To our knowedege, there is no theoretical result for the existence of the discrete solution for the improved FE method.

%In this paper, one of the main contributions is that the existence theory of the solution to a type of FE the nonlinear discrete system
% is established for the time-dependent PNP equations. The type of FE schemes includes three commonly used one: standard FE, SUPG, and edge-averaged finite element (EAFE) schemes, the discrete systems of which have a unified expression form.
%%(see (\ref{{EAFE-non-2}})).
%It is shown that the solution of the nonlinear discrete system exists whenever it satisfies two assumptions: one is that the coefficient matrix is a column M-matrix; another is the intial value of ion concentrations at nodes are positive. We strictly prove that these two assumptions can be satisfied by the three FE schemes under certain weak assumptions for the meshes. To establish the existence theory of the solution, a suitable compact convex set needs to be constructed, and Brouwer fixed point theorem and mathematical induction are also applied.

In this paper, one of the main contributions is that the existence theory of the solution to a type of FE nonlinear discrete system
is established for the time-dependent PNP equations. The type of FE schemes includes three commonly used one: standard FE, SUPG, and edge-averaged finite element (EAFE) schemes, the nonlinear discrete systems of which have a unified expression form. We strictly prove that the coefficient matrix of the unified discrete system is a column M-matrix under certain weak conditions.  
%(see (\ref{{EAFE-non-2}})).
%It is shown that the solution of the nonlinear discrete system exists whenever it satisfies two assumptions: one is that the coefficient matrix is a column M-matrix; another is the intial value of ion concentrations at nodes are positive. We strictly prove that these two assumptions can be satisfied by the three FE schemes under certain weak assumptions for the meshes. 
To establish the existence theory of the solution, a suitable compact convex set needs to be careful constructed, and Brouwer fixed point theorem and mathematical induction are also applied.


\vskip 0.3cm
The above nonlinear discrete systems are usually linearized by iterative methods such as~Gummel or~Newton iteration. For example, in \cite{mathur2009multigrid}, the Newton linearization is used for the adaptive finite volume discrete system of PNP equation on unstructured grid.
% In \cite{bousquet2018newton},  a fast FGMRES algorithm is designed based on a block upper triangular preconditioner for the edge average finite element (EAFE) scheme of the Newton linearized PDEs of the PNP and Navier-Stokes coupled system, in which the~PNP subsystem is solved using the~PGMRES based on the~UA-AMG preconditioner.
% For a class of PNP equation in biological ion channel, special techniques are used to deal with the singular charges in \cite{zheng2011second}, and a global second-order finite difference method is proposed, and then the SOR acceleration method is used to solve the nonlinear system.
 Xie and Lu \cite{xie2020effective} use the Slotboom transformation to transform the PNP equations with periodic boundary conditions into equivalent equations, and give an acceleration method for the Gummel iteration. In this paper, we present the Gummel iteration for the time-dependent PNP equations based on the EAFE scheme. The contraction and convergence theories are established for this iteration, which is another main constribution in this paper. The results of the contraction and convergence theories can be easily generalized to other linearized iterations such as Newton iteration. Since PNP equations are a strong nonlinear coupled system, the analysis to the solution of iteration needs careful treatment of the special nonlinear term.

 The rest of this paper is organized as follows. In Section 2, we introduce the time-dependent PNP equations and three commonly used FE descrete schemes. In Section 3, first we present the corresponding nonlinear discrete algebraic system for the three FE schems. Then, we show the existence of the solutions to the three FE nonlinear fully discrete schemes. After that, we present the Gummel iteration combining with EAFE scheme and estiblish the contraction and convergence theories for the iteration. A numerical example is also reported in this section to verifies the contraction and convergence theories for the Gummel iteration. Finally, some conclusions are made in Section 4.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% There is another kind of method at present, whose basic idea is based on the two-grid method \cite{jin2006two}, which essentially converts the nonlinear discrete system on the fine grid into the nonlinear system on the coarse grid. Shen et. al. \cite{shen2020decoupling} propose a two-grid FE method for a class of time-dependent PNP equations. Based on the optimal $L^2$ norm error estimates of the derived discrete scheme, the~$H^1$ norm error estimates are presented. Comparative experiments with Gummel iteration show that the new method has higher computational efficiency. Ying et. al. \cite{ying2021new} aims at the two-grid FE method of the~SUPG scheme for the three-dimensional steady-state~PNP equations in biological ion channel, in which the Krylov iterative method based on the block Gauss-Seidel preconditioner is designed for the Newton linearized system on the coarse grid, and it is proved that the condition number of the preconditioned system is independent of the mesh size under certain assumptions. It should be pointed out that although the above geometric two-grid method has higher computational efficiency than Gummel or Newton iterative method for some discrete systems of PNP equations, it may encounter many difficulties when the method is applied to solve complex practical PNP problems. For example, the accuracy of the approximation depends on the coarsening rate. Due to factors such as low smoothness of the solution, the coarsening rate cannot be too large, which affects the acceleration effect. In addition, complex meshes generated by professional/commercial softwares are usually difficult to meet the requirements of geometric two-grid method for nested meshes. Therefore, further research is needed on fast algorithms for PNP large-scale discrete systems.

 \vskip 0.3cm
%% In this paper, we mainly study the fast algorithm of the PNP discrete system in semiconductor devices. For the PNP equations in this field, the high voltage applied to the electrode and the discontinuous doping concentration (doping concentration can change from a maximum positive value in one region to a maximum negative value in another region) can cause a strong electric field (\cite{miller1999application,SUPG-IP}). It is usually necessary to transform the original problem into an equivalent model without dimensionality in practical calculation (cf. \cite{miller1999application}). The large size of semiconductor devices and the strong electric field brought by the original problem after dimensionless can lead to strong convection dominated characteristics of the PNP equations, which is one of the main difficulties in numerical calculations. We discuss fast algorithms for PNP equations from two perspectives in this paper. First, we study linearized methods for nonlinear discrete systems. The efficiency of standard FE and EAFE discrete methods is studied and compared for the characteristics of strong coupling, strong convection dominance, and strong nonlinearity of PNP equations. The Gummel iteration algorithm of the discrete methods based on AMG is then proposed. The convergence analysis of the Gummel iteration of EAFE is provided for a class of time-dependent PNP equations. The theoretical results show that if the time step is sufficiently large, the $L^2 $ norm error of this iterative algorithm converges and reaches the optimal order. We also designed several acceleration techniques to improve the convergence efficiency of the iterative algorithm. Numerical experiments have shown.. Second, we study the direct solution of nonlinear systems. We design the Full approximation scheme (FAS) algorithm from both geometric and algebraic perspectives, and combine it with the Newton-Picard iterative algorithm to accelerate the efficiency of the decoupled external iteration of PNP equations. Especially for the algebraic FAS algorithm, there is no need to generate nested grids, which is conducive to the application of the algorithm in practical problems. Numerical experiments have shown that the algebraic FAS method applied to a class of PNP equations in the semiconductor field can not only improve the efficiency of decoupling external iteration, but also expand the solvable area of the problem, compared with the classical Gummel iterative of FE method, which reflecting the effectiveness of this algorithm in solving strong coupling, convection dominance, and nonlinearity of PNP equations. It should be pointed out that this paper mainly studies the fast algorithms for the discrete system of PNP equations of semiconductor devices, but these algorithms can be applied to the fast solution of PNP equations in other fields (such as biological ion channel and nanopore systems without essentially modification.

\setcounter{lemma}{0}
\setcounter{theorem}{0}
\setcounter{corollary}{0}
\setcounter{equation}{0}
\setcounter{remark}{0}
\section{ The continuous and discrete problems}
%In this section, we introduce the time-dependent PNP equations and discuss the semi-discrete virtual element discretization.
Let $\Omega \subset \mathbb{R}^{d}$ $(d=2,3)$ be a bounded Lipschitz domain. We adopt the standard notations for Sobolev spaces $W^{s,p}(\Omega)$ and
their associated norms and seminorms. For $p=2$, denote by
$H^{s}(\Omega)=W^{s,2}(\Omega)$ and $H_0^1(\Omega)=\{v\in H^{1}(\Omega):v|_{\partial\Omega}=0\}$. For simplicity, let $\|\cdot\|_{s}=\|\cdot\|_{W^{s,2}(\Omega)}$ and $\|\cdot\|=\|\cdot\|_{L^2(\Omega)}$. We use $(\cdot,\cdot)$ to denote the standard $L^{2}$-inner product.
%\vspace{3mm}
\vspace{3mm}
\subsection{PNP equations}
 %Introduce the time-dependent PNP equations and steady-state PNP equations, and the weak forms for the two PNP equations.

 Consider the following time-dependent PNP equations (cf. \cite{shen2020decoupling})
 %\begin{eqnarray} \label{wpnp1}
 \begin{equation}\label{pnp equation}
 \left\{\begin{array}{lr}
 -\Delta\phi-\sum\limits^{2}_{i=1}q^{i}p^{i}=f, & \text { in } \Omega,~\text{for}~t\in(0, T], \vspace{1mm}\\
 {\partial_t p^{i}}-\nabla\cdot(\nabla{p^{i}}+ q^{i}p^{i}\nabla\phi)=F^i, & \text { in } \Omega,~\text{for}~t\in(0, T], i=1,2,\vspace{1mm}
 %p^i(\cdot,0)=p^i_{0},~~\phi(\cdot,0)=\phi_0, & \text { in } \Omega,
 \end{array}\right.
 \end{equation}
 with the homogeneous Dirichlet boundary conditions
 \begin{equation}\label{boundary}
 \left\{
 \begin{array}{l}
 \;\phi=0,\;\text{on}\;\partial\Omega,~\text{for}~t\in(0, T],\vspace{0.5mm}\\
 \;p^i=0,\;\text{on}\;\partial\Omega,~\text{for}~t\in(0, T],  i=1,2,
 %\;\varepsilon_{m}\;\;\;if  & \text{$x\epsilon\Omega_{m}$}, \\
 %\;\varepsilon_{s}\;\;\;if      & \text{$x\epsilon\Omega_{s}$},
 \end{array}
 \right.
 \end{equation}
 %\end{eqnarray*}
 where  $p^i,~i=1,2$ represents the concentration of the $i$-th ionic species, $p_t^{i}=\frac{\partial p^i}{\partial t}$, $\phi$ denotes the electrostatic potential, the constant $q^i$ is the charge of the species $i$, and $f$ and $F^{i}$ are the reaction source terms. Denote the initial concentrations and potential by $p^{i}_0,~\phi_{0},~i=1,2$.

% The corresponding steady-state PNP equations is as follows (cf. \cite{liu2021virtual})
% \begin{equation}\label{statPNP}
% \left\{\begin{array}{lr}
% -\Delta\phi-\sum\limits^{2}_{i=1}q^{i}p^{i}=f, & \text { in } \Omega, \vspace{1mm}\\
% -\nabla\cdot(\nabla{p^{i}}+ q^{i}p^{i}\nabla\phi)=F^i, & \text { in } \Omega,~ i=1,2.\vspace{1mm}
% %p^i(\cdot,0)=p^i_{0},~~\phi(\cdot,0)=\phi_0, & \text { in } \Omega.
% \end{array}\right.
% \end{equation}

 The weak formulation of (\ref{pnp equation})-(\ref{boundary}) is that:
 find $p^i\in L^2(0,T;H_0^1(\Omega))\cap L^{\infty}(0,T;L^{\infty}(\Omega))$, $i=1,2$, and $\phi(t)\in H_0^1(\Omega)$ such that
 \begin{eqnarray}
 \label{weak1con}
 (\nabla\phi,\nabla w)-\sum\limits^{2}_{i=1}q^{i}(p^{i},w)=(f,w),~~\forall w\in H_0^1(\Omega), \\
 \label{weak2con}
 (\partial_tp^i,v)+(\nabla{p^{i}},\nabla v)+ (q^{i}p^{i}\nabla\phi,
 \nabla v)=(F^i,v), ~~\forall v\in H_0^1(\Omega), ~i=1,2.
 \end{eqnarray}
% and find $p^i  \in H_0^1 (\Omega ),~i = 1,2$ and $ \phi  \in H_0^1 (\Omega )$ such that
% \begin{eqnarray}
% \label{statweak1con}
% (\nabla\phi,\nabla w)-\sum\limits^{2}_{i=1}q^{i}(p^{i},w)=(f,w),~~\forall w\in H_0^1(\Omega), \\
% \label{statweak2con}
% (\nabla{p^{i}},\nabla v)+ (q^{i}p^{i}\nabla\phi,
% \nabla v)=(F^i,v), ~~\forall v\in H_0^1(\Omega), ~i=1,2,
% \end{eqnarray}
% respectively.

  %{
  The existence and uniqueness of the solutious to (\ref{weak1con})-(\ref{weak2con}) have been presented in \cite{gajewski1986basic} for $F^i=R(p^1,p^2)=r(p^1,p^2)(1-p^1p^2)$.
  	%In this case, the system (\ref{pnp equation})-(\ref{boundary}) governs the transport of mobile carriers in a semiconductor device,
  	Here $p^1,~p^2$ represent the densities of mobile holes and electrons respectively in a semiconductor device and $R(p^1,p^2)$ is the net recombination rate (see \cite{gajewski1986basic}). The function $r: R_+^2\rightarrow R_+$ are required to be Lipschitzian and $p^1,~p^2\in W^{0,\infty}(\Omega)$.

 \subsection{Three discrete schemes}
%Introduce the FE semi- and fully discrete scheme for time-dependent PNP equations (cite references), and present the semi- and fully EAFE schemes
 %for the same PNP equations, respectively.
In this subsection, we introduce three commonly used FE schemes for PNP equations including standard FE, SUPG  and EAFE schemes.

 Suppose $\mathcal{T}_h = \{ K \}$ is a  partition of $\Omega$, where $K$ is the element and $h=\max\limits_{K\in\mathcal{T}_h} \{h_K\}$, $h_K=\mbox{diam}~K$. Define the linear finite element space as follows
 \begin{eqnarray}
 V_h =\{v \in H^1(\Omega): v|_{\partial\Omega}=0~\mbox{and}~v|_K \in \mathcal{P}_1(K), ~~\forall K\in \mathcal{T}_h\},
 \end{eqnarray}
 where $\mathcal{P}_1(K)$
 denotes the set of all polynomials with the degree no more then $1$ on the element $K$.  Denote the set of basis function vector in $V_h$ by
 \begin{eqnarray}\label{Psi}
 \Psi=(\psi_{1},\ldots,\psi_{{n_h}}),
 \end{eqnarray}
where ${n_h}=\dim(V_h )$.

  The standard semi-discrete finite element formulation corresponding to \eqref{weak1con}-\eqref{weak2con} is as follows: find $p^{i}_h,~i=1,2$ and $\phi_h\in V_h$, such that
 \begin{eqnarray}
 \label{semiweak2}
 (\nabla\phi_h,\nabla w_h)-\sum\limits^{2}_{i=1}q^{i}(p^{i}_h,w_h)=(f,w_h),~~\forall w_h\in V_h, \\
 \label{semiweak1}
(\partial_tp^i_h,v_h)+(\nabla{p^{i}_h},\nabla v_h)+ (q^{i}p^{i}_h\nabla\phi_h,
 \nabla v_h)=(F^i,v_h), ~~\forall v_h\in V_h,~i=1,2.
 \end{eqnarray}

 In order to present the full discretization of (\ref{pnp equation})-\eqref{boundary},
 define a partition $0<t^0<t^1<\cdots t^N=T$ with time step $\tau=\max\{t^n-t^{n-1},n=1,2,\cdots N\}$. Also for any $u$, denote by
 \begin{align*}
 u^n({\bf x})=u({\bf x},t^n)
 \end{align*}
 and
 $$D_\tau u^{n+1} =\frac{u^{n+1}-u^{n}} { \tau} , ~\mbox{for}~ n=0,1,2,\cdots,N-1.$$
%For simplicity, the superscript $n+1$ is omitted below.及相应的代数系统
Next three common used linear finite element discretizations are introduced. First, the fully discrete FE approximation for  (\ref{pnp equation})-\eqref{boundary} is: find
$p_h^{i,n+1}\in V_h,~i=1,2$ and $\phi_h^{n+1}\in V_h$, such that
{\small
\begin{align} \label{fulldis2-FEM}
 (\nabla\phi_h^{n+1},\nabla w_h)-\sum\limits_{i = 1}^2 q^i(p_h^{i,n+1},w_h)
 &= (f^{n+1 },w_h),  \forall w_h\in V_h,\\\label{fulldis-FEM}
 (D_\tau p_h^{i,n+1},v_h)+(\nabla p_h^{i,n+1},\nabla v_h)+(q^ip_h^{i,n+1}\nabla\phi^{n+1}_h,\nabla v_h)
 &= (F^{i,n+1},v_h), \forall v_h\in V_h,
 \end{align}}
where $f^{n+1 }=f (t^{n+1},\cdot)  $, $F^{i,n+1}=F^i(t^{n+1},\cdot),~i=1,2$.

Note that the accurate solution to convection dominated equations often has internal or exponential boundary layers, and the SUPG scheme is a commonly used numerical method to overcome numerical oscillations caused by the boundary layers. The fully discrete SUPG scheme for (\ref{pnp equation})-\eqref{boundary} is as follows:
%\textsuperscript{\cite{de2014adaptive}}:
find $p_h^{i,n+1}\in V_h,~i=1,2$ and~$\phi_h^{n+1}\in V_h$, such that
{%\footnotesize%
	%\small
	\begin{eqnarray} \label{fulldis-SUPG-temp}
	&& (\nabla\phi^{n+1}_h,\nabla w_h)-\sum\limits_{i = 1}^2 q^i(p_h^{i,n+1},w_h)
	= (f^{n+1 },w_h),~\forall w_h\in V_h ,
	\\ \notag
	%\end{eqnarray}%\\ \notag&+&
	%{\footnotesize
	%%\small
	%\begin{eqnarray} \notag
	&&(D_\tau p_h^{i,n+1},v_h)+(\nabla{p_h^{i,n+1}},\nabla v)+ (q^{i}p_h^{i,n+1}\nabla\phi_h^{n+1},
	\nabla v_h) \\&+&\sum\limits_{K\in \mathcal T_{h }}(-\nabla\cdot(\nabla{p_h^{i,n+1}}
	+ q^{i}p_h^{i,n+1}\nabla\phi_h^{n+1}),-q^i C_K(x)  \nabla {\phi}_h^{n+1} \cdot \nabla v_h )_K\notag\\&=&(F^{i,n+1},v_h)+\sum\limits_{K\in \mathcal T_{h}}(F^{i,n+1}-D_\tau p_h^{i,n+1},-q^i C_K(x) \nabla {\phi}_h^{n+1}\cdot \nabla v_h  )_K,~\forall v_h\in V_h,
	\label{fulldis2-SUPG-temp}
	\end{eqnarray}}
where
$C_K(x)=\left\{\begin{array}{ll}
\frac{\tilde \tau h_K }{2\| {q^i\nabla \phi^{n+1}_h}\|_{L^{\infty}( K)}}, & \mbox { if} ~P_{K} \geq 1, ~\\
\frac{\tilde \tau h_K ^{2}}{4  }, & \mbox {if } ~P_{K}<1, ~
\end{array}\right. \forall  x \in K$,
with $P_{K}=\frac{h_K \| {q^i\nabla \phi_h^{n+1}}\|_{L^{\infty}(K)}}{2 }$. Here {%\small%\footnotesize
$\sum\limits_{K\in \mathcal T_{h }}(-\nabla\cdot(\nabla{p_h^{i,n+1}}+ q^{i}p_h^{i,n+1}\nabla\phi^{n+1}_h),-q^i C_K(x)  \nabla {\phi}_h^{n+1} \cdot \nabla v_h )_K$} and {%\small %\footnotesize
$\sum\limits_{K\in \mathcal T_{h}}(F^{i,n+1}-D_\tau p_h^{i,n+1},-q^i C_K(x) \nabla {\phi}_h^{n+1}\cdot \nabla v_h  )_K$} are stabilization term. Since $\nabla\cdot (\nabla p_h ^{i,n+1})=0$ and $ \nabla\cdot(\nabla\phi_h^{n+1} )=0$ for linear element discretization, the equations ~\eqref{fulldis-SUPG-temp}-\eqref{fulldis2-SUPG-temp} can be written as
{\small%\footnotesize
	\begin{eqnarray} \label{fulldis-SUPG}
	&& (\nabla\phi_h^{n+1},\nabla w_h)-\sum\limits_{i = 1}^2 q^i(p_h^{i,n+1},w_h)
	=   (f^{n+1},w_h),~\forall w_h\in V_h ,\\\notag
	&&(D_\tau p_h^{i,n+1},v_h)+(\nabla{p_h^{i,n+1}},\nabla v)+ (q^{i}p_h^{i,n+1}\nabla\phi_h^{n+1},
	\nabla v_h)+\sum\limits_{K\in \mathcal T_{h }}(-  q^{i}\nabla p_h^{i,n+1}\cdot \nabla\phi_h^{n+1} ,-q^i C_K(x)  \nabla {\phi}^{n+1}_h \cdot \nabla v_h )_K\\&=&(F^{i,n+1},v_h)+\sum\limits_{K\in \mathcal T_{h}}(F^{i,n+1}-D_\tau p_h^{i,n+1},-q^i C_K(x) \nabla {\phi}^{n+1}_h\cdot \nabla v_h  )_K,~\forall v_h\in V_h.\label{fulldis2-SUPG}
	\end{eqnarray}}

% The standard FE method works not well for the PNP equations with strong convertion dominated character, which often appeared in semiconductor area.

 Another commonly used method to deal with
 dominated convection is EAFE method. It has been used to solve NP equations (cf. \cite{zhang2021inverse}).
  In order to present the EAFE scheme for PNP equations, for any element $K$ with the given number $k$, suppose $E$ is the edge with the endpoints $x_{k_\nu}$ and $x_{k_\mu}$, where ${k_\nu}$ is the whole number corresponding to the local number $\nu$. Let $\tau_E= x_{k_\nu}-x_{k_\mu},~{k_\nu} <{k_\mu} $ for any $E$ in $\mathcal T_h$.

% and define the function $\psi^i_E,i=1,2$ satisfies
% \begin{equation}
% \label{[1](3.7)'}\frac{\partial\psi^i_E}{\partial\tau_E}=\frac{1}{|\tau_E|}\alpha^
% {-1}(\bm\beta^i\cdot\tau_E),~~i=1,2,
% \end{equation}
% where $\alpha=1$ and $\bm\beta^i =q^i\nabla \phi,$ are the diffusion and convection coefficients in \eqref{pnp equation}.  的浓度方程中的扩散系数和对流系数.

 The EAFE fully discrete scheme for PNP equations are as follows: find
 $p_h^{i,n+1}\in V_h ,~ i=1,2$ and $\phi_h^{n+1}\in V_h $, satisfying
{\small \begin{align}
 \label{fulldis2-EAFE}
(\nabla\phi_h^{n+1},\nabla w_h)&-\sum\limits_{i = 1}^2 q^i(p_h^{i,n+1},w_h)
=   (f^{n+1 },w_h),~\forall w_h\in V_h ,\\
(D_\tau p_h^{i,n+1},v_h)+ & \sum\limits_{K\in \mathcal{T}_{h}}[\sum\limits_{E\subset K}\omega_E^K\tilde{\alpha}^{K,i}_{E}(\phi_h^{n+1})\delta_E(e^{q^i\phi_h^{n+1}}p_h^{i,n+1})\delta_Ev_{h}]
 =  \sum\limits_{K\in \mathcal{T}_{h}}(F^{i,n+1},v_h)_K,  ~\forall v_h\in V_h , \label{fulldis-EAFE}
 \end{align}}
 where
{\small\begin{equation}\label{omega}
 	\tilde{\alpha}^{K,i}_{E }(\phi_h )=\left(\frac{1}{|\tau_{E }|}\int_{E } e^{q^i\phi _h}\mathrm{d}s\right)^{-1},~
 	\omega_{E }^K  :=\omega_{E_{\nu \mu }}^K  =-(\nabla \psi_{k_\mu},\nabla \psi_{k_\nu})_K ,~\delta_{E }( u)=  u_{k_\nu}- u_{k_\mu}, ~ u=e^{q^i\phi_h }p_h^{i}.
\end{equation}}


We have introduced PNP equations and three commonly used FE discretizations. In next section, we present the existence of the solutions to the three FE schemes and the converence analysis for a linearized iteration.
 %Gummel iteration is one of most commonly used iteration for solving PNP equations. We present the Gummel iteation of EAFE scheme.

% \begin{algorithm}[!ht]
% 	\caption{Gummel iteration}
% 	\label{gummalgo}
% 	%\begin{algorithmic}[0]
% 	Step 1. Give the initial value $(P_h^{1,n},P_h^{2,n},\Phi_h^n)\in [V_h]^3$, let $(P_h^{1,0}, P_h^{2,0},\Phi_h^{0})$ $=(P_h^{1,n},P_h^{2,n},\Phi_h^n)$ as $l=0$.\\
% 	Step 2. For $l\geq 0$, compute $(P_h^{1,l+1}, P_h^{2,l+1},\Phi_h^{l+1})\in [V_h]^3$, such that for any $v_{h}$ and $ w_h\in V_h$,
% 	\begin{align}\label{gumm1}
% 	&(\nabla\Phi_h^{l+1},\nabla w_h)-\sum\limits^{2}_{i=1}q^{i}(P^{i,l}_h,w_h)=(F_3,w_h),
% 	\\ \label{gumm2}
% 	&\frac 1 {\tau}(P_h^{i,l+1},v_h)+ \sum\limits_{K\in \mathcal{T}_{h}}[\sum\limits_{E\subset K}\omega_E^K\tilde{\alpha}^{K,i}_{E}(\Phi_h^{l+1}\delta_E(e^{q^i\Phi_h^{l+1}}P_h^{i,l+1})\delta_Ev_{h}]
% 	=(F_i,v_h)+\frac 1 {\tau}(P^{i,n}_h,v_h) ,~i=1,2 .
% 	\end{align}
% 	
% 	Step 3. For a given tolerance $\epsilon$, stop the iteration if
% 	\begin{align*}\|P_h^{1,l+1}-P_h^{1,l}\|+\|P_h^{2,l+1}-P_h^{2,l}\|+
% 	\|\Phi_h^{l+1}-\Phi_h^{l}\|\leq\epsilon,
% 	\end{align*}
% 	and set $(P_h^{1},P_h^{2},\Phi_h)=(P_h^{1,l+1},
% 	P_h^{2,l+1},\Phi_h^{l+1})$. Otherwise set $l\leftarrow l+1$ and goto Step 2 to continue the nonlinear iteration.
% 	%\end{algorithmic}
% \end{algorithm}


% In next section, we shall discuss the convergence analysis of the Gummel iteation of EAFE scheme. First, we present the existence of the fully discrete solution of
% EAFE scheme. Then, we show the contraction property of the iteration, which is the main theoretical result of this paper.

 \setcounter{lemma}{0}
 \setcounter{theorem}{0}
 \setcounter{corollary}{0}
 \setcounter{equation}{0}
  \section{The existence of the discrete solution and the convergence analysis of the Gummel iteration }
 %\section{The convergence analysis of Gummel iteration of EAFE scheme}
 In this section, first we give the nonlinear algebraic system for the fully discrete FE schemes, then establish the theory of the existence of the solution to the schemes. After that, we present the contraction and convergence theories of a linearized iteration.

 \subsection{The existence of the fully discrete solution}
 %of EAFE scheme}

 %Present the matrix form the fully discrete EAFE schem (see (2.5) and (2.13) in Liu Yang's manuscript)

 Note that the linear finite element basis function $\phi_h$ on element $K$ can be expressed as
 \begin{equation}\label{phihEi}
\phi_h|_E =\sum_{m=1}^4\Phi_{k_m}\lambda^K_m= \lambda^K  \Phi_K,
\end{equation}
 where $ \lambda^K =(\lambda^K_1,\lambda^K_2,\lambda^K_3,\lambda^K_4)$ and $ \Phi_K=(\Phi_{k_1},\Phi_{k_2},\Phi_{k_3},\Phi_{k_4})^T $ are the volume coordinate vector and degree of freedom vector of element K.


 Assume $n_h$ dimensional vectors
 \begin{equation}\label{def-PhiG3}
% \Phi=(\Phi_1,\ldots,\Phi_{n_h})^T,\quad G^3=((F_3,\psi_1),\ldots,(F_3,\psi_{n_h}))^T,
 \Phi^{n+1}=(\Phi^{n+1}_1,\ldots,\Phi^{n+1}_{n_h})^T,\quad G_\Phi^{n+1}=((f^{n+1 },\psi_1),\ldots,(f^{n+1 },\psi_{n_h}))^T,
 \end{equation}
 and $2n_h$ dimensional vectors
 \begin{equation}\label{def-Pn}
P^\mu=
\begin{pmatrix}
 P^{1,\mu}\\
P^{2,\mu}
\end{pmatrix}
,~~
P^{i,\mu}=(p^{i,\mu}_1,\ldots,p^{i,\mu}_{n_h})^T,~\mu=n,n+1,~ i=1,2,
\end{equation}
{\small
\begin{equation}\label{def-PG}
G^{n+1}=
\begin{pmatrix}
 G^{1,n+1}\\
G^{2,n+1}
\end{pmatrix},~ G^{i ,n+1}=(g^{i ,n+1}_1,\ldots,g^{i ,n+1}_{n_h})=((F^{i ,n+1},\psi_1),\ldots,(F^{i,n+1},\psi_{n_h}))^T,~ i=1,2,
\end{equation}}
$n_h\times 2n_h$ lumped mass matrix
\begin{equation}  \label{C4-M-def}
\bar M =-(q^1M,q^2 M), ~ M=\frac{1}{4}\textrm{diag}(|\Omega_1|,\cdots ,|\Omega_{n_h}|), ~ \Omega_k=supp(\psi_k),~k=1,\ldots,{n_h},
\end{equation}
and $n_h\times n_h$ stiff matrix
\begin{equation}  \label{C4-AL-def}
A_L=(  \nabla\Psi^T,\nabla \Psi).
\end{equation}
Then the corresponding nonlinear algebraic equation for \eqref{fulldis2-FEM}-\eqref{fulldis-FEM} is
%\small
\begin{eqnarray}\label{FEM-non}
A_h^{1}(U_h^{1})U_h^{1} =F_h^1.
\end{eqnarray}
Here the coefficient matrix $A_h^{1}(U_h^{1})$, solution vector~$U_h^{1} $ and right hand vector~$F_h^1$ are respectively as follows
\begin{eqnarray}\label{FEM-non-AFU}
A_h^{1}(U_h^{1})=\left(
  \begin{array}{cc}
    A_L& \bar M \\
   \bf 0    &  {\bf M} + \tau \bar A^1(\Phi^{n+1}) \\
  \end{array}
\right)
,~U_h^{1}=\left(
  \begin{array}{c}
     \Phi^{n+1,1}\\P^{ n+1,1}
  \end{array}
\right),~F_h^{1}=\left(
  \begin{array}{c}
    G_\Phi^{n+1} \\
    F^{ n,1}
  \end{array}
\right),
\end{eqnarray}
where~$2n_h\times 2n_h$ lumped mass matrix and stiff matrix are respectively given by
\begin{equation}  \label{C4-M-def-2}
 {\bf M} =diag(M, M), ~\bar A^1(\Phi^{n+1})=diag(A_L+q^1C(\Phi), A_L+q^2C(\Phi)),
\end{equation}
right hand vector
%{\footnotesize
\begin{eqnarray}\label{def-F}
F^{n,1}=
\left(\begin{array}{c}
    F^{1,n,1} \\
    F^{2,n,1}
  \end{array}\right)= \tau G^{n+1}+ {\bf M} P^n
 =\tau
\left(\begin{array}{c}
    G^{1,n+1}+MP^{1,n} \\
    G^{2,n+1}+MP^{2,n}
  \end{array}\right),
\end{eqnarray}%}
~$\bar M$, $M$ and~$A_L$ are defined by ~\eqref{C4-M-def} and \eqref{C4-AL-def}, respectively, and the general element of $C(\Phi)=(C(\Phi)_{ij})_{n_h\times n_h}$ is $C(\Phi)_{ij}=(\psi_j\nabla\phi_h ,\nabla \psi_i) $.


The nonlinear algebraic equation system for the SUPG discrete system \eqref{fulldis-SUPG}-\eqref{fulldis2-SUPG} is given by
{%\footnotesize
\begin{eqnarray}\label{SUPG-non}
A_h^{2}(U_h^{2})U_h^{2} =F_h^2,
\end{eqnarray}}
where
\begin{eqnarray}\label{SUPG-AU}
A_h^{2}(U_h^{2})=\left(
  \begin{array}{cc}
    A_L& \bar M \\
   \bf 0    &  {\bf M} + \tau \bar A^2(\Phi^{n+1})  \\
  \end{array}
\right)
,~U_h^{2}=\left(
  \begin{array}{c}
     \Phi^{ n+1,2}\\P^{ n+1,2}
  \end{array}
\right), ~F_h^{2}=\left(
  \begin{array}{c}
    G_\Phi^{n+1} \\
    F^{n,2}
  \end{array}
\right).
\end{eqnarray}
Here
\begin{eqnarray}\label{SUPG-AF}
 \bar A^2(\Phi^{n+1}) =\bar A^1(\Phi^{n+1})+A^{stable}(\Phi^{n+1}) ,~ F^{n,2}=F^{n,1}+F ^{stable},
\end{eqnarray}
and~$ \bar M$, ${\bf M}$ and ~$A_L$ are defined by~\eqref{C4-M-def}, \eqref{C4-M-def-2} and~\eqref{C4-AL-def}, respectively,  the submatrix of the FEM system~$\bar{A}^1(\Phi^{n+1})$ and ~$F^{n,1}$ are given by~\eqref{C4-M-def-2} and~\eqref{def-F}, respectively, $A^{stable}(\Phi^{n+1})$ and~$F^{stable}$ are stiffness matrix and right hand vector for the stabilization term.


It is easy to know the nonlinear algebraic equation for the EAFE discrete system ~\eqref{fulldis2-EAFE}-\eqref{fulldis-EAFE} is as  follows:
{%\footnotesize
\begin{eqnarray}\label{EAFE-non}
A_h^{3}(U_h^{3})U_h^{3} =F_h^3.
\end{eqnarray}}
Here the coefficient matrix, solution vector and right hand vector
\begin{eqnarray}\label{EAFE-non-AUF}
A_h^{3}(U_h^{3})=\left(
  \begin{array}{cc}
    A_L& \bar M \\
   \bf 0    &  {\bf M} + \tau \bar A^3(\Phi^{n+1}) \\
  \end{array}
\right)
,~U_h^{3}=\left(
  \begin{array}{c}
     \Phi^{ n+1,3}\\P^{ n+1,3}
  \end{array}
\right),~F_h^{3}=F_h^{1},
\end{eqnarray}
where $ \bar M$, ${\bf M}$ and $A_L$ are defined by \eqref{C4-M-def}, \eqref{C4-M-def-2} and \eqref{C4-AL-def}, respectively, the right hand sider $F_h^{1}$ is given by  \eqref{FEM-non-AFU},
 $2n_h\times 2n_h$ stiff matrix
\begin{equation}  \label{C4-A-def}
\bar A^3(\Phi^{n+1})=diag(\bar A^1(\Phi^{n+1}),\bar A^2(\Phi^{n+1})),
\end{equation}
the general element of the element stiffness matrix ~$\bar A^{i,K}(\Phi^{n+1})$  on tetrahedron element $K$ for $\bar A^i(\Phi^{n+1})$ is as follows:
{%\footnotesize
\begin{equation}\label{aij}
\bar a_{\nu \mu }^{i,K}(\Phi^{n+1})=\left\{\begin{array}{ll}
 & -\omega^K_{E_{\nu \mu }}\tilde{\alpha} _{E_{\nu \mu }}^{K,i}(\Phi^{n+1})e^{q^i \lambda^K(q_{\mu })  \Phi ^{n+1}_K} , {\nu >\mu }, \\
 & -\omega^K_{E_{\mu \nu }}\tilde{\alpha} _{E_{\mu \nu }}^{K,i}(\Phi^{n+1})e^{q^i \lambda^K(q_{\mu })  \Phi ^{n+1}_K} , {\nu <\mu }, \\
 &\sum\limits_{ k> \mu}\omega^K_{E_{\mu  k}}\tilde{\alpha} _{E_{\mu k}}^{K,i}(\Phi^{n+1})e^{q^i \lambda^K(q_{\mu })  \Phi ^{n+1}_K}
 \\&+ \sum\limits_{ k<\mu} \omega^K_{E_{k\mu}}\tilde{\alpha} _{E_{k\nu_2}}^{K,i}(\Phi^{n+1})e^{q^i \lambda^K(q_{\mu })  \Phi ^{n+1}_K} ,  {\nu =k},
\end{array}\right. ~\nu ,\mu=1,2,3,4,~i=1,2,
\end{equation}}
where~$\omega^K_{E_{\nu \mu }}$ is defined by~\eqref{omega}, $q_1,q_2,q_3,q_4$ are four vertices of element~$K$ (see Fig. \ref{figK}), and
\begin{equation}\label{[1](3.10)}
\tilde{\alpha}^{K,i}_{E_{\nu \mu } }(\Phi^{n+1} )=\left[\frac{1}{|\tau_{E }|}\int_{E } e^{q^i \lambda^K  \Phi ^{n+1}_K}\mathrm{d}s\right]^{-1}.
\end{equation}

\begin{figure}[H]
 	\centering
 	\includegraphics[width=4cm,height=4cm]{K.pdf}
 %	\includegraphics[height=5.5cm,width=5.5cm]{fig/square.pdf}
 	\caption{Tetrahedral element $K$ }
 	\label{figK}
 \end{figure}

 From~\eqref{FEM-non}, \eqref{SUPG-non} and~\eqref{EAFE-non}, we have
%{\small
\begin{equation}\label{tildebar}
  \Phi^{ n+1,i}(P^{ n+1,i}):=G_A^{n+1}-\bar BP^{ n+1,i},~\bar B:=A_L^{-1}\bar M,~G^{n+1}_A:=A_L^{-1}G^{n+1 }_\Phi,~i=1,2,3.
\end{equation}%}
Hence, in view of~\eqref{FEM-non}, \eqref{SUPG-non}, and~\eqref{EAFE-non}, it follows that the nonlinear subsystem with respect of $P^{i,n+1}$ on time layer~$t=t^{n+1}$ is
\begin{eqnarray}\label{EAFE-non-2}
A^i(P^{n+1})P^{n+1,i}= F^{n,i},~i=1,2,3,
\end{eqnarray}
where
%{%\footnotesize
%\small
\begin{eqnarray}\label{EAFE-non-2-AP}
A^i (P )= {\bf M} + \tau\tilde A^i(P ), ~\tilde  A^i(P ):= \bar A^i(\Phi(P )),~\tilde A^i(P )=diag(\tilde A^{1,i}(P ),\tilde A^{2,i}(P )) .
\end{eqnarray}%}

It is easy to know that it suffices to prove the existence of the solution of nonlinear subsystem~\eqref{EAFE-non-2} in order to show the existence of the solutions of the three nonlinear fully-discrete scheme ~\eqref{FEM-non}, \eqref{SUPG-non} and~\eqref{EAFE-non}. The following assumption is needed to show the existence of the solution to \eqref{EAFE-non-2}.
\begin{assu}\label{assum-M}
The stiffness matrix $A^i (P^{n+1}),~i=1,2,3$ defined by~\eqref{EAFE-non-2-AP} is a column M-matrix.
\end{assu}


The following Lemma \ref{corollary-2} proved that Assumption
\ref{assum-M} holds under some certain conditions for EAFE scheme. For similicity, the superscript $3$ representing EAFE scheme is omitted in the proof, and denote
the element stiffness matrix on element $K$ of~$\tilde A^{i}(P^{n+1})$ by
\begin{eqnarray}\label{tildeA(P)}
\tilde A^{i,K}(P^{n+1})=(\tilde  a_{\nu \mu }^{i,K}(P^{n+1}))_{4 \times 4},~i=1,2.
\end{eqnarray}

\begin{lemma} \label{corollary-2} If for any element~$K\in \mathcal {T}_h$,  $ \omega^K_{E _{\nu \mu }}$ defined by \eqref{omega} satisfies
\begin{equation}\label{cytj}
 \omega_{E _{\nu \mu }}^K>0,~\nu <\mu  ,~\nu ,\mu =1,2,3,4,
\end{equation}
then~$\tilde  A(P^{n+1})$ and~$A(P^{n+1})$ are all column M-matices.
 \end{lemma}
\begin{proof}
It can be verified directly from ~\eqref{EAFE-non-2-AP} and~\eqref{aij} that the column sum of the elements of~$\tilde A^{i,K}$ is zero and the off-diagonal element
\begin{equation*}\label{aijK}
\tilde  a_{\nu \mu }^{i,K}(P^{n+1})=\left\{\begin{array}{ll}
 -\omega ^K_{E_ {\nu \mu }}\tilde{\alpha} _{E_{\nu \mu }}^{K,i}(\Phi^{n+1})e^{q^i \lambda^K(q_{\mu })  \Phi^{n+1} _K} , &  {\nu >\mu } \\
  -\omega^K_{E_ {\mu  \nu }}\tilde{\alpha} _{E_{\mu \nu }}^{K,i}(\Phi^{n+1})e^{q^i \lambda^K(q_{\mu })  \Phi ^{n+1}_K} , &  {\nu <\mu }
\end{array}\right.,\nu ,\mu =1,2,3,4,~i=1,2.
\end{equation*}
Hence, from~\eqref{[1](3.10)} we know the sufficent and necessary conditions for all diagonal elements of~$\tilde A^{i,K}$ to be less than zero are~\eqref{cytj} holds. From
~\eqref{cytj}, it is easy to know the diagonal element of ~$\tilde A^{i,K}$ is
\begin{align*}\label{aiiK}
\tilde  a_{\mu \mu}^{i,K}(P^{n+1})=&\sum\limits_{ k> \mu}\omega^K_{E_{\mu k}}\tilde{\alpha} _{E_{\mu k}}^{K,i}(\Phi^{n+1})e^{q^i \lambda^K(q_{\mu})  \Phi ^{n+1}_K}
\\&+ \sum\limits_{ k< \mu} \omega^K_{E_{k\mu}}\tilde{\alpha} _{E_{k\mu}}^{K,i}(\Phi^{n+1})e^{q^i \lambda^K(q_{\mu})  \Phi ^{n+1}_K}>0,~\mu=1,2,3,4,
\end{align*}
which implies for any given element~$K$,  the element stiffness matrix~$\tilde A^{i,K}(P^{n+1}) $ is an
~L-matrix and the column sum of its elements is zero. Obviously, the global stiffness matrix integrated from
~$\tilde A^{i,K}(P^{n+1})$ is also an L-matrix and the column sum of its elements is zero. Note that $\tilde A^{i}(P^{n+1})$  is the global stiffness matrix obtained after the Dirichlet boundary treatment of $\tilde A_b^{i}(P^{n+1})$, that is, there is at least one column of strictly diagonally dominant matrix, which implies ~$\tilde A ^{i}(P^{n+1})$ is a column M-matrix. Hence, from \eqref{EAFE-non-2-AP} we have~$\tilde A(P^{n+1})$  is a column M-matrix, which combining with ~\eqref{EAFE-non-2-AP} and~\eqref{C4-M-def} yields~$A (P^{n+1})$ is a column M-matrix too.

%列M-矩阵的定义（文\cite{xu-lz-1999} {\color{blue} 第4 页引理2.1 的上方}）
\end{proof}


\begin{remark}
The condition~\eqref{cytj} can be replaced by the requirement of mesh quality, e.g. each element in the triangular partition is acute triangle in the two-dimensional case
\textsuperscript{\cite{xu1999monotone}}.% 所有内角都小于等于~$\frac{\pi}{2}$.% 就是非钝角三角形.%是~Delaunay 三角剖分.

\end{remark}

It is shown in~\cite{prohl2009convergent} that if $h$ and~$\tau$ are small enough, and  $\mathcal T_h$ is a strong acute angle partition,  Assumption \ref{assum-M} holds for the standard FE scheme. Note that
from~\eqref{SUPG-AF}, we have $A^2(P^{n+1})=A^1(P^{n+1})+A^{stable}(\Phi^{n+1})$, and $A^{stable}(\Phi^{n+1})$ is a column M-matrix when the diffusion coefficient satisfies certain conditions. Hence if $\mathcal T_h$ is a strong acute angle partition,  $h$ and $\tau$ are small enough and the diffusion coefficient satisfies certain conditions{\color{blue}(e.g. ~$\nabla \phi=(a,-a,a)~or ~(-a,a,-a) ,~a\in R$)}, then Lemma \ref{assum-M} holds for ~SUPG scheme.

%Next, we shall discuss the existence of the solution of \eqref{EAFE-non-2}. Consider the time level $t=t_{J+1}$, $J\in\{0,\ldots,N-1\}$, and  \eqref{EAFE-non-2} is written as follows
 	
Next, we will show the existence of the solution to the nonlinear subsystem \eqref{EAFE-non-2} under Assumption ~\ref{assum-M}. We only prove it for the EAFE scheme~\eqref{EAFE-non} as an example.  Setting the time layer $t=t_{J+1}$, $J\in\{0,\ldots,N-1\}$,
then ~\eqref{EAFE-non-2} can be written as
\begin{equation}\label{UphiJJ}
 P=\phi^{J+1}(P),~\phi^{J+1}(P):= (A (P))^{-1}F^J,~P:=P^{J+1}.
\end{equation}

%\begin{equation}\label{Fi}
%\|f \|_{L^{\infty}(0,T;L^{\infty}(\Omega))}\le C,~\|F^i \|_{L^{\infty}(0,T;L^{\infty}(\Omega))}\le C,~i=1,2.
%\end{equation}
%{\color{black}
Note that $P^0=(p^{0,1}_1,\ldots,p^{0,1}_{n_h},p^{0,2}_1,\ldots,p^{0,2}_{n_h})^T$ is the vector composed of the initial ion concentration values at nodes. Assume there exists a positive constant $C_{p^0}$, such that
\begin{equation}\label{pn}
\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{0,i}_k \ge C_{p^0}>0.
%\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{0,i}_k \ge  0.
\end{equation}%}
Note that the assumption (\ref{pn}) is presented based on the physcical background of the solution. It is pointed our later in Remark \ref{init-assume} that this assumption can be removable from mathematical view.


%\begin{equation}\label{UphiJJ}
%P=\phi^{J+1}(P),~\phi^{J+1}(P):= (A (P))^{-1}F^J,~P:=P^{J+1}.
%\end{equation}


Then we have the following property and lemma.
\begin{property}\label{pro1}
For any element  $K\in \mathcal T_h$, the general element $\tilde  a_{\nu \mu }^{i,K}(P^{n+1})$ of the element stiffness matrix defined by  \eqref{tildeA(P)} is smooth enough with respect to~$P^{n+1}$.

In fact, from \eqref{tildebar} we know~$\Phi^{n+1}_K(P^{n+1})$ is a linear polynomial function with respect to $P^{n+1}$, which follows that $e^{ \lambda^K(q_{\mu })  {\Phi}^{n+1}_K} $ is smooth enough with repect to~$P^{n+1}$. Hence in view of \eqref{aij}, ~\eqref{[1](3.10)} and the fact that ~$\omega$ is a constant independent of $P^{n+1}$, we have ~$\bar a_{\nu \mu }^{i,K}(\Phi^{n+1}(P^{n+1})) $ is smooth enough with respect to $P^{n+1}$.
\end{property}

Using Property~\ref{pro1}, noting that~$\tilde A^i(P^{n+1})$ is assembled from ~$\tilde A^{i,K}(P^{n+1}),~\forall K\in \mathcal T_h$, and from~\eqref{EAFE-non-2-AP}, it yields any element of the stiffness matrices~$\tilde A^i(P^{n+1}),i=1,2$ or~$\tilde A(P^{n+1})$ is smooth enough with respect to $P^{n+1}$.

\begin{lemma}\label{lemma1}
%Assume
%\begin{equation}\label{Fi}
% f  , ~F^i  \in {L^{\infty}(0,T;L^{\infty}(\Omega))} ,~i=1,2,
%\end{equation}
%if there exists a positive constants~$C_{p^{J}}$ satisfying
Assume $f$ and $F^i$ in (\ref{weak1con})-(\ref{weak2con}) satisfies
\begin{equation}\label{Fi}
f  , ~F^i  \in {L^{\infty}(0,T;L^{\infty}(\Omega))} ,~i=1,2. 
\end{equation}
If there exists a positive constants~$C_{p^{J}}$ satisfying
\begin{equation}\label{pn-J}
\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{{J},i}_k \ge C_{p^{J}}>0,
\end{equation}
then there exists a positive constant $\tau_{*,J}$ indepedent of $P^J$, such that
\begin{equation}\label{FJge0}
F^J> 0,~\mbox{if}~\tau< \tau_{*,J}.
\end{equation}
	
\end{lemma}

\begin{proof}
	Using the definitions of $F^J$ and ${\bf M}$ in ~\eqref{def-F}  and \eqref{C4-M-def-2}, respectively, we know the $k$th element of $F^{i,J}$ satisfies
	\begin{equation} \label{fgge0}
f_k^{i,J}=\tau g_k^{i,J+1}+\frac{|\Omega_k|}{4}p^{i,J}_k,i=1,2,
\end{equation}
where $g_k^{i,J+1}$ and $p^{i,J}_k $ are the $k$th element of $G^{i,J+1}$ and $P^{i,J}$, respectively.
	
	If $G^{J+1}=\bf 0$, then \eqref{FJge0} holds for any  $\tau$ by \eqref{fgge0} and \eqref{pn-J}. Next we consider the case $G^{J+1}\ne \bf 0$. From the definition of $G^{J+1}$ in \eqref{def-PG} and the assumption \eqref{Fi}, it is obvious  $\|G^{J+1}\|_{L^{\infty}(\Omega)}$ is bounded. Hence we can set
	\begin{equation}\label{def-tau*}
	\tau_{*,J}= \frac{C_{p^J}\min\limits_{k} |\Omega_k|}{4\|G^{J+1}\|_{L^{\infty}(\Omega)}}>0.
	\end{equation}
	Using \eqref{fgge0}, \eqref{def-tau*} and \eqref{pn-J}, for $\tau<\tau_{*,J}$, there holds
	\begin{eqnarray*}\notag
f_k^{i,J}&=&\tau g_k^{i,J+1 }+\frac{|\Omega_k|}{4}p^{i,J }_k
>-\frac{C_{p^J}\min _{k} |\Omega_k|}{4\|G^{J+1}\|_{L^{\infty}(\Omega)}}|g_k^{i,J+1 }|+\frac{|\Omega_k|}{4}p^{i,J }_k
\\&\ge&-\frac{C_{p^J}\min _{k} |\Omega_k|}{4  } +\frac{|\Omega_k|}{4}p^{i,J }
\ge\frac{  C_{p^J}}{4  }(- {\min _{k} |\Omega_k|} + {|\Omega_k|} )\ge0.\label{gle0}
\end{eqnarray*}
	Thus we get \eqref{FJge0}. This completes the proof of this lemma.
\end{proof}

\begin{lemma}\label{lemma2}
	Let $E^T=(1,\ldots,1)^T\in R^{2n_h}$ and assume \eqref{cytj} and \eqref{FJge0} hold.  % 在推论~\ref{corollary-2} 和引理 \ref{lemma1} 的假设条件下{\color{blue}(即 $A(P)$ 是列M-矩阵且 \eqref{pn-J} 成立)},
	Define the positive constants
	\begin{equation}\label{def-CJ}
	C_J= EF^J,~C^{J+1}_k=\frac{4C_J}{|\Omega_k|},
	\end{equation}
	where $F^J$ is defined by \eqref{FJge0},
	and compact convex set
	\begin{equation}\label{set-JJ}
	\mathcal{C}^{J+1}=\{ P~| P\in \mathbb{R}^{2{n_h}}, p_k^i\in[0,C_k^{J+1}],~k=1,2,\ldots,{n_h},i=1,2\}.
	\end{equation}
	Then $\phi^{J+1}$ in \eqref{UphiJJ} is a continuous mapping from $\mathcal C^{J+1}$ to $\mathcal C^{J+1}$, if $\tau<\tau_{*,J}$, where $\tau_{*,J}$ is given in \eqref{FJge0}.
\end{lemma}

\begin{proof}
	Since $A(P)$ is a column M-matrix, we get $A(P)$ is nonsingular. Then from Property~\ref{pro1}, we have $A^{-1}(P)$ is smooth enough. From \eqref{UphiJJ}, it follow that $\phi^{J+1}$ is continuous in~$\mathcal C^{J+1}$. Hence it suffices to prove $\phi^{J+1}$ is a mapping from $\mathcal C^{J+1}\rightarrow \mathcal C^{J+1}$, that is
	\begin{equation*}\label{eq}
	\bar P=\phi^{J+1}(P )\in \mathcal C^{J+1}, ~\forall P \in \mathcal C^{J+1}.
	\end{equation*}
	From the definition of $ \mathcal C^{J+1}$ in~\eqref{set-JJ}, we only need to show the general element $\bar p^i_{k}$ of $\bar P$ satisfies
	\begin{equation}\label{Ci-J}
	\bar p^i_{k} \in [0,C^{J+1}_k], ~ k=1,\ldots, {n_h},i=1,2.
	\end{equation}
From~\eqref{UphiJJ}, we know~$\bar P  =\phi^{J+1}(P )$ is equivalent to the following equation
	\begin{equation}\label{eqJJ}
	A (P)\bar P =F^J.
	\end{equation}
	Note that since~$A^T(P)$ is an M-matrix,  the nonsingular matrix $B=(b_{j_1j_2})_{2n_h\times2n_h}:=(A^T(P))^{-1}$ is a nonnegative matrix, i.e. there is at least one positive element on each row of $B^T$. Then using  \eqref{eqJJ} and \eqref{FJge0}, we have the general element $p^i_{k}$ of $\bar P$ satisfies
	\begin{equation}\label{PJge0}
	\bar p^i_{k}= ( B^TF^J)_k%=\sum_{i=1}^{2 }\sum_{l=1}^{2n_h}b_{l,k} f^{J,i}_{l}
	>0,~ k=1,\ldots, {n_h},i=1,2.
	\end{equation}
	Hence to show~\eqref{Ci-J}, it only need to prove
	\begin{equation}\label{Ci-J1}
	\bar p^i_{k} \le C_k^{J+1}, ~ k=1,\ldots, {n_h}, ~i=1,2.
	\end{equation}
    From ~\eqref{def-CJ}, \eqref{eqJJ} and ~\eqref{EAFE-non-2-AP}, we have
	\begin{equation}  \label{C4-eq1.39-J}
	C_{J} =E F^J=E  A (P ) \bar P =E  ({\bf M}+\tau \tilde  A(P )) \bar P .
	\end{equation}
	
	
	From Corollary~\ref{corollary-2} and \eqref{PJge0}, it follows that
	$E\tilde  A(P) \bar P> 0$, which combining with
	~\eqref{C4-eq1.39-J}, \eqref{C4-M-def-2} and~\eqref{def-Pn} yields
	\begin{eqnarray*}
		C_J&=&{\color{black}E  ({\bf M}+\tau \tilde  A(P )) \bar P }
		> E {\bf M}  \bar P  = \sum_{j=1}^{n_h} \frac{|\Omega_j|}{4}( \bar p^1_{ j}+\bar  p^2_{ j}).
	\end{eqnarray*}
	From \eqref{PJge0} and using the fact  $C^{J+1}_k=\frac{4C_J}{|\Omega_k|}>0$, we get
	\begin{eqnarray}\label{CJ}
	C_J > \frac{|\Omega_k|}{4}  \bar p^i_{ k}=\frac{C_J}{C^{J+1}_k} \bar p^i_{ k}, ~\forall k\in\{1,\ldots, n_h\},i\in\{1,2\},
	\end{eqnarray}
	which implies ~\eqref{Ci-J1}. We complete the proof of this lemma.
\end{proof}

From Lemmas \ref{lemma1} and \ref{lemma2}, and Brouwer fix point theorem (see~\cite{park1999ninety}), we have the following existence theorem.

\begin{theorem}  \label{th-1}
	Assume  \eqref{cytj}, \eqref{pn}  and \eqref{Fi} hold. Then the solution of nonlinear system \eqref{UphiJJ} exists on any given time step $t=t^n,n\in\{1,\ldots,N\}$.
\end{theorem}

\begin{proof}
	We prove Theorem \ref{th-1} by the mathematical induction. First we show the solution of the nonlinear system  \eqref{UphiJJ} exists on the time step $t=t^1$.
	Since \eqref{pn} is the case $J=0$ in \eqref{pn-J}, combining \eqref{Fi}, from Lemma \ref{lemma1} we obtain \eqref{FJge0}.  Using \eqref{cytj}, \eqref{FJge0} and Lemma \ref{lemma2}, we have $\phi^1$ is a continuous mapping from~$\mathcal C^1\rightarrow \mathcal C^1$, which combining with Brouwer fixed point theorem yields the solution $P^1$ of ~\eqref{UphiJJ} exists,  i.e.
	\begin{equation*}\label{eq1J}
	A (P^{1})  P^{1} =F^{0}.
	\end{equation*}
	Since $F^0>0$ and $(A(P^{1}))^T$ is an M-matrix, using the similar arguments in the proof of \eqref{PJge0}, we get the element $p^{i,1}_{k}$ of $P^{1}$ satisfies
	\begin{equation}\label{P1Jge0-1}
	p^{i,1}_{k}= ( B_{1}^TF^0)_k
	>0,~B_{1}=((A(P^{1}))^T)^{-1},~ k=1,\ldots, {n_h},i=1,2.
	\end{equation}
	Hence there exists a positive constant $C_{p^{1}}$ such that
	\begin{equation*}\label{p1}
\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{i,{1} }_k \ge C_{p^{1}}>0,
\end{equation*}
	where $ p^{i,{1} }_k$ is the element of $P^{1}$.
	
	Assuming the solution of \eqref{UphiJJ} exists on $t=t^m(m\ge 1)$ and
	\begin{equation}\label{pJ}
\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{i,{m}}_k \ge C_{p^{m}}>0,
\end{equation}
where~$C_{p^{m}}$ is a constant independent of $P^{m}$, we shall show the solution also exists on $t=t^{m+1}$ and  \eqref{pJ} holds.

From \eqref{Fi}, \eqref{pJ} and setting $J=m$, then we get \eqref{FJge0} by Lemma \ref{lemma1}. Further, using \eqref{cytj}, \eqref{FJge0} and Lemma \ref{lemma2}, we have $\phi^{m+1}$ is a continuous mapping from~$\mathcal C^{m+1}\rightarrow \mathcal C^{m+1}$. Thus, using Brouwer fixed point theorem, it follows that the solution of \eqref{UphiJJ} exists on $t=t^{m+1}$, that is
	\begin{equation*}
	A (P^{m+1})  P^{m+1} =F^{m}.
	\end{equation*}
	Then similar as the proof of \eqref{P1Jge0-1} for the case $t=t^1$, we get any element $p^{i,m+1}_{k}$ of $P^{m+1}$ satisfies
	\begin{equation*}
 p^{i,m+1 }_{k}= ( B_{m+1}^TF^0)_k
>0,~B_{m+1}=((A(P^{m+1}))^T)^{-1},~ k=1,\ldots, {n_h},i=1,2,
\end{equation*}
	Hence there is a positive constant $C_{p^{m+1}}$ such that
	\begin{equation*}\label{p1}
\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{i,{m+1} }_k \ge C_{p^{1}}>0,
\end{equation*}
	where $ p^{i,{m+1} }_k$ is the element of  $P^{m+1}$.
	This completes the proof of the lemma.
\end{proof}

\begin{remark}\label{init-assume}
	%设初始函数~$p^{i}_0\in C(\bar \Omega)$,
	
	{\color{black}
Theorem \ref{th-1} shows that the existence of the solution to nonlinear system \eqref{EAFE-non} is based on \eqref{pn}, which can be removed essentially.}
\end{remark}	
	Next,  we provide a detailed explanation on how to obtain the result of Theorem \ref{th-1}  without using assumption \eqref{EAFE-non}.
%we will show how to remove  assumption \eqref{EAFE-non}.
Assume the initial function
	$p^{i}_0\in C(\bar \Omega)$.
	Let
	\begin{equation}\label{tildep}
	\tilde p^{i}({\bf x},t) = p^{i} ({\bf x},t)+C_0,
	\end{equation}
	where the positive constant ~$ C_0:=\max\limits_{{\bf x}\in\bar\Omega} \{|p^{i,0}_{\bf x}|\}+C_{p^0}$.
	Due to the difference of only one constant between~$p^{i}$ and~$\tilde p^{i}$, it is only need to prove the existence of $\tilde p^{i}$ to show the existence of ~$p^{i}$.
	
	It is easy to know $\phi$ and $\tilde{p}^i$ satisfy the following equations
	\begin{equation}\label{pnp-equation-1}
	\left\{\begin{array}{lr}
	-\Delta  \phi-\sum\limits^{2}_{i=1}q^{i}\tilde p^{i}=f ,  &\text { in } \Omega,~\text{for}~t\in(0, T],  \\
	{\partial_t  \tilde p^{i} }-\nabla\cdot(\nabla \tilde p^{i}  + q^{i} \tilde p^{i} \nabla  \phi   ) +q^{i}C_0\sum\limits^{2}_{j=1}q^{j}\tilde p^{j }  =\tilde F^i, & \text { in } \Omega,~\text{for}~t\in(0, T], i=1,2,\vspace{1mm}
	\end{array}\right.
	\end{equation}
	where~$\tilde F^i:=F^i- q^{i}C_0 f$, with the initial-value conditions
	\begin{equation}\label{boundary-1-0}
	\left\{
	\begin{array}{lr}
	\phi=0,\text{on}\;\partial\Omega,& \text{for}~t\in(0, T],\vspace{0.5mm}\\
	\tilde p^i=C_0,\;\text{on}\;\partial\Omega,&\text{for}~t\in(0, T],\\
	\tilde p^{i}({\bf x},0)=p^{i}({\bf x},0)+ C_0 ,&\text{for}~{\bf x} \in \Omega.
	\end{array}
	\right.
	\end{equation}
	We know that  $\tilde p^{i}({\bf x},t)$ satisfies
	\begin{equation}\label{pn-1}
	\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  \tilde{p}^{0,i}_k \ge C_{p^0}>0,
	%\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{0,i}_k \ge  0.
	\end{equation}
	where  $\tilde{P}^0=(\tilde{p}^{0,1}_1,\ldots,\tilde{p}^{0,1}_{n_h},\tilde{p}^{0,2}_1,\ldots,\tilde{p}^{0,2}_{n_h})^T$ is the vector composed of the initial ion concentration values at nodes and  $C_{p^0}$ is a certain positive constant.
	
	Let the vector of degree of freedoms of $\tilde p^{i}$ be
	\begin{eqnarray}
	\tilde P=
	\left(
	\begin{array}{c}
	\tilde P_{b} \\
	\tilde P_{I}\\
	\end{array}
	\right),
	\end{eqnarray}
	where $\tilde P_{b} $  and $\tilde P_{I}$ are vectors of degrees of freedoms corresponding to the set of boundary nodes and the set of inner nodes.
	
	Similar as the deduction of the EAFE scheme \eqref{EAFE-non} from \eqref{pnp equation}, using \eqref{pnp-equation-1}-\eqref{boundary-1-0} and noting the boudary condition $\tilde p^i=C_0$ in~\eqref{boundary-1-0} can be written as $\alpha\tilde p^i=\alpha C_0$ ($\alpha$ is any constant but not zero),  it is easy to know that the discrete system corresponding to the backward Euler-EAFE scheme of \eqref{pnp-equation-1}-\eqref{boundary-1-0} is as follows
	\begin{eqnarray}\label{AUF}
\left(
  \begin{array}{cc}
    A_L& \bar M \\
   {\bf 0 }   &   \hat A(\tilde P)  \\
  \end{array}
\right)
\left(
  \begin{array}{c}
      \Phi\\ \tilde P
  \end{array}
\right)=\left(
  \begin{array}{c}
    G_\Phi^{n+1}\\
   \tilde F^n
  \end{array}
\right),
\end{eqnarray}
	Here $A_L$, $\bar M$, $\Phi$ and $G_\Phi^{n+1}$ are defined in \eqref{C4-AL-def}, \eqref{C4-M-def} and  \eqref{def-PhiG3}, respectively,  $2(n_{h}+n_{bd})\times 2(n_{h}+n_{bd})$ matrix and $2(n_{h}+n_{bd})$ dimensional vector
	\begin{equation}\label{tidleAF}
	\hat A(\tilde P)= \left(
	\begin{array}{cc}
	\alpha I_b  & {\bf 0} \\
	A_{b}(\tilde P)   &   {A}_I(\tilde P) \\
	\end{array}
	\right),~ \tilde F^n=
	\left(
	\begin{array}{c}
	\alpha\tilde P_e \\
	\tilde F_I^n \\
	\end{array}
	\right),
	\end{equation}
	where $n_{bd}$ is the number of nodes on the boundary, $I_b$ is $2n_{bd}\times 2n_{bd}$ identical matrix,
	$2n_{h}\times 2n_h$ matrix $A_{b}(\tilde P)$ is nonpositive matrix assembled from ~$\tau\tilde A^{i,K}(P)$, $2n_{h}\times 2n_h$ matrix~$ {A}_I(\tilde P)=A(P)+C_0\tau\check{M}$, ${\check M} =\begin{pmatrix}
	M&-M
	\\
	-M &M
	\end{pmatrix}$,   $\tilde P_e$ is the vector composed by the values of the exact solution on boundary nodes, and the right-hand vector
	$$\tilde F_I^n  = \tau\tilde G^{n+1}+ {\bf M} \tilde P^n,
	~\tilde G^{n+1}=((\tilde F^{1,n+1},\psi_1),\ldots,(\tilde F^{1,n+1},\psi_{n_h}),(\tilde F^{2,n+1},\psi_1),\ldots,(\tilde F^{2,n+1},\psi_{n_h}))^T.$$
	
	
	
	From Lemma~\ref{corollary-2} and~$ {A}_I(\tilde P)=A(P)+C_0\tau\check{M}$, we have~${A}_I(\tilde P)$ is a column M-matrix, which combining with the definition of~$\hat A(\tilde P)$ given in~\eqref{tidleAF} yields that if choose
	\begin{equation}\label{def-alpha}
	\alpha\ge \|A_{b}(\tilde  P)\|_1,
	\end{equation}
	then~$\hat A(\tilde  P)$ is a column M-matrix.

In summary,  the result of Theorem \ref{th-1} can be obtained under the assumptions of \eqref{cytj} and \eqref{Fi} and without using the condition (\ref{pn}).

The existence of the solution to FE or SUPG schemes can been obtained by following the similar arguments in the proof of the existence of the solution to the EAFE scheme.

Note that Gummel iteration is a commonly used iteration to solve nonlinear scheme (\ref{fulldis2-EAFE})-(\ref{fulldis-EAFE}) (cf. e.g. \cite{zhang2022class, SUPG-IP, zheng2011second}). In next section, we introduce the Gummel algorithm combining with EAFE scheme for PNP equaitons, and present the contraction and convergence theory for the solution of the algorithm.
%---------------------------
\vspace{3mm}
\subsection{The convergence analysis for the Gummel iteration}
%
In this section, we will present the convergence analysis for the Gummel iteration.
 For $t=t^{n+1},~n\geq 0$, the Gummel iteration for the EAFE scheme (\ref{fulldis2-EAFE})-(\ref{fulldis-EAFE}) are as follows.

 \begin{algorithm}[!h]
 	\caption{Gummel iteration}
 	\label{gummalgo}
 	%\begin{algorithmic}[0]
 	Step 1. Give the initial value $(p_h^{1,n},p_h^{2,n},\phi_h^n)\in [V_h]^3$, let $(p_h^{1,n+1,0}, p_h^{2,n+1,0},\phi_h^{n+1,0})$ $=(p_h^{1,n},p_h^{2,n},\phi_h^n)$ as $l=0$.\\
 	Step 2. For $l\geq 0$, compute $(p_h^{1,n+1,l+1}, p_h^{2,n+1,l+1},\phi_h^{n+1,l+1})\in [V_h]^3$, such that for any $v_{h}$ and $ w_h\in V_h$,
 	\begin{align}\label{gumm2}
 	&(\nabla\phi_h^{n+1,l+1},\nabla w_h)-\sum\limits^{2}_{i=1}q^{i}(p^{i,n+1,l}_h,w_h)=(f^{3,n+1},w_h),
 	\\ \label{gumm1}
 	&\frac 1 {\tau}(p_h^{i,n+1,l+1},v_h)+ \sum\limits_{K\in \mathcal{T}_{h}}[\sum\limits_{E\subset K}\omega_E^K\tilde{\alpha}^{K,i}_{E}(\phi_h^{n+1,l+1})\delta_E(e^{q^i\phi_h^{n+1,l+1}}p_h^{i,n+1,l+1})\delta_Ev_{h}]
 	\nonumber\\
 	&~~~~~~=(F^{i,n+1},v_h)+\frac 1 {\tau}(p^{i,n}_h,v_h) ,~i=1,2 .
 	\end{align}
 	
 	Step 3. For a given tolerance $\epsilon$, stop the iteration if
 	\begin{align}\label{tol}
 	\|p_h^{1,n+1,l+1}-p_h^{1,n+1,l}\|+\|p_h^{2,n+1,l+1}-p_h^{2,n+1,l}\|+
 	\|\phi_h^{n+1,l+1}-\phi_h^{n+1,l}\|\leq\epsilon,
 	\end{align}
 	and set $(p_h^{1,n+1},p_h^{2,n+1},\phi^{n+1}_h)=(p_h^{1,n+1,l+1},
 	p_h^{2,n+1,l+1},\phi_h^{n+1,l+1})$. Otherwise set $l\leftarrow l+1$ and goto Step 2 to continue the iteration.
 \end{algorithm}
%First, we present the Gummel iteration for the fully-discrete scheme \eqref{fulldis2-EAFE}-\eqref{fulldis-EAFE}.
%%{\color{blue}(省略 $n+1$)}.



To show the convergence of the solution to Algorithm 3.1, first we present the algebraic formulation of Algorithm \ref{gummalgo}. Let the linear finite element functions of \eqref{gumm2} and \eqref{gumm1} are
$$\phi_h^{n+1,l+1}=\Psi \Phi^{n+1,l+1}, ~ p_h^{i,n+1,\mu}=\Psi P^{i,n+1,\mu},~ i=1,2,~\mu=l,l+1,$$
respectively, where the basis function vector $\Psi$  is given by \eqref{Psi}. The degrees of freedom vector of electrostatic potential and concentration are defined as follows
\begin{equation}\label{def-P-l+1}
\Phi^{n+1,l+1}=(\Phi^{n+1,l+1}_1,\ldots,\Phi^{n+1,l+1}_{n_h})^T,
~
P^{i,n+1,\mu}=(p^{i,n+1,\mu}_1,\ldots,p^{i,n+1,\mu}_{n_h})^T.%~i=1,2,
\end{equation}

Setting $w_h$ and $v_h$ in ~\eqref{gumm2}-\eqref{gumm1} to be the basis functions, using \eqref{def-P-l+1} and denoting by
 \begin{eqnarray}\label{EAFE-non-dis-1}
F_\Phi^{n+1}(P):=G_\Phi^{n+1}- \bar MP,
\end{eqnarray}
then the linear algebraic equations corresponding to ~\eqref{gumm2}-\eqref{gumm1} can be written as
	\begin{eqnarray}\label{EAFE-non-dis}
	\left\{
	\begin{array}{ll}
	A_L  \Phi^{n+1,l+1}= F_\Phi^{n+1}(P^{n+1,l}) , \\
	({\bf M} + \tau \bar A(\Phi^{n+1,l+1}))P^{n+1,l+1}= F^n ,
	\end{array}
	\right.~P^{n+1,\mu}=
	\begin{pmatrix}
	P^{1,n+1,\mu}\\
	P^{2,n+1,\mu}
	\end{pmatrix}
	,~\mu=l,l+1,
	\end{eqnarray}
%}
where matrices $A_L$, $\bar A(\cdot)$, $\bf M$ and  $\bar M$ are defined in \eqref{C4-AL-def}  and \eqref{C4-M-def}, respectively, vectors $G_\Phi^{n+1} $ and $F^n$ are given by \eqref{def-PhiG3}  and \eqref{def-F}, respectively.

Similar as the deductions of~\eqref{tildebar} and \eqref{UphiJJ}, using \eqref{EAFE-non-dis} and \eqref{EAFE-non-2-AP}, we have
\begin{equation}\label{tildebar-dis}
\Phi^{n+1,l+1}(P^{n+1,l})=G_A^{n+1}-\bar BP^{n+1,l},~\bar B:= A_L^{-1}\bar M ,~G_A^{n+1}:=A_L^{-1}G_\Phi^{n+1}
\end{equation}
and
\begin{eqnarray}\label{EAFE-non-2-dis}
P^{n+1,l+1}=\phi^{n+1}(P^{n+1,l}),~\phi^{n+1}(P^{n+1,l}):=(A (P^{n+1,l}))^{-1}F^n.
\end{eqnarray}


Let ${\tilde C}_k^{0}:=\|P^0\|_\infty$ be a compact convex set and
\begin{equation}\label{set-JJ-3}
\mathcal{\tilde C}^{n}=
\{ P^l~| P^l\in \mathbb{R}^{2{n_h}}, p_k^{l,i}\in[0,{\tilde C}_k^{n}],~k=1,2,\ldots,{n_h},i=1,2\},~{\tilde C}_k^{n}=\max\{{\tilde C}_k^{n-1},{ C}_k^{n}\} ,~ n= 1,\ldots, N ,
\end{equation}
where the positive contant $C^{n}_k,~n=0,\ldots, N-1$ defined by \eqref{def-CJ}. From \eqref{set-JJ-3} and \eqref{def-CJ}, it is obvious to have
\begin{equation}\label{tildeC-C}
\mathcal { \tilde C}^{n-1}\subseteq\mathcal { \tilde C}^{n}~\mbox{and}~\mathcal { C}^{n}\subseteq\mathcal { \tilde C}^{n},~n= 1,\ldots, N .
\end{equation}

Next, in order to show the convergence of Algorithm \ref{gummalgo}, some lemmas needed are presented as follows.

\begin{lemma}\label{tildeC-P-l}
For any time step $t=t^{n},n\in\{1,\ldots,N\}$, if the Gummel iterative vector $P^{n,l}$ defined in \eqref{EAFE-non-dis} satisfies
	\begin{equation}\label{assume}
	P^{n,l}\in\mathcal { \tilde C}^{n},~\forall l \ge 0,
	\end{equation}
	then there exists a positive constant $C_L$ independent of $\{P^{n,\mu},\mu\ge 0\}$, such that the stiffness matrix $\tilde A(P)$ in \eqref{EAFE-non-2-AP} satisfies the following Lipschitz condition	\begin{eqnarray}\label{lp-l}
	\|\tilde A(P^{n,l})-\tilde A(P^{n,l-1})\|_{\infty}\le C_L \|P^{n,l}-P^{n,l-1}\|_{\infty},~\forall l \ge 1.%~\forall P^{l_1},P^{l_2}\in \mathcal C^{n+1},
	\end{eqnarray}
	
	
	
	
	
	\begin{proof}
		In fact, since the diagonal block submatrix $\tilde A^i(P), i=1,2$ of $\tilde A(P)$ in  \eqref{EAFE-non-2-AP} is assembled by the element stiffness matrix~$\tilde A^{i,K}(P):=(\tilde  a_{\nu \mu }^{i,K}(P))_{4\times 4}$, to prove \eqref{lp-l}, it suffices to show there is a positive constant $C_L$ independent of  ~$\{P^{n,\mu},\mu\ge 0\}$, such that
		\begin{eqnarray}\label{lp-l1}
		|\tilde  a_{\nu \mu }^{i,K}(P^{n,l})-\tilde  a_{\nu \mu }^{i,K}(P^{n,l-1})| \le C_L \|P^{n,l}-P^{n,l-1}\|_{\infty},~\forall l \ge 1.
		\end{eqnarray}
		
		Next, we only give the discussion for the case $i=1$, and the case where i=2 is also similar. Let
		\begin{eqnarray}\label{tildeC-l}
		\eta_r ({\bf x}) =q^1\lambda^K({\bf x} ) \Phi_K^{n,r+1}(P^{n,r}),~r=l-1,l.
		\end{eqnarray}
		Using   \eqref{aij}  and \eqref{[1](3.10)}, for $\nu\ne \mu$ we have
		\begin{eqnarray}\label{a-a-l}
		|\tilde a_{{\nu \mu }}^{1,K} (P^{n,l} )-\tilde a_{{\nu \mu }}^{1,K}(P^{n,l-1}  )|
		\notag&\le &|\omega^K_{E_{\nu \mu }}|~ |\left[\frac{1}{|\tau_{E_{\nu \mu }}|}\int_{E_{\nu \mu }} e^{\eta_l (\bf x)}\mathrm{d}s\right]^{-1}e^{  \eta_l(q_{\mu })}-\left[\frac{1}{|\tau_{E_{\nu \mu } }|}\int_{E_{\nu \mu } } e^{  \eta_{l-1}({\bf x}) }\mathrm{d}s\right]^{-1}e^{  \eta_{l-1} (q_{\mu })}|
		\notag\\&&
		\notag\\&\le&|\omega^K_{E_{\nu \mu }}|~ |(e^{ \min\limits_{{\bf x}\in {E_{\nu \mu }}}  \eta_l ({\bf x}) })^{-1}e^{ \eta_l  (q_{\mu })}-(e^{ \max\limits_{{\bf x}\in {E_{\nu \mu }}}   \eta_{l-1} ({\bf x})   })^{-1}  e^{  \eta_{l-1}(q_{\mu })}|\label{delta-tilde-alpha-e}
		\notag\\&&
		\notag\\&\le & \frac{1}{3}   C_L^1   |e^{ \eta_l(q_{\mu })} -e^{  \eta_{l-1}(q_{\mu })}|
		\label{a-a-1}
		\end{eqnarray}
%		
	 where $C_L^1=3\max\limits_{E_{\nu \mu }} \{|\omega^K_{E_{\nu \mu }}|\min\{(e^{ \min\limits_{{\bf x}\in {E_{\nu \mu }}} \eta_l ({\bf x} )})^{-1},(e^{ \max\limits_{{\bf x}\in {E_{\nu \mu }}} \eta_{l-1} ({\bf x})})^{-1} \}\}
	$.
		
		Next we show $C_L^1$ is independent of $P^{n,r},~r=l-1,l$. From \eqref{omega}, \eqref{tildeC-l} and the fact $\|\lambda^K({\bf x})\|_\infty\le 1$, it only requires  proving  there exists a positve constant $\hat C_L^1$ independent of $P^{n,r},r=l-1,l$, such that
		%是与 $P^{n,r},r=l-1,l$ 无关的正常数
		\begin{eqnarray}\label{tildeC1-l}
		\|\Phi^{n,r+1}\|_{\infty}\le  \hat  C_L^1,~r=l-1,l.
		\end{eqnarray}
		From  \eqref{def-PhiG3}, \eqref{C4-M-def},  \eqref{assume} and \eqref{set-JJ-3}, we get
		\begin{eqnarray}
		\|G_\Phi^{n}- \bar MP^{n,r}\|_{\infty}\le C_G+ \frac{\max\limits_k|\Omega_k|}{4}\| P^{n,r}\|_{\infty}
		%~\text{\color{blue}}
		\le C^F_0
		%~\text{\color{blue}
		%	(由 \eqref{assume}, \eqref{set-JJ-3})}
		,~r=l-1,l,\label{FPHI-0-l}
		\end{eqnarray}
		where $C^F_0=C_G+ \frac{\max\limits_k|\Omega_k|}{4}\max\limits_k \{  { \tilde C}^{n+1}_{k}\}$ is a positive constant independent of $P^{n,r},r=l-1,l$.
		
		From \eqref{EAFE-non-dis}, we know $  \Phi^{n,r+1}= A_L^{-1}F_\Phi^{n}(P^{n,r})$. Then using  \eqref{EAFE-non-dis-1} and \eqref{FPHI-0-l}, and noting  $\|A_L^{-1}\|_{\infty}$ is only related to $h$, we obtain \eqref{tildeC1-l}.
		
	Next, we estimate \eqref{a-a-1} $ |e^{ \eta_l(q_{\mu })} -e^{  \eta_{l-1}(q_{\mu })}|$. Let $a  =  \min\{   \eta_1 (q_{\mu }),\eta_2  (q_{\mu })  \},~b=\max\{   \eta_1  (q_{\mu })  , \eta_2 (q_{\mu })\}$. From Lagrange mean value theorem, \eqref{tildeC-l} and \eqref{tildebar-dis},
	%{ \color{blue}对~$x\in E$ 有~$ \|\lambda^K(x)\|_\infty\le 1 $ },
	 it follows that
		\begin{eqnarray}\notag
		|e^{ \eta_l(q_{\mu })} -e^{  \eta_{l-1}(q_{\mu })}|%~~\color{blue}\text{( 由~$e^x>0$)}
		&=&  { \color{black}{ | \eta_l (q_{\mu }) -\eta_{l-1} (q_{\mu })  | }\frac{|e^{ \eta_l  (q_{\mu })} -e^{  \eta_{l-1}(q_{\mu })}| }{ | \eta_l  (q_{\mu }) -\eta_{l-1}  (q_{\mu })  | }}
		\notag\\&=&   {| \eta_l  (q_{\mu }) -\eta_{l-1} (q_{\mu })  |}~|(e^\xi)'|
		%~~{\color{blue}\text{(由中值定理, $\xi\in (a,b)$)}}
		\notag\\&\le & \| e^{   x}  \|_{L^{\infty}(a,b) }  ~{ |    \lambda^K(q_{\mu })(\Phi_K^{n,l +1}(P^{n,l })-\Phi_K^{n,l } (P^{n,l-1}))  | }
	%	~{\color{blue}\text{(由 \eqref{tildeC-l} )}}
		\notag\\&\le & 4\| e^{  x}  \|_{L^{\infty}(a,b) } ~\| \lambda^K \|_\infty~{ \|   ( \bar B( P^{n,l} - P^{n,l-1}))^K \|_{\infty}} %~~{\color{blue}\text{(由~\eqref{tilde%bar-dis}  )}}
		\notag
%		\\&\le &
%		% {\color{blue}4 \| e^{  x}  \|_{L^{\infty}(a,b) }    \|  \bar B( P^{n,l} - P^{n,l-1}) \|_{\infty}
%			~~\text{(~${\bf x}\in ~$ \|\lambda_K({\bf x})\|_\infty\le 1 $)}}
		\notag\\&  \le &  C_L^2\|  P^{n,l} - P^{n,l-1} \|_{\infty}
	%	~~{\color{blue}\text{( 由 $C_h:=\|\bar B\|_\infty$ )}}
		,\label{a-a-3}
		\end{eqnarray}
	where $C_L^2=4 \| e^x  \|_{L^{\infty}(a,b) }\|\bar B\|_\infty$. Noting that $\|\bar B\|_\infty$ is a positive constant only dependent of $h$, we have $C_L^2$ is independent of $P^{n,r},~r=l-1,l$.
		
		
		
		Inserting \eqref{a-a-3} into \eqref{a-a-1} and setting $C_L=C_L^1C_L^2$,  we have \eqref{lp-l1} holds when $\nu\ne\mu$. Then from \eqref{aij}, when $\nu=\mu$, it yields
		{\small\begin{eqnarray*}
				|\tilde a_{{\mu \mu }}^{1,K} (P^{n,l} )-\tilde a_{{\mu \mu }}^{1,K}(P^{n,l-1}  )|
				\le\sum\limits_{k \ne \mu} |\tilde a_{{k \mu }}^{1,K} (P^{n,l})-\tilde a_{{k \mu }}^{1,K}(P^{n,l-1}  )|
				\le     C_L \|P^{n,l}-P^{n,l-1}\|_{\infty},
		\end{eqnarray*}}
		thus we get \eqref{lp-l1}. This complete the proof of this lemma.
	\end{proof}
\end{lemma}

Similar as the deduction of Lemma \ref{lemma2} and Property~\ref{pro1}, we have $\phi^{n+1}$ and $\tilde A(P)$ are continuous on $\mathcal {\tilde C}^{n+1}$. Hence $\phi^{n+1}$ and  $\tilde A(P^{n+1,l})$ are bouned on the compact convex set $\mathcal {\tilde C}^{n+1}$. Denote by %令{\color{blue}(该常数与 $\mathcal {\tilde C}^{n+1}$ 的维数($N=O(h^{-3})$) 有关 )}
\begin{equation}\label{C-Phi-tildeA-l}
C_{\Phi}^{\tilde A} =\max \{\|\tilde A(P^{n+1,l})\|_{\infty},\| \phi^{n+1}(P^{n+1,l})\|_{\infty},l=0,1,\ldots,\}.
\end{equation}

\begin{lemma}\label{le-infty-l}
Under the assumption of Lemma \ref{tildeC-P-l}, and setting
	\begin{equation}\label{def-tauC-l}
	\tau_C=\frac{\min\limits_{k}|\Omega_k|}{8 C_L  C_{\Phi}^{\tilde A}},
	\end{equation}
where $|\Omega_k|$, $C_L$ and $ C_{\Phi}^{\tilde A} $ are constants defined in \eqref{C4-M-def}, \eqref{lp-l} and \eqref{C-Phi-tildeA-l}, respectively, then for $\tau<\tau_C$, the mapping $\phi^{n+1}$ given in \eqref{EAFE-non-2-dis} is contractive, i.e.
	\begin{equation}\label{contraction-l}
	\|\phi^{n+1}(P^{n+1,l})-\phi^{n+1}(P^{n+1,l-1})\|_{\infty}\le \alpha_{n+1}\| P^{n+1,l}-  P^{n+1,l-1} \|_{\infty},
	\end{equation}
	where~$ \alpha_{n+1}=\frac{8  C_L  C_{\Phi}^{\tilde A} }{\min\limits_{k}|\Omega_k|}{\tau}\in(0,1)$ are a positive constant independent of $P^{n+1,l-1}$ and $P^{n+1,l}$.
\end{lemma}

\begin{proof}
	Using~\eqref{EAFE-non-dis} and \eqref{EAFE-non-2-AP}, we obtain
	$$
	({\bf M}+\tau\tilde A(P^{n+1,l}))\phi^{n+1}(P^{n+1,l})=F^n=({\bf M}+\tau\tilde A(P^{n+1,l-1}))\phi^{n+1}(P^{n+1,l-1}),
	$$
	which becomes
{\small\begin{eqnarray}\notag
	{\bf M}(\phi^{n+1}(P^{n+1,l})-\phi^{n+1}(P^{n+1,l-1}))&+&\frac{\tau}{2} \big(\tilde A(P^{n+1,l})\phi^{n+1}(P^{n+1,l})-\tilde A(P^{n+1,l-1})\phi^{n+1}(P^{n+1,l-1})\big)
	\\&=&\frac{\tau}{2}\big(\tilde A(P^{n+1,l-1})\phi^{n+1}(P^{n+1,l-1})-   \tilde A(P^{n+1,l})\phi^{n+1}(P^{n+1,l})\big).
	\label{3-1-3'c11-l}
	\end{eqnarray}}
%	{\color{blue}\small(注意
%		$$\tilde A(P^{l})\phi^{n+1}(P^{l})-\tilde A(P^{l-1})\phi^{n+1}(P^{l-1})=(\tilde A(P^{l}) +  \tilde A(P^{l-1}))(\phi^{n+1}(P^{l})- \phi^{n+1}(P^{l-1}))-\big(\tilde A(P^{l-1}) \phi^{n+1}(P^{l})-\tilde A(P^{l}) \phi^{n+1}(P^{l-1})\big),$$
%		and
%		$$\tilde A(P^{l-1})\phi^{n+1}(P^{l-1})-   \tilde A(P^{l})\phi^{n+1}(P^{l})= (\tilde A(P^{l-1})-   \tilde A(P^{l}))(\phi^{n+1}(P^{l})+   \phi^{n+1}(P^{l-1}))-\big(\tilde A(P^{l-1}) \phi^{n+1}(P^{l})-\tilde A(P^{l}) \phi^{n+1}(P^{l-1})\big),$$
%		%在上式两端同加~$\frac{\tau}{2}(\tilde A(P_2) \phi(P_1)-\tilde A(P_1) \phi(P_2))$, 有
%		将上面两个式子代入 \eqref{3-1-3'c11-l} 有)}

	From \eqref{3-1-3'c11-l}, it yields
	\begin{eqnarray}\notag
	[{\bf M}+ \frac{\tau}{2} (\tilde A(P^{n+1,l})& +&  \tilde A(P^{n+1,l-1}))](\phi^{n+1}(P^{n+1,l})- \phi^{n+1}(P^{n+1,l-1}))
	\\&=&\frac{\tau}{2} ((\tilde A(P^{n+1,l-1})-   \tilde A(P^{n+1,l}))(\phi^{n+1}(P^{n+1,l})+   \phi^{n+1}(P^{n+1,l-1}))).\label{3-1-3'c1-l}
	\end{eqnarray}
	Denoting by $ \delta P:=\phi^{n+1}(P^{n+1,l})- \phi^{n+1}(P^{n+1,l-1})$, from the definitions of ${\bf M}$, $C_{\Phi}^{\tilde A} $ and $\tau_C$ given by \eqref{C4-M-def-2}, \eqref{C-Phi-tildeA-l} and \eqref{def-tauC-l}, respectively,  we have if setting $C_L\ge 1$ and $\tau \le \tau_C$ , the left side of  \eqref{3-1-3'c1-l} can be estimated as follows
	{\small\begin{eqnarray}\notag
		\|[{\bf M}+ \frac{\tau}{2} (\tilde A(P^{n+1,l}) +  \tilde A(P^{n+1,l-1}))]  \delta P\|_{\infty}
		&\ge &\|{\bf M} \delta P\|_{\infty}-\frac{\tau}{2}\| (\tilde A(P^{n+1,l}) +  \tilde A(P^{n+1,l-1})) \delta P \|_{\infty}
	%	\\
		%&&~~\text{\color{blue}(由~$\|a+b\|\ge %||a||-||b||$)}
		\notag\\&\ge& \frac{1}{4}\min_{k}|\Omega_k|\|  \delta P\|_{\infty}-\frac{\tau}{2} \|  \tilde A(P^{n+1,l})  +  \tilde A(P^{n+1,l-1})  \|_{\infty}\| \delta P \|_{\infty}
	%	\notag\\
		%&&\text{\color{black}(from \eqref{C4-M-def} 和~$\|A  \delta P\|\le ||A|| ~|| \delta P||$ )}
		\notag\\&\ge &\frac{1}{4}\min_{k}|\Omega_k|\|  \delta P\|_{\infty}- {\tau}C_{\Phi}^{\tilde A} \| \delta P \|_{\infty}
		%~~\text{\color{black}(by  \eqref{C-Phi-tildeA-l})}
		\notag\\&\ge &\frac{1}{8}\min_{k}|\Omega_k|\| \delta P \|_{\infty}
%		~~\text{\color{blue}(由和 \eqref{def-tauC-l}, $\tau < \tau_C  $ 且 $C_L\ge 1$)}
		.\label{3.23-l}
		\end{eqnarray}}
	On the other hand, from Lemma \ref{tildeC-P-l} and \eqref{C-Phi-tildeA-l}, the right side of \eqref{3-1-3'c1-l}  can be written as
	\begin{eqnarray}\notag
	&&\frac{\tau}{2}\| (\tilde A(P^{n+1,l-1})-   \tilde A(P^{n+1,l}))(\phi^{n+1}(P^{n+1,l})+   \phi^{n+1}(P^{n+1,l-1}))\|_{\infty}
	\\&\le& {\color{black}\frac{\tau}{2}\| (\tilde A(P^{n+1,l-1})-   \tilde A(P^{n+1,l})\|_{\infty}\|\phi^{n+1}(P^{n+1,l})+   \phi^{n+1}(P^{n+1,l-1}) \|_{\infty}}
	\notag\\&\le& \tau  C_{\Phi}^{\tilde A}\| (\tilde A(P^{n+1,l-1})- \tilde A(P^{n+1,l})\|_{\infty}
%	~\text{\color{blue}(由~\eqref{C-Phi-tildeA-l})}
	\notag\\&\le&  {\tau} C_{\Phi}^{\tilde A}C_L \|  P^{n+1,l}-P^{n+1,l-1} \|_{\infty}
%	~\text{\color{blue}(由引理~\ref{tildeC-P-l})}
	.
	\label{3.21-l}
	\end{eqnarray}
Inserting \eqref{3.23-l} and \eqref{3.21-l} into \eqref{3-1-3'c1-l}, it follows that
	\begin{eqnarray*}
		\frac{1}{8}\min_{k}|\Omega_k| ~\|\phi^{n+1}(P^{n+1,l})- \phi^{n+1}(P^{n+1,l-1})\|_{\infty}
		&\le& {\tau} C_L C_{\Phi}^{\tilde A}\| P^{n+1,l}-P^{n+1,l-1}\|_{\infty},
	\end{eqnarray*}
%	$\Rightarrow$%由此可知
that is
	\begin{eqnarray*}
		\|\phi^{n+1}(P^{n+1,l})- \phi^{n+1}(P^{n+1,l-1})\|_{\infty}
		\le\alpha_{n+1}\| P^{n+1,l}-P^{n+1,l-1} \|_{\infty},~\alpha_{n+1}:=\frac{8  C_L  C_{\Phi}^{\tilde A} }{\min\limits_{k}|\Omega_k|}{\tau}.
	\end{eqnarray*}
Hence $\alpha_{n+1} \in(0,1)$ when $\tau<\tau_C$, which implies \eqref{contraction-l}, i.e. {\color{black}  $\phi^{n+1}$ is contractive on $\mathcal {\tilde C}^{n+1}$}. We complete the proof of this lemma.
\end{proof}

By using the above lemma, we have the following theorem.
\begin{theorem}\label{theorem}
Assume~\eqref{cytj}, \eqref{pn} and \eqref{Fi} hold,  $\tau_{*,n-1}$ is defined in \eqref{FJge0} and $\{P^{n,l}\}$ is the Gummel iteration sequence given by  \eqref{EAFE-non-2-dis}. For any given time step $t=t^{n},n\in\{1,\ldots,N\}$ and any positive constant $\tilde\epsilon$ independent of $\{P^{n,l}\}$, if $\tau<\tau_{*,n-1}$, then the sequence $\{P^{n,l}\}$ converges, i.e. there exists a positive constant $L_n$, such that  $\{P^{n,l},l=0,1,\ldots,L_n\}$ satisfies %the following convergence condition %{\color{blue}(或数值收敛)}
	\begin{align}\label{tol-dis}
	\|P^{n,l+1}-P^{n,l}\|_\infty\leq \tilde\epsilon,
	\end{align}
and the element of $P^{n,l}$ satisfies
	
	\begin{equation}\label{phiP-1}
	%P^{n,l}\in \mathcal {\tilde C}^{n},~l=0,1,\ldots,L_n.
	0<p^{i,n,l}_{ k}\le {\tilde C}^{n}_k,~\forall k\in\{1,\ldots, n_h\},i\in\{1,2\},~l=0,1,\ldots,L_n.%~L_n=\lceil  \log_{\alpha_{n}}\frac{\epsilon}{2\max\limits_k\{{\tilde C}_k^{n}\}} \rceil,
	\end{equation}
%where~$0<\alpha_{n}<1$ meets with \eqref{contraction-l} and is independent of $P^{n,l}$.
\end{theorem}




\begin{proof}
Since the operator $\phi^{m}(m=1,\ldots, N)$ in  \eqref{EAFE-non-2-dis} and \eqref{UphiJJ}  are the same, we can show Theorem \ref{theorem} by the mathematical induction and following the arguments of Theorem \ref{th-1} and Lemma \ref{lemma2}.
	
	First we prove \eqref{phiP-1}  holds on $t=t^1$, i.e.
	\begin{equation}\label{phiP-2}
% P^{1,l}\in \mathcal {\tilde C}^{1},~l=1,\ldots,L_1.
 0<p^{i,1,l}_{ k}\le {\tilde C}^{1}_k,~\forall k\in\{1,\cdots, n_h\},i\in\{1,2\},~l=0,1,\cdots.
\end{equation}
From \eqref{pn} and ${\tilde C}_k^{0}:=\|P^0\|_\infty$, it is easy to get \eqref{phiP-2} when $l=0$. Next, we only show  \eqref{phiP-2} for the case $l=1$ as an example, since it is similar for $l\ge 2$. Noting \eqref{pn} is the case $J=0$ in \eqref{pn-J} and using \eqref{Fi}, we get \eqref{FJge0} form Lemma \ref{lemma1}. From~\eqref{EAFE-non-2-dis}, we have~$ P^{1,1}$ satisfies
	\begin{equation}\label{eqJJ-3}
	A (P^{1,0})  P^{1,1} =F^0.
	\end{equation}
	Following the arguments in \eqref{PJge0}, and from \eqref{cytj}
%	{\color{blue}(可保证 $A^T(P^{1,0})$ 是~M-矩阵)}, \eqref{eqJJ-3}
	 and \eqref{FJge0} (i.e. $F^0>0$), we obtain the element of $P^{1,1}$ satisfies
	\begin{equation}\label{PJge0-3}
  p^{i,1,1 }_{k}= ( B^TF^0)_k>0,~ k=1,\ldots, {n_h},i=1,2,
\end{equation}
	Similar to the deduction of \eqref{CJ} %{\color{blue}(或与 \eqref{CJ} 的证明完全相同)}
	,
	using \eqref{cytj} and \eqref{PJge0-3}, we have $E\tilde  A(P^{1,0} )  P^{1,1}> 0$, which combining with  \eqref{eqJJ-3}, \eqref{PJge0-3}, \eqref{EAFE-non-dis}  and \eqref{def-CJ} yields
	\begin{eqnarray*}
C_0=EF^0=E({\bf M}+\tau \tilde  A(P^{1,0})) P^{1,1} >
 E {\bf M} P^{1,1} >  \frac{C_0}{C^{1}_k} p^{i,1,1 }_{k},~\forall k\in\{1,\ldots, n_h\},i\in\{1,2\}.
 \end{eqnarray*}
Then from \eqref{tildeC-C} we have $p^{i,1,1}_{ k}<{C^{1}_k}\le {\tilde C}^{1}_k$. Combining \eqref{PJge0-3}, we get \eqref{phiP-2}.
	
	Next, we show \eqref{tol-dis} when $t=t^1$. From  \eqref{phiP-2}, we know the assumption of Lemma \ref{lemma1} holds when $n=1$. Then from Lemma  \ref{lemma1}, \eqref{EAFE-non-2-dis}  and \eqref{phiP-2}, we obtain
	\begin{eqnarray}\notag
	\| P^{1,l+1} - P^{1,l} \|_{\infty}&=&\|\phi^{1}(P^{1,l})-\phi^{1}(P^{1,l-1})\|_{\infty}
%	~~\text{\color{blue}(利用 \eqref{EAFE-non-2-dis})}
	\notag\\&\le& \alpha_1\| P^{1,l}-  P^{1,l-1} \|_{\infty}
%	~~\text{\color{blue}(引理 \ref{le-infty-l} 中取 $n=1$ )}
	\notag\\&\le& \alpha_1^{l}\| P^{1,1}-  P^{1,0}\|_{\infty}\le  2\alpha_1^{l} \max_k\{{\tilde C}_k^{1}\},
	%~~\text{\color{blue}(利用 \eqref{phiP-2})}
	\label{ys},
	\end{eqnarray}
	 Hence we have \eqref{tol-dis} when $t=t^1$, and the minimum positive constant which satisfies \eqref{tol-dis} is $L_1=\lceil  \log_{\alpha_{1}}\frac{\tilde\epsilon}{2\max\limits_k\{{\tilde C}_k^{1}\}} \rceil$. Denoting by $P^{1}=P^{1,L_1}$, and taking $l=L_1$ in ~\eqref{phiP-2}, it follows that there exists a positive constant ~$C_{p^{1}}$ such that the element of $ P^{1}$ satisfies
	\begin{equation}\label{p1-33}
C_{p^{1}}:=\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{i,{1} }_k   >0.
\end{equation}
	
	
Next, for the time step $t=t^m(m\ge 1)$,  assume there exists a positive constant $L_{m}=\lceil  \log_{\alpha_{m}}\frac{\tilde \epsilon}{2\max\limits_k\{{\tilde C}_k^{m}\}} \rceil$ when
$\tau<\tau_{*,m-1}$,  such that the Gummel iterative sequence $\{P^{m,l},l=0,1,\ldots,L_m\}$ satisfies the convergence codition \eqref{tol-dis} and
	\begin{equation}\label{phiP-m}
 %P^{n,l}\in \mathcal {\tilde C}^{n},~l=0,1,\ldots,L_n.
 0<p^{i,m,l}_{ k}\le {\tilde C}^{m}_k,~\forall k\in\{1,\ldots, n_h\},i\in\{1,2\},~l=0,1,\ldots,L_m,
\end{equation}
and there is a constant $C_{p^{m}}$ independent of $P^{m}:=P^{m,L_m}$ %{\color{blue}(对 $m=1$ 的情形见 \eqref{p1-33})}
satisfies
	\begin{equation}\label{pJ-3}
	C_{p^{m}}:=\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{i,{m}}_k  >0.
	\end{equation}
	
Now we show
	\eqref{tol-dis}-\eqref{pJ-3} when $m:=m+1$.
	Setting $P^{m+1,0}=P^{m,L_m}$, taking $l=L_m$ in \eqref{phiP-m} and from \eqref{set-JJ-3}, we have
	\begin{equation}\label{phiP-2m+1-0}
0<p^{i,m+1,0}_{ k} =p^{i,m,L_m}_{ k}\le {\tilde C}^{m}_k \le {\tilde C}^{m+1}_k,~\forall k\in\{1,\ldots, n_h\},i\in\{1,2\}.
\end{equation}
Since the assumption of Lemma \ref{lemma1} holds when $J=m$ by \eqref{pJ-3},  combining \eqref{Fi},  using Lemma \ref{lemma1} we have \eqref{FJge0} when $J=m$. Following the deduction of \eqref{phiP-2} for  $l\ge 1$ when $t=t^1$, it yields
%{\color{blue}(将 $P^{1,l}$ 和 $F^0$ 用 $P^{m+1,l}$ 和 $F^m$ 替换)}% $m:=m+1$ 时 \eqref{phiP-2} 成立.
	\begin{equation}\label{phiP-2m+1}
%P^{1,l}\in \mathcal {\tilde C}^{1},~l=1,\ldots,L_1.
 0<p^{i,m+1,l}_{ k}\le {\tilde C}^{m+1}_k,~\forall k\in\{1,\cdots, n_h\},i\in\{1,2\},~l=1,\cdots,
\end{equation}
	which combining with \eqref{phiP-2m+1-0} and  \eqref{phiP-2m+1}, we get
	\begin{equation}\label{phiP-2m+1-01}
 0<p^{i,m+1,l}_{ k}\le {\tilde C}^{m+1}_k,~\forall k\in\{1,\cdots, n_h\},i\in\{1,2\},~l=0,1,\cdots.
\end{equation}
	Further, since \eqref{phiP-2m+1-01} is equivalent to Assumption \eqref{assume} when $n=m+1$, similar to the deduction of ~\eqref{ys}, we have
	\begin{eqnarray}
	\| P^{m+1,l+1} - P^{m+1,l} \|_{\infty} \le  2\alpha_{m+1}^{l} \max_k\{{\tilde C}_k^{m+1}\}. \label{ys-m+1}
	\end{eqnarray}
	 Hence  we get \eqref{tol-dis} on $t=t^{m+1}$ and the minimum positive  constant satisfying
	 \eqref{tol-dis} is $L_{m+1}=\lceil  \log_{\alpha_{m+1}}\frac{\tilde \epsilon}{2\max\limits_k\{{\tilde C}_k^{m+1}\}} \rceil$ .
Setting $P^{m+1}=P^{m+1,L_{m+1}}$ and taking $l=L_{m+1}$ in ~\eqref{phiP-2m+1-01}, we have there exists a constant~$C_{p^{m+1}}$ such that the element of $ P^{m+1}$ satisfies
	\begin{equation}\label{p1-33}
C_{p^{m+1}}:=\min_{k\in\{1,\ldots, n_h\},i= 1,2 }  p^{i,m+1}_k
>0.
\end{equation}
Then using \eqref{phiP-2m+1-01}-\eqref{p1-33}, it follows that the Gummel iterative sequence $\{P^{m+1,l},l=0,1,\ldots,L_{m+1}\}$ satisfies the convergence condition \eqref{tol-dis} when $m:=m+1$, and  ~\eqref{phiP-m} and \eqref{pJ-3} hold.
	We complete the proof of this theorem by the mathematical induction.
\end{proof}

\begin{defi}
The sequence $\{P^{n,l}\}$ is convergent, referring to there existence of $P ^ {n, *} \in R ^ {2n_h} $, such that
%称序列 $\{P^{n,l}\}$ 是收敛的, 是指存在~$P^{n,*}\in R^{2n_h}$, 使得
\begin{equation} 
\lim\limits_{l\rightarrow\infty}P^{n,l}=P^{n,*}.
\end{equation}
\end{defi}

From Theorem \ref{theorem}, it is easy to obtain the following  corollary.
\begin{coro}
Under the condition of  Theorem \ref{theorem}, for any given time step $t=t^{n},n\in\{1,\ldots,N\}$, the Gummel iteration sequence $\{P^{n,l}\}$ is convergent.
%在定理的条件下, 序列是收敛的. 
\end{coro}

\subsection{Numerical experiment}
%In this section, we present two numerical experiments to.... First, we verify the contraction and convergence of the Gummer iteration shown in Subsection ...
In this subsection, we present a numerical experiments to verify the contraction and convergence of the Gummel iteration. To implement the algorithms, the code is written in
Fortran 90 and all the computations are carried out on the computer with 32-core
187 GB RAM PowerEdge T640.
% Suppose the computational domain~$\Omega=[-\frac{L}{2}, \frac{L}{2}]^{3} $, and consider the following PNP equations in semiconductor area \textsuperscript{\cite{wang2021stabilized}}:
%\begin{equation}\label{model-1}
%\left\{
%  \begin{array}{ll}
%     -\nabla \cdot (\varepsilon \nabla u)=\frac{e_{c}^{2} \beta}{\varepsilon_{0}}(p-n),  &   \hbox{in $\Omega$  ;}  \\
%   -\nabla \cdot (D_{p}(\nabla p+p \nabla u))=F^p ,   &  \hbox{in $\Omega$ ;}\\
% -\nabla \cdot (D_{n}(\nabla n-n \nabla u)
%)=F^n ,&\hbox{in $\Omega$ ;}
%  \end{array}
%\right.
%\end{equation}
%with Dirichlet boudary conditons
%\begin{equation}\label{bd-1}
%\left\{
%  \begin{array}{ll}
%   u|_{\partial \Omega}=0 , & \hbox{on $\partial\Omega$ ;} \\
%   p|_{\partial \Omega}=c^{b}, & \hbox{on $\partial\Omega$ ;} \\
%   n|_{\partial \Omega}=c^{b} , & \hbox{on $\partial\Omega$ ;}
%  \end{array}
%\right.
%\end{equation}
%where the exact solution is given by
%\begin{equation}\label{ue-1}
%\left\{
%  \begin{array}{ll}
%   u=\frac{L^{2}}{3 \pi^{2} \varepsilon} \frac{e_{c}^{2} \beta}{\varepsilon_{0}} c^{b } \cos \frac{\pi x}{L} \cos \frac{\pi y}{L} \cos \frac{\pi z}{L}, & \hbox{ } \\
%    p=c^{b}\left(1+\frac{1}{2} \cos \frac{\pi x}{L} \cos \frac{\pi y}{L} \cos \frac{\pi z}{L}\right), & \hbox{ } \\
% n=c^{b}\left(1-\frac{1}{2} \cos \frac{\pi x}{L} \cos \frac{\pi y}{L} \cos \frac{\pi z}{L}\right).& \hbox{  }
%  \end{array}
%\right.
%\end{equation}% $L$  的单位为 $m$,
%%The right hand functions $F^p$ and~$F^n$ can be obtained from~\eqref{ue-1},
%Here $u$ is the dimensionless electrostatic potential, the units of hole concentration $p$ and electron concentration $n$ are taken as~$m^{-3}$, the value of the parameters in  \eqref{model-1}-\eqref{bd-1} are displayed in Table 1.
%\begin{table}[H]
%\centering\begin{tabular}{|c|c|c|c|c|}
%\hline Parameter & Notation  & Value and unit  \\
%\hline Relative dielectric constant in solvent region& $\varepsilon$ & 80 (dimensionless) \\
%\hline Unit charge& $e_{c}$ &  $1.60217 \times 10^{-19} \mathrm{C} $\\
%\hline Inverse of Boltzmann constant& $\beta $&  $2.4307\times 10^{20} \mathrm{~J}^{-1} $\\
%\hline Dielectric constant in vacuum& $\varepsilon_{0} $&   $8.854187817 \times 10^{-12} \mathrm{C}^{2} \cdot \mathrm{J}^{-1} \cdot \mathrm{m}^{-1} $\\
%\hline Diffusion coefficient for hole and electron &$D_{p}, D_{n}$  & $10^{-9} \mathrm{  m}^{2} \cdot \mathrm{s}^{-1}$ \\
%\hline Concentration on the boundary& $c^{b  } $&   $1M=6.02214 \times 10^{26} \mathrm{~m}^{-3} $\\
%%\hline L &  设定的区域边长  & 1 U(U   是某个长度单位 ) \\
%\hline
%\end{tabular}
%\caption{  The values of the parameters  }
%\end{table}
%Since the exact solution to (\ref{model-1}) reaches the order of magnitude of $10^{25}$ after the dimensionless by using the values and units in Table 1, the solution needs to be normalized to avoid numerical errors caused by the limitation of computer.
%%Inserting the values of the parameters shown in Table 1 into the PNP equations, we have
%Denote by
%
%%%
%\begin{equation}\label{norma}
%		u:=1.7907\times 10^{17}\lambda ^{-2}  u,~p:=\frac{6.022\times 10^{26}}{3\pi^2}p,~ n:=\frac{6.022\times 10^{26}}{3\pi^2}n,
%\end{equation}
%where $\lambda$ is a certain constant dependent on the unit $U $ of lenth $L$ of $\Omega$, and the corresponding relationship between $U $ and~$\lambda$ is as follows:
%\begin{table}[H]
%\centering\begin{tabular}{|c|c|c|c|c|}
%\hline 单位~$U$  & $m$ & $ mm$  &  $\mu m  $&  $nm $ \\
%\hline $\lambda $ & 1 &$ 10^{3}  $  &  $10^{6}  $ & $ 10^{9}  $  \\
%\hline
%\end{tabular}
%\caption{ Relationship between $U $ and~$\lambda$}\label{1}
%\end{table}
%Inserting (\ref{norma}) into (\ref{model-1}) and \eqref{ue-1}, respectively, we get the following equation on ~$\Omega=[-\frac{1}{2},  \frac{1}{2}]^{3} $ :
%\begin{equation}\label{cont-new-model-steady}
%\left\{
%  \begin{array}{llll}
%&-\Delta u- ( p-n)=0 , & & \text { in } \Omega, \\
%&-\nabla \cdot\left(\nabla p +c_{\lambda}  p  \nabla u\right) =F^p, & & \text { in } \Omega, \\
%&-\nabla \cdot\left(\nabla n-c_{\lambda} n \nabla u\right) =F^n, & & \text { in } \Omega,\end{array}
%\right.
%\end{equation}
%with $c_{\lambda}=0.17907L^2$,
%and the exact solution after the normalization
%\begin{equation}\label{ue-beachmark}
%\left\{
%\begin{array}{ll}
%u = \cos(\pi x)\cos(\pi y)\cos(\pi z),&\\
%p  =3\pi^2(1+\frac{1}{2}\cos(\pi x)\cos(\pi y)\cos(\pi z)), &  \\
%n=3\pi^2(1-\frac{1}{2}\cos(\pi x)\cos(\pi y)\cos(\pi z)).&
%\end{array}
%\right.
%\end{equation}
%%where the right hand sides in \eqref{cont-new-model-steady} are obtained from the exact solution (\ref{ue-beachmark}).

%Next, we consider a numerical experiment for a time-dependent PNP equations to verify the contraction and convergence of the Gummel iteration.

\begin{exam}
Consider the following dimensionless time-dependent PNP equations in semiconductor area (cf. {\cite{wang2021stabilized}} for the steady-state form):
\begin{equation}\label{cont-new-model}
\left\{
  \begin{array}{llll}
&-\Delta u- ( p-n)=F_1 , & & \text { in } \Omega, \\
&{\partial_t p }-\nabla \cdot\left(\nabla p +c_{\lambda}  p  \nabla u\right) =F_2,  & & \text { in } \Omega, \\
&{\partial_t n}-\nabla \cdot\left(\nabla n-c_{\lambda} n \nabla u\right) =F_3,  & & \text { in } \Omega,\end{array}
\right.
\end{equation}
 with the initial and boudary value conditions
 \begin{equation}\label{boundary-1}
\left\{
\begin{array}{l}
 u=g_u,\text{on}\;\partial\Omega,~\text{for}~t\in(0, T],\vspace{0.5mm}\\
 p =g_{p },~n =g_{n },\;\text{on}\;\partial\Omega,~\text{for}~t\in(0, T],\\
 p ( x,0)=0 ,~n( x,0)=0 ,~\text{for}~  x \in \Omega,
\end{array}
\right.
\end{equation}
where~$\Omega=[-\frac{1}{2}, \frac{1}{2}]^3$ and  $c_{\lambda}=0.179$. %$L^2=1.79$,
The initial-boundary condition and the right-hand side functions $F_i,~i=1,2,3$ are given from the following exact solution
\begin{equation*}
\left\{
  \begin{array}{ll}
    u =(1-e^{-t}) \cos(\pi x)\cos(\pi y)\cos(\pi z),&\\
    p =\sin(t)3\pi^2(1+\frac{1}{2}\cos(\pi x)\cos(\pi y)\cos(\pi z)), &  \\
    n =\sin(2t)3\pi^2(1-\frac{1}{2}\cos(\pi x)\cos(\pi y)\cos(\pi z)). &  \\
  \end{array}
\right.
\end{equation*}
%右端函数和初边值函数由真解代入方程~\eqref{cont-new-model} 中计算得到.
\end{exam}
%下面考察 EAFE 格式 Gummel 迭代的压缩性, 此时

%由~\eqref{contraction-l} 和~\eqref{EAFE-non-2-dis} 可知: 在给定时间层~$t=t_{k}$ 上相邻迭代步之间满足压缩性
%\begin{equation}\label{contraction-2}
%\| P^{k,l+1} - P^{k,l} \|_{\infty}\le \alpha^{(l)}_{k}\| P^{k,l}-  P^{k,l-1} \|_{\infty},~l=1,\ldots,{L_k-1},~\alpha^{(l)}_{k}=O(\tau),
%\end{equation}

%\begin{exam}
%	Let $\Omega=[-0.5,0.5]^3$ and consider the following time-dependent PNP equations
%	\begin{equation}\label{cont-new-model}
%	\left\{
%	\begin{array}{llll}
%	&-\Delta \phi-\sum\limits^{2}_{i=1}q^{i}p^{i}=f^3, & & \text { in } \Omega, \\
%	&{\partial_t p^i}-\nabla \cdot\left(\nabla p^i+c_{\lambda} q^ip^i \nabla \phi\right) =f^i, i=1,2,& & \text { in } \Omega,\end{array}
%	\right.
%	\end{equation}
%	with the boundary and initial value conditions given by
%	\begin{equation}\label{boundary-1}
%	\left\{
%	\begin{array}{l}
%	\phi=g_\phi,\text{on}\;\partial\Omega,~\text{for}~t\in(0, T],\vspace{0.5mm}\\
%	p^i=g_{p^i},\;\text{on}\;\partial\Omega,~\text{for}~t\in(0, T],\\
%	p^{i}({\bf x},0)=0 ,~\text{for}~{\bf x} \in \Omega,
%	\end{array}
%	\right.
%	\end{equation}
%	where  $q^1=1$, $q^2=-1$, $c_{\lambda}=0.179,~L^2=1.79$(这里 $L=\sqrt{10}$ 是实际计算区域$\Omega=[-\frac{L}{2},\frac{L}{2}]^3$ 的尺寸). The functions $f^i$, $g_{\phi}$ and $g_{p^i}$ are given by the following exact solution
%	\begin{equation*}
%	\left\{
%	\begin{array}{ll}
%	p_e^1=\sin(t)3\pi^2(1+\frac{1}{2}\cos(\pi x)\cos(\pi y)\cos(\pi z)), &  \\
%	p_e^2=\sin(2t)3\pi^2(1-\frac{1}{2}\cos(\pi x)\cos(\pi y)\cos(\pi z)), &  \\
%	\phi_e=(1-e^{-t}) \cos(\pi x)\cos(\pi y)\cos(\pi z).&
%	\end{array}
%	\right.
%	\end{equation*}
%\end{exam}


%\end{minipage}
%\begin{minipage}[c]{0.5\textwidth}
%\begin{table} [H]
%\caption{$h=\frac{1}{32}$ }
%\centering
%\begin{tabular}{|c|c|c|c|c|c|c|  }% 一个c 表示有一列，格式为居中显示(center)
%\hline
%$\tau$ &  $\bar \alpha$&   rate  \\% 第一行第一列和第二列  中间用&连接
%\hline
%$4h^2$ & 4.61E-2 &  --
%   \\% 第二行第一列和第二列  中间用&连接
%\hline
%$2h^2$ & 2.42E-2	&  1.90
%   \\% 第二行第一列和第二列  中间用&连接
%\hline
% $h^2$ &  1.31E-2 &   1.85
%   \\% 第二行第一列和第二列  中间用&连接
%\hline
%\end{tabular}
%\end{table}
%\end{minipage}
\vskip0.3cm
In our computation, we choose the time step $\tau=h^2$ and set the final time $T=0.25$. The tolerance $\epsilon=1.0\time 10^{-6}$, the maximum iteration $M_{iter}$=500 and the direct solver for linear algebraic system is ~pardiso.

From \eqref{EAFE-non-2-dis} and \eqref{contraction-l}, we have the solution $P^{k,l+1}$ of the Gummel iteration satisfies the contraction on $t=t^{k}$, i.e.
\begin{equation}\label{contraction-2}
\| P^{k,l+1} - P^{k,l} \|_{\infty}\le \alpha^{(l)}_{k}\| P^{k,l}-  P^{k,l-1} \|_{\infty},~l=1,\ldots,{L_k-1},~\alpha^{(l)}_{k}=O(\tau).
\end{equation}
Let $\bar\alpha =\frac{1}{L_k-1}\sum\limits_{l=1}^{L_k-1} \alpha_k^{(l)}$, and  $L_k$ is defined by ~\eqref{phiP-1}. The following Table 1 displays the value of $\bar\alpha$ at different $\tau$ by using the Gummel iteration combining with three FE schemes including standard FE (\ref{fulldis2-FEM})-(\ref{fulldis-FEM}), SUPG (\ref{fulldis-SUPG-temp})-(\ref{fulldis2-SUPG-temp}) and EAFE (\ref{fulldis2-EAFE})-(\ref{fulldis-EAFE}) schemes.
%通过一个实例验证 Gummel 迭代算法 \ref{gummalgo} 的压缩性 \eqref{contraction-l}.
%\begin{minipage}[c]{0.4\textwidth}
\begin{table} [H]%\caption{  $h=\frac{1}{16}$  Gummel   }
	\caption{the value of~$\bar \alpha$ with $h=\frac{1}{16}$   }
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|  }% 一个c 表示有一列，格式为居中显示(center)
		\hline
		$\tau$ &  $\bar\alpha$-FEM &   rate &  $\bar\alpha$-SUPG &   rate &  $\bar\alpha$-EAFE &   rate \\% 第一行第一列和第二列  中间用&连接
		\hline
		$4h^2$ &  1.63E-1 &  --& 1.62E-1 &  -- &1.63E-1 &  --
		\\% 第二行第一列和第二列  中间用&连接
		\hline
		$2h^2$ & 8.55E-2	&  1.91& 8.52E-2	&  1.90& 8.53E-2	&  1.91
		\\% 第二行第一列和第二列  中间用&连接
		\hline
		$h^2$ &  4.49E-2 &  1.90& 4.47E-2 &  1.90 &4.48E-2 &  1.90
		\\% 第二行第一列和第二列  中间用&连接
		\hline
	\end{tabular}
\end{table}
It is shown from the above table that  $\bar\alpha<1$ and $\tilde{\alpha}$ is  linearly dependent on $\tau$, which means the mapping $\phi^{n+1}$ defined by \eqref{EAFE-non-2-dis} is a contraction and coincides with the theoretical result~\eqref{contraction-l}.


 Next, we present the numerical results of Gummel iteration combining with the three FE schemes.
Figures \ref{FEMl2h1}-\ref{EAFEl2h1} show that the errors between the discrete solution $(u_h,~p_h,~n_h)$ and the weak solution $(u,~p,~n)$ in $L^2$ and $H^1$ norms are second-order and first-order reduction, respectively, which indicates the validity of the three FE schemes used to solve the PNP equations (\ref{cont-new-model}).

\begin{figure}[H]
	\centering
	{
		\begin{minipage}{7cm}
			\centering
			\includegraphics[scale=0.48]
			{FEML2.pdf}
		\end{minipage}
	}
	{
		\begin{minipage}{7cm}
			\centering
			\includegraphics[scale=0.48]
			{FEMH1.pdf}
		\end{minipage}
	}
	
	\caption{h-convergence of FEM scheme  with  $t=0.25$   }
	\label{FEMl2h1}
\end{figure}

\begin{figure}[H]
	\centering
	{
		\begin{minipage}{7cm}
			\centering
			\includegraphics[scale=0.48]
			{SUPGL2.pdf}
		\end{minipage}
	}
	{
		\begin{minipage}{7cm}
			\centering
			\includegraphics[scale=0.48]{SUPGH1.pdf}
		\end{minipage}
	}
	
	\caption{h-convergence of SUPG scheme  with  $t=0.25$   }
	\label{SUPGl2h1}
\end{figure}

\begin{figure}[H]
	\centering
	{
		\begin{minipage}{7cm}
			\centering
			\includegraphics[scale=0.48]{EAFEL2.pdf}
		\end{minipage}
	}
	{
		\begin{minipage}{7cm}
			\centering
			\includegraphics[scale=0.48]{EAFEH1.pdf}
		\end{minipage}
	}
	
	\caption{h-convergence of EAFE scheme  with  $t=0.25$   }
	\label{EAFEl2h1}
\end{figure}


%Next, we study the influence of the size of convective coefficient ro convective intensity on the convergence of Algorithm \ref{gummalgo}
%\begin{exam}
%Consider the steady-state PNP equations~\eqref{cont-new-model-steady}
%with boundary condition given by
% \begin{equation}\label{boundary-steady}
%\left\{
%\begin{array}{l}
% u=g_u,\text{on}\;\partial\Omega,\vspace{0.5mm}\\
% p =g_{p },\;\text{on}\;\partial\Omega,~i=1,2,\\
% n=g_{n},\;\text{on}\;\partial\Omega,~i=1,2,
%\end{array}
%\right.
%\end{equation}
%where~$\Omega=[-0.5,0.5]^3$, the exact solution is defined by~\eqref{ue-beachmark}.
%\end{exam}
%
%
%Noting that the diffusion coefficient of \eqref{cont-new-model-steady},  we observe the iteration times and error of Algorithm \ref{gummalgo} based on EAFE scheme, the result of which is shown in Table \ref{gummel-iter}. The tolerence $\epsilon=1E-6$, $M_{iter}=1000$, $c_{\lambda}=0.179L^2$, the direct solver to solve ~\eqref{gumm2} and~\eqref{gumm1} is pardiso. For simplicity, denote by~$e_{\zeta}=u_h-u ,~\zeta=u,p ,n$, where $*$ means divergence.
%\begin{table} [H]
%\caption{Iterations}\label{gummel-iter}
%\centering
%\begin{tabular}{|c|c|c|c|c|c|c|c|c|c| }% 一个c 表示有一列，格式为居中显示(center)
%\hline
%\diagbox{$h$}{$L$}  & 1  & $\sqrt{2.6}$ &  $\sqrt{2.7 }$ &  $\sqrt{2.8}$  \\% 第一行第一列和第二列  中间用&连接
%\hline
%$\frac{1}{8}$  & 11	&175&557&*
%   \\% 第二行第一列和第二列  中间用&连接
%% 第二行第一列和第二列  中间用&连接
%\hline
%$\frac{1}{16}$ &9 &	118 &273&*
%   \\
%\hline
%$\frac{1}{32}$ & 7	& 85 & 188  &*
%   \\ \hline
%\end{tabular}
%\end{table}
%\noindent
%
%\begin{table} [H]
%\caption{Error when $h=\frac{1}{8}$  }\label{Gummel-8}
%\centering
%\begin{tabular}{|c|c|c|c|c|c|c|c|c| }% 一个c 表示有一列，格式为居中显示(center)
%\hline
%$L$ &$\|e_{ u }\|_0$   &  $\|e_{ p  }\|_0$ &  $\|e_{ n }\|_0$ & $\|e_{ u }\|_1$   & $\|e_{ p  }\|_1$ & $\|e_{ n }\|_1$   \\% 第一行第一列和第二列  中间用&连接
%\hline
%$1$  & 2.32E-02&	4.00E-01&	4.06E-01&	4.80E-01&	7.10 &	7.10
%\\
%\hline
%$\sqrt{2.6}$ &2.43E-02	&4.08E-01&	4.32E-01&	4.80E-01&	7.11 	&7.11
%   \\% 第二行第一列和第二列  中间用&连接
%\hline
%$\sqrt{2.7}$  & 2.43E-02&	4.08E-01	&4.33E-01&	4.80E-01&	7.11 &	7.11
%   \\% 第二行第一列和第二列  中间用&连接
% \hline
%\end{tabular}
%\end{table}
%\begin{table} [H]
%\caption{ Error when $h=\frac{1}{16}$}\label{Gummel-16}
%\centering
%\begin{tabular}{|c|c|c|c|c|c|c|c|c| }% 一个c 表示有一列，格式为居中显示(center)
%\hline
%$L$ & $\|e_{ u }\|_0$   &  $\|e_{ p  }\|_0$ &  $\|e_{ n }\|_0$ & $\|e_{ u }\|_1$   & $\|e_{ p  }\|_1$ & $\|e_{ n }\|_1$  \\% 第一行第一列和第二列  中间用&连接
%\hline
%$1$  & 6.04E-03&	1.03E-01&	1.05E-01	&2.43E-01&	3.60 &	3.60
%\\
%\hline
%$\sqrt{2.6}$ & 6.12E-03	&1.08E-01&	1.14E-01&	2.43E-01	& 3.60 &	3.60
%   \\% 第二行第一列和第二列  中间用&连接
%\hline
%$\sqrt{2.7}$  &6.36E-03	&1.04E-01	&1.11E-01&	2.43E-01&	3.60 &	3.60
%   \\% 第二行第一列和第二列  中间用&连接
%\hline
%\end{tabular}
%\end{table}
%\begin{table} [H]
%\caption{Errors when $h=\frac{1}{32}$}\label{Gummel-32}
%\centering
%\begin{tabular}{|c|c|c|c|c|c|c|c|c| }% 一个c 表示有一列，格式为居中显示(center)
%\hline
%$L$ &  $\|e_{ u }\|_0$   &  $\|e_{ p  }\|_0$ &  $\|e_{ n }\|_0$ & $\|e_{ u }\|_1$   & $\|e_{ p  }\|_1$ & $\|e_{ n }\|_1$   \\% 第一行第一列和第二列  中间用&连接
%\hline
%$1$  & 2.16E-03&	2.25E-02&	2.34E-02&	1.22E-01&	1.80 &	1.80
%\\
%\hline
%$\sqrt{2.6}$ &2.46E-03&	1.65E-02&	1.72E-02&	1.22E-01&	1.80 &	1.80
%   \\% 第二行第一列和第二列  中间用&连接
%\hline
%$\sqrt{2.7}$  & 8.65E-04&	3.98E-02	&4.16E-02&	1.22E-01&	1.81 &	1.81
%   \\% 第二行第一列和第二列  中间用&连接
%\hline
%\end{tabular}
%\end{table}
%\vskip0.5cm
%From Tables \ref{gummel-iter} to \ref{Gummel-32}, it can been seen that  the iteration of Gummel iteration increases rapidly even divergence as the size $L$ of domain increases (the diffusion coefficient becomes large).
%
%From the above, we know that although the commonly used Gummel iteration is effective at some cases, it is not easy to converge for some complex cases. The time step needs to small enough for some time-dependent PNP equations. It need to design more robust and efficient algorithm. Full approximation storage (FAS) is commmonly used efficient method to solve some nonlinear PDE discretite system\textsuperscript{\cite{brandt1977multi,bueler2021full}}. In next section, we introduce the two-level FAS algorithm for PNP equations.
%
%\setcounter{lemma}{0}
%\setcounter{theorem}{0}
%\setcounter{corollary}{0}
%\setcounter{equation}{0}
%%\section{Geometric and algebraic full approximation scheme}
%\section{Algebraic full approximation scheme}
%
%In this section, we present the algebraic full approximation scheme for PNP equations.
%
%
%%First, we introduce the geometric full approximation scheme (FAS) \cite{TGPNP}, then discuss the algebraic FAS.
%Setting $ V_{h_1}=V_h$, the nonlinear system \eqref{EAFE-non} can be written as
%\begin{equation}\label{1.1-EAFE}
%A_1(U_1)U_1=F_1.
%\end{equation}
%Here
%{%\small%\footnotesize
%\begin{equation}\label{def-A1U1F1}
%A_1(U_1):=\left(
%  \begin{array}{cc}
%   A_{1}^\Phi& \bar M_1\\
%   \bf 0    &  A_1^{P}(\Phi_1) \\
%  \end{array}
%\right)%=A_{h}(U_h)
%,~U_1=\left(
%  \begin{array}{c}
%     \Phi_1\\P_1
%  \end{array}
%\right),~F_1=\left(
% \begin{array}{c}
%    F_1^\Phi \\
%    F_1^{P}
% \end{array}
%\right),
%\end{equation}}
%where
%\begin{equation}\label{def-A1F1}
%A_{1}^\Phi=A_L,~ \bar M_1=\begin{pmatrix}
%-q^1M_1& -q^2 M_1
%\end{pmatrix},~ M_1=  M,~A_1^{P}(\Phi_1):= {\bf M}+ \tau \bar A^1(\Phi^{n+1} ),
%\end{equation}
%\begin{equation}\label{def-U1}
% \Phi_1=\Phi^{ n+1,1},~P_1=P^{ n+1,1},~
%F_1^\Phi=G_\Phi^{n+1},~F_1^{P}=F^{n,1}.
%\end{equation}
%
%%\noindent
%
%Next, we present the algebraic FAS algorithm combining coarsening algorithm of AMG, interpolation matrix generation algorithm with geometric FAS algorithm. \begin{algorithm}[H]%\small%\footnotesize
%\caption{Algebraic type~FAS algorithm}\label{a-FAS}
%\begin{description}
%  \item[Setup:]~
%\begin{description}
%  \item[S1.]  Generate grid $\mathcal{T}_{h_1}$ and submatrix ~$A^\Phi_1$ of stiffness matrix  ~$A_{1}(\cdot)$corresponding to the discrete system ~\eqref{fulldis2-EAFE}-\eqref{fulldis-EAFE} on $\mathcal{T}_{h_1}$, $ \bar M_1$ and right hand vector $F_1$.
%  \item[S2.]  Get the onversion operator between coarse and fine level.
%  \begin{description}
%    \item[S2.1] Generate CF array (denote by ~$n_2^a$ the number of $C$ point) and interpolation matrix ~$P_{1}^{2,a}$ from Algorithm \ref{amg-setup}, .
%
%
%    \item[S2.2] Get degree of Freedoms conversion matrix~$R_1^{2,u,a}\in R^{n_{2}^a\times n_1}$, the general element of which is defined by
%\begin{equation}\label{Ru2-a}
%R_1^{2,u,a}(i,j)=\left\{
%         \begin{array}{ll}
%           \frac{R_1^{2,a}(i,j)}{ \sum\limits_{j=1}^{n_{1}} R_1^{2,a}(i,j)}, & \hbox{若~$R_1^{2,a}(i,j) \ne 0$;} \\
%           0, & \hbox{else,}
%         \end{array}
%       \right.,
%\end{equation}
%where~$ R_1^{2,a}=(P_2^{1,a})^T$.
%
%  \end{description}
%
%\item[S3.] Generate the submatrix of the coarse grid operator $ A_{2}(\cdot)$
%\begin{equation}\label{A2-submatrix}
% A^\Phi_2=R_1^{2,a}A^\Phi_1P_2^{1,a}, ~M_2=R_1^{2,a}M_1P_2^{1,a},%~ A_1^{P}(\Phi_1).
%\end{equation}
%and give the initial value ~$U_1^{(0)}$, stop tolerence ~$\epsilon$ between coarse and fine grid and~$\epsilon_c$ and maximum iteration  ~$M_{iter}$.
%\end{description}
%
%
%  \item[Solve:]
%
% Fro any $l\ge0$, the algorithm procedure from ~$U_{1}^{(l)}\rightarrow U_{1}^{(l+1)}$ is as follows:
%  \begin{description}
%
% \item[S1.]{\bf Pre-smoothing}:   Given initial value~$  U_1^{( l)} $, perform $ \nu_{1}\ge 0$ times~Gummel iteration using Algorithm \ref{gummalgo} to get~$U_1^{ ( fs  )}$.
%
%   \item[S2.]{\bf }: Soving nonlinear system on  on the coarse grid by Algorithm \ref{csolve-a}
%\begin{equation}\label{ce}
%A_2\left(  U_2\right) U_2=\tilde{\tau}_2.
% \end{equation}
%Here {%\small
%\begin{equation}\label{Atau}
%    A_2(\cdot)=\vec R_1^{2,a }A_1 ((\vec R_1^{2,a })^T(\cdot) )(\vec R_1^{2,a })^T,~  \tilde{\tau}_2:=\vec R_1^{2,a }A_1 ((\vec R_1^{2,a })^Ty_2 ) y_2+\vec R_1^{2,a }r_1, % ~r_1=F_1-A_1\left(U_1^{(fs)}\right)  U_1^{(fs)},
%    \end{equation}}
%   where
%\begin{equation}
%r_1=F_1-A_1\left(U_1^{(fs)}\right)  U_1^{(fs)},~~ \vec R_1^{2,a} =diag(R_1^{2,a}, R_1^{2,a}, R_1^{2,a}),~ y_2 = \vec R_1^{2,u,a}   U_1^{(  f s)},
% \end{equation}
%\begin{equation}
%   \vec R_1^{2,u,a} =diag(R_1^{2,u,a}, R_1^{2,u,a}, R_1^{2,u,a}).
% \end{equation}
%
%\item[S3.] {\bf correction on coarse grid}:
%\begin{equation}
%  U_1^{ ( bs  )}=  U_{h_{1}}^{( fs)} + ( \vec R_1^{2,a } )^T(  U_2-y_2).
%\end{equation}
%
%\item[S4.] {\bf Back-smoothing }: Taking $U_1^{( bs)} $ as the initial value, perform $\nu_2\ge 0$ times Gummel iteration by Algorithm \ref{gummalgo} to get $  U_1^{ ( l+1  )} $.
%\end{description}
%\end{description}
%\end{algorithm}
%
%Algorithms ~\ref{amg-setup} and ~\ref{csolve-a} used above are descripted as follows.
%\begin{algorithm}[H]\small
%\caption{Generate CFmarker array and interpolate matrix $P_{1}^{2,a}$}\label{amg-setup}
%\begin{description}
%  \item[S1]Given coarsing times $k$, strong and weak connectivity threshold $\theta_1$, row sum parameter $\theta_2$, the finest grid matrix $A_1$, generate array~CF\_marker\_l on each level and interpolant matrix $P_l$ between coarse and fine grid. For $l=1,\ldots, k$, Do
%\begin{description}
%  \item[S1.1] Get strong connect matrix  $S_l\in R^{n_l\times n_l}$, the general element of which is
%    \begin{equation*}
%    S_l(i,j) =\left\{
%     \begin{array}{l}
%      1,~~j\in S_i^l;\\
%      0,~~otherwise.
%     \end{array}
%    \right.
%  \end{equation*}
%
%  %调用 $CreateSNew$, 生成矩阵 $A_l=(a_{ij})$ 的强连通矩阵 $S_l$(具体算法见课件三 Page15-17);% Ruge-St\"{u}ben
%  \item[S1.2] Let the set of numbers of the degree of freedoms on level $l$ be $V_l=\{1,2,\cdots,n_l\}$. Perform C/F splitting for $V_l$ by using $S_l$, and get the C/F property array
%  \textsuperscript{\cite{ruge1987algebraic}},
%   \begin{eqnarray*}
% \text{ CF\_marker\_l}(i) =
%  \begin{cases}
%    -1, & \mbox{if}~i\in F_l  \\
%    1,  & \mbox{if}~i\in C_l
%  \end{cases},~C_l\cup F_l=V_l, ~C_l\cap F_l=\emptyset,
%\end{eqnarray*}
%%其中 $$.
%which strictly satisfies C1 condition, and tries to satisfy~C2 condition \textsuperscript{\cite{ruge1987algebraic}}.% 这里 $V_l=\{1,2,\cdots,n_l\}$ 是第 $l$ 层的(网格)自由度集合.
%
%   \item[S1.3]% 利用矩阵 $A_l$、$S_l$ 和数组 $CF_l$, 调用 $ClassicalInterp$,
%Get interpolant matrix $P_l\in R^{n_l\times n_{l+1}}$ from the grid~$(l+1)$ to grid $l$, the general element satisfies
%\begin{equation*}
%  P_l(i,j) = - \frac{1}{a^l_{ii}+\sum\limits_{k\in D_i^{w,l}\cup F^l_i} a^l_{ik}}
%  \left( a^l_{ij}
%  + \sum\limits_{k\in D_i^{s,l} \backslash F^l_i} \frac{a^l_{ik} \hat{a}^l_{kj}}{\sum\limits_{m\in C^l_i} \hat{a}^l_{km} }\right),
%\end{equation*}
%where
%\begin{equation*}
%  \hat{a}^l_{ij} = \left\{
%   \begin{array}{ll}
%     0, & \text{if sign}(a^l_{ij})= \text{sign} (a^l_{ii}); \\
%     a^l_{ij}, & \text{otherwise}.
%   \end{array}
%  \right.
%\end{equation*}
%
%  \item[S1.4] generate the coefficient matrix on grid~$(l+1)$
%  \begin{equation}
%  A_{l+1}=P_l^T A_{l}P_l=(a_{ij}^{l+1})_{n_{l+1}\times n_{l+1}}.
%  \end{equation}
%\end{description}
%
% \item[S2]  Incorporate level by level for ~CF\_marker\_l to get two-level CFmarker needed and corresponding $n_2^a\times n_1$ lifting matrix $P_{1}^{2,a}=\Pi_{l=1}^{k} P_l$, where~$n_2^a=n_{k+1}$.
%\end{description}
%\end{algorithm}
%
%%\newpage
%%\newpage
%\begin{algorithm}[H]
%\small
%\caption{Gummel algorithm on coarse system~\eqref{ce}}\label{csolve-a}
%\begin{description}
%  \item[Setup:] generate matrix $A_2^{\Phi}$, $\bar M_2 $ and $\tilde{\tau}_2$, from \eqref{A2-submatrix} and~\eqref{Atau}, and give the initial value~$U_2^{(0)}$, stopping tolerance~$\epsilon_c$ and maximum number of iterations~$M_{iter}$.
%  \item[Solve:]  For~$l\ge0$,  Gummel iteration from~$U_2^{(l)}\rightarrow U_2^{(l+1)}$ is as follow.
%% \noindent 给定初值 $U^{(0)}$, 对任意 $k\ge 0$, 下面给出从 $U^{(k)}\rightarrow U^{(k+1)}$ 的算法流程.
%\begin{description}
%  \item[S1.] Solve the following linear system
%  \begin{align}
%  A_2^{\Phi}  \Phi_2^{(l+1)}= \tilde{\tau}_2^\Phi-   \bar M_2 P_2^{(l)};
%  \end{align}
%  \item[S2.]generate~$A_2^{P} (\Phi_2^{(l+1)})= R_1^{2,a }A_1^{P} ( P_2^{1,a}\Phi_2^{(l+1)})P_2^{1,a }.$
%  \item[S3.]Solve the linear system
%  \begin{align}
%  A_2^{P} (\Phi_2^{(l+1)})P_2^{(l+1)}= \tilde{\tau}_2^{P};
%  \end{align}
%  \item[S4.] If%For a given tolerance $\epsilon$,
%\begin{align}\label{tol-3}
%\| \tilde{\tau}_2-A_2(  U_2^{ ( l+1 )} )  U_2^{ ( l+1 )}  \|_{R^{3n_{2}^a}}\leq\epsilon_c,
%\end{align}
%or~$l+1\ge M_{iter}$, then set~$U_1=U_1^{ ( l+1 )}$. Otherwise let~$l\leftarrow l+1$,  return ~S1 and continue.
%\end{description}
%\end{description}
%\end{algorithm}
%
%For given tolerance~$\epsilon$, the exit of Algorithm~\ref{a-FAS} is ~$l+1\ge$ $M_{iter}$ or
%%对于 \eqref{ce-g},
%%stop the iteration if
%\begin{align}\label{tol-fas}
%\|F_1-A_1 (  U_1^{ ( l+1 )} )  U_1^{ ( l+1 )}  \|_{R^{3n_1}}\leq\epsilon.
%\end{align}
%
%Next we present an example of PNP equations in ion channel. Since the mesh used in ion channel is unstructured grid, it is very difficult to get natrual coarse grid. Hence the geometric FAS algorithm is not suitable and we use algebraic FAS algorithm \ref{a-FAS} to solve the practical PNP problem and compare the result with that of Gummel from the error, convergence speed and CPU time.
%
%\begin{exam}
%Consider the following PNP equations for simulating  ~Gramicidin A(gA) ion channel in $1:1$ CsCl solution with valence $+1$ and $-1$
%\textsuperscript{\cite{lu2007electrodiffusion}}
%\begin{equation}\label{prob1}
%\left\{\begin{array}{ll}
%-\nabla\cdot(-  D_i\left(\nabla
%p^i+\frac{e}{K_BT}q^ip^i\nabla\phi\right) )=0, \text{in}~\Omega_s,~i=1,2,\\
%-\nabla\cdot(\epsilon\nabla\phi)=\lambda\sum\limits_{i=1}^2q^ip^i +\rho^f,~\text{ in}~\Omega=\Omega_s\cup\bar\Omega_m,
%\end{array}\right.
%\end{equation}%
%where the unknown function $\phi$ is electrostatic potential and $p^1$ and $p^2$ are the concentrations of positive and negative ion, respectively. Here  $\Omega=[-15, 15]\times[-15,15]\times [-30,30] {\AA}$, $\Omega_s$ represents the bulk region,   $\Omega_m$ represents the Membrane and protein region, the diffusion coefficient ~$D_{1} =2.0561 \times 10^{-9} \mathrm{~m}^{2}/\mathrm{s}$, $D_{2}=2.0321\times 10^{-9} \mathrm{~m}^{2} / \mathrm{s} $,  charges $q^1=1$ and $q^2=-1$, elementary charge $e =1.6 \times 10^{-19} \mathrm{C}$, Boltzmann constant $ K_{B} T=4.14 \times 10^{-21} \mathrm{J}$, the dielectric coefficient $\epsilon(x)=\left\{\begin{array}{ll} 2\epsilon_0\ ,~ \mbox{in}~ \Omega_m\\
%80\epsilon_0 ,~ \mbox{in}~ \Omega_s
%\end{array}\right.$, with permittivity of vacuum~$\varepsilon_{0}=8.85 \times 10^{-12} \mathrm{C}^{2}/\left(\mathrm{N} \mathrm{m}^{2}\right)$,  $\lambda=\left\{\begin{array}{ll} 0,~ \mbox{in}~\Omega_m\\
%1,~ \mbox{in}~\Omega_s
%\end{array}\right.$, $\rho^f(\bf x)=\sum\limits_j q_j\delta(  x-  x_j)$ is an ensemble of singular atomic charges $q_j$ located at $x_j$ inside the protein.
%
%% $\Omega_s$ 是溶剂区域,  $\Omega_m$ 是溶质区域,
%
%Let~$\Gamma=\partial\Omega_s\cap\partial\Omega_m$ shows the interface that intersect the membrane and the bulk region, see the red curve in Figure~\ref{cutplanebiid}, $\partial\Omega_1$ is the part of boundary of $Omega$ that perpendicular to $z$ axis (suppose the channel is along the $z$ axis), $\partial\Omega_2$ is the part of boundary of $Omega$ that is along the channel, $\partial\Omega_3 =\partial\Omega \setminus (\partial\Omega_m\cap\partial\Omega) $ ($\partial\Omega_3 =\partial\Omega \setminus \Gamma $)is the surface of the bulk region from which the interface of membrane $Gamma$ is removed. (是~$\partial\Omega$ 中除去溶质与~$\partial\Omega$  相交的部分.)
%
%The interface and boundary conditions are
%\begin{equation}
%[\phi]=0,~[\epsilon\frac{\partial\phi}{\partial \upsilon^m}]=0,~~\mbox{on}~~\Gamma \end{equation}
%and
%\begin{equation}\label{1bd}\left\{\begin{array}{ll}
%\phi=V_{applied},~\mbox{on}~\partial\Omega_1,\\
%\frac {\partial\phi}{\partial\upsilon }=0,~\mbox{on}~ \partial\Omega_2 ,\\
%D_i\left(\nabla
%p^i+\frac{e}{K_BT}q^ip^i\nabla\phi\right) \cdot \upsilon =0,~\mbox{on}~\Gamma,~i=1,2,\\
%p^i=p_{\infty},~\mbox{on}~\partial\Omega_3,~i=1,2,
%\end{array}\right.\end{equation}%$(Cl^-)$$(Cs^+)$
%where $V_{applied}$ is the applied potential,  $\upsilon^m$ and  $\upsilon$ are the unit outer normal vectors of $\Omega_m$ and the boundary, respectively,  and $p_{\infty}$  is the initial concentration.
%
%\end{exam}
%
%
%在模拟中,  $\mathcal {T}_h$ 是用~TMSmesh 生成的四面体网格\textsuperscript{\cite{chen2011tmsmesh}}, 包括~224650 个四面体单元和~37343 个节点, $\Omega_m$ 内膜附近的原子数~$j$,  电荷数~$q_j$ 和原子~$x_j$ 在蛋白质中的位置是从蛋白质数据库获得的.%, 该数据库为~\eqref{prob1} 中的源项~$\rho^f(\bm x)$ 提供数据.
%\begin{figure}[H]\centering
%\includegraphics[width=5cm,height=6cm]{fig/cutplanebdid-ly.png}
%\caption {沿~z 轴且穿过求解域中心的二维切割平面图. 其中
%绿色是溶质区域~$\Omega_m$; 灰色是溶剂区域~$\Omega_s$. } \label{cutplanebiid}
%\end{figure}
%%\begin{figure}[H]
%%\begin{minipage}[t]{0.5\linewidth}
%%\centering
%%\includegraphics[width=6.5cm,totalheight=6cm]{fig/mesh-q.eps}
%%%\caption{asfda}
%%\vskip0.1cm
%%{(a)}
%%\label{fig:side:a}
%%\end{minipage}%
%%\begin{minipage}[t]{0.5\linewidth}
%%\centering%[width=2.8in]
%%\includegraphics[width=6cm,totalheight=6cm]{fig/mesh-q-2.eps}
%%%\caption{(b)}
%%\vskip0.1cm
%%{(b)}
%%%\footnotesize{(b)}
%%\label{fig:side:b}
%%\end{minipage}
%%\caption{(a) gA 离子通道的表面网格剖分, Ratio 表示三角形单元最小边与最大边的比值. (b) gA 离子通道的表面网格剖分的质量分析, 横坐标为三角形最小边与最大边的比值, 纵坐标为单元数.}
%%\label{3dwholesystem}
%%\end{figure}
%由于~PNP 方程~\eqref{prob1} 很难找到解析解. 下面通过将模拟结果与实验数据的电流进行比较, 来验证算法的正确性,  将电流定义为
%\textsuperscript{\cite{tu2013parallel,lu2011poisson}}
%\begin{equation}
%I=e\int_{\Omega_I}(J_1-J_2)dS,
%\end{equation}
%其中, ${\Omega_I}$ 为通道的任意横截面, 正离子和负离子通量为
%\begin{equation}
%J_i=-\nabla \cdot D_i\left(\nabla
%p^i+\frac{e}{K_BT}q^ip^i\nabla\phi\right) ,i=1,2.
%\end{equation}
%
%
%%实验电流数据来自~Andersen~[2]公司, 作为比较的参考数据
%
%下面两个表分给出不同电压下用~Gummel 迭代和~FAS 算法得到的电流, 迭代次数和~CPU 时间, 其中作为参考标准的实验数据是由~Andersen \textsuperscript{ \cite{andersen1983ion}} 提供的.
%
%
%\begin{table}[H]\centering\small
%\caption{在~CsCl 浓度为~0.02M 时,  不同电压(mV) 下, 模拟结果的电流与实验数据的电流}
%\label{ion-A}
%\vskip0.3cm
%\begin{tabular}{|c|c|c|c|c|c|}
%\hline
%{\small 电压 (mV)} &  {\small 实验数据(pA) } &  {\small  Gummel  结果(pA) }  &  {\small FAS  结果(pA)}    \\
%\hline
%25 & 0.13 & 0.14  &    0.14 \\%\hline
%50 & 0.24 & 0.26   &   0.26\\%\hline
%75 & 0.34 & 0.34 &    0.34\\%\hline
%100 & 0.40 & 0.40  &   0.40\\%\hline
%150 & 0.47 & 0.50   &  0.50\\%\hline
%200 & 0.53 & 0.57   &  0.57 \\%\hline
%250 & 0.56 &  0.65  &  0.65\\%\hline
%300 & 0.60 &  0.73 &    0.73\\%\hline
%350 & 0.62 &  0.81  &   0.81\\%\hline
%400 & 0.65 &  0.89 &    0.89\\
%\hline
%\end{tabular}
%\end{table}
%%\begin{table}[H]\centering\small
%%\caption{ 在~CsCl 浓度为~0.02M 时,  不同电压(mV) 下, Gummel 和~FAS 的外迭代次数和~CPU 时间(s) }
%%\label{ion-B}
%%\vskip0.3cm
%%\begin{tabular}{|c|c|c|c|c|c|}
%%\hline
%%{\small 电压 (mV) }& {\small   Gummel 迭代次数} &  {\small FAS 迭代次数 }&  {\small Gummel CPU 时间 }&{\small  FAS CPU 时间  } \\
%%\hline 25 & 10 & 1 & 49 & 29  \\
%%50 &  10 & 1 & 50 & 29  \\
%%75 &  10 & 1 & 49 & 29 \\
%%100 & 10 & 1 & 49 & 29 \\
%%150 & 10 & 1 & 49 & 28 \\
%%200 & 10 & 1 & 50 & 28 \\
%%250 & 10 & 1 & 49 & 28 \\
%%300 & 10 & 1 & 49 & 28 \\
%%350 & 10 & 1 & 50 & 29 \\
%%400 & 10 & 1 & 49 & 28 \\
%%\hline
%%\end{tabular}
%%\end{table}
%\begin{table}[H]\centering\small
%\caption{ 在~CsCl 浓度为~0.02M 时,  不同电压(mV) 下, Gummel 和~FAS 的外迭代次数和~CPU 时间(s) }
%\label{ion-B}
%\vskip0.3cm
%\begin{tabular}{|c|c|c|c|c|c|}
%\hline
%{\small 电压 (mV) }& {\small   Gummel 迭代次数} &  {\small FAS 迭代次数 }&  {\small Gummel CPU 时间 }&{\small  FAS CPU 时间  } \\
%\hline
%25 & 139 & 1 & 690 & 29  \\
%50 &  139 & 1 & 688 & 29  \\
%75 &  139  & 1 & 688 & 29 \\
%100 & 139  & 1 & 679 & 29 \\
%150 & 145  & 1 & 717 & 28 \\
%200 & 145 & 1 & 722 & 28 \\
%250 & 145 & 1 & 717 & 28 \\
%300 & 145 & 1 & 725 & 28 \\
%350 & 145 & 1 & 721 & 29 \\
%400 & 145 & 1 & 718 & 28 \\
%\hline
%\end{tabular}
%\end{table}
%\begin{remark}
%注意一次~FAS 迭代中包括两次前磨光, 两次后磨光和求解一次粗网格系统等, 因此做一次~FAS 迭代的时间差不多是做一次~Gummel 迭代的~6 倍.
%\end{remark}
%由表~\ref{ion-A} 和表~\ref{ion-B} 可见:  代数型~FAS 比~Gummel 迭代法求解速度更快, 且误差基本一致. 接着在非一致网格下比较~Gummel 算法粗化率为~1:8 的代数型~FAS 算法.%的计算效率.
%
%\begin{figure}[H]%[htbp]
%%\begin{minipage}[t]{0.45\linewidth}
%\centering
%\includegraphics[height=5.5cm,width=6cm]{fig/kershaw-6.png}
%\caption{$\mathcal {T}_h^1$: s=0.3 的~Kershaw 网格示意图}\label{Kershaw}
%%\end{minipage}
%%\begin{minipage}[t]{0.65\linewidth}
%%\centering
%%\includegraphics[height=5.5cm,width=9cm]{fig/bx-mesh.png}
%%\caption{$\mathcal {T}_h^2$: s=0.2 的扰动网格示意图 }
%\label{rand}
%%\end{minipage}
%\end{figure}
%%\begin{figure}[H]%[htbp]
%%\begin{minipage}[t]{0.45\linewidth}
%%\centering
%%\includegraphics[height=5.5cm,width=6cm]{fig/kershaw-6.png}
%%\caption{$\mathcal {T}_h^1$: s=0.3 的~Kershaw 网格示意图}\label{Kershaw}
%%\end{minipage}
%%\begin{minipage}[t]{0.65\linewidth}
%%\centering
%%\includegraphics[height=5.5cm,width=9cm]{fig/bx-mesh.png}
%%\caption{$\mathcal {T}_h^2$: s=0.2 的扰动网格示意图 }\label{rand}
%%\end{minipage}
%%\end{figure}
%图~\ref{Kershaw} 是~Kershaw 网格\textsuperscript{\cite{kershaw1981differencing}},  其中~$s=(0,0.5]$ 代表网格扭曲程度(s 越小, 网格质量越差, 特别当~$s=0.5$ 时就是一致网格), % 图~\ref{rand}
%%是扰动网格, 它是在一致网格的基础上, 对内部节点做如下扰动得到的
%%\begin{equation*}
%%x=\left\{
%%    \begin{array}{ll}
%%      a+(b-a)*(1-s)*(i-1)/nx, & \hbox{$2 \le i\le  \frac{nx}{2}+1 $ ;} \\
%%      anew2+(b-anew2)*\frac{ i-\frac{nx}{2}+1 }{nx/2}, & \hbox{$\frac{nx }{2} +1  < i\le  nx $ ;}
%%    \end{array}
%%  \right.
%%\end{equation*}
%%\begin{equation*}
%%y=\left\{
%%    \begin{array}{ll}
%%      a+(b-a)*(1-s)*(j-1)/ny, & \hbox{$2 \le j\le  \frac{ny}{2}+1 $ ;} \\
%%      anew2+(b-anew2)*\frac{ j-\frac{ny}{2}+1 }{ny/2}, & \hbox{$\frac{ny }{2} +1  < j\le  ny $ ;}
%%    \end{array}
%%  \right.
%%\end{equation*}
%%\begin{equation*}
%%z=\left\{
%%    \begin{array}{ll}
%%      a+(b-a)*s*(k-1)/nz, & \hbox{$2 \le k\le  \frac{nz}{2}+1 $ ;} \\
%%      anew1+(b-anew1)*\frac{ k-\frac{nz}{2}+1 }{nz/2}, & \hbox{$\frac{nz }{2} +1  < k\le  nz $ ;}
%%    \end{array}
%%  \right.
%%\end{equation*}
%%其中~$anew1=a+\frac{(b-a)s}{2}$, $anew2=a+\frac{(b-a)(1-s)}{2}$, 区间的左右端点~$a=-0.5,~b=0.5$, $nx=ny=nz$ 是单方向剖分段数.
%下表给出了利用~Gummel 算法~\ref{gummelgo} 和代数型~FAS 算法~\ref{a-FAS} 求解{\bf 算例~3.2} 在~$\mathcal {T}_h^1$  网格剖分下对应离散系统的迭代次数和误差, 其中~$s$ 反应网格扰动程度.
%%\begin{table} [H]
%%\caption{ $\mathcal {T}_h^1$, $h=\frac{1}{12}$, $L=\sqrt{3.5}$ }
%%\small\centering
%%\begin{tabular}{|c|c|c|c|c|c|c|c|c| }% 一个c 表示有一列，格式为居中显示(center)
%%\hline
%%&s &  iter(iter-c)& $\|e_{ u }\|_0$   &  $\|e_{ p  }\|_0$ &  $\|e_{ n }\|_0$ & $\|e_{ u }\|_1$   & $\|e_{ p  }\|_1$ & $\|e_{ n }\|_1$  \\% 第一行第一列和第二列  中间用&连接
%%\hline
%%几何~FAS  & 0.4  & 13(30)  &2.10E-02&	1.20E-01	&1.66E-01&	3.77E-01&	5.60&  5.57
%%\\
%%\hline
%%代数型~FAS  & 0.4 & 7(41)     &2.10E-02&	1.20E-01	&1.66E-01&	3.77E-01&	5.60&  5.57
%%\\
%%\hline
%%几何~FAS  &0.3 & 12(30)  & 5.10E-02&	3.04E-01&	3.97E-01	&5.98E-01&	8.94& 8.82
%%\\
%%\hline
%%代数型~FAS  & 0.3 & 7(19) & 5.10E-02&	3.04E-01&	3.97E-01	&5.98E-01&	8.94& 8.82
%%\\
%%\hline
%%\end{tabular}
%%\end{table}
%
%%\begin{table} [H]
%%\caption{  $\mathcal {T}_h^2$, $h=\frac{1}{16}$, $L=\sqrt{3.0}$  }
%%\small\centering
%%\begin{tabular}{|c|c|c|c|c|c|c|c|c| }% 一个c 表示有一列，格式为居中显示(center)
%%\hline
%%&s &  iter(iter-c) & $\|e_{ u }\|_0$   &  $\|e_{ p  }\|_0$ &  $\|e_{ n }\|_0$ & $\|e_{ u }\|_1$   & $\|e_{ p  }\|_1$ & $\|e_{ n }\|_1$  \\% 第一行第一列和第二列  中间用&连接
%%\hline
%%Gummel  &   &    &
%%\\
%%\hline
%%自适应代数型~FAS  & 0.3 & 7(22)  &1.41E-02	&9.58E-02	&1.02E-01	&3.01E-01&	4.46&	4.46
%%\\
%%\hline
%%Gummel  &
%%\\
%%\hline
%%自适应代数型~FAS &0.2  &6(27)   &  1.47E-02	&9.88E-02	&1.05E-01	&3.10E-01&	4.59&	4.59
%%\\
%%\hline
%%\end{tabular}
%%\end{table}
%\noindent 其中~iter 和~iter-c 分别是~FAS 的迭代次数和粗网格平均迭代次数.
%\vskip0.3cm
%
%由上表可见: %
%%当~$L$ 较大时, 在~$\mathcal {T}_h^1$  上的离散系统用~Gummel 算法求解的迭代次数总是比代数型~FAS 算法的多, 但两者的绝对误差基本相同, 且粗网格迭代次数均偏多, 如~$\mathcal {T}_h^1$,  $s=0.4$ 的~Gummel 算法的迭代次数仅为代数型~FAS 算法的~2 倍左右, 但两种算法的粗网格迭代次数~$\ge30$.
%
%%尽管代数型~FAS 迭代法对非结构或非一致网格具有更好的适应性, 然而, 还存在对~$L$ 的适应性不够强, 以及求解相应的粗网格非线性代数系统的迭代次数偏多等缺陷, 下面基于加速技术和自适应方法做进一步改进.%,对这些算法(不妨以 Gummel 迭代法为例)
%
%%\noindent{$\bullet$ \bf Setup }
%%\begin{description}
%%	\item[S1.] Generate one-level grid~$\mathcal{T}_{h_1}$.
%%	\item[S2.] Generate matrices~$ A_{h_{1}} (\cdot)$, $\tau_{h_1}$ and~$\delta A_{h_{1}} (\cdot)$, where
%%	\begin{itemize}
%%		\item  $A_{h_{1}} (\cdot)$ is the corresponding stiffness matrix of the following PNP equations
%%		\begin{equation}\label{eqh1}
%%		\left\{
%%		\begin{array}{ll}
%%		- \nabla \cdot ( \nabla  {u})- (  p-  n)=0 , & \\
%%		- \nabla \cdot\left( \nabla  {p}+\tilde c_{\lambda}  {p}  \nabla  {\color{black}u_{h_{1}}^{(  k)}}\right)=   f_p, & \\
%%		- \nabla \cdot\left( \nabla  {n}-\tilde c_{\lambda}  {n}  \nabla {\color{black} u_{h_{1}}^{(  k)}}\right)=  f_n,&
%%		\end{array}
%%		\right.
%%		\end{equation}
%%		\item $\tau_{h_1}$ is the linear element total loading vector corresponding to \eqref{eqh1},
%%		and
%%		\item $\delta A_{h_{1}} (\cdot)$ is the linear element total stiffness matrix of corresponding to the following PNP equations
%%		{\small
%%			\begin{equation}\label{hat}
%%			\left\{
%%			\begin{array}{ll}
%%			- \nabla \cdot ( \nabla \hat  {u} )- ( \hat p - \hat n )=   \nabla \cdot ( \nabla  {\color{black} {u}_{h_{1}}^{(  k)}})+ (  {\color{black} p_{h_{1}}^{( k)}}-  {\color{black}n_{h_{1}}^{(  k)}}), & \\
%%			- \nabla \cdot\left( \nabla   \hat p +\tilde c_{\lambda}  ({\color{black}p_{h_{1}}^{( k)}} \nabla   \hat u + \hat p   \nabla {\color{black} u_{h_{1}}^{(  k)}} )   \right)=   f_p +  \nabla \cdot ( \nabla  {\color{black} p_{h_{1}}^{( k)}} +\tilde c_{\lambda}{\color{black}p_{h_{1}}^{( k)}  } \nabla {\color{black} {\color{black}u_{h_{1}}^{(  k)}}})    , &   \\
%%			- \nabla \cdot\left( \nabla   \hat n -\tilde c_{\lambda}  ({\color{black}n_{h_{1}}^{(  k)}} \nabla   \hat u + \hat n   \nabla  {\color{black} u_{h_{1}}^{(  k)}  })   \right)=   f_n+  \nabla \cdot ( \nabla {\color{black} n_{h_{1}}^{( k)}} -\tilde c_{\lambda}{\color{black}n_{h_{1}}^{(  k)}}  \nabla {\color{black}u_{h_{1}}^{(  k)}}) . &
%%			\end{array}
%%			\right.
%%			\end{equation}}
%%	\end{itemize}
%% \item[S3.] Generate interpolation matrices ~$R^o$ and~$R^u$.
%%\begin{description}
%%	\item[S3.1] Generate coarse grid ~$\mathcal T_{h_2}$ nested with $\mathcal T_{h_1}$.
%%	\item[S3.2]  Assume~$\Phi^{h_1}$ and~$\Phi^{h_2}$ are the basis vector function of~$V_{h_1}$ and ~$ V_{h_2}$, respectively, and the $i$-th point of
%%	 $\mathcal {T}_{h_2}$ is the $k$-th point of $ \mathcal {T}_{h_1}$. Then~the restriction matrix ~$R^o\in R^{n_{h_{2 },0}\times n_{h_1}}$ between $\mathcal {T}_{h_1}$ and $\mathcal {T}_{h_2}$ satisfies
%%	\begin{equation}\label{Ro12}
%%	\Phi^{h_2}=R^o\Phi^{h_1},
%%	\end{equation}
%%	where~$n_{h_{2 },0}$ denotes the number of coarse point which removed the Dirchlet boundary points. Then, we have
%%	\begin{equation}
%%	R^o(i,j)= \left\{
%%	\begin{array}{ll}
%%	\Phi^k_{h_1}(x_j), & \hbox{if~$supp(\Phi^j_{h_1}) \in supp(\Phi^i_{h_2})$;} \\
%%	0, & \hbox{else.}
%%	\end{array}
%%	\right.
%%	\end{equation}
%%	The corresponding array~$CF\_marker$
%%	\begin{eqnarray*}
%%		CF\_marker(i) =
%%		\begin{cases}
%%			-1, & \mbox{if}~i\in V\backslash V_{c}\\\
%%			k,  & \mbox{if~$i\in V_{c}$, }
%%		\end{cases},
%%	\end{eqnarray*}
%%where $k$ is the number of the coarse point corresponding to the $i$-th fine point.
%%	\item[S3.3]  Generate restriction matix $R^u\in R^{n_{h_{2},0}\times n_{h_1}}$ between the coarse grid and fine grid using
%%	array~$CF\_marker$, which satisfies
%%	\begin{equation}
%%	R^u(i,j)=\left\{
%%	\begin{array}{ll}
%%	1, & \hbox{if~$CF\_marker(j)=i$;} \\
%%	0, & \hbox{else.}
%%	\end{array}
%%	\right.
%%	\end{equation}
%%\end{description}
%%
%%\end{description}
%%
%%\noindent{$\bullet$ \bf Solver }
%%\begin{description}
%%	\item[S1.]{\bf Pre-smoothing}
%%	\begin{description}
%%		\item[step 1.1]   		
%%		Let~$\vec U_{h_{1}}^{( 0)}:=\bf 0$, and ~$\vec U_{h_{1}}^{(   0)} $ be the intial value. Pre-smooth for \eqref{1.1}
%%		$$\vec U_{h_{1}}^{(  f s)}:=\vec U_{h_{1}}^{\left( \nu_{1}\right)}=\mathcal{M}_{1}\left(\vec U_{h_{1}}^{(  0)}, A_{h_{1}}(\vec U_{h_{1}}^{(  0)}), \tau_{h_{1}}, \nu_{1}\right) .$$
%%		where~$\mathcal{M}_{1}\left(\vec U_{h_{1}}^{( 0)}, A_{h_{1}}(\vec U_{h_{1}}^{( 0)}), \tau_{h_{1}}, \nu_{1}\right)  $ are defined as follows
%%		\begin{equation}\label{nd}
%%		\vec U_{h_{1}}^{(  k+1)}=\vec U_{h_{1}}^{ (k)}+ (\delta A_{h_{1}} (\vec U_{h_{1}}^{( k)} ) )^{-1} (\tau_{h_{1}}-A_{h_{1}} (\vec U_{h_{1}}^{  ( k)}   )\vec U_{h_{1}}^{  ( k)}  ), ~~k=0, \cdots, \nu_{1}-1.
%%		\end{equation}
%%		
%%		\item[step  1.2]   Compute the residual part $$r_{h_{1}} =\tau_{h_{1}}-A_{h_{1}} (\vec U_{h_{1}}^{ (  fs )} )\vec U_{h_{1}}^{ (   fs )}  .$$
%%		
%%	\end{description}
%% \item[S2.]{\bf Generate the iteration initial value of the nonlinear system on~$\mathcal T_{h_{2}} $}
%%
%%Using the restriction
%%\begin{equation}
%%\vec R^u \vec U_{h_{1}}^{(  f s)}, ~~
%%\vec R^u =\begin{pmatrix}
%%R^u&\bf 0&\bf 0\\\bf 0&R^u&\bf 0\\\bf 0& \bf 0&R^u
%%\end{pmatrix}_{3n_{h_2}\times3n_{h_1}}
%%\end{equation}
%%of numerical solution~$U_{h_{1}}^{(   f s)}$ on $\mathcal T_{h_{1}} $ as the initial value~$\vec U_{h_{2}}^{( 0)}$ of the nonlinear system on
%%~$\mathcal T_{h_{2}} $.
%%
%%\item[S3.]{\bf Soving the following nonlinear system on the coarse grid using the initial value~$\vec U_{h_{2}}^{(  0)}$
%%	\begin{equation}\label{ce}
%%	A_{h_{2}}\left(\vec U_{h_{2}}\right)\vec U_{h_{2}}=\tau_{h_{2}},
%%	\end{equation}
%%	to get~$\vec U_{h_{2}}^{( fs)}$}, where~$A_{h_{2}}(\cdot)=\vec R^oA_{h_{1}} ((\vec R^o)^T(\cdot) )(\vec R^o)^T$,  $ \tau_{h_{2}}=\vec R^oA_{h_{1}} ((\vec R^o)^T\vec U_{h_{2}}^{(0)} )(\vec R^o)^T\vec U_{h_{2}}^{(0)}+\vec R^or_{h_{1}} $.
%%\item[S4.] {\bf Correction on coarse grid}
%%\begin{equation}
%%\vec U_{h_{1}}^{ ( bs,0  )}=\vec U_{h_{1}}^{ (   \nu_{1} )} + ( \vec R^{o } )^T(\vec U_{h_{2}}^{( fs)}-\vec U_{h_{2}}^{(0)}).
%%\end{equation}
%%\item[S5.] {\bf Post-smoothing}
%%
%%Post-smooth \eqref{1.1} for $\nu_2$ times using the initial value~$\vec U_{h_{1}}^{( bs, 0)} $
%%$$\vec U_{h_{1}}^{(  bs)}:=\vec U_{h_{1}}^{\left( \nu_{2}\right)}=\mathcal{M}_{1}\left(\vec U_{h_{1}}^{( bs, 0)}, A_{h_{1}}(\vec U_{h_{1}}^{( bs, 0)}), \tau_{h_{1}}, \nu_{2}\right) .$$
%%where~$\mathcal{M}_{1}\left(\vec U_{h_{1}}^{( bs, 0)}, A_{h_{1}}(\vec U_{h_{1}}^{( bs, 0)}), \tau_{h_{1}}, \nu_{2}\right)  $ are defined by
%%\begin{equation}\label{nd2}
%%\vec U_{h_{1}}^{(  k+1)}=\vec U_{h_{1}}^{ (k)}+ (\delta A_{h_{1}} (\vec U_{h_{1}}^{( k)} ) )^{-1} (\tau_{h_{1}}-A_{h_{1}} (\vec U_{h_{1}}^{  ( k)}   )\vec U_{h_{1}}^{  ( k)}  ), ~~k=0, \cdots, \nu_{2}-1
%%\end{equation}
%%to get~$\vec U_{h_{1}}^{ ( bs  )} $.
%%\end{description}

\vspace{3mm}
\section{Conclusion}
In this paper, we present the theory of the existence of three commonly used FE nonlinear fully discrete solutions and the convergence of the Gummel linearized iteration. The theory of the existence of the solution can be viewed as a framework to FE schemes which only need to satisfy two assumptions. The theory of convergence (including contraction) of the linearized iteration can be easily to generalized to other commonly used iterations such as Picard-Newton iteration. The numerical experiment verifies the result of the theory and also shows the validity of the three FE schemes. Note that although Gummel iteration is effective for some PNP equations, it is not easy to converge for some complex practical PNP problems, for example, the strong convection dominated problem in semiconductor area. In our next upcoming paper, we will design several fast algorithms to improve the convergence efficiency of the iterative algorithm for PNP equations especially for the case with strong convection dominance. \\

\noindent
{\bf Acknowledgement }
%The authors would like to thank ... for their valuable discussions on numerical experiments.
  S. Shu was supported by the China NSF (NSFC 12371373). Y. Yang was supported by the China NSF (NSFC 12161026).

%\begin{thebibliography}{999}
%	%\bibliographystyle{plain}
%	\bibliographystyle{unsrt}
%	\bibitem{Nernst1889} W. Nernst, Die elektromotorische Wirksamkeit der Ionen, Z. Phys. Chem. 4 (1889) 129-181.	
%	
%	\bibitem{Planck1890}M. Planck, $\ddot{U}$Ber die erregung von electricit$\ddot{a}$t und w$\ddot{a}$rme in electrolyten, Ann. Phys. 275 (1890) 161-186
%		
%	\bibitem{Lu2013}B. Tu, M. Chen, Y. Xie, L. Zhang, B. Eisenberg,  B. Lu,  A parallel finite
%	element simulator for ion transport through three-dimensional ion channel
%	systems,  J. Comput. Chem. 34 (2013) 2065-2078.	
%	\bibitem{SUPG-IP}Q. Wang, H. Li, L. Zhang, B. Lu, A stabilized finite element method for the
%	Poisson-Nernst-Planck equations in three-dimensional ion channel simulations,
%	Appl. Math. Lett. 111 (2021) 106652
%	
%	
%	\bibitem{Ion2004}H. Daiguji, P. Yang, A. Majumdar, Ion transport in nanofluidic channels,
%	Nano Lett. 4 (2004) 137-142.
%	
%	\bibitem{Ion2018}J. Xu, B. Lu, L. Zhang,  A time-dependent finite element algorithm for
%	simulations of ion current rectification and hysteresis properties of 3D nanopore
%	system,  IEEE Trans. Nanotechnol. 17 (2018) 513-519.
%	
%	\bibitem{semiconductor1999}J. J. H. Miller, W. H. A. Schilders,  S. Wang,  Application of finite element methods to the simulation of semiconductor devices,  Rep. Prog. Phys. 62 (1999)  277-353.
%	
%	%[1] Schilders W ,  Miller J ,  Wang S . Application of Finite Element Methods to the Simulation of Semiconductor Devices.  2019.
%	
%	
%	\bibitem{semiconductor2005}
%	F. Brezzi, L. D. Marini, S. Micheletti, P. Pietra, R. Sacco, S. Wang,
%	Discretization of semiconductor device problems(I),  Handb. Numer. Anal. 13 (2005)
%	317-441.
%	
%	\bibitem{IAFE}Q. Zhang, Q. Wang, L. Zhang,  B. Lu,
%	An inverse averaging finite element method
%	for solving three-dimensional Poisson-Nernst-Planck equations in nanopore system simulations,  J.
%	Chem.  Phys. 155 (2021) 194106.
%	
%	\bibitem{TuSUPG}B. Tu, Y. Xie, L. Zhang, B. Lu, Stabilized finite element methods to simulate the conductances of ion channels, Comput. Phys. Commun. 188 (2015)
%	131-139.
%	
%	\bibitem{IAFE0} Q. Zhang, Q. Wang, L. Zhang, B. Lu, A class of finite element methods with averaging techniques for solving the three-dimensional drift-diffusion model
%	in semiconductor device simulations, J. Comput. Phys. 458 (2022)  111086.
%	
%	%Journal of Computational Physics.
%	
%	\bibitem{AMG}  S. R. Mathur, J. Y. Murthy, A multigrid method for the Poisson-Nernst-Planck equations, Int. J. Heat. Mass. Tran. 52.17-18(2009):4031-4039.
%	
%	\bibitem{AMG-GMRES} A. Bousquet, X. Hu, M. S. Metti, J. Xu,          Newton solvers for drift-diffusion and electrokinetic equations, SIAM J. Sci. Comput. 40.3 (2018):B982-B1006.
%	
%	\bibitem{2orderPNP} Q. Zheng, C. Duan, W. Guo, Second-order Poisson-Nernst-Planck solver for ion transport, J. Comput. Phys. 230.13 (2011) 5239-5262.
%	
%	\bibitem{Newton}  D. Xie, B. Lu, An effective finite element iterative solver for a Poisson-Nernst-Planck ion channel model with periodic boundary conditions, SIAM J. Sci. Comput.  42.6(2020): B14900-B1516.
%	
%	
%	%\bibitem{PB} {Tu Y ,  Pang Q ,  Yang H , et al. Linear-scaling selected inversion based on hierarchical interpolative factorization for self Green's function for modified Poisson-Boltzmann equation in two dimensions[J]. Journal of Computational Physics, 2022(461-):461. }
%	
%	
%	\bibitem{TG}J. Jin, S. Shu, J. Xu, A two-grid discretization method for decoupling systems of partial differential equations, Math. Comput. 75 (256) (2006) 1617-1626.
%	
%	\bibitem{TGPNP}R. Shen, S. Shu, Y. Yang, B. Lu, A decoupling two-grid method for the time-dependent Poisson-Nernst-Planck equations, Numer. Algorithms 83 (2020) 1613-1651.
%	
%	\bibitem{Pre-TG-PNP} J. Ying,   R. Fan,  J. Li,  B. Lu, A new block preconditioner and improved finite element solver of Poisson-Nernst-Planck equation, J. Comput. Phys. 430 (2021) 110098.
%	%......以下文献没在正式版本引用。
%%	\bibitem{FVM} S. Mathur, J. Murthy, A pressure-based method for unstructured meshes,
%%	Numer. Heat Transfer B: Fundam. 32 (2) (1997) 195-216.
%%	
%%	
%%	\bibitem{niyuhui} 半导体器件的三维有限元模拟研究, 倪宇晖, 硕士学位论文.
%%	\bibitem{xu}J. Xu, L. Zikatanov, A monotone finite element scheme for convection-diffusion equations, Math. Comput. 68(1999) 1429-1446.
%%	
%%	\bibitem{supg}  A. N. Brooks, T. J. R.  Hughes, Streamline upwind/Petrov-Galerkin formulations for convection dominated flows with particular emphasis on the incompressible Navier-Stokes equations, Comput. Methods Appl. Mech. Eng.  32(1-3) (1982) 199-259 .
%%	
%%	\bibitem{gls-1} T. J. R. Hughes, L. P. Franca, G. M. Hulbert,  A new finite element formulation for computational fluid dynamics: VIII. The Galerkin/least-squares method for
%%	advective-diffusive equations. Comput. Methods Appl. Mech. Eng. , 73.2 (1989) 173-189.
%%	
%%	\bibitem{gls-2} L. P.  Franca,   S. L. Frey , T. J. R. Hughes, Stabilized finite element methods : I. application to the advective-diffusive model, Comput. Methods Appl. Mech. Eng. , 95.2 (1992) 253-276.
%%	
%%	\bibitem{HSS1} Z. Bai, G. H. Golub,  M. K. NG, Hermitian and skew-hermitian splitting methods for non-hermitian positive definite linear systems,  SIAM J. Matrix. Anal. A.   24.3 (2003) 603-626.
%%	
%%	\bibitem{HSS2} K. Jiang,  X. Su,  J. Zhang, A general alternating-direction implicit framework with Gaussian process regression parameter prediction for large sparse linear systems, SIAM J. Sci. Comput. 44.4(2022):A1960-A1988.
%%	
%%	
%%
%%	\bibitem{xu-lz-1999}J. Xu and L. Zikatanov, A monotone finite element scheme for convection-diffusion equations. Math. Comput., 68 (1999): 1429-1446.
%%	
%%	
%	\bibitem{PG-BT-1974} G. Poole, T. Boullion, A Survey on M -Matrices. SIAM Review, 1974, 16(4):419-427.
%	
%%		
%	\bibitem{R1999} Park S.  \newblock {Ninety years of the Brouwer fixed point theorem}
%	\newblock {VIETNAM J MATH}, 27(3):187-222, 1999.
%%	
%%	
%%	
%%	\bibitem{R2016}
%%	Blanc X,  Labourasse E. \newblock {
%%		A positive scheme for diffusion problems on deformed meshes}
%%	\newblock {\em ZAMM $\cdot$ Z. Angew. Math. Mech.}, 6, 660-680,2016.
%		\bibitem{lish21}Y. Liu, S. Shu, H. Wei, and Y. Yang, A virtual element method for the steady-state Poisson-Nernst-Planck equations on polygonal meshes. Comput. Math. Appl., 102(15) (2021): 95-112.
%		\bibitem{ga86}H. Gajewski and K. Gr$\ddot{o}$ger. On the basic equations for carrier transport in semiconductors. J.
%		Math. Anal. Appl., 113(1):12-35, 1986.
%
%  % \bibitem{lish21} Y. Liu, S. Shu, H. Wei, and Y. Yang., A virtual element method for the steady-state Poisson-NernstPlanck equations on polygonal meshes, Comput. Math. Appl., 102(15) ?2021?95?112  .
%
%	
%\end{thebibliography}
\bibliographystyle{unsrt}  %unsrt参考文献的条目的编号按照引用的顺序排列
\bibliography{artpnp}
%\bibliography{artpnp}
%\bibliographystyle{abbrv}
%????????
%\bibliographystyle{unsrt}
%????????
\end{document}
