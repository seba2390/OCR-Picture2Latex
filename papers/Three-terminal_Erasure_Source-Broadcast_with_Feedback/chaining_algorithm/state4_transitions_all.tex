\input{chaining_algorithm/fig/state4_table_all}

\begin{LaTeXdescription}
	\item [State~4]  We enumerate all outgoing transitions from State~4 based on all possible channel conditions in Table~\ref{tab:state4_transitions_all}.  We remind the reader that State~4 is characterized by user~$i$ having just been the only receiver to receive the previous transmission.  Thus, the chain-building process has begun and in this timeslot, the transmitter will send a different linear combination of the previous two symbols sent.
	Finally, we note that this state has outbound transitions in which a source symbol may be placed in $Q_{j}$ or $Q_k$ \emph{after} time $t$.  In the event that one or both of these queues are nonempty, and depending on whether $Q_i$ is nonempty,  the transmitter may also have the option of temporarily suspending the chaining algorithm to send linear combinations of the form 
	\begin{subequations}	
	\label{eq:linear_comb_available}
		\begin{align}
			\label{eq:linear_comb_available_a}
			&q_{i} \oplus q_{j} \oplus q_{k},\\
			\label{eq:linear_comb_available_b}
			&q_j \oplus q_{i, k}, \\%\textrm{or }\\ 
%		\end{align}
%	or
%	\begin{align}
			\label{eq:linear_comb_available_c}
			&q_{k} \oplus q_{i, j}, %\hphantom{\oplus q}
		\end{align}

	\end{subequations}
	which are instantly-decodable, distortion-innovative transmissions for all users.
	We now go over the possible state transitions based on whether the linear combination sent at time $t$ was received by any of the receivers.
	\begin{enumerate}
		\item $\zall = (0, 0, 0)$.  In this case, user~$i$ has now received as many equations as there are unknown variables in the chain.  Thus the subsequent state is State~6, the decoding absorbing state, and there is no need to set $\rhoqstar = 1$, since all variables in the chain have been accounted for.  
		\item $\zall = (0, 0, 1)$. In this case, user~$i$ can again decode. Furthermore, we place the source symbol intended for user~$k$ into $Q_k$ and set $\rhoqk = 1$.
		\item $\zall = (0, 1, 0)$. Similar to the previous case, user~$i$ can also decode given this channel noise realization, and we place the source symbol intended for user~$j$ into $Q_j$ and set $\rhoqj = 1$.
		\item $\zall = (0, 1, 1)$. In this case, user~$i$ can again decode, and we place the source symbol intended for users~$j$ and~$k$ into $Q_j$ and~$Q_k$ respectively and set $\rhoqj = \rhoqk = 1$.
		\item $\zall = (1, 0, 0)$.  This case is similar to its counterpart in State~2, however, since both symbols appearing in $X(t)$ have been accounted for, i.e., both symbols appearing in $X(t)$ are in the set $\chainsetarg{t-1}$, there is no need to set $\rhoqi = 1$.
%		in State~4 we are sending a different linear combination of the \emph{same} two source symbols in the previous transmission, one of the symbols has already been accounted for and we do not need to place a symbol in $Q_i$.  Instead, we need to account for only one other symbol that is placed in $\Qstar$.
		\item $\zall = (1, 0, 1)$.  This case is analogous to its counterpart in State~2, however, since the symbol just received by user~$j$ has been accounted for, i.e., since it is one of the symbols in $\chainsetarg{t-1}$, there is no need to set $\rhoqi = 1$.
		\item $\zall = (1, 1, 0)$	.  This case is analogous to its counterpart in State~2, however, since the symbol just received by user~$k$ has been accounted for, i.e., since it is one of the symbols in $\chainsetarg{t-1}$, there is no need to set $\rhoqi = 1$.
		\item $\zall = (1, 1, 1)$	.  This case is analogous to its counterpart in State~1, except we transition back to State~4 in the next timeslot.
	\end{enumerate}
\end{LaTeXdescription}





