% !TEX root = 0-20SPAWC_SAND.tex
% DO NOT REMOVE THE ABOVE COMMENT!
\section{Results}
\label{sec:simulations}

We now demonstrate the efficacy of 1-BEACHES, $\alpha$-BEACHES, and SAND. 
%
As reference methods, we consider perfect channel state information (CSI), where $\bmh^\star= \bmh$,  BEACHES \cite{ghods19a}, which denoises the infinite-resolution (unquantized) measurements $\bmy = \bmh+\bmn$, and 1-bit maximum-likelihood (ML) channel estimation, where $\bmh^\star = \bmr$ is the 1-bit observation in~\fref{eq:quantized_antenna_domain}. In addition, we compare the performance to state-of-the-art denoising methods, including (i) Newtonized orthogonal matching pursuit (NOMP) \cite{mamandipoor16} with an equivalent noise variance $\Qo$  and a false alarm rate $P_\text{fa}=0.5$ (using $\Eo$ results in poor performance; $P_\text{fa}$ has been tuned to achieve low MSE at low and high SNR)
%
and (ii) the 1-bit Bussgang linear MMSE  estimator (BLMMSE)~\cite{li16a,li17b}, which corresponds to $\bmh^\star = \frac{\Eh}{\sqrt{\pi(\Eh+\No)}}\bmr$ for the used orthogonal pilots.




\begin{figure}[tp]
	\centering
	\subfigure[LoS channel]{\includegraphics[width=0.235\textwidth]{fig/MSE_256x16_QuadMMLoS_QPSK_BussgangLMMSE_QuantizedChannel_QuantizedSignal_Eh1_Norm-0p5to2_Trials10000}}
	\subfigure[non-LoS channel]{\includegraphics[width=0.235\textwidth]{fig/MSE_256x16_QuadMMnLoS_QPSK_BussgangLMMSE_QuantizedChannel_QuantizedSignal_Eh1_Norm-0p5to2_Trials10000.pdf}}
	\vspace{-0.1cm}
	\caption{Mean square error (MSE) of the considered channel denoising methods for mmWave LoS and non-LoS channels. The proposed sparsity-adaptive denoising methods significantly outperform na\"ive 1-bit ML channel estimation.}
	\label{fig:MSE}
\end{figure}


\subsection{Simulation Setup}
We simulate a mmWave massive MIMO system with $B=256$ BS antennas and $U=16$ single-antenna UEs. 
%
We generate LoS and non-LoS channel matrices using the QuaDRiGa mmMAGIC UMi model \cite{jaeckel2019quadriga} at a carrier frequency of $60$\,GHz for a BS with $\lambda/2$-spaced antennas arranged in a ULA. 
%
The UEs are placed randomly in a $120^\circ$ circular sector around the BS between a distance of $10$\,m and $110$\,m, and the UEs are separated by at least $4^\circ$. 
%
We model UE-side power control to ensure that the highest receive power is at most $6$\,dB higher than that of the weakest UE. 



\begin{figure*}[tp]
	\centering
	\subfigure[LoS, QPSK]{\includegraphics[width=0.24\textwidth]{fig/BER_256x16_QuadMMLoS_QPSK_BussgangLMMSE_QuantizedChannel_QuantizedSignal_Eh1_Norm-0p5to2_Trials10000}}
	\hfill
	\subfigure[non-LoS, QPSK]{\includegraphics[width=0.24\textwidth]{fig/BER_256x16_QuadMMnLoS_QPSK_BussgangLMMSE_QuantizedChannel_QuantizedSignal_Eh1_Norm-0p5to2_Trials10000}}
	\hfill
	\subfigure[LoS, 16-QAM]{\includegraphics[width=0.24\textwidth]{fig/BER_256x16_QuadMMLoS_16QAM_BussgangLMMSE_QuantizedChannel_QuantizedSignal_Eh1_Norm-0p5to2_Trials10000.pdf}}
	\hfill
	\subfigure[non-LoS, 16-QAM]{\includegraphics[width=0.24\textwidth]{fig/BER_256x16_QuadMMnLoS_16QAM_BussgangLMMSE_QuantizedChannel_QuantizedSignal_Eh1_Norm-0p5to2_Trials10000.pdf}}
	\vspace{-0.1cm}
	\caption{Uncoded bit error rate (BER) of 1-bit channel estimation and 1-bit data detection in mmWave LoS and non-LoS channels. We see that $\alpha$-BEACHES and SAND outperform $1$-BEACHES and 1-bit ML for LoS and non-LoS channel conditions for 16-QAM transmission. }
	\label{fig:BER}
\vspace{-0.37cm}	
\end{figure*}
%


\subsection{Mean-Square Error (MSE) Performance}
%
\fref{fig:MSE} shows the channel estimation MSE of the proposed 1-bit denoising algorithms and the considered baseline methods. We observe that the three proposed methods, $1$-BEACHES, $\alpha$-BEACHES, and SAND significantly outperform 1-bit ML channel estimation. Furthermore, we see that $\alpha$-BEACHES and SAND have a slight advantage over $1$-BEACHES in LoS scenarios. Surprisingly, SAND has a slightly higher MSE than $\alpha$-BEACHES, which we attribute to the fact that SAND has to learn two parameters, whereas $ \alpha$-BEACHES only learns the optimal denoising threshold. For that reason, SAND is more sensitive to the assumptions made in footnote~1.
%
NOMP and BLMMSE also outperform 1-bit ML, but their MSE is higher than that of our algorithms, especially at high SNR. 

\subsection{Bit Error Rate (BER) Performance}
%
To assess the impact of the proposed 1-bit denoising algorithms on the uncoded BER performance during the data detection phase, we use the 1-bit Bussgang linear MMSE equalizer proposed in \cite{nguyen19}, which operates on the 1-bit quantized received data using the channel estimates provided by our denoising methods and the considered baseline algorithms. We consider QPSK and $16$-QAM transmission.


\fref{fig:BER} shows that the proposed sparsity-adaptive denoising algorithms significantly outperform na\"ive 1-bit ML channel estimation. We furthermore see that for QPSK, all three methods,  $1$-BEACHES, $\alpha$-BEACHES, and SAND, perform equally well under both LoS and non-LoS scenarios. For 16-QAM, where it is important to get an accurate estimate of the channel gain, $\alpha$-BEACHES and SAND outperform $1$-BEACHES and NOMP, which directly operate with the received 1-bit measurements. 
Hence, correcting the scale of the received data is critical for higher-order constellation sets.
%
While BLMMSE adjusts for the scale, it is unable to exploit sparsity which results in rather poor BER performance.
%
For non-LoS channels, NOMP performs inferior to the proposed methods. 
In addition, NOMP requires high complexity~\cite{mirfarshbafan19a}.
%
Since the propagation conditions (such as the number of propagation paths $L$) are typically unknown in practice, SAND and $\alpha$-BEACHES are the preferred denoising methods. 
%

