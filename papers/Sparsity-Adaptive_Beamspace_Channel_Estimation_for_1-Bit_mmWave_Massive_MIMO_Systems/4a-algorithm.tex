% !TEX root = 0-20SPAWC_SAND.tex
% DO NOT REMOVE THE ABOVE COMMENT!
\makeatletter
\newcommand\fs@betterruled{%
  \def\@fs@cfont{\bfseries}\let\@fs@capt\floatc@ruled
  \def\@fs@pre{\vspace*{5pt}\hrule height.8pt depth0pt \kern2pt}%
  \def\@fs@post{\kern2pt\hrule\relax}%
  \def\@fs@mid{\kern2pt\hrule\kern2pt}%
  \let\@fs@iftopcapt\iftrue}
\floatstyle{betterruled}
\restylefloat{algorithm}
\makeatother
\setlength{\textfloatsep}{5pt}
\begin{algorithm}[tp]
\caption{\strut SAND: Sparsity-Adaptive oNe-bit Denoiser \label{alg:SAND}}
\begin{algorithmic}[1]
%
\STATE {\bf input} $\bmr$, $\alpha$ and $\Do$ 
\STATE $\rhat = \text{FFT}(\bmr)$, $\SURE_{\text{min}}=\infty$	, $\tau=0$			
\STATE $\rshat=\text{sort}\{|\rhat|,\text{`ascend'}\}$, $\rshate{B+1}=\rshate{B+2}=\infty$
\STATE $\sumabsysquared=\sum_{k=1}^{B} {(\rshate{k})^{2}}$, $\sumabsy=\sum_{k=1}^{B} {\rshate{k}}$, $\sumabsyinverse=\sum_{k=1}^{B} {(\rshate{k})^{-1}}$
%
\FOR{$k=0,\ldots,B+1$}
\STATE $\gamma =\max\{0, \frac{2(\sumabsysquared-\tau \sumabsy) - \Do(2\sumone-\tau \sumabsyinverse)}{2\alpha(\sumabsysquared-2\tau \sumabsy+\tau^2 \sumone)}\}$
\STATE $\SURE = \frac{1}{B}\gamma^2\left(\sumabsysquared-2\tau\sumabsy+\tau^2\sumone\right) + \frac{2-\Do}{\alpha^2}
- \frac{1}{B}\frac{\gamma}{\alpha}\left(2\left(\sumabsysquared-\tau\sumabsy\right) 
- \Do\left(2\sumone-\tau\sumabsyinverse\right)\right)$ 					
%
\IF{$\SURE<\SURE_{\text{min}}$ \AND $\tau<\sqrt{2\Do\log(B)}$}		
\STATE $\SURE_{\text{min}} = \SURE$, $\tau^\star = \tau$, $\gamma^\star = \gamma$
\ENDIF
%	
\STATE $\tau \!=\! \rshate{k+1}$, $\sumabsysquared \!=\! \sumabsysquared \!-\! (\rshate{k+1})^2, \sumabsy \!=\! \sumabsy \!-\! \rshate{k+1}, \sumabsyinverse \!=\! \sumabsyinverse \!-\! (\rshate{k+1})^{-1}$
%		
\ENDFOR																				
\STATE $\hhatstare{k}=\gamma^\star\frac{\rhate{k}}{|\rhate{k}|}\max{\{|\rhate{k}|-\tau^\star,0\}}$, $k=1,\ldots,B$
\STATE  {\bf return} $\bmh^\star = \text{IFFT}(\hhatstar)$ 
%
\end{algorithmic}
\end{algorithm}




