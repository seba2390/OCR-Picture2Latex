%%%%%%%% ICML 2021 EXAMPLE LATEX SUBMISSION FILE %%%%%%%%%%%%%%%%%

\documentclass{article}

% Recommended, but optional, packages for figures and better typesetting:
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} % for professional tables
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{placeins}
\usepackage[left=1in,bottom=1in,top=1in,right=1in]{geometry}
\usepackage[colorlinks=true]{hyperref}
\usepackage{thmtools}


\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{url}            % simple URL typesetting
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{xcolor}         % colors


\usepackage{enumitem}% http://ctan.org/pkg/enumitem
%\setlist{parsep=0pt, topsep=0pt}
%{partopsep=-\parskip,parsep=0pt}%noitemsep, topsep=0pt}
%\setlength{\textfloatsep}{10pt plus 1.0pt minus 2.0pt}
%\setlength{\intextsep}{10pt plus 2pt minus 2pt}
%\usepackage[belowskip=-15pt,aboveskip=0pt]{caption}




\usepackage{url}
\def\UrlBreaks{\do\/\do-}
%\usepackage{subcaption}
% hyperref makes hyperlinks in the resulting PDF.
% If your build breaks (sometimes temporarily if a hyperlink spans a page)
% please comment out the following usepackage line and replace
% \usepackage{icml2021} with \usepackage[nohyperref]{icml2021} above.
%\usepackage{hyperref}

% Attempt to make hyperref and algorithmic work together better:
\newcommand{\theHalgorithm}{\arabic{algorithm}}

\usepackage[disable]{todonotes} % pass with option disable to remove all comments
%\usepackage[1-11]{pagesel}
\presetkeys{todonotes}{}{}

\usepackage{commath} % defines things such as \abs, \norm; alternatively can also use package physics
%\renewcommand{\algorithmicensure}{\textbf{Output:}}
%\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\newcommand{\Mod}[1]{(\mathrm{mod}\ #1)}


\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

\theoremstyle{remark}
\newtheorem*{remark}{Remark}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]

\theoremstyle{plain}
\newtheorem{corollary}{Corollary}[theorem]

\theoremstyle{plain}
\newtheorem{conjecture}{Conjecture}[section]

\theoremstyle{plain}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{fact}[theorem]{Fact}

%\newclass{\NPH}{NPH}


\newcommand{\stringset}[1]{\{0,1\}^{#1}}
\newcommand{\bn}{\mathbb{N}}
\newcommand{\br}{\mathbb{R}}
\newcommand{\bz}{\mathbb{Z}}
\newcommand{\bq}{\mathbb{Q}}
\newcommand{\bc}{\mathbb{C}}
\newcommand{\bbE}{\mathbb{E}}
\newcommand{\dout}{d_{\mathrm{out}}}
%\newcommand{\norm}[1]{\left| \left| #1 \right| \right|}
\newcommand{\ip}[2]{\left\langle #1, #2 \right\rangle}

\newcommand{\Swish}{\ensuremath{\mathsf{swish}}}
\newcommand{\relu}{\ensuremath{\mathsf{ReLU}}} 
\newcommand{\lrelu}{\ensuremath{\mathsf{LReLU}}} 
\newcommand{\selu}{\ensuremath{\mathsf{SELU}}}
\newcommand{\elu}{\ensuremath{\mathsf{ELU}}}
\newcommand{\silu}{\ensuremath{\mathsf{SiLU}}}
\renewcommand{\tanh}{\ensuremath{\mathsf{tanh}}}

\newcommand{\Reals}{\ensuremath{\mathbb{R}}}
\newcommand{\indicator}{\ensuremath{\mathbb{I}}}
	\newcommand{\bv}{\mathbf{v}}
	\newcommand{\bV}{\mathbf{V}}
	\newcommand{\obV}{\overline{\bV}}
	\newcommand{\bx}{\mathbf{x}}
	\newcommand{\obx}{\overline{\mathbf{x}}}
	\newcommand{\bw}{\mathbf{w}}
	\newcommand{\bW}{\mathbf{W}}
	\newcommand{\bM}{\mathbf{M}}
	\newcommand{\obW}{\overline{\bW}}
	\newcommand{\bu}{\mathbf{u}}
	\newcommand{\deriv}{\ensuremath{\,\mathrm{d}}}
	\newcommand{\Ball}{\mathbb{B}}
	\newcommand{\Sphere}{\mathbb{S}}
	\newcommand{\enet}{\mathcal{N}_\epsilon}
	\newcommand{\dnet}{\mathcal{N}_\delta}
	


	\DeclareMathOperator{\ent}{S}
	\DeclareMathOperator*{\Ex}{\mathbb{E}}
	\DeclareMathOperator{\tr}{\mathsf{tr}}
	\DeclareMathOperator{\dt}{\mathsf{det}}
	%\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
	%%\DeclareMathOperator{\dim}{\mathsf{dim}}
	%%\DeclareMathOperator{\span}{\mathsf{span}}


	
	\newtheorem{assumption}{Assumption}
	\newtheorem{thoughts}{Thoughts}
	\DeclareMathOperator*{\argmax}{arg\,max}
	\newcommand{\heart}{\ensuremath\heartsuit}



\declaretheoremstyle[%
  spaceabove=0.5\parskip,%
  spacebelow=0.5\parskip,%
  headfont=\normalfont\itshape,%
  postheadspace=1em,%
  qed=\qedsymbol%
]{mystyle} 
\declaretheorem[name={Proof},style=mystyle,unnumbered,
]{prf}

% Use the following line for the initial blind version submitted for review:
%\usepackage{icml2021}

% If accepted, instead use the following line for the camera-ready submission:
%\usepackage[_{}]{icml2021}

% The \icmltitle you define below is probably too long as a header.
% Therefore, a short form for the running title is supplied here:
%\icmltitlerunning{Learning and Generalization in RNNs}



\title{Learning and Generalization in RNNs}


\author{%
	%  David S.~Hippocampus\thanks{Use footnote for providing further information
	%    about author (webpage, alternative address)---\emph{not} for acknowledging
	%    funding agencies.} \\
	%  Department of Computer Science\\
	%  Cranberry-Lemon University\\
	%  Pittsburgh, PA 15213 \\
	%  \texttt{hippo@cs.cranberry-lemon.edu} \\
	% examples of more authors
	Abhishek Panigrahi\\
	Computer Science, Princeton University\\
	%Department of Computer Science\\
	%Princeton University
	%Microsoft Research India\\
	% Address \\
	\texttt{ap34@cs.princeton.edu} \\
	%\and
	%Abhishek Shetty\thanks{Work done when the author was in Microsoft Research India}\\
	%Cornell University\\
	% Address \\
	%\texttt{ashetty1995@gmail.com}
	\and
	Navin Goyal\\
	Microsoft Research India\\
	% Address \\
	\texttt{navingo@microsoft.com}  
	% Coauthor \\
	% Affiliation \\
	% Address \\
	% \texttt{email} \\
	% \And
	% Coauthor \\
	% Affiliation \\
	% Address \\
	% \texttt{email} \\
	% \And
	% Coauthor \\
	% Affiliation \\
	% Address \\
	% \texttt{email} \\
}

\sloppy
\begin{document}
\maketitle
%\onecolumn
%\icmltitle{Learning and Generalization in RNNs}

% It is OKAY to include author information, even for blind
% submissions: the style file will automatically remove it for you
% unless you've provided the [accepted] option to the icml2021
% package.

% List of affiliations: The first argument should be a (short)
% identifier you will use later to specify author affiliations
% Academic affiliations should list Department, University, City, Region, Country
% Industry affiliations should list Company, City, Region, Country

% You can specify symbols, otherwise they are numbered in order.
% Ideally, you should not use this facility. Affiliations will be numbered
% in order of appearance and this is the preferred way.
%\icmlsetsymbol{equal}{*}

%\begin{icmlauthorlist}
%\icmlauthor{Abhishek Panigrahi}{to}
%\icmlauthor{Navin Goyal}{msr}
%\end{icmlauthorlist}

%\icmlaffiliation{to}{Computer Science, Princeton University}
%\icmlaffiliation{msr}{Microsoft Research India}

%\icmlkeywords{Machine Learning, ICML}

\vskip 0.3in


% this must go after the closing bracket ] following \twocolumn[ ...

% This command actually creates the footnote in the first column
% listing the affiliations and the copyright notice.
% The command takes one argument, which is text to display at the start of the footnote.
% The \icmlEqualContribution command is standard text for equal contribution.
% Remove it (just {}) if you do not need this facility.

%\printAffiliationsAndNotice{}  % leave blank if no need to mention equal contribution
%\printAffiliationsAndNotice % otherwise use the standard text.



\begin{abstract}
\input{ESN_RNN_normalizedseq/abstract}
\end{abstract}

%\section{Introduction}
%\label{sec:introduction}
\input{ESN_RNN_normalizedseq/Intro}

%\section{Preliminaries}
%\label{sec:Preliminaries}
\input{ESN_RNN_normalizedseq/Preliminaries}

%\section{Proof Sketch}
%\label{sec:proofsketch}
%\input{../ESN_RNN_normalizedseq/MainTheorem}
\input{ESN_RNN_normalizedseq/Outline}
%\input{../ESN_RNN_normalizedseq/Lowerbound}

%\section{Experiments}
%\label{sec:experiments}
%\input{../ESN_RNN_normalizedseq/differences}
\input{ESN_RNN_normalizedseq/conclusion}

% In the unusual situation where you want a paper to appear in the
% references without citing it in the main text, use \nocite
%\nocite{langley00}
%\newpage
\bibliographystyle{unsrt}
\bibliography{references}

%\input{Checklist}
% In the unusual situation where you want a paper to appear in the
% references without citing it in the main text, use \nocite
%\nocite{langley00}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\appendix
\tableofcontents
%\newpage 
\vspace{10 mm}
The appendix has been structured as follows.   We discuss few more notations and basic facts in section~\ref{sec:further_prelims}. We prove few basic properties of the recurrent neural network at initialization in section~\ref{sec:basic_prop}. In section~\ref{sec:singlecell_RNN}, we prove in lemma~\ref{lemma:singlecell_ESN} that any linear function on $[\mathbf{h}^{(\ell-1)}, \mathbf{x}^{(\ell)}]$ at RNN cell $\ell$ can be expressed as a linear transformation of the hidden state $\mathbf{h}^{(\ell)}$. In section~\ref{sec:Invert_RNN}, we use the above lemma to show in theorem~\ref{thm:Invertibility_ESN} that from hidden state $\mathbf{h}^{[L]}$, one can get $[\bx^{(1)}, \cdots, \bx^{[L]}]$ using a linear transformation. We show in section~\ref{sec:existence} that a linear approximation of the recurrent neural networks exist at initialization that can approximate the target function in our concept class. We finish the proof in section~\ref{sec:optim_general}, where we show that RNNs can find a network with population risk close to the target function. We discuss about the experiments in section~\ref{sec:expts}.
\todo{Review this nearer to the submissino}


%\tableofcontents
%\input{SinglecelInvertibility}
\input{ESN_RNN_normalizedseq/Preliminaries_appendix}
\input{ESN_RNN_normalizedseq/SinglecellInvertibility_seqnormalized}
%\input{Fullinvertibilty}
%\input{RNN}
\input{ESN_RNN_normalizedseq/RNN_normalizedinput}
\input{ESN_RNN_normalizedseq/Generalization}
%\input{../ESN_RNN_normalizedseq/Lowerbound}
\newpage
\input{ESN_RNN_normalized_Seq/ESN_Invertibility_normalizedseq_proof}
\input{ESN_RNN_normalized_Seq/Pseudo_network}
\input{ESN_RNN_normalized_Seq/Generalization_proof}
\input{ESN_RNN_normalizedseq/differences}
\input{ESN_RNN_normalizedseq/Experiments}
%\input{../ESN_RNN_normalizedseq/Regularlanguage}



\end{document}


% This document was modified from the file originally made available by
% Pat Langley and Andrea Danyluk for ICML-2K. This version was created
% by Iain Murray in 2018, and modified by Alexandre Bouchard in
% 2019 and 2021. Previous contributors include Dan Roy, Lise Getoor and Tobias
% Scheffer, which was slightly modified from the 2010 version by
% Thorsten Joachims & Johannes Fuernkranz, slightly modified from the
% 2009 version by Kiri Wagstaff and Sam Roweis's 2008 version, which is
% slightly modified from Prasad Tadepalli's 2007 version which is a
% lightly changed version of the previous year's version by Andrew
% Moore, which was in turn edited from those of Kristian Kersting and
% Codrina Lauth. Alex Smola contributed to the algorithmic style files.
