\section{Proof of the Main Theorem} \label{Proof}

\subsection{Lemmas}

\begin{lemma}
For two $C\textsupsub{$1$}{}$ functions $f_{1}(t)$ and $f_{2}(t)$, if  $f_{1}(t_{0}) \geq f_{2}(t_{0})$ and $\forall t \geq t_{0}$ (resp. $\forall t \leq t_{0}$), 
$f_{1}^{\prime}(t) \geq f_{2}^{\prime}(t)$ (resp. $f_{1}^{\prime}(t) \leq f_{2}^{\prime}(t)$), we have $f_{1}(t) \geq f_{2}(t)$ $\forall t \geq t_{0}$ (resp. $\forall t \leq t_{0}$).
\label{lemma:simpleAscending}
\end{lemma}

\begin{proof}
Using Lagrangeâ€™s mean value theorem, $\forall t > t_{0}$,
$\exists \xi > t_{0}$ such that
\begin{equation}\begin{split}
&f_{1}(t)-f_{2}(t) \\
&=f_{1}(t_{0})-f_{2}(t_{0}) + (f_{1}^{\prime}(\xi)-f_{2}^{\prime}(\xi))(t-t_{0}) \ge 0
\label{eq.1}
\end{split}\end{equation}%
\end{proof}

\begin{lemma}
Suppose $s_{i}$ is an ascending series, then the Bezier curve $C(t)=\sum_{i=0}^{n}s_{i}B\textsupsub{$n$}{$i$}(t)$ is an ascending function.
\label{lemma:bezierAscending}
\end{lemma}

\begin{proof}
Taking the derivative of $C(t)$,
\begin{equation}\begin{split}
C^{\prime}(t)=n\sum_{i=0}^{n-1}(s_{i+1}-s_{i})B\textsupsub{$n-1$}{$i$}(t) \ge 0
\end{split}\end{equation}
\end{proof}

\begin{lemma}
Suppose $s_{i}$ is a concave (convex) series, i.e. $s_{i+2}-2s_{i+1}+s_{i} \le 0$ (resp. $\ge 0$) $\forall i \le n-2$,  then the Bezier curve $C(t)=\sum_{i=0}^{n}s_{i}B\textsupsub{$n$}{$i$}(t)$ is a concave (convex) function.
\label{lemma:bezierConcave}
\end{lemma}

\begin{proof}
Taking the second derivative of $C(t)$,
\begin{equation}\begin{split}
C^{(2)}(t)=n(n-1)\sum_{i=0}^{n-2}(s_{i+2}-2s_{i+1}+s_{i})B\textsupsub{$n-2$}{$i$}(t) \le 0
\end{split}\end{equation}
\end{proof}

\begin{corollary}
Suppose $s_{i}$ is a concave (convex) series, the Bezier curve $C(t)=\sum_{i=0}^{n}s_{i}B\textsupsub{$n$}{$i$}(t)$ passes the first and the last control point, and is inferior than the first and the last segment of the CPETS.
\label{corollary:tangentFistLastPoint}
\end{corollary}

\begin{proof}
The proof is trivial by applying lemma \ref{lemma:simpleAscending} and lemma \ref{lemma:bezierConcave}.
\end{proof}

\begin{lemma}
$\forall n > 1$, if the upper bound function $f(t)$ defined in $\left[0,1\right]$ is ascending (resp. descending) and concave, for series $s_{i}=f(\frac{i}{n})$, $\forall j \in \left[0, n-1\right]$ and 
$\forall t \in \left[\frac{j}{n}, \frac{j+1}{n}\right]$, we have $C(t)=\sum_{i=0}^{n}s_{i}B\textsupsub{$n$}{$i$}(t)$ $\le$ $s_{j}+n(s_{j+1}-s{j})(t-\frac{j}{n})$, i.e. the Bezier curve is bounded by the CPETS.
\label{lemma:mainLemma}
\end{lemma}

\begin{proof}
We only need to prove lemma \ref{lemma:mainLemma} for the case that $f(t)$ is ascending. For the descending case, it suffices to replace $t$ with $(1-t)$ and it returns to the ascending case, thanks to a property of Bezier curve that its orientation can be reversed and its control points keep unchanged by replacing  $t$ with $(1-t)$.

The series $s_{i}$ is ascending and concave due to the properties of $f(t)$. Applying lemma \ref{lemma:bezierAscending} and lemma \ref{lemma:bezierConcave}, $C(t)$ is ascending and concave.
We will prove lemma \ref{lemma:mainLemma} by recurrence. For $n \le 2$, it is easy to verify that lemma \ref{lemma:mainLemma} holds using lemma \ref{lemma:simpleAscending}.

Suppose the lemma holds for $n=k$ $(k > 2)$, when $n=k+1$, using the recurrence definition of Bezier curve:

\begin{equation}\begin{split}
C(t)&=\sum_{i=0}^{k+1}s_{i}B\textsupsub{$k+1$}{$i$}(t) \\
&=(1-t)\sum_{i=0}^{k}s_{i}B\textsupsub{$k$}{$i$}(t)+t\sum_{i=0}^{k}s_{i+1}B\textsupsub{$k$}{$i$}(t)
\label{eq:BezierRecurDefinition}
\end{split}\end{equation}

We only need to show that lemma \ref{lemma:mainLemma} holds for intervals $\left[\frac{1}{k+1}, \frac{2}{k+1}\right]$, $\left[\frac{2}{k+1}, \frac{3}{k+1}\right]$, ... , 
$\left[\frac{k-1}{k+1}, \frac{k}{k+1}\right]$, because for the first and the last interval, lemma \ref{lemma:mainLemma} holds due to corollary \ref{corollary:tangentFistLastPoint}.

The recurrence definition (\ref{eq:BezierRecurDefinition}) means that $C(t)$ is a combination of two lower degree Bezier curves. One is formed with $s_{0}, s_{1},$ $...$ $, s_{k}$, the other is formed with $s_{1}, s_{2},$ $...$ $, s_{k+1}$. With the assumption of recurrence, $\forall j \in \left[1, k-1\right]$ and 
$\forall t \in \left[\frac{j}{k}, \frac{j+1}{k}\right]$, we have

\begin{equation}\begin{split}
C(t) \le D(t)
\label{eq:BezierRecurIniquality}
\end{split}\end{equation}
where
\begin{equation}\begin{split}
D(t) = (1-t)(s_{j}+k(s_{j+1}-s_{j})(t-\frac{j}{k})) \\
+t(s_{j+1}+k(s_{j+2}-s_{j+1})(t-\frac{j}{k}))
\label{eq:BezierRecurIniqualityRightSide}
\end{split}\end{equation}

One can easily verify that $D(\frac{j}{k}) = s_{j}$, $D^{\prime}(\frac{j}{k}) = (k+1)(s_{j+1}-s_{j})$, and $D(t)$ is concave. According to lemma \ref{lemma:simpleAscending} and (\ref{eq:BezierRecurIniquality}), we have
\begin{equation}\begin{split}
C(t) &\le D(t) \le s_{j}+(k+1)(s_{j+1}-s_{j})(t-\frac{j}{k}) \\
& \forall t \in \left[\frac{j}{k}, \frac{j+1}{k}\right]
\label{eq:unshiftedInequality}
\end{split}\end{equation}

Now we will use the monotony of $C(t)$. $\forall t \in \left[\frac{j}{k+1}, \frac{j+1}{k+1}\right]$, note $\Delta t = \frac{j}{k} - \frac{j}{k+1} > 0$, we have $t+\Delta t \in \left[\frac{j}{k}, \frac{j+1}{k}\right]$. As we know $C(t)$ is ascending, from (\ref{eq:unshiftedInequality}) we have

\begin{equation}\begin{split}
C(t) &\le C(t+\Delta t) \\
&\le s_{j}+(k+1)(s_{j+1}-s_{j})(t + \Delta t - \frac{j}{k}) \\
&= s_{j}+(k+1)(s_{j+1}-s_{j})(t - (\frac{j}{k} - \frac{j}{k} + \frac{j}{k+1})) \\
&= s_{j}+(k+1)(s_{j+1}-s_{j})(t - \frac{j}{k+1})
\label{eq:shiftedInequality}
\end{split}\end{equation}

This concludes the proof for $n=k+1$. Lemma \ref{lemma:mainLemma} is thus proven.
\end{proof}

\begin{corollary}
$\forall n > 1$, if the upper bound function $f(t)$ defined in $\left[0,1\right]$ is ascending (resp. descending) and concave, for series $s_{i}=f(\frac{i}{n})$, we have $C(t)=\sum_{i=0}^{n}s_{i}B\textsupsub{$n$}{$i$}(t)$ $\le$ $f(t)$.
\label{corollary:monotoneLowerThanFt}
\end{corollary}

\begin{proof}
Using lemma \ref{lemma:mainLemma}, the proof is trivial due to the fact that CPETS is bounded by $f(t)$.
\end{proof}

\begin{lemma}
$\forall n > 1$, if the concave upper bound function $f(t)$ defined in $\left[0,1\right]$ is ascending in $\left[0, t_{0}\right]$ and is descending in $\left[t_{0}, 1\right]$, for series $s_{i}=f(\frac{i}{n})$, we have $C(t)=\sum_{i=0}^{n}s_{i}B\textsupsub{$n$}{$i$}(t)$ $\le$ $f(t)$.
\label{lemma:ascendingNdescending}
\end{lemma}

\begin{proof}
Define two functions $f_{1}(t)$ and $f_{2}(t)$ as shown in (\ref{eq:newFunction1}) and (\ref{eq:newFunction2}):
\begin{equation}\begin{split}
f_{1}(t) = \left\{
\begin{array}{l}
f(t) \; if \; t \in \left[0, t_{0}\right] \\
f(t_{0}) \; \text{otherwise}
\end{array}
\right.  
\label{eq:newFunction1}
\end{split}\end{equation}

\begin{equation}\begin{split}
f_{2}(t) = \left\{
\begin{array}{l}
f(t) \; if \; t \in \left[t_{0}, 1\right] \\
f(t_{0}) \; \text{otherwise}
\end{array}
\right.  
\label{eq:newFunction2}
\end{split}\end{equation}

It is easy to verify that $f_{1}(t)$ is ascending, $f_{1}(t) \ge f(t)$, $f_{2}(t)$ is descending, $f_{2}(t) \ge f(t)$, and the point-wise minimum function of $f_{1}(t)$ and $f_{2}(t)$ is $f(t)$, as shown in (\ref{eq:pointWiseMiminum}).

\begin{figure}[tbp]
\begin{center}
\includegraphics[width=6cm]{ascendingNdecending.png}
\end{center}
\vspace{-0.2 in}
\caption{Graphs of functions $f_{1}(t)$ (curve $abc'$), $f_{2}(t)$ (curve $a'bc$) and $f(t)$ (curve $abc$).}
\label{Fig:ascendingNdecending}
\vspace{-0.2 in}
\end{figure}

\begin{equation}\begin{split}
f(t) = \text{min} \left\{f_{1}(t), f_{2}(t)\right\}
\label{eq:pointWiseMiminum}
\end{split}\end{equation}

To better illustrate the idea of this proof, Fig. \ref{Fig:ascendingNdecending} shows the graphs of functions $f_{1}(t)$, $f_{2}(t)$ and $f(t)$. The curve $abc$ represents $f(t)$, $abc'$ represents $f_{1}(t)$, and $a'bc$ represents $f_{2}(t)$. Our objective is to bound $C(t)$ with $f_{1}(t)$ and $f_{2}(t)$ so that we can take the common part of the bounds, which is $f(t)$.

Applying corollary \ref{corollary:monotoneLowerThanFt}, we have

\begin{equation}\begin{split}
\left\{
\begin{array}{l}
\sum_{i=0}^{n}f_{1}(\frac{i}{n})B\textsupsub{$n$}{$i$}(t) \le f_{1}(t) \\
\sum_{i=0}^{n}f_{2}(\frac{i}{n})B\textsupsub{$n$}{$i$}(t) \le f_{2}(t)
\end{array}
\right. 
\label{eq:lowerThanNewDefinedFunc}
\end{split}\end{equation}

As $f_{1}(t) \ge f(t)$ and $f_{2}(t) \ge f(t)$, we have

\begin{equation}\begin{split}
\left\{
\begin{array}{l}
\sum_{i=0}^{n}f(\frac{i}{n})B\textsupsub{$n$}{$i$}(t) \le f_{1}(t) \\
\sum_{i=0}^{n}f(\frac{i}{n})B\textsupsub{$n$}{$i$}(t) \le f_{2}(t)
\end{array}
\right. 
\label{eq:lowerThanNewDefinedFunc2}
\end{split}\end{equation}

From (\ref{eq:pointWiseMiminum}) and (\ref{eq:lowerThanNewDefinedFunc2}), we have

\begin{equation}\begin{split}
\sum_{i=0}^{n}f(\frac{i}{n})B\textsupsub{$n$}{$i$}(t) \le \text{min} \left\{f_{1}(t), f_{2}(t) \right\} = f(t)
\label{eq:lowerThanNewDefinedFunc3}
\end{split}\end{equation}

This concludes the proof.
\end{proof}

\begin{corollary}
$\forall n > 1$, if the concave upper bound function $f(t)$ defined in $\left[0,1\right]$ is ascending in $\left[0, t_{0}\right]$ and is descending in $\left[t_{0}, 1\right]$, for series $s_{i}=f(\frac{i}{n})$, $\forall j \in \left[0, n-1\right]$ and 
$\forall t \in \left[\frac{j}{n}, \frac{j+1}{n}\right]$, we have $C(t)=\sum_{i=0}^{n}s_{i}B\textsupsub{$n$}{$i$}(t)$ $\le$ $s_{j}+n(s_{j+1}-s{j})(t-\frac{j}{n})$, i.e. the Bezier curve is bounded by the CPETS.
\label{lemma:ascendingNdescendingCPETS}
\end{corollary}

\begin{proof}
One can notice that the CPETS itself can be treated as a concave upper bound function, and the CPETS of a CPETS is still itself. The proof is trivial by applying lemma \ref{lemma:ascendingNdescending}.
\end{proof}

\subsection{Proof of Theorem \ref{theorem:equivalentTheorem}}

\begin{proof}
For the concave upper bound function $f(t)$, there is at most three possibilities: $f(t)$ is ascending, or descending, or ascending then descending. Corollary \ref{lemma:ascendingNdescendingCPETS} and lemma \ref{lemma:mainLemma} cover all possibilities. This concludes the proof.
\end{proof}
