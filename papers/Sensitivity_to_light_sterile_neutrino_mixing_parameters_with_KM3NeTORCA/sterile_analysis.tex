\section{Sterile Neutrino Analysis}\label{sec:analysismethod}
The analysis presented here is based on detailed Monte Carlo (MC) simulations as described in Ref.~\cite{ORCA_NMO_Paper}. Neutrino interactions are generated with gSeaGen~\cite{gSeaGen}, which is based on GENIE~\cite{GENIE}. Secondary particles and their emitted Cherenkov light are propagated with KM3Sim~\cite{KM3Sim}, a software package based on GEANT4~\cite{GEANT4}. The atmospheric neutrino flux is computed from the Honda model~\cite{Honda} for the Gran Sasso site without mountain over the detector, assuming minimum solar activity. Atmospheric muons are generated with MUPAGE~\cite{MUPAGE, MUPAGE2}, and propagated with KM3~\cite{KM3}.
\\
Event reconstruction is performed via a maximum likelihood fit to shower and track hypotheses. Background events arising from noise and atmospheric muons are rejected with two independent Random Decision Forests (RDF) trained on MC simulations. A third RDF was used to separate neutrino candidates into three topology classes defined by the output score of the RDF, trained to identify track-like events. Events with a track score larger than 0.7 are labelled as track-like, track scores less than 0.3 are labelled as shower-like, and other values are labelled as an intermediate topology. Moreover, as in Ref.~\cite{ORCA_NMO_Paper}, only upgoing events are considered in order to get rid of the atmospheric muon contamination.
\\
Instead of using parametrised response functions as in Ref.~\cite{ORCA_NMO_Paper}, the analysis reported here is based on the aforementioned MC simulations to directly model the detector response. The two approaches have been compared and found consistent.
\\
The MC-based modelling of the detector response is implemented in the KM3NeT framework Swim \cite{swim}. The detector response is represented by a 4-dimensional matrix, as a function of  true and reconstructed neutrino energy $E, \, E'$, and zenith angle $\theta, \, \theta'$, for each interaction channel $\nu_x$, $R^{[\nu_x \rightarrow i]}(E, \theta, E', \theta')$. Each entry of this matrix summarises in a single dimensionless coefficient the efficiency of detection, classification and probability of reconstruction for a given true bin $(E,\theta)$. Therefore, $R$ incorporates all the effects related both to the detector and to the event selection. More details on this approach, can be found in Ref.~\cite{swim}. The binning scheme, for the detector response matrix, used in this analysis is shown in Tab.\ \ref{tab:binsSwim}.\ Since the atmospheric neutrino flux follows a power law in energy, equal-width bins in $\log_{10}E$ are chosen. The same choice is adopted for reconstructed events histograms, as the relative energy resolution in ORCA is, to first order, constant above $\sim 10$ GeV, $\delta E / E \simeq \delta(\log_{10} E) \simeq 15\%$ \cite{intrinsic_limits}. 
\\
A binning of constant width in $\cos\theta_Z$ is used. This is motivated by the fact that the solid angle covered by an interval of zenith angle $\theta_1 \leq \theta \leq \theta_2$ is proportional to $|\cos\theta_1 - \cos\theta_2|$ and, considering to first order the atmospheric neutrino flux as isotropic, this choice yields equally populated bins along the zenith angle axis. 
\begin{table}[h]
	\centering
	\begin{tabular}{|c|c|c|c|c|}
		\hline
		& $E$ [GeV]& $\cos\theta_Z$ & $E'$ [GeV]& $\cos\theta_Z'$ \\
		\hline
		Bins & 40 & 40 &  20 & 20 \\
		\hline
		Range & $[1, 100]$ & $[-1, 0]$ & $[2, 100]$ & $[-1, 0]$ \\
		\hline
	\end{tabular}
	\caption{Bin choice for the MC-based response matrix, $R$, used in this analysis. Energy bins are in $\log_{10}$ space.}
	\label{tab:binsSwim}
\end{table}
\\
For reconstructed event histograms, the choice of binning granularity is dominated by the detector resolutions. The bin width should be comparable with the typical error on the reconstructed variable. Moreover, it should account for a sufficiently smooth sampling of the detector response, to minimise the finite MC statistics issues, which can result in overestimations of sensitivity \cite{swim}. Statistical fluctuations due to the sparse MC effect are taken into account by following the â€œBeeston and Barlow method" \cite{beeston}. 
\\
The values of the standard neutrino parameters used in this analysis is taken from the NuFit v4.1 global fit result with Super-Kamiokande (SK) data~\cite{NuFit41} and summarised in Tab.~\ref{tab:benchmarkoscparam}, for both normal (NO) and inverted ordering (IO). Current fits have large errors on $\delta_{CP}$. The impact of such variable in the analysis has been tested and found to be negligible. For this reason, its value is fixed to the ones reported in Tab.~\ref{tab:benchmarkoscparam}. Moreover, $\dmf > 0$ is always assumed. Oscillation probabilities are evaluated with the software package OscProb \cite{OscProb}, and to account for Earth's matter effects the PREM model \cite{PREM} with 44 layers is used.
\begin{table}[h]
	\centering
	\begin{tabular}{|c|c|c|c|c|c|c|}
		\hline
		& $\sin^2 \theta_{12}$ & $\sin^2\theta_{23}$ & $\sin^2\theta_{13}$ & $\dcp$ & $\Delta m_{21}^2 (\rm eV^2)$ & $\Delta m_{31}^2 (\rm eV^2)$ \\
		\hline
		NO & 0.310 & 0.563 & 0.02237 & $221^\circ$ & 7.39 $\times$ $10^{-5}$ & 2.528 $\times$ $10^{-3}$ \\
		\hline
		IO & 0.310 & 0.565 & 0.02259 & $282^\circ$ & 7.39 $\times$ $10^{-5}$ & $-2.510 \times$ $10^{-3}$ \\
		\hline
	\end{tabular}
	\caption{Benchmark oscillation parameters for NO and IO, taken from the NuFit v4.1 result \cite{NuFit41}.}
	\label{tab:benchmarkoscparam}
\end{table}
\\
The above information can be used to define the distinguishability $S_\sigma$, as a quick estimator of sensitivity of measurements, with the goal of illustrating the impact of a sterile neutrino in the event distributions, as
\begin{equation}
S_{\sigma} = \frac{(N_{\rm Sterile} - N_{\rm Standard}) |N_{\rm Sterile} - N_{\rm Standard}|}{N_{\rm Sterile} },
\end{equation}
where $N_{\rm Sterile}$ and $N_{\rm Standard}$ are the number of events, as a function of reconstructed energy and zenith angle, in the sterile and standard hypothesis respectively.
\begin{figure}
	\centering
	\includegraphics[width=1.\linewidth]{figures/chi2dist/LSMS_NOnorm}
	\caption{$S_\sigma$ distribution of the three topologies considered in the analysis (tracks, intermediates and showers) assuming three years of data taking. The colour scale denotes the $S_\sigma$ value for each bin, whereas the total $S_\sigma$ is reported on top of the plots: the high value obtained is due to the normalisation. The sterile neutrino parameters are $\sin^2\theta_{14} = 0$, $\sin^2\theta_{24} = 0.03$,  $\sin^2\theta_{34} = 0.05$, $\Delta m_{41}^2 = 1 \, \eV$.}
	\label{fig:chi2paperstd3years}
\end{figure}
\begin{figure}
	\centering
	\includegraphics[width=1.\linewidth]{figures/chi2dist/LSMS_Ue005_NOnorm}
	\caption{$S_\sigma$ distribution of the three topologies considered in the analysis (tracks, intermediates and showers) assuming three years of data taking. The colour scale denotes the $S_\sigma$ value for each bin, whereas the total $S_\sigma$ is reported on top of the plots: the high value obtained is due to the normalisation. The sterile neutrino parameters are $\sin^2\theta_{14} = 0.05$,  $\sin^2\theta_{24} = \sin^2\theta_{34} = 0$, $\Delta m_{41}^2 = 1 \, \eV$.}
	\label{fig:chi2paperue43years}
\end{figure}
\begin{figure}
	\centering
	\includegraphics[width=1.\linewidth]{figures/chi2dist/SSMS_UeUmuUt001_NOnorm}
	\caption{$S_\sigma$ distribution of the three topologies considered in the analysis (tracks, intermediates and showers) assuming three years of data taking. The colour scale denotes the $S_\sigma$ value for each bin, whereas the total $S_\sigma$ is reported on top of the plots: the high value obtained is due to the normalisation. The sterile neutrino parameters are $\sin^2\theta_{14} = \sin^2\theta_{24} = \sin^2\theta_{34} = 0.01$,  $\Delta m_{41}^2 = 10^{-4} \, \eV$.}
	\label{fig:chi2paperlowmass3years}
\end{figure}
\\
Fig. \ref{fig:chi2paperstd3years} shows the distinguishability distribution for a sterile neutrino in the HF region, for non-zero $\theta_{24}$ and $\theta_{34}$, assuming three years of ORCA data taking. The presence of the sterile neutrino mainly impacts the track-like events in the form of a deficit of upgoing events at higher energies ($E' \geq 40$ GeV). Therefore, this region of the sterile parameter space can be well constrained also by neutrino telescopes whose energy threshold is higher than that of ORCA, such as ANTARES \cite{ANTARES_Sterile} and IceCube/DeepCore \cite{DeepCore_Steriles}.
\\
To understand the sensitivity to $\theta_{14}$ in particular, the distinguishability for a sterile neutrino in the HF region and $\sin^2\theta_{14}=0.05$ is shown in Fig. \ref{fig:chi2paperue43years}. In this case, the shower-like events are the most affected and mainly for energies $< 20$ GeV. It follows that ORCA is well suited to test $\theta_{14}$.
\\
Finally, Fig. \ref{fig:chi2paperlowmass3years} shows the impact of a sterile neutrino with $\Delta m_{41}^2 = 10^{-4}$ eV$^2$. In this case, the energy region $E' < 10$ GeV is the most significant, and all the three event topologies are highly impacted. This applies also for $\Delta m_{41}^2 = 10^{-2}, 10^{-3}, 10^{-5} \, \eV$.
\\
The sensitivity evaluation is based on the minimisation of a negative log-likelihood function describing the agreement between a model prediction and observed data. This is done with the Asimov approach \cite{Asimov} assuming the negative log-likelihood follows a chi-squared distribution. Specifically, the negative log-likelihood function is defined as: 
\begin{equation}
\begin{split}
\chi^2 = & -2 \log L = \chi^2_{\rm stat} + \chi^2_{\rm syst} = \\
& 2 \sum_{i=1}^{N_{E'}} \sum_{j=1}^{N_{\cos \theta'}} \sum_{t=1}^{3} \left[ N_{ijt}^{\rm model}(\eta) - N_{ijt}^{\rm data}
+ N_{ijt}^{\rm data}\rm{log} \left( \frac {\it N_{\rm ijt}^{\rm data}}{\it N_{ijt}^{\rm model}(\eta)} \right) \right] \\
& + \sum_{k=1}^{N_{\rm Syst}} \left( \frac{\eta'_{k} - \braket{\eta'_{k}}}{\sigma_{\eta'_k}} \right)^2 ,
\end{split}
\end{equation}
where $N_{ijt}^{\rm model}$ and $N_{ijt}^{\rm data}$ represent the number of expected and measured events in bin ($i,j$) respectively and the sum over $t$ runs over the three event topologies: tracks, intermediates and showers. $\eta$ represents the model parameters, which comprise both the oscillation parameters listed in Tab.\ \ref{tab:benchmarkoscparam}, and nuisance parameters $\eta'$, which are related to systematic uncertainties. The second sum runs over the nuisance parameters and $\braket{\eta'_{k}}$ is the assumed prior of the parameter $k$ and $\sigma_{\eta'_k}$ its uncertainty. The set of free parameters considered in this analysis, together with the assumed gaussian priors with mean $\mu$ and standard deviation $\sigma$, is summarised in Tab.\ \ref{tab:systlist}. 
\begin{table} 
	\centering
	\begin{tabular}{|c |c|} 	
		\hline
		\bf{Parameter} & \bf{Gaussian Prior ($\mu \pm \sigma$)}  \\ [0.5ex] 
		\hline
		$\nu_e/\bar{\nu}_e$ & $0 \pm 0.07$ \\ 
		\hline
		$\nu_\mu/\bar{\nu}_\mu$ & $0 \pm 0.05$ \\ 
		\hline
		$\nu_e/\nu_\mu$ & $0 \pm 0.02$ \\ 
		\hline
		NC Scale & No prior \\
		\hline
		Energy Scale & $1 \pm 0.05$\\
		\hline
		Energy Slope & No prior \\
		\hline
		Zenith Angle Slope & $0 \pm 0.02$\\
		\hline
		Track Normalisation & No Prior \\
		\hline
		Intermediate Normalisation & No Prior \\
		\hline
		Shower Normalisation & No Prior \\
		\hline
		$\Delta m_{31}^2$ & No prior \\ 
		\hline
		$\theta_{13}$ & $\theta_{13} \pm 0.13^\circ$ \\
		\hline
		$\theta_{23}$ & No prior \\[1ex]
		\hline
	\end{tabular}
	\caption{List of fitted values and relative gaussian priors considered in this analysis. $\theta_{13}$ refers to the values listed in Tab.\ \ref{tab:benchmarkoscparam}}
	\label{tab:systlist}
\end{table} 
Where the uncertainties on the neutrino flux are taken from Ref. \cite{flux_syst} and the uncertainty on the detector energy scale follows the investigations reported in Ref. \cite{loi} (section 3.4.6). Specifically:
\begin{enumerate}
	\item \label{sysnew-2} the ratio between the total number of $\nu_e$ and $\bar{\nu}_e$ is allowed to vary with a standard deviation of 7$\%$ of the parameter's nominal value,
	\item the ratio between the total number of $\nu_\mu$ and $\bar{\nu}_\mu$ is allowed to vary with a standard deviation of 5$\%$ of the parameter's nominal value,
	\item the ratio between the total number of $\nu_e$ and $\nu_\mu$ is allowed to vary  with a standard deviation of 2$\%$ of the parameter's nominal value,
	\item the number of NC events is scaled by the \textit{NC scale} factor, to which no constraint is applied,
	\item the absolute \textit{energy scale} of the detector, which depends on the knowledge of the PMT efficiencies and the water optical properties, as discussed in Ref.~\cite{ORCA_NMO_Paper}, is allowed to vary with a standard deviation of 5\% around its nominal value,
	\item the \textit{energy slope} of the neutrino flux energy distribution is allowed to vary without constraint,
	\item \label{sysnew-1} the ratio of upgoing to horizontally-going neutrinos, the \textit{zenith angle slope}, is allowed to vary with a standard deviation of $2\%$ of the parameter's nominal value,
	\item  \label{sysnew-L} the number of events in the three classes is allowed to vary without constraints,
	\item $\Delta m_{31}^2$ and $\theta_{23}$ are allowed to vary without constraints,
	\item $\theta_{13}$ is allowed to vary within a $1\sigma$ window of the parameter's nominal value, which corresponds to $0.13^\circ$ for both NO and IO.
\end{enumerate}
In the following section, the ORCA sensitivity to the active-sterile parameters is presented.


