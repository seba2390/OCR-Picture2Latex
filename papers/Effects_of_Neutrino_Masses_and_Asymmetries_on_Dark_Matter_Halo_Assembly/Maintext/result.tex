\section{Simulation results}
\label{sec:result}
\subsection{Neutrino effects on mean formation time $\bar a$}
We study the distribution of the halo formation time $a_{1/2}$ for halos with mass $M$ between $10^{13} M_\odot$ and $3\times 10^{13} M_\odot$. 
The choice of the mass range ensures the halos contain more than 100 simulation particles and enough halo samples to reduce the statistical error of $\bar a$.
The mean formation time $\bar a$ for different $M_\nu$ and $\eta^2$ are listed in Table \ref{tab:formtime}, showing changes that are small but significant. The changes of the $a_{1/2}$ distributions can be represented by $\bar a$ of the halos in this mass range.

\begin{table}[!h]
		\begin{center}
		\begin{tabular}{|c|c|c|c|c|}
			\hline
			No. & $\bar a$ & Std. Err. & Sample size \\
			\hline \hline
			A1 & 0.58530 & 0.00024 & 316378  \\
			A2 & 0.58350 & 0.00024 & 315481  \\
			A3 & 0.57483 & 0.00024 & 310334  \\
			\hline
			B1 & 0.59319 & 0.00023 & 325006  \\
			B2 & 0.59038 & 0.00023 & 324867  \\
			B3 & 0.58331 & 0.00024  & 321874  \\
			\hline
			C1 & 0.60059 & 0.00023 & 338174  \\
			C2 & 0.59872 & 0.00023 & 337104  \\
			C3 & 0.59076 & 0.00023  & 334514  \\		
			\hline
		\end{tabular}
		\caption{\label{tab:formtime} $\bar a = \langle a_{1/2} \rangle$ for halos with mass $10^{13}M_\odot < M <3\times10^{13} M_\odot$} for simulations with different $M_\nu$ and $\eta^2$  (see Table \ref{tab:simparam}).
		\end{center}
\end{table}


To parameterize the effects of neutrinos on $\bar a$, we fit the fractional change of $\bar a$ as a function of $M_\nu$ and $\eta^2$. Here we choose $M_\nu = 0.06$ eV and $\eta^2=0$ as the baseline for comparison. We define:
\begin{equation}
    \Delta \bar a(M_\nu,\eta^2) \equiv \frac{\bar a(M_\nu, \eta^2) - \bar a(0.06\mathrm{ \,eV}, 0)}{\bar a(0.06\mathrm{\,eV}, 0)}.
\end{equation}
The regression model is:
\begin{align}
\label{eq:reg_da}
    \Delta \bar a(M_\nu,\eta^2) [\%] &= C_m \left(\frac{M_\nu-0.06\mathrm{\, eV}}{0.1\mathrm{\, eV}}\right) + C_\eta\eta^2, \nonumber \\
    \Delta \bar a(M',\eta^2) [\%]&= (1.39\pm0.06)M' -(1.55\pm0.07)\eta^2,
\end{align}
where $M'=(M_\nu[\mathrm{0.1eV}]-0.6)$, the deviation of $M_\nu$ in units of $0.1\,\mathrm{eV}$ from our chosen baseline. We plot $\Delta \bar{a} - 1.39 M'$ in Figure \ref{fig:da_m}, which should depend on $\eta^2$.

\begin{figure}[!h]
		\begin{center}% Center the figure.
		\includegraphics[width=0.7\columnwidth]{PDF/da_m.pdf}
		\caption{$\Delta \bar a - 1.39M'$ vs. $\eta^2$ (see Eq.(\ref{eq:reg_da})) for different $M_\nu$ in Table \ref{tab:formtime}. This combination of $\Delta \bar a$ and $M'$ should depend only on $\eta^2$ in the regression model, and the simple linear fit describes the simulation data quite well.}
		\label{fig:da_m}
		\end{center}
\end{figure}
\begin{figure}[!h]
		\begin{center}% Center the figure.
		\includegraphics[width=0.7\columnwidth]{PDF/da_v.pdf}
		\caption{$\Delta {\bar a}$ vs. $v_1$ (see Eq. (\ref{eq:reg_v1})) for various $M_\nu$ and $\eta^2$, showing the quality of the regression model.}
		\label{fig:da_v}
		\end{center}
\end{figure}




Notice that we use $\eta^2$, not $\eta$ for the dependence of $\Delta \bar a$. 
This is because the regression of cosmological parameters suggest that the coefficient of $\eta^1$ is 0 within uncertainty (see Appendix \ref{app:posterior}).
Physically, the changes in the neutrino energy density are proportional to $\eta^2$ to the lowest order when neutrino asymmetries are introduced.
Finite $M_\nu$ and $\eta^2$ have opposite effects on $\Delta \bar a$. A previous study also showed similar results on the cosmological parameters and matter power spectrum \cite{Carton}.


To unveil the possible correlation between $M'$ and $\eta^2$ in the fitting of $\Delta \bar a$, we compute the covariance matrix of the fitting, and the off-diagonal elements are significant indeed. We define $v_1, v_2$ as:
\begin{equation}
\label{eq:rot}
    \begin{cases}
    v_1 = M'\cos \theta  - \eta^2 \sin \theta,  \\ 
    v_2 = M' \sin \theta  + \eta^2\cos \theta.
    \end{cases}
\end{equation}
We find that $\theta = 0.27\pi$ will minimize the off-diagonal terms of the covariance matrix in the new basis. The contribution of $v_1 = (0.66 M' - 0.75\eta^2)$ to $\Delta \bar a$ dominates over that of $v_2$.
\begin{equation}
\label{eq:reg_v1}
    \Delta \bar a(v_1, v_2) [\%] = (2.09\pm0.09) v_1 + (0.02\pm0.03) v_2.
\end{equation}
We plot $\Delta \bar a(v_1)$ in Figure \ref{fig:da_v}. The lack of its dependency on $v_2$ implies that we can only determine the combination of $M_\nu$ and $\eta^2$ as $v_1$ using $\Delta \bar a$. We hope to break this degeneracy between $M_\nu$ and $\eta^2$ using the merger histories of the halos.


\subsection{Neutrino effects on the mean tree entropy $\bar s$}
The tree entropy $s$ is also calculated for the halo catalog,
including all halos with mass $M>4\times10^{13} M_\odot$ and excluding those that never experienced any merger (i.e. $s=0$). Those halos would have more than 400 simulation particles, and thus the merger histories of halos can be captured accurately.
However, the changes in the mean tree entropy $\bar s$ for different $M_\nu$ and $\eta^2$, $\Delta {\bar s} (M', \eta^2) \equiv \bar s(M', \eta^2) / \bar s (0, 0)-1$, are barely significant. 
The shifts in the distribution of $s$ at a higher redshift (see Figure \ref{fig:s_dis}) are still fairly small.
The regression of $\Delta \bar s$ on $M'$ and $\eta^2$ gives:
\begin{equation}
    \Delta \bar s(M',\eta^2) [\%] = (-0.02\pm0.03) M' + (0.15\pm0.07) \eta^2.
\end{equation}

\begin{minipage}{\columnwidth}
\centering
  \begin{minipage}[b]{0.49\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{PDF/s_dis.pdf}
    \captionof{figure}{\label{fig:s_dis}PDF of tree entropy for A3 and C1 at $z=0$ (upper panel) and 1.256 (lower panel).}
  \end{minipage}
  \hfill
  \begin{minipage}[b]{0.49\columnwidth}
    \centering
		\begin{tabular}{|c|c|c|c|c|}
			\hline 
			No. & $\bar s$ & Std. Err. & Sample size \\
			\hline \hline
			A1 & 0.40912 & 0.00054 & 94488  \\
			A2 & 0.40922 & 0.00054 & 94272  \\
			A3 & 0.41090 & 0.00054 & 93997  \\
			\hline
			B1 & 0.40773 & 0.00054 & 94421  \\
			B2 & 0.40921 & 0.00054 & 94566  \\
			B3 & 0.41135 & 0.00054 & 94101  \\
			\hline
			C1 & 0.40718 & 0.00054 & 94653  \\
			C2 & 0.40785 & 0.00054 & 94256 \\
			C3 & 0.41044 & 0.00054 & 93886  \\		
			\hline
		\end{tabular}
      \captionof{table}{ \label{tab:entropy_dis} Mean tree entropies for different simulations $\bar s = \langle s \rangle$ with their standard errors and sample sizes.}
    \end{minipage}
\end{minipage}
\vspace{0.5cm}
		

At $z=0$, all 9 runs show $\bar s\sim 0.4$ with overlapping error bars (See Table $\ref{tab:entropy_dis}$).
To reveal the neutrinos' effects on the merger histories of halos, we calculate $\bar s$ for different halo leaf counts $X$.

\begin{table}[!hbt]
		\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
			\hline 
			No & $X$ bin & $\bar s$ & Sample size \\
			\hline \hline
			A1 & $1<X\le6$ & 0.3216 & 16890  \\
			B1& $6<X\le30$ & 0.4208 & 68126  \\
			C1 & $30<X\le120$ & 0.4706 & 8425  \\
			\hline
			A1 & $1<X\le6$ & 0.3264 & 19079  \\
			B1 & $6<X\le30$ & 0.4211 & 66716  \\
			C1 & $30<X\le120$ & 0.4720 & 7758  \\
			\hline
			A1 & $1<X\le6$ & 0.3293 & 21226  \\
			B1 & $6<X\le30$ & 0.4226 & 65759  \\
			C1 & $30<X\le120$ & 0.4767 & 6926  \\
			\hline
		\end{tabular}
		\caption{$\bar s$ for different neutrino mass $M_\nu$ (A1: $M_\nu = 0.06$ eV, B1: $M_\nu = 0.15$ eV, C1: $M_\nu = 0.24$ eV. All with fixed $\eta^2 = 0$) with $X$ binning.}
		\end{center}
\end{table}

With the $X$ filter, we can see two general trends. Firstly, $X$ has a positive correlation with $\bar s$. This is intuitive as a larger $X$ would imply more merging events for the halo, and such a halo would more likely experience major mergers. Secondly, in each $X$ bin, $\bar s$ increases as $M_\nu$ increases, especially for halos with lower $X$. The reason that we do not see an overall $\bar s$ dependence on $M_\nu$ is that while a larger $M_\nu$ increases $\bar s$ for each $X$ bin, it also decreases the number of halos with large $X$, which have larger $s$, and the two effects compensate for each other.

Qualitatively, the increase in $\bar s$ with increasing $M_\nu$ for halos with a given $X$ can be understood as a result of the shorter neutrino free-streaming length, which leads to less clustering of halos. On average, the halo environment would be less dense and there would be less smooth accretion which would decrease $s$.



\subsection{Neutrino effects on the halo leaf function $\ell(X)$}
The halo leaf function $\ell(X)$ for different $M_\nu$ and $\eta^2$ is calculated.
We define the fractional change of $\ell(X)$ as $\Delta \ell_{>X} \equiv \ell(M', \eta^2, X) /\ell(0, 0, X) - 1$.
We plot $\Delta \ell_{>2}$ vs. $z$ for various $M_\nu$ and $\eta^2$ in Figure \ref{fig:N_x}. We then do the linear fitting of $\Delta \ell_{>2}$ for different $z$:
\begin{equation}
\label{eq:reg_dN}
    \Delta \ell_{>2}(M', \eta^2)[\%] = D_m  M' + D_\eta\eta^2,
\end{equation}
and we rotate the basis $(M', \eta^2)$ to $(w_1, w_2)$ using $w_1 = M' \cos \phi\, -\, \eta^2 \sin \phi$ and $w_2 = M' \sin \phi \,+\, \eta^2 \cos \phi$ to minimize the off-diagonal terms in the covariance matrix:\
\begin{equation}
\label{eq:reg_dN_w}
    \Delta \ell_{>2}(w_1, w_2)[\%]= D_1 w_1 + D_2 w_2.
\end{equation}
\begin{figure}[!h]
		\begin{center}% Center the figure.
		\includegraphics[width=\columnwidth]{PDF/Nz_full.pdf}
		\caption{\label{fig:N_x}Number of halos containing more than 2 leaves ($\ell(2)$, top panel) and $\Delta \ell_{>2}$ (bottom panel) vs. $z$, for different $M_\nu$ and $\eta^2$.  As $M_\nu$ increases (left panel), the suppression of $\ell(2)$ at large $z$ is more severe, implying larger delay of  merger events. The effect of $\eta^2$ partially cancels with that of $M_\nu$ (right panel). }
		\end{center}
\end{figure}
\begin{table}[!h]
		\begin{center}
		\begin{tabular}{|c|c c|c|c c|}
			\hline
			$z$ & $D_m$ & $D_\eta$ & $\phi (\pi)$ & $D_1$ & $D_2$\\
			\hline \hline
			0.00 & $-3.44 \pm 0.21$ & $6.09 \pm 0.38$ & 0.337 & $-6.99 \pm 0.44$ & $-0.08 \pm 0.00$ \\
			0.03 & $-3.65 \pm 0.22$ & $6.30 \pm 0.39$ & 0.337 & $-7.28 \pm 0.44$ & $-0.17 \pm 0.02$ \\
			0.07 & $-3.87 \pm 0.25$ & $6.40 \pm 0.44$ & 0.338 & $-7.47 \pm 0.50$ & $-0.31 \pm 0.04$ \\
			0.11 & $-4.07 \pm 0.30$ & $6.43 \pm 0.53$ & 0.339 & $-7.59 \pm 0.60$ & $-0.47 \pm 0.07$ \\
			0.16 & $-4.26 \pm 0.36$ & $6.39 \pm 0.62$ & 0.337 & $-7.65 \pm 0.70$ & $-0.65 \pm 0.12$ \\
			0.21 & $-4.64 \pm 0.36$ & $6.70 \pm 0.60$ & 0.336 & $-8.11 \pm 0.68$ & $-0.84 \pm 0.14$ \\
			0.26 & $-5.12 \pm 0.32$ & $7.27 \pm 0.52$ & 0.334 & $-8.86 \pm 0.60$ & $-0.71 \pm 0.13$ \\
			0.32 & $-5.59 \pm 0.27$ & $7.94 \pm 0.44$ & 0.334 & $-9.68 \pm 0.51$ & $-0.77 \pm 0.11$ \\
			0.38 & $-6.15 \pm 0.29$ & $8.41 \pm 0.45$ & 0.330 & $-10.37 \pm 0.51$ & $-1.01 \pm 0.13$ \\
			0.45 & $-6.95 \pm 0.27$ & $9.11 \pm 0.40$ & 0.321 & $-11.42 \pm 0.46$ & $-0.99 \pm 0.14$ \\
			0.53 & $-7.51 \pm 0.31$ & $9.56 \pm 0.44$ & 0.313 & $-12.13 \pm 0.52$ & $-0.83 \pm 0.16$ \\
			0.62 & $-8.21 \pm 0.42$ & $9.93 \pm 0.53$ & 0.296 & $-12.86 \pm 0.64$ & $-0.80 \pm 0.21$ \\
			0.71 & $-9.06 \pm 0.46$ & $10.47 \pm 0.53$ & 0.277 & $-13.84 \pm 0.67$ & $-0.30 \pm 0.20$ \\
			0.82 & $-9.94 \pm 0.57$ & $11.23 \pm 0.62$ & 0.269 & $-14.99 \pm 0.81$ & $-0.03 \pm 0.24$ \\
			0.95 & $-11.27 \pm 0.50$ & $12.51 \pm 0.53$ & 0.262 & $-16.83 \pm 0.71$ & $0.35 \pm 0.20$ \\
			1.09 & $-12.20 \pm 0.84$ & $12.72 \pm 0.81$ & 0.244 & $-17.60 \pm 1.14$ & $0.92 \pm 0.25$ \\
			1.25 & $-13.43 \pm 1.05$ & $13.83 \pm 0.99$ & 0.241 & $-19.25 \pm 1.41$ & $0.89 \pm 0.29$ \\
			1.44 & $-15.89 \pm 0.80$ & $16.00 \pm 0.74$ & 0.239 & $-22.54 \pm 1.07$ & $0.78 \pm 0.17$ \\
			1.67 & $-18.63 \pm 0.65 $ & $ 18.36 \pm 0.60$ & 0.236 & $ -26.15 \pm 0.87 $ & $ 0.63 \pm 0.11$\\
			\hline
		\end{tabular}
		\caption{\label{tab:dN_reg} Regression result for $\Delta \ell_{>2}$ at different $z$ (see Eqs.(\ref{eq:reg_dN}) and (\ref{eq:reg_dN_w})).}
		\end{center}
\end{table}
\begin{figure}[!h]
		\begin{center}% Center the figure.
		\includegraphics[width=0.71\columnwidth]{PDF/phi.pdf}
		\caption{\label{fig:phi} Values of $\phi$ in Eq.(\ref{eq:reg_dN_w}) for $\Delta \ell_{>2}$,  $\Delta \ell_{>4}$ and $\Delta \ell_{>8}$. All of them go through a similar transition, though at different redshifts $z$. 
		To obtain the error bars for $\phi$, we fit $\Delta \ell_{>X}$ as a function of $\phi$ using Eq.(\ref{eq:reg_dN_w}) with $D_1, D_2$ fixed at their best-fit values in Table \ref{tab:dN_reg}.}
		\end{center}
\end{figure}

We first focus on the regression model Eq.(\ref{eq:reg_dN}). The signs of $D_m$ and $D_\eta$ in Table \ref{tab:dN_reg} are opposite, implying that the effects of $M_\nu$ and $\eta^2$ on $\ell(2)$ are opposite. 
$M_\nu$ suppresses $\ell(2)$, while $\eta^2$ enhances it. 
This may be due to the modified Hubble expansion. 
In Appendix \ref{app:posterior}, we show that a larger $M_\nu$ ($\eta^2$) leads to a smaller (larger) $H_0$.
A faster expansion leads to fewer halo mergers,
resulting in a universe with more halos with two or less leaves.

If we rotate the basis to $(w_1, w_2)$, the contribution of $w_2$ is again minimal, and the rotation angle $\phi$ is redshift-dependent. $\phi$ stays at $0.24\pi$ for high redshift and gradually increases to $0.34\pi$ before it stabilizes again at $z\sim0.2$. 
Like $\Delta \bar a$, $\Delta \ell_{>2}$ can only be used to determine a specific combination of $M_\nu$ and $\eta^2$. However, it provides different combinations at different redshifts. Therefore, the values of $\Delta \ell_{>2}$ at different redshifts can constrain both $M_\nu$ and $\eta^2$.
Since the contribution of $w_2$ is small, $\Delta \ell_{>2}(z)\approx D_1(z) w_1[\phi(z)]$. $D_1(z)$ controls the overall suppression compared to the baseline, while $\phi(z)$ controls the relative weights of $M_\nu$ and $\eta^2$.

The transition of $\phi$ is due to the different decay rates of $D_m$ and $D_\eta$. 
Between $z=1.67$ and $z=0$, $D_m$ drops by a factor of $5$, whereas $D_\eta$ only drops by a factor of $3$. 
However, the value of $\phi$ changes quite rapidly at $z\sim0.7$, and there are no correspondingly sudden changes of $D_m$ and $D_\eta$. A deeper understanding of the transition in $\phi$ is an interesting future work. 

We repeated the calculation for $\ell(4)$ and $\ell(8)$, and similar transitions in $\phi$ are observed (see Figure \ref{fig:phi}) even though they are delayed compared to that for $\ell(2)$.


