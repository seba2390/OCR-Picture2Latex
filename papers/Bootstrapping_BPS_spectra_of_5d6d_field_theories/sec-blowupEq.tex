\section{Blowup equations}\label{sec:BlowupEq}

In this section, we review and generalize the Nakajima-Yoshioka's blowup equations which are the main tool for computing the BPS partition functions of 5d/6d SQFTs on $\mathbb{C}^2\times S^1 ({\rm or~} \mathbb{C}^2\times T^2)$, and propose our main claim which enables one to compute the BPS spectrum of any SQFT. We also present some instructive examples for computing the partition functions.

%--------------------
\input{sec-BE-review}
%--------------------

\subsection{Instructive examples}\label{sec:instructive}

In this section, we present instructive examples which illustrate our proposal in section~\ref{sec:BlowupEqReview} for bootstrapping the BPS partition functions.

\subsubsection{5d pure \texorpdfstring{$SU(2)_\theta$}{SU2theta} with \texorpdfstring{$\theta=0,\pi$}{theta0pi}}

As the simplest example, consider the 5d $\mathcal{N}=1$ pure $SU(2)_\theta$ gauge theory with a discrete theta angle $ \theta = 0 $ or $ \pi $. As the perturbative descriptions of two theories are the same, they have the same prepotential. It follows from \eqref{eq:preF} that the cubic prepotential is given by
\begin{align}
6\mathcal{F}
= 6 m \phi^2+8\phi^3 \ ,
\end{align}
where $ m= 1/g^2 $ is the gauge coupling and $\phi$ is the Coulomb branch parameter for the $SU(2)$ gauge symmetry. The effective prepotential defined in \eqref{eq:E-func} evaluated on the $\Omega$-background for both theories takes the form of
\begin{align}
\mathcal{E}
= \frac{1}{\epsilon_1 \epsilon_2} \qty(\mathcal{F} - \frac{\epsilon_1^2  + \epsilon_2^2}{12}\phi+\epsilon_+^2 \phi) \ ,
\end{align}
where the second term comes from the mixed gauge/gravitational CS term with $C^G_\phi=-4$ in \eqref{eq:C_i}, and the third term comes from the mixed gauge/$SU(2)_R$ CS term with $C^R_\phi=2$. The mixed CS terms are also insensitive to the discrete theta angle.

We now use the effective prepotential $\mathcal{E}$ as an initial input for the blowup equation to obtain BPS spectrum of this theory. Recall that though $\mathcal{E}$ for both $SU(2)_0$ and $SU(2)_\pi$ theories are the same, they have different UV fixed points and thus they have different BPS spectra. This is reflected in the blowup equation by two distinct choices of background magnetic flux $B_m$ for the topological $U(1)$ symmetry: 
\begin{equation}
B_m \in \left\{ \begin{array}{ll} \mathbb{Z} &\ {\rm for} \ SU(2)_0\  \\ \mathbb{Z}+1/2 & \ {\rm for} \ SU(2)_\pi \end{array}\right.\ .
\end{equation}

To choose the flux $B_m$ properly, it is convenient to consider geometric construction of two theories. The $SU(2)_0$ theory is geometrically engineered by a CY 3-fold containing a single Hirzebruch surface $ \mathbb{F}_0 $, while the $SU(2)_\pi$ theory is engineered by another 3-fold containing a Hirzebruch surface $ \mathbb{F}_1 $.
\begin{figure}
	\centering
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{tikzpicture}
		\draw[thick] (0, 0) -- (1.5, 0) -- (1.5, 1.5) -- (0, 1.5) -- (0, 0);
		\draw[thick] (0, 0) -- (-0.5, -0.5);
		\draw[thick] (1.5, 0) -- (2, -0.5);
		\draw[thick] (1.5, 1.5) -- (2, 2);
		\draw[thick] (0, 1.5) -- (-0.5, 2);
		\draw (-0.2, 0.75) node {$ _f $} (0.75, 1.7) node {$ _e $};
		\end{tikzpicture}
		\caption{$ \mathbb{F}_0 $}
	\end{subfigure}
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{tikzpicture}
		\draw[thick] (0, 0) -- (0, 1.5) -- (1, 1.5) -- (2, 0) -- (0, 0);
		\draw[thick] (0, 0) -- (-0.5, -0.5);
		\draw[thick] (0, 1.5) -- (-0.5, 2);
		\draw[thick] (1, 1.5) -- (1, 2);
		\draw[thick] (2, 0) -- (2.6, -0.3);
		\draw (-0.2, 0.75) node {$ _f $} (0.5, 1.7) node {$ _e $} (1, -.3) node {$ _h $};
		\end{tikzpicture}
		\caption{$ \mathbb{F}_1 $}
	\end{subfigure}
	\caption{Geometric constructions of (a) $ SU(2)_0 $ and (b) $ SU(2)_\pi $. The fiber $\mathbb{P}^1$ in a Hirzebruch surface $\mathbb{F}_n$ is denoted by $f$, the base $\mathbb{P}^1$ is denoted by $e$, and $h=e+f$ for $\mathbb{F}_1$. } \label{fig:SU2}
\end{figure}
The primitive 2-cycles (or Mori cone generators) in a Hirzebruch surface are the fiber $f$ and the base $e$. The volumes of these 2-cycles are given by
\begin{align}
\left\{
\begin{array}{ll}
\mathbb{F}_0 &: \quad \vol(f) = 2\phi, \quad \vol(e) = 2\phi + m\,, \\
\mathbb{F}_1 &: \quad \vol(f) = 2\phi, \quad \vol(e) = \phi + m\,.
\end{array} \right. 
\end{align}
Here $m$ is a K\"ahler parameter for a non-compact 4-cycle that is identified with the gauge coupling in the gauge theory. This implies that the curve $e$ in each geometry carries charge $+1$ for the $U(1)$ topological symmetry. 

Let us consider a canonically quantized magnetic flux $n\in\mathbb{Z}$ for the $SU(2)$ gauge symmetry in both $\mathbb{F}_0$ and $\mathbb{F}_1$ theories. This magnetic flux can suitably couple to the state coming from a wrapped M2-brane on the fiber curve $f$. This state is a W-boson with gauge charge $+2$ and it feels an integer magnetic flux $2n$, which is compatible with the quantization condition in \eqref{eq:quantization}.

Two theories have different quantization conditions on the background flux $B_m$ for the $U(1)$ topological symmetry. Consider first the theory of $\mathbb{F}_0$. The $e$ curve in this geometry gives rise to a vector multiplet with charge $+2$ for the gauge symmetry and charge $+1$ for the topological symmetry. From the quantization condition \eqref{eq:quantization} with $n\in\mathbb{Z}$, the background flux should be quantized as $B_m\in\mathbb{Z}$. On the other hand, the state associated to the $e$ curve in the theory of $\mathbb{F}_1$ is a hypermultiplet with gauge charge $+1$ and topological charge $+1$. Then the quantization condition \eqref{eq:quantization} requires the background flux to be half-integrally quantized, $B_m\in\mathbb{Z}+1/2$. Hence we find the following quantizations for the magnetic fluxes:
\begin{align}\label{eq:su2_e_shift}
\left\{
\begin{array}{ll}
\mathbb{F}_0 &: \quad n\in\mathbb{Z} \ , \quad B_m \in \mathbb{Z} \\
\mathbb{F}_1 &: \quad n\in\mathbb{Z} \ , \quad B_m \in \mathbb{Z}+1/2\,.
\end{array}\right.
\end{align}

We note however that not all integer/half-integer fluxes $B_m$ are allowed in the blowup equations; the blowup equations only with the consistent magnetic fluxes can be solved to produce the correct BPS spectrum, as discussed in the previous subsection. If one uses other sets of magnetic fluxes, then the solution to the blowup equation will contain some BPS states with negative volumes ${\rm vol}(C)<0$ on the Coulomb branch, which is surely inconsistent. So we first need to identify the consistent magnetic fluxes $B_m$.

Let us try to solve the blowup equation with magnetic fluxes $n\in\mathbb{Z}$ and some $B_m$. The magnetic fluxes result in the shifts of parameters in the North and the South poles as $\phi \to \phi + n \,\epsilon_{1,2}$, $m \to m + B_m\,\epsilon_{1,2}$. The GV-invariant (or the Witten index) can be decomposed into two parts, the perturbative and the instanton parts, as
\begin{align}
	Z_{GV}(\phi,m;\epsilon_1,\epsilon_2) &= \mathcal{Z}_{\rm pert}(\phi;\epsilon_1,\epsilon_2)\cdot \mathcal{Z}_{\rm inst}(\phi,m;\epsilon_1,\epsilon_2) \ , \nonumber \\
	\mathcal{Z}_{\rm pert}(\phi;\epsilon_1,\epsilon_2) & ={\rm PE}\left[-\frac{1+p_1p_2}{(1-p_1)(1-p_2)}e^{-2\phi}\right] \ , \nonumber \\
	\mathcal{Z}_{\rm inst}(\phi,m;\epsilon_1,\epsilon_2) &= \sum_{k=0}^\infty q^k Z_k(\phi; \epsilon_1, \epsilon_2) \ ,
\end{align}
with the instanton fugacity $q\equiv e^{-m}$ and $Z_0=1$. The perturbative part comes from the W-boson (or the M2-brane state on $f$) on the Coulomb branch. Plugging the GV-invariant into \eqref{eq:bleq-GV}, one finds a unity blowup equation that can be expanded in terms of the instanton fugacity as
\begin{align}
\sum_{k,k'=0}^\infty q^{k+k'}\Lambda_{k'} \hat{Z}_k(\phi; \epsilon_1, \epsilon_2)=& \
\sum_{n \in \mathbb{Z}}  \sum_{k_1, k_2=0}^\infty (-1)^n e^{-V}\frac{\hat{\mathcal{Z}}_{\text{pert}}^{(N)}\hat{\mathcal{Z}}_{\text{pert}}^{(S)}}{\hat{\mathcal{Z}}_{\text{pert}}} (q \,p_1^{B_m})^{k_1} (q\, p_2^{B_m})^{k_2}  \\
&\  \times \hat{Z}_{k_1}^{(N)}(\phi + n\epsilon_1 ; \epsilon_1, \epsilon_2 - \epsilon_1) \cdot \hat{Z}^{(S)}_{k_2}(\phi + n\epsilon_2; \epsilon_1 - \epsilon_2, \epsilon_2)\,, \nonumber
\end{align}
with $V$ defined in \eqref{eq:GV-V}, where $\Lambda_0=1$ which is fixed by the zeroth order equation in the expansion. Here, the hatted functions are defined with the shift in the parameter $\epsilon_1$ as
\begin{equation} 
	\hat{f}(\phi,m;\epsilon_1,\epsilon_2)\equiv f(\phi,m;\epsilon_1+2\pi i,\epsilon_2) \ .
\end{equation}

One can extract the $k$-th order of the instanton expansion of this equation, which can be schematically written as
\begin{align}
\Lambda_k(\epsilon_1,\epsilon_2) + \hat{Z}_k(\phi; \epsilon_1, \epsilon_2)
=& ~p_1^{kB_m}\, \hat{Z}_k(\phi; \epsilon_1, \epsilon_2 - \epsilon_1) + p_2^{kB_m}\, \hat{Z}_k(\phi; \epsilon_1 - \epsilon_2, \epsilon_2) \cr
&+ (\text{terms with } \hat{Z}_{r<k} \ \text{and } \Lambda_{r<k})\ .
\end{align}
Here the $k$-instanton partition function $\hat{Z}_k$ at the $k$-th order in the expansion is independent of the background magnetic flux $B_m$ and appears only with a trivial gauge flux $n=0$.
All $\phi$ independent terms in the second line (first by expanding it in $e^{-\phi}$) will be absorbed into $\Lambda_k$. This equation can be solved once we know the solutions $Z_{r}$ at the lower orders $r<k$. In particular, since $\hat{Z}_k$ is independent of $B_m$, when there exist 3 (or more) distinct consistent fluxes $B_m$, we can exactly solve three linearly independent equations for 3 unknown functions, $\hat{Z}_k,\hat{Z}_k^{(N)},$ and $\hat{Z}^{(S)}_k$, and hence find a closed expression for the $k$-instanton partition function $\hat{Z}_k$ at each $k$.

The first order of the blowup equation can be written explicitly as
\begin{align}\label{eq:1-inst-su2}
	\Lambda_1+\hat{Z}_1 =& \  p_1^{B_m}\hat{Z}_1^{(N)}+p_2^{B_m}\hat{Z}_1^{(S)} - \frac{(p_1p_2)^{B_m+1}e^{-2(2+B_m)\phi_1}}{(1-e^{-2\phi})(1-p_1e^{-2\phi})(1-p_2e^{-2\phi})(1-p_1p_2e^{-2\phi})} \nonumber \\
	&- \frac{(p_1p_2)^{B_m-1}e^{-2(2-B_m)\phi_1}}{(1-e^{-2\phi_1})(1-p_1^{-1}e^{-2\phi_1})(1-p_2^{-1}e^{-2\phi_1})(1-(p_1p_2)^{-1}e^{-2\phi_1})} \ .
\end{align}
The last two terms on the right-hand side come from the perturbative parts with the gauge fluxes $n=1$ and $n=-1$ respectively. One can then easily see that if $B_m>2$ or $B_m<-2$, then the last two terms will start with a negative power of $e^{-\phi}$ in the expansion. This means that the solution $\hat{Z}_1$ to the above equation will involve a BPS state of mass $|M|=m+ a \phi$ with a negative coefficient $a$. This is problematic because this state violates the unitarity condition on its mass, i.e. $a\phi\ge0$, on the Coulomb branch parametrized by $\phi>0$ in the UV limit where $m\rightarrow0$. In addition, one can check that this state is not a hypermultiplet and thus there is no associated flop transition. Thus the solution is inconsistent due to the states with  negative masses (or volumes) in the UV limit. This tells us that solving the blowup equations with flux $|B_m|>2$ cannot give the correct BPS partition function for the pure $SU(2)_\theta$ gauge theory.

On the other hand, if $-2\le B_m\le 2$, then the solution will not contain any states with ${\sf{e}}\cdot\phi<0$. Therefore we conclude that the consistent magnetic fluxes for the $SU(2)_0$ and $SU(2)_\pi$ theories are
\begin{align}
\left\{
\begin{array}{ll}
\mathbb{F}_0:~~SU(2)_0 & \quad n\in\mathbb{Z} \ , \ \ B_m = -2,\ -1,\ 0,\ 1, 2 \\
\mathbb{F}_1:~~SU(2)_\pi & \quad n\in\mathbb{Z} \ , \ \  B_m =-\frac{3}{2},\ -\frac{1}{2},\ \frac{1}{2},\ \frac{3}{2}\ .
\end{array}\right. \label{eq:su2 three choices of B}
\end{align}

Since we have more than three sets of consistent fluxes $(n,B_m)$ for both cases, we can compute  a closed expression of the partition function at each instanton order. For example, the 1-instanton partition functions are given as follows:
\begin{align}
Z_1^{SU(2)_0}(\phi; \epsilon_1, \epsilon_2)
&= \frac{p_1 p_2 (1+p_1 p_2)e^{-2\phi}}{(1-p_1)(1-p_2)(1-p_1 p_2 e^{-2\phi})(e^{-2\phi}-p_1p_2)}\ , \label{eq:SU2_0Z-1instanton}\\
Z_1^{SU(2)_\pi}(\phi; \epsilon_1, \epsilon_2)
&= -\frac{p_1^{3/2} p_2^{3/2}(1+e^{-2\phi})e^{-\phi}}{ (1-p_1)(1-p_2) (1-p_1 p_2 e^{-2\phi})(e^{-2\phi}-p_1 p_2)}\ . \label{eq:SU2_piZ-1instanton}
\end{align}
By repeating this procedure for the blowup equations to higher orders in $q$, it is straightforward to obtain the $k$-instanton partition functions $Z_k$. 

We note that though there are many theories which possess three different sets of consistent magnetic fluxes, many of which are discussed in \cite{Kim:2019uqw}, a much larger class of theories do not allow such three distinct sets. However, as discussed in the previous subsection and also in \cite{Huang:2017mis,Gu:2019pqj}, a single unity blowup equation with the consistent magnetic fluxes $(\vec{n},\vec{B})$ is enough to compute the BPS partition function. We will now illustrate this by computing the BPS spectra of the pure $SU(2)_\theta$ theories, using only a single background flux $B_m$ giving a unity blowup equation.

\paragraph{Solving a unity blowup equation}

Let us start with the following ansatz for the GV-invariant.
\begin{align}
	Z_{GV}(\phi,m;\epsilon_{1,2})&={\rm PE}\left[\sum_{j_l,j_r}\sum_{d_1,d_2=0}^\infty(-1)^{2(j_l+j_r)}N_{j_l,j_r}^{(d_1,d_2)} A_{j_l,j_r}(\epsilon_1,\epsilon_2) e^{-d_1{\rm vol}(e)-d_2{\rm vol}(f)}\right] \nonumber \\
	A_{j_l,j_r}(\epsilon_1,\epsilon_2) &\equiv\frac{\chi_{j_l}^{SU(2)}(p_1/p_2)\chi_{j_r}^{SU(2)}(p_1p_2)}{(p_1^{1/2}-p_1^{-1/2})(p_2^{1/2}-p_2^{-1/2})} \ .
\end{align}
Here ${\bf d}=(d_1,d_2)$ denotes the degrees $d_1$ and $d_2$ of 2-cycles $e$ and $f$ respectively. The BPS states with $d_1=0$ at 0-instanton sector are all captured by the perturbative spectrum of the $SU(2)$ theory. The perturbative spectrum then fixes $N_{0,\frac12}^{(0,1)}=1$ and $N_{j_l,j_r}^{(0,d_2)}=0$ for $d_2>1$.

We shall now put the ansatz to the blowup equation and solve it order by order in $d_1$ expansion. Let us first consider the $SU(2)_0$ theory with the background flux $B_m=0$. The equation at $d_1=1$ order is given in \eqref{eq:1-inst-su2}. To solve this equation, we further expand the equation in $d_2$ as
\begin{align}
	\Lambda_1 = &~\hat{Z}^{(N)}_1 + \hat{Z}^{(S)}_1 -\hat{Z}_1 -\big(p_1p_2+(p_1p_2)^{-1}\big)e^{-4\phi}\cr
	&-\frac{(1+p_1)(1+p_2)(1+p_1^3p_2^3)}{p_1^2p_2^2}e^{-6\phi}+\mathcal{O}(e^{-8\phi}) \ .
\end{align}
This equation can be easily solved order by order in $d_2$ or in the powers of $e^{-\phi}$. 

It turns out that this equation uniquely determines all the degeneracies $N_{j_l,j_r}^{(1,d_2)}$, except for the degeneracies $N_{0,\frac12}^{(1,d_2)}$ for all $d_2\ge0$. The result is listed in Table~\ref{table:SU2_0_1inst}. 
\begin{table}[H]
	\centering
	\begin{tabular}{|c|C{25ex}||c|C{25ex}|} \hline
		$\mathbf{d}$ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ & $\mathbf{d}$ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ \\ \hline
	 	$ (1, 0) $ & $ N_{0, \frac{1}{2}}^{(1, 0)}(0, \frac{1}{2}) $ & $ (1, 1) $ & $ N_{0, \frac{1}{2}}^{(1, 1)}(0, \frac{1}{2}) \oplus (0, \frac{3}{2}) $ \\ \hline
		$ (1, 2) $ & $ N_{0, \frac{1}{2}}^{(1, 2)}(0, \frac{1}{2}) \oplus (0, \frac{5}{2}) $ & $ (1, 3) $ & $ N_{0, \frac{1}{2}}^{(1, 3)}(0, \frac{1}{2}) \oplus (0, \frac{7}{2}) $ \\ \hline
	\end{tabular}
	\caption{The result of solving the $ SU(2)_0 $ blowup equation at $d_1=1$ order for the background flux $ B_m = 0 $.} \label{table:SU2_0_1inst}
\end{table}
The degeneracies $N_{0,\frac12}^{(1,d_2)}$ are not determined in the 1st order computation because they vanish in the combination $\hat{Z}^{(N)}_1 + \hat{Z}^{(S)}_1 -\hat{Z}_1$ and thus do not appear in the above equation. These undetermined degeneracies at $d_1=1$ order are all fixed by solving the blowup equation in the next order or higher orders: $N_{0,\frac12}^{(1,0)}=1$ and $N_{0,\frac12}^{(1,d_2)}=0$ for $d_2>0$.

We can solve the blowup equation iteratively and compute the degeneracies of higher degree curves.  
The resulting BPS spectra for $ d_1 \leq 2 $, $ d_2 \leq 3 $ are summarized in  Table~\ref{table:SU2_0}. One can readily see that this result agrees with the above result obtained by solving three blowup equations in \eqref{eq:SU2_0Z-1instanton}.
\begin{table}[H]
	\centering
	\begin{tabular}{|c|C{25ex}||c|C{25ex}|} \hline
		$\mathbf{d}$ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ & $\mathbf{d}$ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ \\ \hline
		$ (1, 0) $ & $ (0, \frac{1}{2}) $ & $ (1, 1) $ & $ (0, \frac{3}{2}) $ \\ \hline
		$ (1, 2) $ & $ (0, \frac{5}{2}) $ & $ (1, 3) $ & $ (0, \frac{7}{2}) $ \\ \hline
		$ (2, 1) $ & $ (0, \frac{5}{2}) $ & $ (2, 2) $ & $ (0, \frac{5}{2}) \oplus (0, \frac{7}{2}) \oplus (\frac{1}{2}, 4) $ \\ \hline
		$ (2, 3) $ & \multicolumn{3}{c|}{$ (0, \frac{5}{2}) \oplus (0, \frac{7}{2}) \oplus 2(0, \frac{9}{2}) \oplus (\frac{1}{2}, 4) \oplus (\frac{1}{2}, 5) \oplus (1, \frac{11}{2}) $} \\ \hline
	\end{tabular}
	\caption{BPS spectrum of the $ SU(2)_0 $ theory for $ d_1 \leq 2 $, $ d_2 \leq 3 $, where $ \mathbf{d} = (d_1, d_2) $ labels the states from an M2-brane wrapping $ d_1 e + d_2 f $ curve in $ \mathbb{F}_0 $.} \label{table:SU2_0}
\end{table}
\noindent 
Next, consider the $ SU(2)_\pi $ theory with a background magnetic flux $B_m = \frac{1}{2}$. The computation is basically the same as the previous case with $\theta=0$. The blowup equation at $d_1=1$ order is expanded as
\begin{align}
	\Lambda_1 = &~ p_1^{1/2}\hat{Z}^{(N)}_1 + p_2^{1/2}\hat{Z}^{(S)}_1 -\hat{Z}_1 -(p_1p_2)^{1/2}e^{-3\phi}\cr
	&-\frac{1+(1+p_1)(1+p_2)p_1^2p_2^2}{(p_1p_2)^{3/2}}e^{-5\phi}+\mathcal{O}(e^{-7\phi}) \ .
\end{align}
All the degeneracies $N_{j_l,j_r}^{(1,d_2)}$ are uniquely determined by solving this equation, except for the degeneracies $N_{0,0}^{(1,d_2)}$ for all $d_2\ge0$. The undetermined degeneracies $N_{0,0}^{(1,d_2)}$ are also fixed uniquely by solving the equations in higher orders. We list the result for $d_1\le2,d_2\le3$ in Table~\ref{table:SU2_pi}. Like the $SU(2)_0$ case, this result agrees with the expansion of \eqref{eq:SU2_piZ-1instanton}.

\begin{table}[H]
	\centering
	\begin{tabular}{|c|C{25ex}||c|C{25ex}|} \hline
		$\mathbf{d}$ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ & $\mathbf{d}$ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ \\ \hline
		$ (1, 0) $ & $ (0, 0) $ & $ (1, 1) $ & $ (0, 1) $ \\ \hline
		$ (1, 2) $ & $ (0, 2) $ & $ (1, 3) $ & $ (0, 3) $ \\ \hline
		$ (2, 2) $ & $ (0, \frac{5}{2}) $ & $ (2, 3) $ & $ (0, \frac{5}{2}) \oplus (0, \frac{7}{2}) \oplus (\frac{1}{2}, 4) $ \\ \hline
	\end{tabular}
	\caption{ BPS spectrum of the $ SU(2)_\pi $  theory for $ d_1 \leq 2 $, $ d_2 \leq 3 $, where $ \mathbf{d} = (d_1, d_2) $ labels the states from an M2-brane wrapping $ d_1 e + d_2 f $ curve in $ \mathbb{F}_1 $.} \label{table:SU2_pi}
\end{table}

\paragraph{Solving a vanishing blowup equation}
In the $ SU(2) $ gauge theories, it is possible to turn on non-canonically quantized magnetic flux as $ n \in \mathbb{Z}+1/2 $ because the W-boson carries charge +2 for the gauge symmetry. Then we can choose $ B_m \in \mathbb{Z} $ which is a consistent quantization for the instanton state corresponding to the curves $ e $  in both $ \mathbb{F}_0 $ and $ \mathbb{F}_1 $. So the magnetic fluxes
\begin{align}\label{eq:su2_vanishing_flux}
n \in \mathbb{Z} + 1/2 \ , \quad
B_m = 0 \ ,
\end{align}
satisfy the quantization conditions for both $ \theta = 0 $ and $ \pi $. These fluxes with the effective prepotential for the $SU(2)$ theories lead to a vanishing blowup equation. We will now show that this vanishing blowup equation alone can be solved with additional geometric data. In fact, we find two independent solutions to the blowup equation and they correspond to respectively the BPS spectrum of the $SU(2)_0$ theory and that of the $SU(2)_\pi$ theory.

Solving the vanishing blowup equation is much harder than solving unity equations because of huge cancellations in the expansion and also non-uniqueness of solutions. Let us start with an ansatz for the GV-invariant as
\begin{align}
Z_{\mathrm{GV}} = \PE\qty[ \,\sum_{j_l, j_r} \sum_{d_1, d_2 = 0}^\infty (-1)^{2(j_l + j_r)} N_{j_l, j_r}^{(d_1, d_2)} A_{j_l, j_r}(\epsilon_1, \epsilon_2) e^{-(d_1 m + d_2 \phi)} ] \, .
\end{align}
As discussed in \cite{Gu:2017ccq}, the spins of a degree $(d_1,d_2)$ state are bounded as
\begin{align}
j_l &\leq \frac{C^2\! +\! K_S \cdot C}{2} \!+\! 1 = \frac{d_1 d_2 \!-\! 2d_1^2 \!-\! d_2\!+\!2}{2} \, , \cr
 j_r &\leq \frac{C^2 \!-\! K_S \cdot C}{2} = \frac{d_1 d_2 \!-\! 2d_1^2 \!+\! d_2}{2}\, ,
\end{align}
where $ C $ is a curve with volume $ d_1 m + d_2 \phi $ and $ K_S $ is the canonical class in $ \mathbb{F}_0 $ or $ \mathbb{F}_1 $.

The zeroth-order in the expansion of the blowup equation is
\begin{align}
\sum_{n \in \{ \pm 1/2 \}} (-1)^n e^{-V} \frac{\hat{\mathcal{Z}}_{\mathrm{pert}}^{(N)} \hat{\mathcal{Z}}_{\mathrm{pert}}^{(S)}}{\hat{\mathcal{Z}}_{\mathrm{pert}}} = 0 \, ,
\end{align}
which is automatically satisfied by the perturbative spectrum $ N_{0, 1/2}^{(0, 2)} = 1 $. The 1st order blowup equation with $d_1=1$ is then given by
\begin{align}
\sum_{n \in \{ \pm 1/2 \}} (-1)^n e^{-V} \frac{\hat{\mathcal{Z}}_{\mathrm{pert}}^{(N)} \hat{\mathcal{Z}}_{\mathrm{pert}}^{(S)}}{\hat{\mathcal{Z}}_{\mathrm{pert}}} \qty(\hat{Z}_1^{(N)} + \hat{Z}_1^{(S)}) = 0 \, .
\end{align}
This equation for each $ d_2 $ can be rephrased in terms of the multiplicities $ N_{j_l,j_r}^{(1, d_2)} $ as
\begin{align}\label{eq:su2_vanishing_1st}
& \sum_{j_l, j_r} (-1)^{2(j_l + j_r)} N_{j_l, j_r}^{(1, d_2)} \qty( A_{j_l, j_r}(\epsilon_1, \epsilon_2/\epsilon_1) p_1^{-d_2/2} + A_{j_l, j_r}(\epsilon_1/\epsilon_2, \epsilon_2) p_2^{-d_2/2} -  A_{j_l, j_r}(\epsilon_1, \epsilon_2)) \nonumber \\
& = \sum_{j_l, j_r} (-1)^{2(j_l + j_r)} N_{j_l, j_r}^{(1, d_2)} \qty( A_{j_l, j_r}(\epsilon_1, \epsilon_2/\epsilon_1) p_1^{d_2/2} + A_{j_l, j_r}(\epsilon_1/\epsilon_2, \epsilon_2) p_2^{d_2/2} -  A_{j_l, j_r}(\epsilon_1, \epsilon_2)) \, .
\end{align}
It turns out that this equation is not enough to fix the multiplicities $ N_{j_l, j_r}^{(1, d_2)} $, and in fact it has infinitely many solutions. For example, if $ N_{j_l,j_r}^{(1, d_2)}=c^{(d_2)} $ with an integer number $c^{(d_2)}$ is a solution, then $ N_{j_l,j_r}^{(1, d_2)} =2c^{(d_2)}$ is also another solution. 
We thus need to solve higher order equations to determine them.

The 2nd order of the blowup equation can be written as
\begin{align}
\sum_{n \in \{ \pm 1/2 \}} (-1)^n e^{-V} \frac{\hat{\mathcal{Z}}_{\mathrm{pert}}^{(N)} \hat{\mathcal{Z}}_{\mathrm{pert}}^{(S)}}{\hat{\mathcal{Z}}_{\mathrm{pert}}} & \qty( \hat{Z}_2^{(N)} +  \hat{Z}_2^{(S)} +  \hat{Z}_1^{(N)} \hat{Z}_1^{(S)} ) \nonumber \\
& + \sum_{n \in \{\pm 3/2\}} (-1)^n e^{-V} \frac{\hat{\mathcal{Z}}_{\mathrm{pert}}^{(N)} \hat{\mathcal{Z}}_{\mathrm{pert}}^{(S)}}{\hat{\mathcal{Z}}_{\mathrm{pert}}}
= 0 \ .
\end{align}
Unfortunately, this equation does not help us to fix the degeneracies $ N_{j_l, j_r}^{(1, d_2)} $ because they do not appear in this order. We need the blowup equation at higher orders to fully fix $ N_{j_l, j_r}^{(1, d_2)}$. We find that at the order of the blowup equation involving $ N_{j_l, j_r}^{(4, 10)} $, the degeneracy $ N_{j_l, j_r}^{(1, 1)} $ is first fixed to be
\begin{align}
N_{j_l, j_r}^{(1, 1)} =0\ ,\quad\text{except for} ~~
N_{0, 0}^{(1, 1)} = \Bigg\{
\begin{array}{ll}
1 & \quad \text{when~} \theta=\pi \\
0 & \quad \text{when~}\theta=0
\end{array} \ .
\end{align}
Here we fixed the discrete theta angles from the geometric information: $ N_{j_l, j_r}^{(1, 1)} = 0 $ for the $ SU(2)_0 $ theory, while $ N_{0, 0}^{(1, 1)} =1 $ for the $ SU(2)_\pi $ theory. 

Now consider the $ SU(2)_0 $ theory. Solving the blowup equation at the order having terms of $ N_{j_l, j_r}^{(4, 12)} $ again gives two sets of solutions: one with $ N_{j_l, j_r}^{(1, 2)} = 0 $ for all $ (j_l, j_r) $ and the other with $ N_{j_l, j_r}^{(1, 2)} = 0 $ but $ N_{0, \frac{1}{2}}^{(1, 2)} = 1 $. However, the geometric realization suggests that there exists a BPS state with charge $ m + 2\phi $, so only the second solution is acceptable. The next order blowup equation which contains $ N_{j_l, j_r}^{(4, 13)} $ gives $ N_{j_l, j_r}^{(1, 3)} = 0 $ for all $ (j_l, j_r) $. Now to fix $ N_{j_l, j_r}^{(1, 4)} $, instead of calculating higher order equations, one can use other consistency conditions. First, we know from geometry that there are effective curves with volume $ m + 4\phi $. In addition, the blowup equation yields that $ N_{j_l, j_r}^{(1, 4)} = 0 $ for $ (j_l, j_r) \neq (0, \frac{3}{2}) $ and  $N_{1,\frac{15}{2}}^{(3,12)} = 1 - N_{0,\frac{3}{2}}^{(1, 4)} $. Notably, $ N_{1,\frac{15}{2}}^{(3,12)} $ must be a non-negative integer and $ N_{0,\frac{3}{2}}^{(1, 4)} \neq 0 $ from geometry. Therefore the only possible solution is $ N_{0,\frac{3}{2}}^{(1, 4)} = 1 $. This result reproduces all the BPS states of the $SU(2)_0$ theory up to $(d_1,d_2)=(1,4)$. In this way, a vanishing blowup equation together with other consistency conditions can determine the BPS spectrum in this theory. We expect other higher degree states can also be captured by solving higher order blowup equations in this manner. 

Next, consider the $ SU(2)_\pi $ theory. The blowup equation at the order containing $ N_{j_l, j_r}^{(4, 11)} $ fixes $ N_{j_l, j_r}^{(1, 2)} = 0 $ for all $ (j_l, j_r) $. The higher order equations containing $ N_{j_l, j_r}^{(4, 14)} $ has two sets of solutions: one with $ N_{j_l, j_r}^{(1, 3)} = 0 $ for all $ (j_l, j_r) $, and the other one with $ N_{j_l, j_r}^{(1, 3)} = 0 $ but $ N_{0, 1}^{(1, 3)} = 1 $. Also, the geometry of $\mathbb{F}_1$ says that there is a state with charge $ m + 3\phi $, so only the second one is acceptable. The next order equation containing $ N_{j_l, j_r}^{(4, 15)} $ fixes $ N_{j_l, j_r}^{(1, 4)} = 0 $. It is also possible to fix $ N_{j_l, j_r}^{(1, 4)} $ by consistency conditions instead of calculating higher order equations. The blowup equation fixes $ N_{j_l, j_r}^{(1, 4)} = 0 $  for $ (j_l, j_r) \neq (0, \frac{3}{2}) $, and $N_{1,\frac{15}{2}}^{(3,12)} = - N_{0,\frac{3}{2}}^{(1, 4)}$, from which the only possible solution is $ N_{0,\frac{3}{2}}^{(1, 4)} = 0 $. This result agrees with the spectrum of the $ SU(2)_\pi $ theory that we computed above using unity bloup equations. 

These computations show that, although the BPS spectrum is not completely determined only by solving vanishing blowup equations, we may be able to uniquely determine the BPS degeneracies by requiring the solution of the vanishing blowup equations to be physically or geometrically consistent.


\subsubsection{\texorpdfstring{5d pure $SU(3)_{\kappa \leq 7}$}{5d pure SU(3)k}}\label{sec:su3_k}

Let us now discuss rank-2 theories. A non-trivial example is the pure $SU(3)$ gauge theory at the Chern-Simons level $ \kappa $. When $ \kappa $ is even, it is geometrically engineered as
\begin{align}\label{eq:su3_even_geo}
\begin{tikzpicture}
\draw[thick](-3,0)--(0,0);	
\node at(-3.6,0) {$\mathbb{F}_{\kappa+1}{}\big|_1$};
\node at(-2.8,0.3) {${}_e$};
\node at(0.5,0) {$\mathbb{F}_{1}{}\big|_2$\ .};
\node at(-0.8,0.3) {${}_{h+(\frac{\kappa}{2}-1)f}$};
\end{tikzpicture}
\end{align}
Whereas, if $\kappa$ is odd, it is engineered by
\begin{align}\label{eq:su3_odd_geo}
\begin{tikzpicture}
\draw[thick](-3,0)--(0,0);	
\node at(-3.6,0) {$\mathbb{F}_{\kappa+1}{}\big|_1$};
\node at(-2.8,0.3) {${}_e$};
\node at(0.5,0) {$\mathbb{F}_{0}{}\big|_2$\ .};
\node at(-0.8,0.3) {${}_{h+\frac{\kappa-1}{2}f}$};
\end{tikzpicture}
\end{align}
Each geometry contains three primitive curves: the fiber $f_1$ in $\mathbb{F}_{n_1}|_1$, the fiber $f_2$ and the base $e_2$ in $\mathbb{F}_{n_2}|_2$.
The volumes of the primitive 2-cycles are
\begin{align}
&\vol(f_1) = 2\phi_1 - \phi_2, \quad
\vol(f_2) = -\phi_1 + 2\phi_2, \nonumber\\
&\vol(e_2) = \left\{ \begin{array}{ll} \left(1-\tfrac{\kappa}{2}\right)\phi_1+\phi_2 + m& \ \ {\rm for \ even}\ \kappa \\
	\frac{1-\kappa}{2}\phi_1+2\phi_2 + m & \ \ {\rm for \ odd}\ \kappa 
	\end{array}\right. \ .
\end{align}
These theories with CS level $|\kappa|\le9$ have UV completions \cite{Jefferson:2018irk,Bhardwaj:2019jtr}. The 5-brane webs for $|\kappa|\le 7$ and $|\kappa|=9$ have been constructed in \cite{Hayashi:2018lyv}. 

Surprisingly the BPS spectra of the  $SU(3)_\kappa$ theories for all $|\kappa|\le 9$ can be computed by employing our bootstrapping approach explained above. The $SU(3)_8$ theory is of particular interest. Unlike other $\kappa$, this theory at $\kappa=8$ has no consistent geometric realization \cite{Jefferson:2018irk,Bhardwaj:2019jtr,Bhardwaj:2020gyu} and also its 5-brane web is unknown yet. Moreover the usual ADHM construction for instantons in this theory does not work. So it was a quite challenging task to compute its BPS partition function. The $SU(3)_8$ theory and its blowup equations will be discussed separately in subsection~\ref{sec:SU3_8}. The $SU(3)_9$ theory, which is a KK theory, will be discussed in subsection~\ref{subsubsec:SU3/Z2}.

In this subsection, we will illustrate how to bootstrap the BPS spectra of  $|\kappa| \le 7$ theories and their dual theories using the blowup equations as well as their geometric descriptions.

Consider the $SU(3)_\kappa$ theory put on the blowup $\hat{\mathbb{C}}_2$. We turn on the magnetic flux $\textsf{F}=(n_1,n_2,B_m)$ for two Hirzebruch surfaces and a non-compact divisor of the non-normalizable K\"ahler parameter $m$. The quantization conditions for the fluxes are given by their intersections with the primitive 2-cycles as
\begin{align}
	&\textsf{F}\cdot f_1 = 2n_1-n_2\ \in \ \mathbb{Z} \ , \qquad \textsf{F}\cdot f_2 = 2n_2-n_1 \ \in \ \mathbb{Z} \nonumber \ ,\\
	&  \textsf{F}\cdot e_2 = \left\{ \begin{array}{ll} \left(1-\tfrac{\kappa}{2}\right)n_1+n_2 + B_m \ \in \ \mathbb{Z}+\frac{1}{2} & \ \ {\rm for \ even}\ \kappa \\
	\frac{1-\kappa}{2}n_1+2n_2 + B_m \ \in \ \mathbb{Z} & \ \ {\rm for \ odd}\ \kappa 
	\end{array}\right. \ ,
\end{align}
which follow from the geometric quantization condition \eqref{eq:quantization} together with the self-intersections of the curves, $f_1^2 = f_2 ^2 = 0$ and $e_2^2 = -1$ for even $\kappa$ and $e_2^2=0$ for odd $\kappa$. Each theory has 3 or more sets of magnetic fluxes satisfying the quantization conditions. We can use, for example, the following fluxes for solving the blowup equations:
\begin{equation}\label{eq:su3_r}
	n_1,n_2 \in \mathbb{Z} \quad {\rm and} \quad B_m = \left\{
\begin{array}{ll}
-\frac{1}{2}, \frac{1}{2}, \frac{3}{2} & \quad \kappa = 0, 2, 4, 6 \\
-1, 0, 1 & \quad \kappa = 1, 3, 5, 7\ .
\end{array}\right.
\end{equation}

Let us now consider the Coulomb branch of the theory where $2\phi_1-\phi_2 \ge0$ and $2\phi_2-\phi_1\ge0$ with $\phi_1,\phi_2>0$. The effective prepotential $\mathcal{E}$ on the Coulomb branch takes the following form
\begin{align}\label{eq:SU3_k_prepotential}
\mathcal{E} &= \frac{1}{\epsilon_1 \epsilon_2} 
\left( \mathcal{F} - \frac{\epsilon_1^2  + \epsilon_2^2}{12}(\phi_1 + \phi_2) +\epsilon_+^2 (\phi_1 + \phi_2) \right), \\ 
6\,\mathcal{F} &= 6 m(\phi_1^2 - \phi_1 \phi_2 + \phi_2^2)+ 3\kappa \phi_1 \phi_2(\phi_1 - \phi_2) + 8 \phi_1^3 - 3\phi_1^2 \phi_2 - 3\phi_1 \phi_2^2 + 8\phi_2^3\, ,\nonumber
\end{align}
where $m$ is the gauge coupling. The GV-invariant of this theory can be factorized as
\begin{align}
Z_{GV}(\phi_i, m; \epsilon_1, \epsilon_2) &= \mathcal{Z}_{\mathrm{pert}}(\phi_i; \epsilon_1, \epsilon_2) \cdot \mathcal{Z}_{\mathrm{inst}}(\phi_i, m; \epsilon_1, \epsilon_2) \ , \nonumber  \\
\mathcal{Z}_{\mathrm{pert}}(\phi_i; \epsilon_1, \epsilon_2) &= \PE \qty[-\frac{1+p_1 p_2}{(1-p_1)(1-p_2)} \qty(e^{-(2\phi_1 - \phi_2)} + e^{-(2\phi_2-\phi_1)} + e^{-(\phi_1 + \phi_2)})] \ , \nonumber \\
\mathcal{Z}_{\mathrm{inst}}(\phi_i, m; \epsilon_1, \epsilon_2) &= \sum_{k=0}^{\infty} q^k Z_k(\phi; \epsilon_1, \epsilon_2) \ ,
\label{eq:SU3_k_GV}
\end{align}
with the instanton fugacity $ q = e^{-m} $ and $ Z_0 = 1 $. 

We can then write the blowup equation for the $SU(3)_\kappa$ theory as
\begin{align}
\sum_{k, k'=0}^{\infty} q^{k+k'} \Lambda_{k'} \hat{Z}_k &= \sum_{\vec{n}\in \mathbb{Z}^2}\sum_{k_1,k_2=0}^\infty (-1)^{\abs{\vec{n}}} e^{-V} \frac{\mathcal{Z}_{\mathrm{pert}}^{(N)} \mathcal{Z}_{\mathrm{pert}}^{(S)}}{\mathcal{Z}_{\mathrm{pert}}} (q \,p_1^{B_m})^{k_1} \hat{Z}^{(N)}_{k_1} \cdot (q \,p_2^{B_m})^{k_2} \hat{Z}^{(S)}_{k_2} \ .
\end{align}
Again, the blowup equation at the $ k $-th order can be written as
\begin{align}\label{eq:su3_k_kinst}
\Lambda_k(m; \epsilon_1, \epsilon_2) + \hat{Z}_k(\phi_i, \epsilon_1, \epsilon_2)
=&~ p_1^{kB_m} \hat{Z}_k(\phi_i, \epsilon_1, \epsilon_2 - \epsilon_1) + p_2^{kB_m}\hat{Z}_k(\phi_i, \epsilon_1 - \epsilon_2, \epsilon_2) \nonumber \\
& + (\text{terms with } Z_{r<k} \text{ and } \Lambda_{r<k})\ .
\end{align}
The $ \Lambda_0 $ factor is then fixed to be 1 from the zeroth order expansion. In $ q^1 $ order, the blowup equation is given by
\begin{align}\label{eq:su3_k_1inst}
\Lambda_1 + \hat{Z}_1(\phi_i, \epsilon_1, \epsilon_2)
= ~& p_1^{B_m} \hat{Z}_1(\phi_i, \epsilon_1, \epsilon_2 - \epsilon_1) + p_2^{B_m} \hat{Z}_1(\phi_i, \epsilon_1 - \epsilon_2, \epsilon_2) \nonumber \\
& +  \sum_{\vec{n} \in S_1} q^{-1} e^{-V} \frac{\mathcal{Z}_{\mathrm{pert}}^{(N)} \mathcal{Z}_{\mathrm{pert}}^{(S)}}{\mathcal{Z}_{\mathrm{pert}}} \ ,
\end{align}
where the last term comes from the contribution with $k_1=k_2=0$ and $n_1^2 - n_1 n_2 +n_2^2 =1$ which is solved for $(n_1,n_2)\in S_1 = \{\pm(1, 1), \pm(1, 0), \pm(0, 1) \}$.

The three choices of $ B_m $ given in \eqref{eq:su3_r} provide three linearly independent  algebraic equations for $\hat{Z}_k(\phi_i, \epsilon_1, \epsilon_2)$ at each $k$-th order.
They allow us to find a closed form of $\hat{Z}_k(\phi_i, \epsilon_1, \epsilon_2)$. Thus, the $k$-instanton partition function $Z_k(\phi_i, \epsilon_1, \epsilon_2)$ for the $SU(3)_\kappa$ theory at $|\kappa|\le 7$ can be computed by recursively solving three blowup equations with $B_m$'s in  \eqref{eq:su3_r}. In \cite{Kim:2019uqw}, the partition functions for $|\kappa|\le 3$ were computed in this manner and checked against the results from the ADHM calculations.

The instanton partition function for the $SU(3)_4$ theory can be computed by solving the blowup equations similarly to the $ \abs{\kappa} \leq 3 $ cases. Using the effective prepotential \eqref{eq:SU3_k_prepotential} and consistent magnetic fluxes \eqref{eq:su3_r}, we solve the blowup equations in terms of volumes of primitive 2-cycles
\begin{align}\label{eq:vol of 2-cycles for SU3_4}
\vol(f_1) = 2\phi_1 - \phi_2 \, , \quad
\vol(f_2) = -\phi_1 + 2\phi_2 \, , \quad
\vol(e_2) = -\phi_1 + \phi_2 + m \, .
\end{align}
Instead of giving an explicit form of the partition function, we list some BPS states in Table~\ref{table:SU(3)_4}.\footnote{As the BPS spectrum in Table~\ref{table:SU(3)_4} is expressed as the expansion of 2-cycles, one can reconstruct the partition function given in terms of dynamical variables, by substituting the 2-cycles with \eqref{eq:vol of 2-cycles for SU3_4}. Likewise, one can also rewrite the partition function given in terms of dynamical variables as the BPS spectrum, by first converting them into the 2-cycles and then expanding the 2-cycles.}
\begin{table}
	\centering
	\begin{tabular}{|c|C{28ex}||c|C{28ex}|} \hline
		$ \mathbf{d} $ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ & $ \mathbf{d} $ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ \\ \hline
		$ (1, 0, 0) $ & $ (0, 0) $ & $ (1, 0, 1) $ & $ (0, 1) $ \\ \hline
		$ (1, 0, 2) $ & $ (0, 2) $ & $ (1, 0, 3) $ & $ (0, 3) $ \\ \hline
		$ (1, 1, 0) $ & $ (0, 0) $ & $ (1, 1, 1) $ & $ (0, 0) \oplus (0, 1) $ \\ \hline
		$ (1, 1, 2) $ & $ (0, 1) \oplus (0, 2) $ & $ (1, 1, 3) $ & $ (0, 2) \oplus (0, 3) $ \\ \hline
		$ (1, 2, 1) $ & $ (0, 1) $ & $ (1, 2, 2) $ & $ (0, 0) \oplus (0, 1) \oplus (0, 2) $ \\ \hline
		$ (1, 2, 3) $ & $ (0,1) \oplus (0,2) \oplus (0,3) $ & $ (1, 3, 2) $ & $ (0, 1) \oplus (0, 2) $ \\ \hline
		$ (1, 3, 3) $ & $ (0,0) \oplus (0,1) \oplus (0,2) \oplus (0,3) $ & $ (2, 0, 2) $ & $ (0, \frac{5}{2}) $ \\ \hline
		$ (2, 0, 3) $ & $ (0,\frac{5}{2}) \oplus (0,\frac{7}{2}) \oplus (\frac{1}{2},4) $ & $ (2, 1, 2) $ & $ (0, \frac{3}{2}) \oplus (0, \frac{5}{2}) $ \\ \hline
		$ (2, 1, 3) $ & $ (0,\frac{3}{2}) \oplus 3(0,\frac{5}{2}) \oplus 2(0,\frac{7}{2}) \oplus (\frac{1}{2},3) \oplus (\frac{1}{2},4) $ & $ (2, 2, 2) $ & $ (0,\frac{1}{2}) \oplus (0,\frac{3}{2}) \oplus (0,\frac{5}{2}) $ \\ \hline
		$ (2, 2, 3) $ & $ (0,\frac{1}{2}) \oplus 3(0,\frac{3}{2}) \oplus 4(0,\frac{5}{2}) \oplus 2(0,\frac{7}{2}) \oplus (\frac{1}{2},2) \oplus (\frac{1}{2},3) \oplus (\frac{1}{2},4) $ & $ (2, 3, 2) $ & $ (0,\frac{1}{2}) \oplus (0,\frac{3}{2}) \oplus (0,\frac{5}{2}) $ \\ \hline
		$ (2, 3, 3) $ & $ 3(0,\frac{1}{2}) \oplus 4(0,\frac{3}{2}) \oplus 4(0,\frac{5}{2}) \oplus 2(0,\frac{7}{2}) \oplus (\frac{1}{2},1) \oplus (\frac{1}{2},2) \oplus (\frac{1}{2},3) \oplus (\frac{1}{2},4) $ & $ (3, 0, 3) $ & $ (0, 3) \oplus (\frac{1}{2}, \frac{9}{2}) $ \\ \hline
		$ (3, 1, 3) $ & $ (0,2) \oplus 2(0,3) \oplus (0,4) \oplus (\frac{1}{2},\frac{7}{2}) \oplus (\frac{1}{2},\frac{9}{2}) $ & $ (3, 2, 3) $ & $ (0,1) \oplus 2(0,2) \oplus 3(0,3) \oplus (0,4) \oplus (\frac{1}{2},\frac{5}{2}) \oplus (\frac{1}{2},\frac{7}{2}) \oplus (\frac{1}{2},\frac{9}{2}) $ \\ \hline
		$ (3, 3, 3) $ & \multicolumn{3}{C{68.5ex}|}{$ \! (0,0) \oplus 2(0,1) \oplus 3(0,2) \oplus 3(0,3) \oplus (0,4) \oplus (\frac{1}{2},\frac{3}{2}) \oplus (\frac{1}{2},\frac{5}{2}) \oplus (\frac{1}{2},\frac{7}{2}) \oplus (\frac{1}{2},\frac{9}{2}) \! $} \\ \hline
	\end{tabular}
	\caption{BPS spectrum of $SU(3)_4$ for $ d_i \leq 3 $. Here, $\mathbf{d} = (d_1, d_2, d_3)$ labels the BPS states with charge $d_1 e_2 + d_2 f_1 + d_3 f_2$.} \label{table:SU(3)_4}
\end{table}

The $ SU(3)_5 $ theory is dual to the $ Sp(2)_\pi $ gauge theory, so they can provide a non-trivial check for the validity of the blowup equations. In the geometry \eqref{eq:su3_odd_geo} with $\kappa=5$, this duality is realized as the base-fiber duality exchanging two curve classes $e_2$ and $f_2$ in $\mathbb{F}_0$. The map between the parameters in the $ SU(3)_5 $ theory and those in the $ Sp(2)_\pi $ theory can be easily found from the geometric realization. The volumes of 2-cycles in the $ SU(3) $ frame are
\begin{align}\label{eq:su3_5_vol}
\vol(f_1)= 2 \phi_1 - \phi_2, \quad
\vol(f_2) = -\phi_1 + 2\phi_2, \quad
\vol(e_2) = -2\phi_1 + 2\phi_2 + m\ ,
\end{align}
while those in the $ Sp(2) $ frame after exchanging $e_2$ and $f_2$ are
\begin{align}
\vol(f_1) = 2\phi_1 - \phi_2, \quad
\vol(f_2) = -2\phi_1 + 2\phi_2, \quad
\vol(e_2) = -\phi_1 + 2\phi_2 + m\ .
\end{align}
From this, we find a natural map between the parameters in two dual frames as \cite{Gaiotto:2015una, Hayashi:2016abm, Hayashi:2018lyv}
\begin{align}
\phi_1^{SU} &= \phi_1^{Sp} + \frac{1}{3} m^{Sp} \ , \quad \phi_2^{SU} = \phi_2^{Sp} + \frac{2}{3} m^{Sp} \ ,\quad
m^{SU} = -\frac{2}{3} m^{Sp}\ . \label{eq:SU3 and Sp2 duality map}
\end{align}

The effective prepotential of the $Sp(2)_\pi$ theory on the Coulomb branch is written as
\begin{align}
\mathcal{E} &= \frac{1}{\epsilon_1\epsilon_2}\left(\mathcal{F} -\frac{\epsilon_1^2+\epsilon_2^2}{12}(\phi_1+\phi_2) + \epsilon_+^2(\phi_1+\phi_2)\right) \ , \nonumber \\
6\mathcal{F}
 &= 6m (2\phi_1^2 - 2\phi_1 \phi_2 + \phi_2^2)+8\phi_1^3 + 12\phi_1^2 \phi_2 - 18\phi_1 \phi_2^2 + 8\phi_2^3 \ ,
\end{align}
where $ m $ is the $ Sp(2) $ gauge coupling. One can easily check that this $\mathcal{E}$ of the $ Sp(2)_\pi $ theory coincides with that of the $ SU(3)_5 $ theory in \eqref{eq:SU3_k_prepotential} under the above parameter map up to terms independent of the dynamical K\"ahler parameters. The perturbative GV-invariants of the $Sp(2)_\pi$ gauge theory is
\begin{align}
	\mathcal{Z}_{\rm pert} = {\rm PE} \left[ -\frac{1+p_1p_2}{(1-p_1)(1-p_2)}\left(e^{-2\phi_1}+e^{-\phi_2}+e^{-(2\phi_2-2\phi_1)}+e^{-(2\phi_1-\phi_2)}\right)\right] \ .
\end{align} 

In the $ Sp(2) $ frame, there are three (and more) sets of consistent fluxes respecting the $ Sp(2) $ structure:
\begin{align}
n_1,n_2 \in \mathbb{Z} \ , \quad B_m = -1, 0, 1 \, .
\end{align}
The three sets of unity blowup equations from these magnetic fluxes can be easily solved and the solution provides a closed expression of the instanton partition function of the $ Sp(2)_\pi $ theory at each instanton order. We checked that the result perfectly matches the BPS states captured by the $ SU(3)_5 $ calculation under the parameter map \eqref{eq:SU3 and Sp2 duality map} in the K\"ahler parameter expansion. Instead of giving explicit forms of  the instanton partition functions, we list BPS spectrum up to 3-instanton order in Table~\ref{table:SU(3)_5}.
\begin{table}
	\centering
	\begin{tabular}{|c|C{28ex}||c|C{28ex}|} \hline
		$ \mathbf{d} $ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ & $ \mathbf{d} $ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ \\ \hline
		$ (1, 0, 0) $ & $ (0, \frac{1}{2}) $ & $ (1, 0, 1) $ & $ (0, \frac{3}{2}) $ \\ \hline
		$ (1, 0, 2) $ & $ (0, \frac{5}{2}) $ & $ (1, 1, 0) $ & $ (0, \frac{1}{2}) $ \\ \hline
		$ (1, 1, 1) $ & $ (0, \frac{1}{2}) \oplus (0, \frac{3}{2}) $ & $ (1, 1, 2) $ & $ (0, \frac{3}{2}) \oplus (0, \frac{5}{2}) $ \\ \hline
		$ (1, 2, 0) $ & $ (0, \frac{1}{2}) $ & $ (1, 2, 1) $ & $ (0, \frac{1}{2}) \oplus (0, \frac{3}{2}) $ \\ \hline
		$ (1, 2, 2) $ & $ (0, \frac{1}{2}) \oplus (0, \frac{3}{2}) \oplus (0, \frac{5}{2}) $ & $ (2, 0, 1) $ & $ (0, \frac{5}{2}) $ \\ \hline
		$ (2, 0, 2) $ & $ (0, \frac{5}{2}) \oplus (0, \frac{7}{2}) \oplus (\frac{1}{2}, 4) $ & $ (2, 1, 1) $ & $ (0, \frac{3}{2}) \oplus (0, \frac{5}{2}) $ \\ \hline
		$ (2, 1, 2) $ & $ (0, \frac{3}{2}) \oplus 3(0, \frac{5}{2}) \oplus 2(0, \frac{7}{2}) \oplus (\frac{1}{2}, 3) \oplus (\frac{1}{2}, 4) $ & $ (2, 2, 1) $ & $ (0, \frac{1}{2}) \oplus (0, \frac{3}{2}) \oplus (0, \frac{5}{2}) $ \\ \hline
		$ (2, 2, 2) $ & $ (0, \frac{1}{2}) \oplus 3(0, \frac{3}{2}) \oplus 4(0, \frac{5}{2}) \oplus 2(0, \frac{7}{2}) \oplus (\frac{1}{2}, 2) \oplus (\frac{1}{2}, 3) \oplus (\frac{1}{2}, 4) $ & $ (3, 0, 1) $ & $ (0, \frac{7}{2}) $ \\ \hline
		$ (3, 0, 2) $ & $ (0,\frac{5}{2}) \oplus (0,\frac{7}{2}) \oplus 2(0,\frac{9}{2}) \oplus (\frac{1}{2},4) \oplus (\frac{1}{2},5) \oplus (1,\frac{11}{2}) $ & $ (3, 1, 1) $ & $ (0,\frac{5}{2}) \oplus (0,\frac{7}{2}) $ \\ \hline
		$ (3, 1, 2) $ & $ (0,\frac{3}{2}) \oplus 3(0,\frac{5}{2}) \oplus 5(0,\frac{7}{2}) \oplus 3(0,\frac{9}{2}) \oplus	(\frac{1}{2},3) \oplus 3(\frac{1}{2},4) \oplus 2(\frac{1}{2},5) \oplus (1,\frac{9}{2}) \oplus (1,\frac{11}{2}) $ & $ (3, 2, 1) $ & $ (0,\frac{3}{2}) \oplus (0,\frac{5}{2}) \oplus (0,\frac{7}{2}) $ \\ \hline
		$ (3, 2, 2) $ & \multicolumn{3}{C{68ex}|}{$ (0,\frac{1}{2}) \oplus 3(0,\frac{3}{2}) \oplus 8(0,\frac{5}{2}) \oplus 7(0,\frac{7}{2}) \oplus 4(0,\frac{9}{2}) \oplus (\frac{1}{2},2) \oplus 3(\frac{1}{2},3) \oplus 4(\frac{1}{2},4) \oplus 2(\frac{1}{2},5) \oplus (1,\frac{7}{2}) \oplus (1,\frac{9}{2}) \oplus (1,\frac{11}{2}) $} \\ \hline
	\end{tabular}
	\caption{BPS spectrum of $SU(3)_5$ for $d_1 \leq 3$ and $ d_2, d_3 \leq 2 $. Here, $\mathbf{d} = (d_1, d_2, d_3)$ labels the BPS states with charge $d_1 e_2 + d_2 f_1 + d_3 f_2$.} \label{table:SU(3)_5}
\end{table}

In the case of $ \kappa = 6 $, one should be careful about the $ \Lambda $ factor. When background magnetic flux is $ B_m = 3/2 $, the last term of \eqref{eq:su3_k_1inst} in the K\"ahler parameter expansion  contains a $ \phi_i $ independent term :
\begin{align}
-p_1^{1/2} p_2^{1/2}\ \in\ \sum_{\vec{n} \in S_1} q^{-1} e^{-V} \frac{\mathcal{Z}_{\mathrm{pert}}^{(N)} \mathcal{Z}_{\mathrm{pert}}^{(S)}}{\mathcal{Z}_{\mathrm{pert}}} \ .
\end{align}
This term should be absorbed into $ \Lambda_1 $ on the left side of \eqref{eq:su3_k_1inst}. Thus we have
\begin{align}
&\Lambda_1 = 0 \quad \text{for} \quad B_m = \pm \tfrac{1}{2} \ , \qquad \Lambda_1 = -p_1^{1/2} p_2^{1/2} \quad \text{for} \quad B_m = \tfrac{3}{2} \ .
\end{align}
Then the solution $ Z_1(\phi_i; \epsilon_1, \epsilon_2) $ does not contain $ \phi_i $ independent terms in the expansion. Similarly, the last term of the blowup equation at $ q^2 $ order
\begin{align}\label{eq:su3_6_2inst_blowup}
\Lambda_2(m; \epsilon_1, \epsilon_2) + \hat{Z}_2(\phi_i, \epsilon_1, \epsilon_2)
=&~ p_1^{2B_m} \hat{Z}_2(\phi_i, \epsilon_1, \epsilon_2 - \epsilon_1) + p_2^{2B_m}\hat{Z}_2(\phi_i, \epsilon_1 - \epsilon_2, \epsilon_2) \nonumber \\
& + (\text{terms from } \hat{Z}_{1} \text{ and } \Lambda_1)
\end{align}
contains $ \phi_i $ independent terms for three magnetic fluxes $ B_m = -\tfrac12, \tfrac12, \tfrac32 $ as
\begin{align}
	\frac{-2 p_1 p_2}{(1-p_1) (1-p_2) (p_1-p_2)^2} \, , \ \ \frac{-2p_1^2 p_2^2}{(1-p_1)(1-p_2)(p_1-p_2)^2}  \, , \ \ \frac{-F(p_1, p_2)}{(1-p_1)(1-p_2)(p_1 - p_2)^2}
\end{align}
respectively, where
\begin{align}
F(p_1, p_2) = p_1 p_2 &(-p_1^2 -p_1^4 + 2 p_1 p_2 + p_1^3 p_2 + p_1^4 p_2 - p_2^2 \nonumber \\
& + 2 p_1^2 p_2^2 - p_1^3 p_2^2 + p_1 p_2^3 - p_1^2 p_2^3 - p_2^4 + p_1 p_2^4) \ .
\end{align}
After absorbing these terms into $ \Lambda_2 $, the blowup equation at $q^2$ order is solved consistently. However, when we take the plethystic logarithm and extract single particle states from the resulting partition function, it turns out that the partition function contain unexpected $ \phi_i $ independent term given by
\begin{align}
-\frac{p_1 p_2 q^2}{(1-p_1)^2 (1-p_2)^2}\ \in\ \PLog\qty[1 + q Z_1(\phi_i; \epsilon_1, \epsilon_2) + q^2 Z_2(\phi_i; \epsilon_1, \epsilon_2)] \ ,
\end{align}
where $ \PLog $ denotes the plethystic logarithm. The PE of this term provides some $\phi_i$ independent terms and again we put them into the $ \Lambda_2 $ factor. After all, we find that the $ \Lambda_2 $ factor is given by
\begin{align}
&\Lambda_2 = 0 \quad \text{for } B_m = \pm \tfrac{1}{2}, \nonumber \\
&\Lambda_2 = -p_1 p_2 (p_1 + p_2) \quad \text{for} \quad B_m = \tfrac{3}{2} \ .
\end{align}
In this way, we can solve the blowup equation iteratively while absorbing all $\phi_i$ independent terms into the $ \Lambda $ factor. The resulting BPS spectrum of the $ SU(3)_6 $ theory is given in Table~\ref{table:SU3_6}.
\begin{table}
	\centering
	\begin{tabular}{|c|C{28ex}||c|C{28ex}|} \hline
		$ \mathbf{d} $ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ & $ \mathbf{d} $ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ \\ \hline
		$ (1, 0, 0) $ & $ (0, 0) $ & $ (1, 0, 1) $ & $ (0, 1) $ \\ \hline
		$ (1, 0, 2) $ & $ (0, 2) $ & $ (1, 0, 3) $ & $ (0, 3) $ \\ \hline
		$ (1, 1, 1) $ & $ (0, 0) \oplus (0, 1) $ & $ (1, 1, 2) $ & $ (0, 1) \oplus (0, 2) $ \\ \hline
		$ (1, 1, 3) $ & $ (0, 2) \oplus (0, 3) $ & $ (1, 2, 0) $ & $ (0, 0) $ \\ \hline
		$ (1, 2, 1) $ & $ (0, 0) \oplus (0, 1) $ & $ (1, 2, 2) $ & $ (0, 0) \oplus (0, 1) \oplus (0, 2) $ \\ \hline
		$ (1, 2, 3) $ & $ (0, 1) \oplus (0, 2) \oplus (0, 3) $ & $ (1, 3, 1) $ & $ (0, 1) $ \\ \hline
		$ (1, 3, 2) $ & $ (0,1) \oplus (0,2) $ & $ (1, 3, 3) $ & $ (0,0) \oplus (0,1) \oplus (0,2) \oplus (0,3) $ \\ \hline
		$ (2, 0, 2) $ & $ (0, \frac{5}{2}) $ & $ (2, 0, 3) $ & $ (0,\frac{5}{2}) \oplus (0,\frac{7}{2}) \oplus (\frac{1}{2},4) $ \\ \hline
		$ (2, 1, 2) $ & $ (0, \frac{3}{2}) \oplus (0, \frac{5}{2}) $ & $ (2, 1, 3) $ & $ (0,\frac{3}{2}) \oplus 3(0,\frac{5}{2}) \oplus 2(0,\frac{7}{2}) \oplus (\frac{1}{2},3) \oplus (\frac{1}{2},4) $ \\ \hline
		$ (2, 2, 1) $ & $ (0, \frac{1}{2}) $ & $ (2, 2, 2) $ & $ (0, \frac{1}{2}) \oplus 2(0, \frac{3}{2}) \oplus (0, \frac{5}{2}) $ \\ \hline
		$ (2, 2, 3) $ & $ (0,\frac{1}{2}) \oplus 3(0,\frac{3}{2}) \oplus 5(0,\frac{5}{2}) \oplus 2(0,\frac{7}{2}) \oplus (\frac{1}{2},2) \oplus (\frac{1}{2},3) \oplus (\frac{1}{2},4) $ & $ (2, 3, 1) $ & $ (0, \frac{1}{2}) $ \\ \hline
		$ (2, 3, 2) $ & $ 2(0,\frac{1}{2}) \oplus 2(0,\frac{3}{2}) \oplus (0,\frac{5}{2}) $ & $ (2, 3, 3) $ & $ 3(0,\frac{1}{2}) \oplus 5(0,\frac{3}{2}) \oplus 5(0,\frac{5}{2}) \oplus 2(0,\frac{7}{2}) \oplus (\frac{1}{2},1) \oplus (\frac{1}{2},2) \oplus (\frac{1}{2},3) \oplus (\frac{1}{2},4) $ \\ \hline
		$ (3, 0, 3) $ & $ (0,3) \oplus (\frac{1}{2},\frac{9}{2}) $ & $ (3, 1, 3) $ & $ (0,2) \oplus 2(0,3) \oplus (0,4) \oplus (\frac{1}{2},\frac{7}{2}) \oplus (\frac{1}{2},\frac{9}{2}) $ \\ \hline
		$ (3, 2, 2) $ & $ (0, 2) $ & $ (3, 2, 3) $ & $ (0,1) \oplus 3(0,2) \oplus 5(0,3) \oplus (0,4) \oplus (\frac{1}{2},\frac{5}{2}) \oplus 2(\frac{1}{2},\frac{7}{2}) \oplus (\frac{1}{2},\frac{9}{2}) $ \\ \hline
		$ (3, 3, 2) $ & $ (0, 1) \oplus (0, 2) $ & $ (3, 3, 3) $ & $ (0,0) \oplus 3(0,1) \oplus 7(0,2) \oplus 6(0,3) \oplus (0,4) \oplus (\frac{1}{2},\frac{3}{2}) \oplus 2(\frac{1}{2},\frac{5}{2}) \oplus 2(\frac{1}{2},\frac{7}{2}) \oplus (\frac{1}{2},\frac{9}{2}) $ \\ \hline
	\end{tabular}
	\caption{BPS spectrum of the $SU(3)_6$ theory for $d_i \leq 3$. Here, $ \mathbf{d} = (d_1, d_2, d_3) $ labels the BPS states with charge $d_1 e_2 + d_2 f_1 + d_3 f_2$.} \label{table:SU3_6}
\end{table}

When $ \kappa = 7 $, the fiber-base duality of $ \mathbb{F}_0 $ in the geometry \eqref{eq:su3_odd_geo}  gives the $ G_2 $ gauge theory description. The $ G_2 $ instanton partition function can be calculated using the ADHM-like method in \cite{Kim:2018gjo} or using the topological vertex in \cite{Hayashi:2018bkd}. Here, we will present the partition function computation of this theory using blowup equations in both the $SU(3)$ and $G_2$ descriptions. In the $ SU(3) $ frame, the volumes of 2-cycles in the geometry are
\begin{align}
\vol(f_1) &= 2\phi_1 - \phi_2\,, &
\vol(f_2) &= -\phi_1 + 2\phi_2\,, &
\vol(e_2) &= -3\phi_1 + 2\phi_2 + m \ .
\end{align}
On the other hand, in the $ G_2 $ frame after exchanging the fiber and the base of $ \mathbb{F}_0 $, the volumes are 
\begin{align}
\vol (f_1) &= 2\phi_1 - \phi_2\,,&
\vol (f_2) &= -3\phi_1 + 2\phi_2 \,,&
\vol (e_2) &= -\phi_1 + 2\phi_2 + m \ .
\end{align}
The parameters in these two descriptions are thus mapped each other as \cite{Hayashi:2018lyv}
\begin{align}
\phi_1^{SU} &= \phi_1^{G_2} + \frac{1}{3} m_0^{G_2}\,, \quad
\phi_2^{SU} = \phi_2 + \frac{2}{3} m_0^{G_2}\,, \quad
m^{SU} = -\frac{1}{3} m^{G_2}\, .
\end{align}

In the $ G_2 $ description, the effective prepotential on the Coulomb branch where $2\phi_1-\phi_2>0$ and $2\phi_2-3\phi_1>0$ with $\phi_1,\phi_2>0$ is given by
\begin{align}
\mathcal{E} &= \frac{1}{\epsilon_1 \epsilon_2} 
\left( \mathcal{F} - \frac{\epsilon_1^2  + \epsilon_2^2}{12}(\phi_1 + \phi_2) +\epsilon_+^2 (\phi_1 + \phi_2) \right) \, , \nonumber \\ 
6\mathcal{F} &= 6 m \qty(3\phi_1^2 - 3\phi_1 \phi_2 + \phi_2^2 )+ 8\phi_1^3 + 18\phi_1^2 \phi_2 - 24\phi_1 \phi_2^2 + 8\phi_2^2  \, .
\end{align}
One can check that this agrees with the $ SU(3)_7 $ effective prepotential under the above parameter map up to terms independent of $\phi_i$. The perturbative GV-invariants of the $G_2$ gauge theory is
\begin{align}
	\mathcal{Z}_{\rm pert} &= {\rm PE} \bigg[ -\frac{1+p_1p_2}{(1-p_1)(1-p_2)}\left(e^{-\phi_1}+e^{-\phi_2} +e^{-(3\phi_1-\phi_2)}+e^{-(2\phi_1-\phi_2)}\right. \nonumber \\
	&\qquad \qquad \qquad \qquad \qquad \qquad \left.+e^{-(\phi_2-\phi_1)}+e^{-(2\phi_2-3\phi_1)}\right)\bigg] \ .
\end{align} 

There are again three sets of consistent magnetic fluxes respecting the $ G_2 $ structure:
\begin{align}
n_1,n_2 \in \mathbb{Z} \ , \quad B_m  = -1, 0, 1 \ .
\end{align}
We computed the unity blowup equations built from these fluxes and checked that two results from the $SU(3)_7$ theory and the $G_2$ theory perfectly agree with each other in the K\"ahler parameter expansion. The BPS spectrum of this theory can be found in Table~\ref{table:SU(3)_7}.
\begin{table}
	\centering
	\begin{tabular}{|c|C{28ex}||c|C{28ex}|} \hline
		$ \mathbf{d} $ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ & $ \mathbf{d} $ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ \\ \hline
		$(1, 0, 0)$ & $(0, \frac{1}{2})$ & $(1, 0, 1)$ & $(0, \frac{3}{2})$ \\ \hline
		$(1, 0, 2)$ & $(0, \frac{5}{2})$ & $(1, 1, 0)$ & $(0, \frac{1}{2})$ \\ \hline
		$(1, 1, 1)$ & $(0, \frac{1}{2}) \oplus (0, \frac{3}{2})$ & $(1, 1, 2)$ & $(0, \frac{3}{2}) \oplus (0, \frac{5}{2})$  \\ \hline
		$(1, 2, 0)$ & $(0, \frac{1}{2})$ & $(1, 2, 1)$ & $(0, \frac{1}{2}) \oplus (0, \frac{3}{2})$ \\ \hline
		$(1, 2, 2)$ & $(0, \frac{1}{2}) \oplus (0, \frac{3}{2}) \oplus (0, \frac{5}{2})$ & $(2, 0, 1)$ & $(0, \frac{5}{2})$ \\ \hline
		$(2, 0, 2)$ & $(0, \frac{5}{2}) \oplus (0, \frac{7}{2}) \oplus (\frac{1}{2}, 4)$ & $(2, 1, 1)$ & $(0, \frac{3}{2}) \oplus (0, \frac{5}{2})$ \\ \hline
		$(2, 1, 2)$ & $(0, \frac{3}{2}) \oplus 3(0, \frac{5}{2}) \oplus 2(0, \frac{7}{2}) \oplus (\frac{1}{2}, 3) \oplus (\frac{1}{2}, 4)$ & $(2, 2, 1)$ & $(0, \frac{1}{2}) \oplus (0, \frac{3}{2}) \oplus (0, \frac{5}{2})$ \\ \hline
		$(2, 2, 2)$ & $(0, \frac{1}{2}) \oplus 3(0, \frac{3}{2}) \oplus 4(0, \frac{5}{2}) \oplus 2(0, \frac{7}{2}) \oplus (\frac{1}{2}, 2) \oplus (\frac{1}{2}, 3) \oplus (\frac{1}{2}, 4)$ & $ (3, 0, 1) $ & $ (0, \frac{7}{2}) $ \\ \hline
		$ (3, 0, 2) $ & $ (0,\frac{5}{2}) \oplus (0,\frac{7}{2}) \oplus 2(0,\frac{9}{2}) \oplus (\frac{1}{2},4) \oplus (\frac{1}{2},5) \oplus (1,\frac{11}{2}) $ & $ (3, 1, 1) $ & $ (0, \frac{5}{2}) \oplus (0, \frac{7}{2}) $ \\ \hline
		$ (3, 1, 2) $ & $ (0,\frac{3}{2}) \oplus 3(0,\frac{5}{2}) \oplus 5(0,\frac{7}{2}) \oplus 3(0,\frac{9}{2}) \oplus (\frac{1}{2},3) \oplus 3(\frac{1}{2},4) \oplus 2(\frac{1}{2},5) \oplus (1,\frac{9}{2}) \oplus (1,\frac{11}{2}) $ & $ (3, 2, 1) $ & $ (0, \frac{3}{2}) \oplus (0, \frac{5}{2}) \oplus (0, \frac{7}{2}) $ \\ \hline
		$ (3, 2, 2) $ & \multicolumn{3}{C{68ex}|}{$ (0,\frac{1}{2}) \oplus 3(0,\frac{3}{2}) \oplus 8(0,\frac{5}{2}) \oplus 7(0,\frac{7}{2}) \oplus 4(0,\frac{9}{2}) \oplus (\frac{1}{2},2) \oplus 3(\frac{1}{2},3) \oplus 4(\frac{1}{2},4) \oplus 2(\frac{1}{2},5) \oplus (1,\frac{7}{2}) \oplus (1,\frac{9}{2}) \oplus (1,\frac{11}{2}) $} \\ \hline
	\end{tabular}
	\caption{BPS spectrum of the $SU(3)_7$ theory for $d_1 \leq 3$ and $ d_2, d_3 \leq 2 $. Here, $\mathbf{d} = (d_1, d_2, d_3)$ labels the BPS states with charge $d_1 e_2 + d_2 f_1 + d_3 f_2$.} \label{table:SU(3)_7}
\end{table}


\subsubsection{\texorpdfstring{6d minimal $ SU(3) $ SCFT on a circle with $ \mathbb{Z}_2 $ twist: 5d $SU(3)_9$}{6d SU(3) gauge theory with Z2 twist}} \label{subsubsec:SU3/Z2}

Elliptic genera of many 6d theories, for instance,  E-string, M-string, or 6d SCFTs compactified on a circle without twist, have been evaluated using the blowup equations \cite{Gu:2018gmy, Gu:2019dan, Gu:2019pqj, Gu:2020fem}. In this subsection, we will demonstrate with a simple example  of how to bootstrap BPS partition functions (or elliptic genera) for 6d SCFTs on a circle with outer automorphism twists by solving the blowup equations. 

We will consider a circle compactification of the 6d minimal $SU(3)$ SCFT with $\mathbb{Z}_2$ automorphism twist. This theory is dual to the 5d $SU(3)$ gauge theory at CS-level $\kappa=9$ \cite{Jefferson:2017ahm},
\begin{align}\label{eq:su3_9-6d}
\begin{tikzpicture}
\draw (0, 0) node {$ SU(3)_9 $}
(2, 0) node {$ = $}
(4, 0.3) node {$ \mathfrak{su}(3)^{(2)} $}
(4, -0.3) node {$ 3 $};
\end{tikzpicture}
\end{align}
We follow the notations in \cite{Bhardwaj:2019fzv} to denote 6d theories. It is geometrically engineered by gluing $ \mathbb{F}_{10} $ and $ \mathbb{F}_0 $ \cite{Jefferson:2018irk}:
\begin{align}\label{eq:su3_9_geo}
\begin{tikzpicture}
\draw[thick](-3,0)--(0,0);	
\node at(-3.6,0) {$\mathbb{F}_{10}{}\big|_1$};
\node at(-2.8,0.3) {${}_e$};
\node at(0.5,0) {$\mathbb{F}_{0}{}\big|_2$};
\node at(-0.45,0.3) {${}_{h+4f}$};
\end{tikzpicture} 
\end{align}
In geometry, the duality is simply the exchange of the base and the fiber classes in $\mathbb{F}_0$.
We will solve the blowup equations for this theory in both 5d and 6d frames and compare the results.

In the 5d $SU(3)_9$ theory, the effective prepotential $\mathcal{E}$ is given by
\begin{align}\label{eq:su3_9_prepotential}
\mathcal{E} &= \frac{1}{\epsilon_1 \epsilon_2} 
\left( \mathcal{F} - \frac{\epsilon_1^2  + \epsilon_2^2}{12}(\phi_1 + \phi_2) +\epsilon_+^2 (\phi_1 + \phi_2) \right), \\ 
6 \mathcal{F} &=  6m\big(\phi_1^2 - \phi_1 \phi_2 + \phi_2^2\big) +8\phi_1^3 + 24\phi_1^2 \phi_2 - 30\phi_1 \phi_2^2 + 8\phi_2^2  \ , \nonumber 
\end{align}
where $m$ is the gauge coupling. The GV-invariant of this theory takes the same form of \eqref{eq:SU3_k_GV}. It is convenient to use volumes of three independent 2-cycles in the geometry \eqref{eq:su3_9_geo} as the basis of states in the GV-invariant,
\begin{align}\label{eq:su3_9_vol}
\vol (f_1) =  2\phi_1 - \phi_2, \quad
\vol (f_2) = -\phi_1 + 2\phi_2, \quad
\vol (e_2) = -4\phi_1 + 2\phi_2 + m\ .
\end{align}
Unlike the other $SU(3)_\kappa$ theories with $|\kappa|\le 7$, this theory has only one set of consistent magnetic fluxes respecting the $ SU(3) $ structure:
\begin{align}\label{eq:MFforSU3_9}
	n_1,n_2\in \mathbb{Z} \ , \quad B_m = 0 \ .
\end{align}
This set of fluxes gives rise to a unity blowup equation. As we discussed already, a single unity blowup equation is enough to compute the BPS invariants. By solving the unity blowup equation, we find the BPS spectrum of the $SU(3)_9$ theory listed in Table~\ref{table:SU3_9}.
\begin{table}
	\centering
	\begin{tabular}{|c|C{28ex}||c|C{28ex}|} \hline
		$\mathbf{d}$ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ & $\mathbf{d}$ & $\oplus N_{j_l, j_r}^{\mathbf{d}} (j_l, j_r)$ \\ \hline
		$(1, 0, 0)$ & $(0, \frac{1}{2})$ &$ (1, 0, 1)$ & $(0, \frac{3}{2})$ \\ \hline
		$(1, 0, 2)$ & $(0, \frac{5}{2})$ & $(1, 1, 0)$ & $(0, \frac{1}{2})$ \\ \hline
		$(1, 1, 1)$ & $(0, \frac{1}{2}) \oplus (0, \frac{3}{2})$ & $(1, 1, 2)$ & $(0, \frac{3}{2}) \oplus (0, \frac{5}{2})$ \\ \hline
		$(1, 2, 1)$ & $(0, \frac{1}{2}) \oplus (0, \frac{3}{2})$ & $(1, 2, 2)$ & $(0, \frac{1}{2}) \oplus (0, \frac{3}{2}) \oplus (0, \frac{5}{2})$ \\ \hline
		$(2, 0, 1)$ & $(0, \frac{5}{2})$ & $(2, 0, 2)$ & $(0, \frac{5}{2}) \oplus (0, \frac{7}{2}) \oplus (\frac{1}{2}, 4)$ \\ \hline
		$(2, 1, 1)$ & $(0, \frac{3}{2}) \oplus (0, \frac{5}{2})$ & $(2, 1, 2)$ & $(0, \frac{3}{2}) \oplus 3(0, \frac{5}{2}) \oplus 2(0, \frac{7}{2}) \oplus (\frac{1}{2}, 3) \oplus (\frac{1}{2}, 4)$ \\ \hline
		$(2, 2, 1)$ & $(0, \frac{1}{2}) \oplus (0, \frac{3}{2}) \oplus (0, \frac{5}{2})$ & $(2, 2, 2)$ & $(0, \frac{1}{2}) \oplus 3(0, \frac{3}{2}) \oplus 4(0, \frac{5}{2}) \oplus 2(0, \frac{7}{2}) \oplus (\frac{1}{2}, 2) \oplus (\frac{1}{2}, 3) \oplus (\frac{1}{2}, 4)$ \\ \hline
		$ (3, 0, 1) $ & $ (0, \frac{7}{2}) $ & $ (3, 0, 2) $ & $ (0,\frac{5}{2}) \oplus (0,\frac{7}{2}) \oplus 2(0,\frac{9}{2}) \oplus (\frac{1}{2},4) \oplus (\frac{1}{2},5) \oplus (1,\frac{11}{2}) $ \\ \hline
		$ (3, 1, 1) $ & $ (0,\frac{5}{2}) \oplus (0,\frac{7}{2}) $ & $ (3, 1, 2) $ & $ (0,\frac{3}{2}) \oplus 3(0,\frac{5}{2}) \oplus	5(0,\frac{7}{2}) \oplus 3(0,\frac{9}{2}) \oplus (\frac{1}{2},3) \oplus 3(\frac{1}{2},4) \oplus 2(\frac{1}{2},5) \oplus (1,\frac{9}{2}) \oplus (1,\frac{11}{2}) $ \\ \hline
		$ (3, 2, 1) $ & $ (0, \frac{3}{2}) \oplus (0, \frac{5}{2}) \oplus (0, \frac{7}{2}) $ & $ (3, 2, 2) $ & $ (0,\frac{1}{2}) \oplus 3(0,\frac{3}{2}) \oplus 8(0,\frac{5}{2}) \oplus 7(0,\frac{7}{2}) \oplus 4(0,\frac{9}{2}) \oplus (\frac{1}{2},2) \oplus 3(\frac{1}{2},3) \oplus 4(\frac{1}{2},4) \oplus 2(\frac{1}{2},5) \oplus (1,\frac{7}{2}) \oplus (1,\frac{9}{2}) \oplus (1,\frac{11}{2}) $ \\ \hline
	\end{tabular}
	\caption{BPS spectrum of $SU(3)_9$ theory for $d_1 \leq 3$ and $ d_2, d_3 \leq 2 $. Here, $\mathbf{d} = (d_1, d_2, d_3)$ labels BPS states with charge $d_1 e_2 + d_2 f_1 + d_3 f_2$ cycle.} \label{table:SU3_9}
\end{table}

We now perform a similar computation in the perspective of the 6d $SU(3)$ gauge theory with $\mathbb{Z}_2$ twist. In the 6d frame, the volumes of 2-cycles in the geometry are 
\begin{equation}
	{\rm vol}(f_1) = \frac{\tau}{4} - \phi_1 \ , \quad {\rm vol}(f_2) = 2\phi_1 \ , \quad {\rm vol}(e_2) = 3\phi_0+2\phi_1-\frac{\tau}{2}\ .
\end{equation}
The effective prepotential in this frame is given in \eqref{eq:E-SU3-Z2} with a shift $\phi_0 \rightarrow \phi_0-\frac{1}{16}\tau$. 

The GV-invariant for this 6d theory can be written as
\begin{align}
Z_{GV}(\Phi, \phi_1, \tau; \epsilon_{1,2})
= \mathcal{Z}_{\mathrm{pert}}(\phi_1, \tau; \epsilon_{1,2})  \qty(1 + \sum_{k=1}^{\infty} e^{-k \Phi} Z_k(\phi_1, \tau, \epsilon_{1,2}))\ ,
\end{align}
where $ Z_k(\phi_1, \tau, \epsilon_{1,2}) $ is the $ k $-string elliptic genus and $\Phi\equiv 3\phi_0-\tau/2$ which is the string number fugacity. Here, the perturbative part can be read off from the 6d $SU(3)$ vector multiplets under the $\mathbb{Z}_2$ automorphism twist, which is given by
\begin{align}
\mathcal{Z}_{\mathrm{pert}}
= \PE \qty[ -\frac{1+p_1 p_2}{(1-p_1)(1-p_2)} \frac{1}{1-q} \qty(e^{-2\phi_1} + (q^{1/4}+q^{3/4})(e^{-\phi_1}+e^{\phi_1}) + q e^{2\phi_1}) ] , 
\end{align}
where $ q = e^{-\tau} $. See Appendix~\ref{appendix:1-loop} for more details.

There are three sets of consistent magnetic fluxes preserving the affine $A^{(2)}_2$ algebra structure:
\begin{align}
	n_1 \in \mathbb{Z}\ , \quad B_\tau = 0  \ , \quad n_0 \in \mathbb{Z}+B_0 \ \ {\rm with } \ \  B_0=0,1/3,2/3 \ .
\end{align}
Then the elliptic genus can be found by solving three unity blowup equations from these three flux sets. For example, the blowup equations at 1-string order are
\begin{align}
&\Lambda(\tau; \epsilon_1, \epsilon_2) \hat{Z}_1(\phi_1, \tau; \epsilon_1, \epsilon_2) \nonumber \\
&= \sum_{\vec{n} = (n, 2n)} e^{-V} \frac{\hat{\mathcal{Z}}_{\mathrm{pert}}^{(N)} \hat{\mathcal{Z}}_{\mathrm{pert}}^{(S)}}{\hat{\mathcal{Z}}_{\mathrm{pert}}} \qty(p_1^{3n + B_0} \hat{Z}_1(\phi_1, \epsilon_1, \epsilon_2 - \epsilon_1) + p_2^{3n + B_0} \hat{Z}_1(\phi_1, \epsilon_1 - \epsilon_2, \epsilon_2) ) \nonumber \\
& \qquad + \sum_{\vec{n} = (n, 2n \pm 1)} e^\Phi e^{-V} \frac{\hat{\mathcal{Z}}_{\mathrm{pert}}^{(N)} \hat{\mathcal{Z}}_{\mathrm{pert}}^{(S)}}{\hat{\mathcal{Z}}_{\mathrm{pert}}} \ .
\end{align}
Here the prefactor can be computed by collecting all $\phi_i$ independent terms in the blowup equation as follows:
\begin{align}
\Lambda(\tau; \epsilon_1, \epsilon_2) = \sum_{\vec{n} = (n, 2n)} e^{-V} \ .
\end{align}
The solution at 1-instanton string is then given by
\begin{align}
Z_1(\phi_1, \tau; \epsilon_1, \epsilon_2)
&= \frac{e^{-2\phi_1} p_1 p_2 (1+p_1 p_2)}{(1-p_1)(1-p_2) (e^{-2\phi_1} - p_1 p_2) (1-e^{-2\phi_1} p_1 p_2)} \nonumber \\
& \quad + \frac{e^{-\phi_1}(1+e^{-2\phi_1}) p_1 p_2 (1+p_1 p_2)}{(1-p_1) (1-p_2) (e^{-2\phi_1} - p_1 p_2) (1-e^{-2\phi_1} p_1 p_2)} q^{1/4} \nonumber \\
& \quad + \frac{e^{-2\phi_1} (1 + 2p_1 p_2 + 2p_1^2 p_2^2 + p_1^3 p_2^3)}{(1-p_1)(1-p_2) (e^{-2\phi_1} - p_1p_2)(1-e^{-2\phi_1} p_1 p_2)} q^{1/2} + \cdots \ .
\end{align}
This is in perfect agreement with the BPS spectrum of the $ SU(3)_9 $ theory given in Table \ref{table:SU3_9} and also topological vertex as well as the ADHM calculations \cite{Kim:2021cua}.