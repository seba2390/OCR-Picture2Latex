We recall the signal model $y = Z\RxTx \cdot i + w$ from \Cref{eq:SignalModel} and the constraint $|i - \DiskRadius| \leq \DiskRadius$ from \Cref{eq:Constraint}. Thereby $Z\RxTx$ is non-random and $w \sim \calCN(0,\sigma^2)$ is additive white Gaussian noise (AWGN). In this simple abstraction, which is visualized in \Cref{fig:BlockDiagram}, the impedance $z$ and the map $\ChannelFunc$ do not occur anymore.

Henceforth, the transmit current $i$ is considered as random variable; the probability density function (PDF) is denoted $f_i$. Its support must lie in the disk, i.e. $\supp(f_{i}) \subseteq \Disk$.

We are interested in the achievable information rates for a given signal-to-noise ratio (SNR). We define the SNR as
\begin{align}
\SNR := \f{|Z\RxTx|^2 \, \DiskRadius^2}{\sigma^2}
%= \f{|Z\RxTx|^2 \, |v\Ind\Tx|^2}{4 R\Tx^2 \,\sigma^2}
\, . \label{eq:SNR}
\end{align}
From an engineering perspective, reliable communication is possible over the channel at any achievable information rate, stated in bit per channel use (bpcu). The largest achievable rate defines the channel capacity $\RateMax$. Suitable error-correcting codes with a very large block length allow for information rates arbitrarily close to $\RateMax$ and with an arbitrarily small block error rate.
Formally, the mutual information $\Rate$ specifies an achievable rate, and the channel capacity $\RateMax$ is the supremum of $\Rate$ over all eligible transmit PDFs $f_i$. \cite{Tse2005}
%More formal detail is given in \Cref{apdx:ar}.

\begin{figure}[t]
\centering
\input{BlockDiagram}
\caption{Communication-theoretic description of load modulation in AWGN.}
\label{fig:BlockDiagram}
\end{figure}

%The transmit current $i \in \bbC$ is now considered as a random variable that can have any distribution that is restricted to the disk $\Disk$ as defined in \eqref{eq:Disk}. In formal terms, the probability density function (PDF) $f_{i}$ must fulfill $\int_\Disk f_{i}(i)\,di = 1$ and its support $\supp(f_{i}) \subseteq \Disk$.

%According to the random-coding argument from information theory \cite[Sec.~X.Y]{Cover2006}, an appropriate code book can be obtained by iid sampling from $f_{i}$.
%Low-complexity designs for the error-correcting encoder and decoder are out of scope.

%
%\footnotetext{For RFID, also the more specific properties
%$\DiskRadius = \f{|Z\RxTx|}{2 R\Tx} |i\Rx|$
%and
%$\SNR \propto |Z\RxTx|^4$ apply.
%For inductive RFID, these become
%$\DiskRadius = \f{\omega M}{2 R\Tx} |i\Rx|$
%and
%$\SNR \propto \omega^4 M^4$.%
%The expression hints to the severe path loss of RFID.
%}

%\begin{align}
%\RateMax = \sup_{\{f_s | \supp(f_s) \subseteq \Disk \}} \Rate
%\label{eq:ChannelCapacityDef}
%\end{align}
%

A crucial insight is that the disk constraint $|i - \DiskRadius| \leq \DiskRadius$ is equivalent to a peak-power-type constraint $|i - \DiskRadius|^2 \leq \DiskRadius^2$ on the signal $i - \DiskRadius$. The $\DiskRadius$-offset does not affect mutual information. Hence, the capacity problem at hand is equivalent to that of the complex-valued, peak-power constrained AWGN channel. The latter has been solved in \cite{ShamaiTIT1995}.

\subsection{Capacity-Achieving Transmit Current Statistics}
\label{sec:CurrentStats}

We translate the results in \cite{ShamaiTIT1995} to our formalism. This readily allows for a characterization of the capacity-achieving distribution on the transmit current $i$. It fulfills:
\begin{enumerate}
\item
The PDF support is given by a finite union 
$\supp(f_{i}) = \calC_1 \cup \ldots \cup \calC_K$
of concentric circles $\calC_k$, $k \in \{ 1 , \ldots , K \}$, with radii $\Radius_k$. All circles have their center at $\DiskRadius$.
More formally, the circles are given by
\begin{align}
\calC_k = \left\{\, \DiskRadius + \Radius_k\, e^{j\phi} \, \big| \, \phi \in (-\pi,\pi] \,\right\} .
\label{eq:CircleDefinition}
\end{align}
We assume that the indexing asserts
$0 \leq \Radius_K < \ldots < \DiskRadius$.
\item
The circles are chosen with non-uniform probabilities, denoted as $\CircProb_k$.
\item
The angle $\phi$ has uniform distribution
$\phi \sim \calU(-\pi,\pi)$
for any circle $k$ and for any $\SNR$.
%This means $i|k \sim \calU(\calC_k)$.
\item
The set of circles always contains the largest possible circle $\calC_1 = \partial\Disk$ (the disk boundary with radius $\DiskRadius$).
\item
The number of circles $K \in \bbN$ increases with $\SNR$.
\item
At low SNR, $K=1$ achieves capacity. This corresponds to a uniform-PSK modulation $i \sim \calU(\calC_1)$.
\end{enumerate}
%
\Cref{fig:CapAchievingDistr_i} shows a high-SNR example of the capacity-achieving distribution of $i$.

\begin{figure}[!ht]
\centering
\subfloat[transmit current]{%
%\ \ \,\includegraphics[height=42.6mm,trim=6.2mm 6.2mm 0 0,clip=true]{CapacityAchievingDistr_sCircles-crop}
%\put(-117,60){\rotatebox{90}{\scriptsize{$\Im(s)\, / \,\DiskRadius$}}}%
%\put(-71,-7){\scriptsize{$\Re(s)\, / \,\DiskRadius$}}%
\resizebox{!}{46mm}{\input{CapacityAchievingDistr_sCircles.tex}}
\label{fig:CapAchievingDistr_i}}
\subfloat[load impedance]{
%\includegraphics[height=46.8mm]{CapacityAchievingDistr_zL-crop}
\resizebox{!}{46mm}{\input{CapacityAchievingDistr_zL.tex}}
\label{fig:CapAchievingDistr_z}}
\caption{Capacity-achieving distribution of the relevant complex-valued quantities, plotted for $\SNR = 21\dB$.}
\label{fig:CapAchievingDistr}
\end{figure}

\subsection{Channel Capacity Statement}

For the moment we consider that $K$ circles are given in terms of their radii $\Radius_k$ and probabilities $\CircProb_k$ (their $\SNR$-dependent evolution is covered in the next subsection).
The resulting achievable information rate in bpcu is given by the mutual information expression
\begin{align}
\Rate =&
-\int_0^\infty\! a \cdot \gamma(a) \, \log_2\!\big( \gamma(a) \big)\,da - \log_2(e)
\label{eq:RateFromCircles} \, , \\
\gamma(a) :=&
\sum_{k = 1}^K \,
\CircProb_k \,\exp\!\left( -\f{a^2 + a_k^2}{2} \right)
I_0\!\left( a a_k \right) \, , \\
a_k :=& \f{\Radius_k}{\DiskRadius} \sqrt{2\, \SNR}
%= \sqrt{2} |Z\RxTx| \cdot \Radius_k / \sigma
\, .
\end{align}
Thereby $I_0$ is the modified Bessel function of the first kind and $e$ is the Euler number.
The integral is evaluated numerically. 
The expression \Cref{eq:RateFromCircles} was obtained by adapting the statements \cite[Eq.~(4),(13),(11),(46)]{ShamaiTIT1995}, which relate to the peak-power constrained quadrature AWGN channel, to our system model. More formal detail is given in \Cref{apdx:ar}.

As stated in \cite{ShamaiTIT1995}, the channel capacity $\RateMax$ is obtained by maximizing $\Rate$ with respect to the free circle parameters:
\begin{align}
\RateMax = &\max_{\Radius_2\, , \ldots , \,\Radius_K, \,\CircProb_1\, , \ldots, \,\CircProb_K} \Rate
\label{eq:Capacity} \\
&\mathrm{subject\ to}\
%\Radius_2 , \ldots , \Radius_K \in [0,\Radius_1) \, , \nonumber\\
0 \leq \Radius_K < \ldots < \Radius_2 < \Radius_1 \, , \nonumber\\
&\hphantom{\mathrm{subject\ to}}\
\CircProb_1 , \ldots , \CircProb_K \in [0,1] \, , \nonumber\\
&\hphantom{\mathrm{subject\ to}}\
\CircProb_1 + \ldots + \CircProb_K = 1 \, . \nonumber
\end{align}
In all following evaluations, this problem is tackled with an interior-point algorithm for constrained nonlinear optimization \cite{InteriorPointAlgorithm}, with sensible choices for the initial values.

%\ToDo{From \Cref{fig:CapAchievingDistr_i,fig:Rates_Capacity} we learned that achieving the largest possible data rate in the high-SNR regime requires a transmit current distribution with good coverage of both the disk boundary as well as the disk interior. Hence, adding load resistance to reach the disk interior is crucial.}

%\ToDo{At low SNR $C = I$ and $\gamma(s) = \exp( -s^2 - \SNR ) \, I_0( 2 s \sqrt{\SNR})$.}

\subsection{Optimal Number of Circles}
\label{sec:K}

We have yet to address the optimal number of circles $K \in \bbN$ for a given $\SNR$. The intervals where $K = 1,2,3$ are optimal are stated in \cite[Tab.~1]{ShamaiTIT1995} (please note that their $\SNR$ thresholds are $3\dB$ larger because they assumed an AWGN variance of $2$).
%
A very important fact is the optimality of $K = 1$ for $\SNR < 3.011$ or rather $\SNR < 4.8\dB$ (this threshold was originally determined by solving \cite[Eq.~(45)]{ShamaiTIT1995} numerically).
Beyond that, the optimal $K$ increases with $\SNR$ \cite{ShamaiTIT1995}.

\Cref{fig:Radii_PMF_evolution} shows how new circles emerge with increasing $\SNR$. For this numerical evaluation we iterated through a fine grid of increasing $\SNR$ values. For each $\SNR$ value, all $\Radius_k , \CircProb_k$ were optimized according to \Cref{eq:Capacity}, whereby their preceding values were used as initial values. We added a new smallest circle whenever this addition caused an appreciable rate increase. The associated numerical thresholds have a noticeable effect in the high-SNR regime, because there, parameter fine tuning of the innermost circles only causes rate changes near the floating point accuracy. In detail, we required that a new $K$-th circle must have probability $\CircProb_K \geq 0.003 \cdot \CircProb_{K-1}$ and must yield a rate increase larger than $100$ times the floating-point relative accuracy of Matlab ($2^{-52}$). %The optimized values then served as initial values for the next largest $\SNR$.
%In This evaluation  thresholds have a noticeable effect on the computed high-$\SNR$-thresholds for adding new circles. This is because, at high SNR, 

%We found that the rule of thumb $K \approx \lceil \sqrt{\SNR / 3} \,\rceil$ allows for a decent estimate. The circumferential probability densities $\f{\CircProb_k}{2\pi \Radius_k}$ are very similar for the inner circles but appreciably larger for the outmost circles (cf. \Cref{fig:CapAchievingDistr_i}).

\begin{figure}[t]
\centering
\subfloat[circle radii]{%
\resizebox{!}{55mm}{\input{CapacityAchievingCircles_Rad}}%
\put(-60,143){\scriptsize{$k \!=\! 1$}}%
\put(-77,78){\scriptsize{$k \!=\! 2$}}%
\put(-64,53){\scriptsize{$k \!=\! 3$}}%
\put(-44,41){\scriptsize{$...$}}%
\label{fig:Radii_evolution}%
}
\
\subfloat[circle probabilities]{%
\resizebox{!}{55mm}{\input{CapacityAchievingCircles_Prob}}%
\put(-48,118){\footnotesize{$\CircProb_1$}}%
\put(-64,53){\scriptsize{$\CircProb_2$}}%
\put(-48,39){\scriptsize{$\CircProb_3$}}%
\put(-37,32){\scriptsize{$...$}}%
\label{fig:PMF_evolution}%
}
\caption{Evolution of the radii and probabilities of the circles that describe the capacity-achieving transmit distribution.}
\label{fig:Radii_PMF_evolution}
\end{figure}

\begin{figure}[t]
\centering
%\includegraphics[width=.92\columnwidth]{Rates_CapacityResults-crop}
\resizebox{.96\columnwidth}{!}{\input{Rates_CapacityResults}}%
\caption{Channel capacity in bit per channel use (bpcu) plotted versus $\SNR$.} % ... could be attained by error-correcting codes ... sampled from ... with infinite block length
\label{fig:Rates_Capacity}
\end{figure}

\Cref{fig:Rates_Capacity} plots $\Rate$ versus $\SNR$ for different assumptions:
\begin{itemize}
\item \textbf{The capacity-achieving $K$ and $\Radius_k$, $\CircProb_k$ are used:} At high SNR, the additional circles inside the disk ensure that the transmit signal space is utilized thoroughly. %(cf. sphere packing).
This is achieved by purposefully raising the load resistance $\Re(z) \geq 0$.
\item \textbf{Only $K = 1$ is used:} This uniform-PSK $i \sim \calU(\calC_1)$ at the disk boundary is associated with a purely reactive load ($z = jx$), which is an interesting feature from a circuit perspective. The resulting information rate also constitutes the channel capacity of reactive load modulation. At high SNR, it lacks behind general passive load modulation, because the disk interior is not utilized.
\end{itemize}
For $\SNR < 4.8\dB$ the two cases coincide precisely, because then $K=1$ achieves capacity.
%the optimal number of circles $K$ is used and 2.) $K = 1$ is enforced, e.g. for technical reasons. 
%The second case uses just the largest circle with radius $\Radius_1$ (and $\CircProb_1 = 1$), hence no optimization must be conducted. In communications-engineering terms, this corresponds to $\infty$-PSK modulation. This case is attractive from a circuit perspective because it can be realized with a purely reactive load, i.e. $\Re(z) = 0$.

\subsection{Capacity-Achieving Load Impedance Statistics}
\label{sec:loadstats}

Herein we characterize the capacity-achieving distribution of the load impedance $z$, which follows from $z = \ChannelFunc^{-1}(i)$ together with the statistics of $i$ described in \Cref{sec:CurrentStats}.

The circle $\calC_1$ maps to the imaginary axis $j\bbR = \ChannelFunc^{-1}(\calC_1)$, i.e. to the set of purely reactive loads.
In detail, $i = \DiskRadius + \DiskRadius\, e^{j\phi}$ maps to $z = jx$ with
$x = -\tan(\phi / 2)$ and $\phi \sim \calU(-\pi,\pi)$. We find that $x$ has standard Cauchy distribution; the PDF is
% with location parameter $0$ and scale parameter $1$.
%In other words, the PDF is the simple Lorentzian function
\begin{align}
f_x(x) &= \f{1}{\pi(1 + x^2)} \, , &
x &\in \bbR \, . &
%z &= jx \, ,
\label{eq:Lorentz}
\end{align}
%which is shown in \Cref{fig:Lorentz}.
This is a complete description of the capacity-achieving load statistics in the low-SNR case (where $K = 1$ is optimal) or when a purely reactive load is enforced for technical reasons. The specific probability density evolution from \Cref{eq:Lorentz} can also seen along the imaginary axis in \Cref{fig:CapAchievingDistr_z}.

%\begin{figure}[!ht]
%\centering
%\resizebox{.7\columnwidth}{!}{\input{LorentzianPlot}}
%\caption{Capacity-achieving reactance statistics (standard Cauchy distribution) under a purely-reactive-load constraint $\Re(z) = 0$. At low SNR, this scheme achieves capacity even under the looser passive-load constraint $\Re(z) \geq 0$.}
%\label{fig:Lorentz}
%\end{figure}

The inner circles $\calC_k$ with $k \in \{2,\ldots,K\}$ map to circles $z \in \ChannelFunc^{-1}(\calC_k)$ with centers
$\f{\Radius_1^2 + \Radius_k^2}{\Radius_1^2 - \Radius_k^2} \in \bbR$
and radii
$\f{2 \Radius_1 \Radius_k}{\Radius_1^2 - \Radius_k^2}$.
In detail, a current phasor $i = \DiskRadius + \Radius_k\, e^{j\phi} \in \calC_k$ maps to
\begin{align}
z &= g^{-1}\left( i \right)
= \f{\Radius_1^2 + \Radius_k^2}{\Radius_1^2 - \Radius_k^2} + \f{2 \Radius_1 \Radius_k}{\Radius_1^2 - \Radius_k^2} \, e^{j(\theta + \pi)}
, \label{eq:z_from_s} \\
\theta &= 2 \arctan\left( \f{\sin\phi}{\Radius_k  / \Radius_1 + \cos\phi} \right) - \phi
\, . \label{eq:phi_from_phi}
\end{align}
%The relation between $\phi, \theta \in (-\pi,\pi]$ behaves as follows.
If $\Radius_k / \Radius_1 \ll 1$ then the approximate linearity $\theta \approx \phi$ holds.
If $\Radius_k / \Radius_1 \approx 1$ then $\theta$ is pushed towards zero.
Both properties can be observed in the high-SNR example in \Cref{fig:CapAchievingDistr_z}.
The distribution of $\theta|k$ is determined by \Cref{eq:phi_from_phi} and
$\phi \sim \calU(-\pi,\pi)$.%
%\footnote{To state the PDF of $\theta|k$, we first note that $\phi \mapsto \theta$ in \Cref{eq:phi_from_phi} is a monotonously increasing bijective map from and to $(-\pi,\pi]$.
%A change of variables yields
%$
%f_{\theta|k}(\theta|k)
%= f_{\phi}(\phi) \cdot |\fp{\phi}{\theta}|
%= \f{1}{2\pi} / \fp{\theta}{\phi}
%= \f{\Radius_k^2 + 2 \Radius_k \DiskRadius \cos(\phi) + \DiskRadius^2}{2\pi(\DiskRadius^2 - \Radius_k^2)}
%$
%after some rearrangements, an implicit formulation in terms of $\phi$. An explicit formulation is prohibited by the unavailability of the inverse map $\theta \mapsto \phi$ in closed form.}

%A change of variables and some rearrangements yield an implicit formulation of the PDF $f_\theta$ in terms of $\phi(\theta)$,
%\begin{align}
%f_{\theta}(\theta)
%= \f{\Radius_k^2 + 2 \DiskRadius \Radius_k \cos(\phi(\theta)) + \DiskRadius^2}{2\pi(\DiskRadius^2 - \Radius_k^2)} \, .
%\end{align}

% ... , i.e. $z$ is pushed towards $\f{\Radius_1 - \Radius_k}{\Radius_1 + \Radius_k}$.
% ... for most values of $\phi$ (unless $\phi$ is close to $\pm \pi$).
%Two interesting special points are
%$\phi =   0$ $\Longrightarrow$ $z = \f{\Radius_1 - \Radius_k}{\Radius_1 + \Radius_k}$ and
%$\phi = \pi$ $\Longrightarrow$ $z = \f{\Radius_1 + \Radius_k}{\Radius_1 - \Radius_k}$.

%\subsection{Sampling the Distribution}

To draw samples $Z\L$ from the capacity-achieving distribution, the following simple procedure suffices. Choose a circle $k$ according to the probabilities $\CircProb_k$ and draw a sample of the angle $\phi \sim \calU(-\pi,\pi)$. Compute $i = \DiskRadius + \Radius_k\, e^{j\phi}$, \mbox{$z = \ChannelFunc^{-1}(i)$}, and finally $Z\L = R\Tx \cdot z$. This way, a capacity-achieving codebook of load impedances $Z\L$ can be obtained.

\subsection{Upper Bound on the Capacity}

The effective constraint $|i - \DiskRadius|^2 \leq \DiskRadius^2$ of the peak-power type is obviously stricter than a constraint $\EV{|i - \DiskRadius|^2} \leq \DiskRadius^2$ of the average-power type. This inflicts the upper bound \cite{ShamaiTIT1995}
\begin{align}
\RateMax < \log_2(1 + \SNR).
\label{eq:UpperBound}
\end{align}
\Cref{fig:Rates_Capacity} shows that the bound is practically tight at low $\SNR$. Formally however, equality is ruled out by the following argument. By \cite[Appendix~B.4]{Tse2005}, equality would require a Gaussian $i \sim \mathcal{CN}(\DiskRadius, \DiskRadius^2)$ whose PDF support $\bbC \nsubseteq \Disk$ however violates the disk constraint \Cref{eq:Constraint}.

%To attain this bound, a Gaussian $i \sim \mathcal{CN}(\DiskRadius, \DiskRadius^2)$ would be necessary \cite[Appendix~B.4]{Tse2005}. However, because such $i$ could have any realization in $\bbC$, it would violate the disk condition \Cref{eq:Constraint} frequently. Therefore, equality is ruled out in \Cref{eq:UpperBound}. Still, \Cref{fig:Rates_Capacity} shows that the bound is practically tight at low $\SNR$.
