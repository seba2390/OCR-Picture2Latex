\begin{tikzpicture}
    [
    font=\small, >=stealth', line width=1pt, draw=black,
    block/.style={rectangle, draw, minimum height=5.5mm, minimum width=7mm, rounded corners},
    section/.style={circle, minimum size=7mm, draw=black},
    check/.style={rectangle, minimum height=6mm, minimum width=6mm, draw=black, fill=gray!20, rounded corners},
    trivialcheck/.style={rectangle, minimum height=4mm, minimum width=4mm, draw=black, fill=gray!20},
    section/.style={circle, minimum size=7mm, draw=black},
    ]

% Draw fancy boxes
\draw[draw=black, fill=white, densely dotted, rounded corners] (1.0, 4.0) rectangle (6.7, 6);
\node[draw=none, rotate=90] (binidlabel) at (0.75, 5) {Bin ID};
\draw[draw=black, fill=white, densely dotted, rounded corners] (1.0, -0.125) rectangle (6.875, 3.75);
\node[draw=none, rotate=90] (fig1subblocklabel) at (0.75, 1.8125) {Fig.~\ref{figure:EncodingProcess} Encoding};

% Stage 1: user's starting message block
\node[block](wj) at (0.5, 3.375) {$\mathbf{w}_j$};

% Stage 2: user's message fragments
\node[block, rotate=90](wjbin) at (1.5, 5.0) {$\mathbf{w}_j\left[1\mathpunct{:}w_0\right]$};
\draw[draw=black, fill=white, rounded corners] (1.25, 0) rectangle (1.75, 3.5);
\node[draw=none, rotate=90](wjmainlabel) at (1.5, 1.75) {$\mathbf{w}_j\left[w_0+1\mathpunct{:}w\right]$};

% Stage 1-2 connections
\draw[->,shorten >=0.5cm] (wj.east) -- (1.25, 5.0);
\draw[->,shorten >=0.5cm] (wj.east) -- (1.25, 2.0);

% Stage 3
\draw[draw=black, fill=white, rounded corners] (2.25, 0) rectangle (4.25, 3.5);
\node[draw=none, rotate=90] (ldpcenclabel) at (3.25, 1.75) {LDPC Encoder};

% % Stage 2-3 connections
\draw[->] (1.75, 3) -- (2.25, 3);
\draw[->] (1.75, 2.5) -- (2.25, 2.5);
\node[draw=none] (vdots231) at (2.0, 1.5) {$\vdots$};
\draw[->] (1.75, 0.5) -- (2.25, 0.5);
\draw[->, rounded corners] (wjbin.south) -- (3.25, 5.0) -- (3.25, 3.5);

% Stage 4
\node[block] (eg) at (5.75, 5.0) {$\mathbf{e}_g$};
\node[draw=none] (flabel) at (3.625, 5.25) {$f\left(\cdot\right)$};
\draw[draw=black, fill=white, rounded corners] (4.75, 0) rectangle (6.75, 3.5);
\node[draw=none, rotate=90] (csenclabel) at (5.75, 1.75) {CS Encoder};

% Stage 3-4 connections
\draw[->] (wjbin.south) -- (eg.west);
\draw[->] (4.25, 3) -- (4.75, 3);
\draw[->] (4.25, 2.5) -- (4.75, 2.5);
\node[draw=none] (vdots231) at (4.5, 1.5) {$\vdots$};
\draw[->] (4.25, 0.5) -- (4.75, 0.5);
\draw[->, rounded corners] (wjbin.south) -- (4.25, 5.0) -- (5.75, 4.25) -- (5.75, 3.5);
\node[draw=none] (aglabel) at (6.0, 4.25) {$\mathbf{A}_g$};

% Stage 5 
\node[block, rotate=90] (concat) at (7.5, 3.375) {concat};

% stage 4-5 connections
\draw[->, rounded corners] (eg.east) -- (7.5, 5.0) -- (concat.east);
\draw[->, rounded corners] (6.75, 1.75) -- (7.5, 1.75) -- (concat.west);

% Stage 6
\node[draw, circle] (MAC) at (8.5, 3.375) {$\Sigma$};

% Stage 5-6 connections
\draw[->] (concat.south) -- (MAC.west);
\draw[->] (8.5, 4.375) -- (MAC.north);
\node[draw=none] (awgn) at (8.5, 4.5) {$\mathbf{z}$};
\draw[->, rounded corners] (8.0, 2.2375) -- (8.0, 2.75) -- (MAC.south west);
\draw[->, rounded corners] (8.0, 4.375) -- (8.0, 4) --  (MAC.north west);
\draw[->] (MAC.south) -- (8.5, 1.5);
\node[draw=none] (ylabel) at (8.5, 1.25) {$\mathbf{y}$};


\end{tikzpicture}