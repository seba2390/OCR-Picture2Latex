\begin{tikzpicture}
  [
  font=\small, >=stealth', line width=1pt, draw=black,
  check/.style={rectangle, minimum height=6mm, minimum width=6mm, draw=black, fill=gray!20},
  trivialcheck/.style={rectangle, minimum height=4mm, minimum width=4mm, draw=black, fill=gray!20},
  section/.style={circle, minimum size=7mm, draw=black},
  trivialcheck/.style={rectangle, minimum height=4mm, minimum width=4mm},
  pmeblock/.style={rectangle, minimum height=6mm, minimum width=2mm},
  quantity/.style={rectangle, minimum height=9mm, minimum width=20mm, rounded corners, draw=black, fill=white, line width=1pt},
  psbox/.style={rectangle, minimum height=6mm, minimum width=75mm, rounded corners, draw=black, fill=white, line width=1pt}
  ]
  
% Draw appropriate boxes
\draw[draw=black, fill=white, densely dotted, rounded corners] (-4.0,-1.125) rectangle (4.125, 2.25);
\node[draw=none, rotate=-90](fglabel) at (4.375, 0.625) {LDPC Factor Graph};
\draw[draw=black, fill=white, densely dotted, rounded corners] (-4.0, -2.125) rectangle (4.125, -3.875);
\node[draw=none, rotate=-90](overallpmelabel) at (4.375, -3) {PME};

% Draw factor nodes
\node[draw=none] (fftlabel) at (-3.125, 1.7) {FFT-Based};
\node[draw=none] (fftlabel) at (-3.125, 1.3) {Factors};
\node[check](c1) at (-1.75, 1.5) {$a_1$};
\node[check](c2) at (0, 1.5) {$a_2$};
\node[check](c3) at (1.75, 1.5){$a_3$};

% Draw section nodes
\node[section](s1) at (-2.75, -0.5) {$s_1$};
\node[draw=none](dots) at (-1.375, -0.5) {$\ldots$};
\node[section](s_ell) at (0, -0.5) {$s_\ell$};
\node[draw=none](dots2) at (1.375, -0.5){$\ldots$};
\node[section](s3) at (2.75, -0.5) {$s_{L}$};

% Draw graph edges
\draw (c1.south) -- (s1.north);
\draw (c1.south) -- (s_ell.north);
\draw (c2.south) -- (s1.north);
\draw (c2.south) -- (s_ell.north);
\draw (c2.south) -- (s3.north);
\draw (c3.south) -- (s1.north);
\draw (c3.south) -- (s_ell.north);
\draw (c3.south) -- (s3.north);

% Draw graph edges
\draw[dashed] (c1.south) -- (-2,0.5);
\draw[dashed] (c1.south) -- (-1.75,0.5);
\draw[dashed] (c1.south) -- (-1.5,0.5);
\draw[dashed] (c1.south) -- (-1.25,0.5);
\draw[dashed] (c2.south) -- (-0.85,0.5);
\draw[dashed] (c2.south) -- (-0.55,0.5);
\draw[dashed] (c2.south) -- (-0.25,0.5);
% \draw[dashed] (c2.south) -- (0,0.5);
\draw[dashed] (c2.south) -- (0.25,0.5);
\draw[dashed] (c2.south) -- (0.55,0.5);
\draw[dashed] (c2.south) -- (0.85,0.5);
\draw[dashed] (c3.south) -- (1.25,0.5);
\draw[dashed] (c3.south) -- (1.5,0.5);
\draw[dashed] (c3.south) -- (1.75,0.5);
\draw[dashed] (c3.south) -- (2,0.5);


% Draw PME nodes
\node[quantity] (pme1label1) at (-2.55, -2.9) {};
\node[quantity] (pme1label2) at (-2.65, -3.0) {};
\node[quantity] (pme1label3) at (-2.75, -3.1) {$\hat{s}_g \left(\; \cdot \;, \; \cdot \;, \tau_t \right)$};

\node[quantity] (pme2label1) at (0.2, -2.9) {};
\node[quantity] (pme2label2) at (0.1, -3.0) {};
\node[quantity] (pme2label3) at (0, -3.1) {$\hat{s}_g \left(\; \cdot \;, \; \cdot \;, \tau_t \right)$};

\node[quantity] (pme3label1) at (2.95, -2.9) {};
\node[quantity] (pme3label2) at (2.85, -3.0) {};
\node[quantity] (pme3label3) at (2.75, -3.1) {$\hat{s}_g \left(\; \cdot \;, \; \cdot \;, \tau_t \right)$};

% Draw PME to section node edges
\draw[densely dashed] (s1) -- (pme1label1.north);
\draw[densely dashed] (s1) -- (pme1label2.north);
\draw[densely dashed] (s1) -- (pme1label3.north);
\draw[densely dashed] (s_ell) -- (pme2label1.north);
\draw[densely dashed] (s_ell) -- (pme2label2.north);
\draw[densely dashed] (s_ell) -- (pme2label3.north);
\draw[densely dashed] (s3) -- (pme3label1.north);
\draw[densely dashed] (s3) -- (pme3label2.north);
\draw[densely dashed] (s3) -- (pme3label3.north);

% Draw labels to various graph edges
\draw [->] (-2.85, 0) -- (-2.1, 1);
\node[draw=none, rotate=53] (mu_s_a) at (-2.65, 0.65) {$\muv_{s_1 \rightarrow a_1}$};
\draw [<-] (2.85, 0) -- (2.1, 1);
\node[draw=none, rotate=-53] (mu_a_s) at (2.65, 0.65) {$\muv_{a_3 \rightarrow s_{L}}$};

\draw[->] (-2.4, -1.25) -- node[right] {$\muv_{s_1}$} (-2.4, -2);
\draw[<-] (-2.95, -1.25) -- node[left] {$\lambdav_1$} (-2.95, -2);

\draw[->] (0.35, -1.25) -- node[right] {$\muv_{s_{\ell}}$} (0.35, -2);
\draw[<-] (-0.2, -1.25) -- node[left] {$\lambdav_{\ell}$} (-0.2, -2);

\draw[->] (3.1, -1.25) -- node[right] {$\muv_{s_L}$} (3.1, -2);
\draw[<-] (2.55, -1.25) -- node[left] {$\lambdav_L$} (2.55, -2);

% Draw inputs/outputs to each set of PMEs
\draw[<-,rounded corners] (-2.875, -3.625) -- (-2.875, -4.625) -- node[above,xshift=-1.5mm] {$\rv_g^{(t)}(1)$} (-3.75, -4.625);
\draw[->,rounded corners] (-2.625, -3.625) -- (-2.625, -4.75) -- node[below,xshift=-3.5mm] {$\sv_g^{(t+1)}(1)$} (-1.75, -4.75) -- (-1.75, -5.25);

\draw[<-,rounded corners] (-0.125, -3.625) -- (-0.125, -4.625) -- node[above,xshift=-1.5mm] {$\rv_g^{(t)}(\ell)$} (-1, -4.625);
\draw[->,rounded corners] (0.125, -3.625) -- (0.125, -4.75) -- node[below,xshift=-3.5mm] {$\sv_g^{(t+1)}(\ell)$} (1, -4.75) -- (1, -5.25);

\draw[<-,rounded corners] (2.625, -3.625) -- (2.625, -4.625) -- node[above,xshift=-2mm] {$\rv_g^{(t)}(L)$} (1.75, -4.625);
\draw[->,rounded corners] (2.875, -3.625) -- (2.875, -4.75) -- node[below,xshift=-4mm] {$\sv_g^{(t+1)}(L)$} (3.75, -4.75) -- (3.75, -5.25);

% Draw parallel-serial box 
% \node[psbox] (ps) at (0.1, -3.75) {Serial $\longleftrightarrow$ Parallel};

% Draw labels for PME/FG interactions
% \draw[->] (-0.1, -5.0) -- (-0.1, -4.25);
% \node[draw=none] (inputlabel) at (-0.50, -4.625) {$\mathbf{r}_g^{(t)}$};
% \draw[<-] (0.3, -5.0) -- (0.3, -4.25);
% \node[draw=none] (outputlabel) at (1.25, -4.625) {$\boldsymbol{\eta}_g^{(t)}\left(\mathbf{r}_g^{(t)}\right)$};
% \draw[->] (-0.2, -5.0) -- (-0.2, -4.25);
% \node[draw=none] (inputlabel) at (-0.60, -4.625) {$\mathbf{r}_g^{(t)}$};
% \draw[<-] (0.2, -5.0) -- (0.2, -4.25);
% \node[draw=none] (outputlabel) at (1.15, -4.625) {$\boldsymbol{\eta}_g^{(t)}\left(\mathbf{r}_g^{(t)}\right)$};

% JF Suggestions
% \draw[->] (s3.south) -- (2.5, -2.65);
% \draw (s3.south) -- (2.7, -2.25);
% \draw (s3.south) -- node[right] {$\qv_L$} (2.8, -2.15);
% \draw[->, rounded corners] (1.7, -4) -- (1.7, -3) -- node[left] {$\rv_L$} (1.7, -2) -- (s3);
% \draw[->, rounded corners] (1.7, -3.5) -- (2.85, -3.5) -- (2.85, -2.9);
% \draw[rounded corners] (1.7, -3.5) -- (2.95, -3.5) -- (2.95, -3.25);
% \draw[rounded corners] (1.7, -3.5) -- (3.05, -3.5) -- (3.05, -3.25);
%(2.85, -2.5);
% \draw[->] (2.85, -2) -- node[right] {$\rv_L$} (s3.south);
% Add input/output labels

% \draw[->] (-2.95, -4.5) -- (-2.95, -3.25);
% \node[draw=none] (rlabel) at (-3.25, -4) {$\rv_1^{(t)}$};

% \draw[<-] (-2.55, -4.5) -- (-2.55, -3.25);
% \node[draw=none] (etalabel) at (-1.85, -4) {$\boldsymbol{\eta}\left(\rv_1^{(t)}\right)$};

\end{tikzpicture}