%% LyX 2.3.7 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[letterpaper,twocolumn,english,prb,noeprint,nodoi]{revtex4-2}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{verbatim}
\usepackage{bm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
\pdfpageheight\paperheight
\pdfpagewidth\paperwidth


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage{braket}

\makeatother

\usepackage{babel}
\begin{document}
\title{Quantum mechanics of composite fermions}
\author{Junren Shi}
\email{junrenshi@pku.edu.cn}

\affiliation{International Center for Quantum Materials, Peking University, Beijing 100871, China}
\affiliation{Collaborative Innovation Center of Quantum Matter, Beijing 100871, China}
\begin{abstract}
We establish the quantum mechanics of composite fermions based on the dipole picture initially proposed by Read. It comprises three complimentary components: a wave equation for determining the wave functions of a composite fermion in ideal fractional quantum Hall states and when subjected to external perturbations, a wave function ansatz for mapping a many-body wave function of composite fermions to a physical wave function of electrons, and a microscopic approach for determining the effective Hamiltonian of the composite fermion. The wave equation resembles the ordinary Schr\"{o}dinger equation but has drift velocity corrections which are not present in the Halperin-Lee-Read theory. The wave-function ansatz constructs a physical wave function of electrons by projecting a state of composite fermions onto a half-filled bosonic Laughlin state of vortices. Remarkably, Jain's wave function ansatz can be reinterpreted as the new ansatz in an alternative wave-function representation of composite fermions. The dipole model and the effective Hamiltonian can be derived from the microscopic model of interacting electrons confined in a Landau level, with parameters fully determined. In this framework, we can construct the physical wave function of a fractional quantum Hall state deductively by solving the wave equation and applying the wave function ansatz, based on the effective Hamiltonian derived from first principles, rather than relying on intuitions or educated guesses. For ideal fractional quantum Hall states in the lowest Landau level, the approach yields physical wave functions identical to those prescribed by the standard theory of composite fermions. We further demonstrate that the reformulated theory of composite fermions can be easily generalized for flat Chern bands.
\end{abstract}
\maketitle

\section{Introduction}

Exotic correlated states of electrons emerge in fractional quantum Hall systems, where strong magnetic fields completely quench the kinetic energy of electrons, rendering conventional many-body techniques inadequate in addressing the effects of correlations between electrons~\citep{tsui1982}. The theory of composite fermions, proposed by Jain in 1989, offers a comprehensive framework for understanding these exotic states~\citep{jain2007}. It introduces a new paradigm, interpreting correlated states of electrons as non-correlated or weakly-correlated states of fictitious particles called composite fermions, which are assumed to be the bound states of electrons and quantum vortices. Based on the insight, the theory prescribes an ansatz for constructing many-body wave functions that achieve nearly perfect overlaps with those determined by exact diagonalizations for various fractional quantum Hall states in the lowest Landau level~\citep{jain1997}. On the other hand, for predicting the responses of these states to external perturbations, one usually employs the effective theory proposed by Halperin, Lee and Read (HLR)~\citep{halperin1993}, which has been shown to make predictions that align well with experimental observations~\citep{heinonen1997}. The two components of the theory, namely the wave function ansatz and the effective theory, complement each other, forming a versatile framework for understanding the rich physics of the fractional quantum Hall systems.

Despite the remarkable success, the theory still lacks a concrete foundation. On the one hand, one usually relies on intuitions or educated guesses when constructing composite fermion wave functions. This is in sharp contrast to the usual practice when dealing with weakly correlated electrons, for which one can confidently write down a Hamiltonian, and obtain wave functions by solving the Schrödinger equation. On the other hand, the conjecture of the HLR theory \textemdash{} a composite fermion also follows the ordinary Schrödinger equation \textemdash{} is only justified heuristically. Lopez-Fradkin's theory~\citep{lopez1991} is often cited as the rationale behind both the wave function ansatz and the effective theory. However, the theory can only be viewed as a tentative argument rather than a rigorous foundation for the theory of composite fermions due to two obvious issues. 

Firstly, Jain's ansatz prescribes wave-functions of electrons in the form~\citep{jain1997}
\begin{equation}
\Psi\left(\left\{ z_{i}\right\} \right)=\hat{P}_{\mathrm{LLL}}J\left(\left\{ z_{i}\right\} \right)\tilde{\Psi}_{\mathrm{CF}}\left(\left\{ \bm{z}_{i}\right\} \right),\label{eq:Psistd}
\end{equation}
which differs from the form suggested by Lopez-Fradkin's theory based on the singular Chern-Simons (CS) transformation~\citep{lopez1991}
\begin{equation}
\Psi\left(\left\{ \bm{z}_{i}\right\} \right)=\frac{J\left(\left\{ z_{i}\right\} \right)}{\left|J\left(\left\{ z_{i}\right\} \right)\right|}\tilde{\Psi}_{\mathrm{CF}}\left(\left\{ \bm{z}_{i}\right\} \right),\label{eq:CFCS}
\end{equation}
where $\Psi$ and $\tilde{\Psi}_{\mathrm{CF}}$ represent the wave function of electrons and composite fermions, respectively, 
\begin{equation}
J\left(\left\{ z_{i}\right\} \right)\equiv\prod_{i<j}\left(z_{i}-z_{j}\right)^{2}\label{eq:Jastrow}
\end{equation}
is the Bijl-Jastrow factor which presumably attaches a vortex with two flux quanta to each electron, $\hat{P}_{\mathrm{LLL}}$ is the projection operator to the lowest-Landau-level, and $\{\bm{z}_{i}\equiv(x_{i},y_{i})\}$ and $\{z_{i}\equiv x_{i}+\mathrm{i}y_{i}\}$ denote the coordinates of electrons in the vector and complex forms, respectively. Equation (\ref{eq:CFCS}) is formulated in the full Hilbert space of free electrons while Eq.~(\ref{eq:Psistd}) is defined in the restricted Hilbert space of a single Landau level. Reconciling the two is non-trivial~\citep{murthy2003}.

Secondly, the picture of composite fermions implied by Lopez-Fradkin's theory, which is also inherited by the HLR theory, differs from that obtained by directly inspecting the ansatz wave function Eq.~(\ref{eq:Psistd}). For the latter, Read's analysis indicates that the electron and the vortex in a composite fermion are spatially separated~\citep{read1994}. The finding contradicts the picture implied by Eq.~(\ref{eq:CFCS}), which suggests that a composite fermion is a point particle, consisting of an electron and $\delta$-function flux tubes. More recently, Son points out that the HLR theory lacks the particle-hole symmetry~\citep{son2015}, whereas the ansatz wave function is shown to preserve the symmetry well~\citep{balram2016}. These observations raise doubts about whether the HLR theory accurately describes the composite fermions implied by the ansatz wave function. It prompts the need for an alternative effective theory, or ideally, an alternative foundation from which both the wave-function ansatz and the effective theory can be inferred.

The dipole picture of composite fermions, initially proposed by Read, offers an alternative picture for the fictitious particle~\citep{read1994,rezayi1994}. The picture differs from the HLR view in two fundamental ways. Firstly, instead of being a point particle, the composite fermion has a dipole structure with the electron and vortex spatially separated. Secondly, the electron and the vortex are confined in two separated Landau levels created by the physical magnetic field and an emergent CS magnetic field, respectively, as opposed to moving in a free space~\citep{shi2017,shi2018}. The dipole picture is shown to yield low-energy and long-wavelength electromagnetic responses that are identical to those predicted by the Dirac theory of composite fermions~\citep{ji2021}, indicating that it satisfies the general requirements of particle-hole symmetry. The feature, along with the fact that the picture is inferred directly from microscopic wave functions, set it apart from other alternatives.

Pasquier and Haldane investigate the dipole picture of a system of bosons in an isolated Landau level at filling factor one~\citep{pasquier1998}. Their work, along with subsequent developments by other researchers~\citep{read1998,dong2020,gocanin2021}, sheds light on the construction of physical wave functions. They propose interpreting vortices as auxiliary degrees of freedom that extend the physical Hilbert space to a larger Hilbert space of composite fermions. To obtain a physical state from a state of composite fermions in the enlarged Hilbert space, one must eliminate the auxiliary degrees of freedom by projecting the state into a physical subspace defined by a pure state of the vortices. In this context, the Bijl-Jastrow factor is interpreted as the complex conjugate of the wave function of the vortex state, rather than the numerator of the singular gauge factor in Eq.~(\ref{eq:CFCS}). The interpretation naturally leads to a wave function ansatz alternative to Eq.~(\ref{eq:Psistd}), and avoids the difficulties associating with the singular CS transformation~\citep{read1998}.

In this paper, we present a theory of quantum mechanics for composite fermions based on the dipole picture and Pasquier-Haldane's interpretation. The theory comprises three complimentary components: a wave equation for determining the wave functions of a composite fermion in ideal fractional quantum Hall states and when subjected to external perturbations, a wave function ansatz for mapping a many-body wave function of composite fermions to a physical wave function of electrons, and a microscopic approach for determining the effective Hamiltonian of the composite fermion. In our theory, the state of a composite fermion is represented by a bivariate wave function that is holomorphic (anti-holomorphic) in the coordinate of its constituent electron (vortex), and is defined in a Bergman space with a weight determined by the spatial profiles of the physical and the emergent Chern-Simons magnetic fields. The wave equation is derived from the phenomenological dipole model proposed in Ref.~\onlinecite{ji2021} by applying the rules of quantization in the Bergman space. It resembles the ordinary Schr\"{o}dinger equation but has drift velocity corrections which are not present in the HLR theory. The wave-function ansatz constructs a physical wave function of electrons by projecting a state of composite fermions onto a half-filled bosonic Laughlin state of vortices. Remarkably, Jain's wave function ansatz, which underlies the success of the theory of composite fermions, can be recast to the form of the new ansatz using an alternative wave-function representation for composite fermions. The phenomenological dipole model can be derived from the microscopic model of interacting electrons confined in a Landau level by applying a Hartree-like approximation, with its parameters determined from first principles. In this framework, we can construct the physical wave function of a fractional quantum Hall state deductively by solving the wave equation and applying the wave function ansatz, rather than relying on intuitions or educated guesses. We further demonstrate that the reformulated theory of composite fermions can be easily generalized for flat Chern bands, which are also predicted to host fractional quantum Hall states~\citep{parameswaran2013,bergholtz2013}.

The remainder of the paper is organized as follows. In Sec.~\ref{sec:Ideal-systems-of}, we develop the quantum mechanics of composite fermions for ideal fractional quantum Hall systems which are subject only to uniform magnetic fields. In Sec.~\ref{sec:General-theory}, the quantum mechanics of composite fermions is established for general physical circumstances when systems are subject to non-uniform external electromagnetic fields and have inhomogeneous densities. In Sec.~\ref{sec:Derivation-of-the}, we provide a microscopic underpinning for our theory by deriving the phenomenological dipole model from the microscopic Hamiltonian of interacting electrons confined in a Landau level. In Sec.~\ref{sec:Generalization-for-flat}, we generalize and apply our approach to flat Chern bands. In Sec.~\ref{sec:Summary-and-discussion}, we summarize and discuss our results. Certain details of derivations are presented in Appendices.

\section{Theory for ideal systems \label{sec:Ideal-systems-of}}

In this section, we develop the quantum mechanics of composite fermions in systems that are subject only to uniform external magnetic fields and have homogeneous densities. We will establish a new wave function ansatz and a set of wave equations for composite fermions. Remarkably, the standard wave function ansatz Eq.~(\ref{eq:Psistd}), which underlies the success of the composite fermion theory, can be shown to be equivalent to the new ansatz. With the theory, the state of composite fermions can be determined by solving the wave equations, and the wave function of electrons can be obtained by applying the new ansatz. The principles established in this section will also serve as the foundation for developing a general theory.

\subsection{Hilbert space \label{subsec:Segal-Bargmann-space}}

The Hilbert space of a composite fermion in the dipole picture is not that of an ordinary quantum particle in a free space as assumed in the HLR theory. This is obvious in light of the dipole model illustrated in Fig.~\ref{fig:CFdipolemodel_FQH}. According to the model, a composite fermion consists of an electron and a vortex confined in two separated Landau levels, one for the electron is the Landau level created by the uniform physical magnetic field $\bm{B}=-B\bm{n}$, another for the vortex is a fictitious Landau level created by an emergent CS magnetic field $\bm{b}=b\bm{n}$ with its strength determined by the CS self-consistent condition $b=(2h/e)\rho_{0}$, where $\rho_{0}$ is the density of electrons, and $\bm{n}$ denotes the normal vector of the two-dimensional plane of the system. The Hilbert space of such a composite fermion is the tensor product of two Hilbert spaces with respect to the two Landau levels.

\begin{figure}
\includegraphics{CFdipolemodel_FQH}

\caption{\label{fig:CFdipolemodel_FQH}Dipole model of a composite fermion. It consists of an electron (black) and a vortex (gray). The electron is confined in the Landau level created by the physical magnetic field $\bm{B}$, while the vortex belongs to a bosonic fluid of vortices in the $\nu=1/2$ Laughlin state. Under the mean-field approximation, the vortex is considered as an independent particle confined in a Landau level created by the CS magnetic field $\bm{b}$. The electron and the vortex are bound together by a binding potential which can be modeled as the harmonic potential Eq.~(\ref{eq:Vbound}) for the lowest Landau level.}
\end{figure}

The Hilbert space spanned by a Landau level is a weighted Bergman space~\citep{girvin1984,rohringer2003}. For a disc geometry, the space includes all holomorphic polynomials in the complex electron coordinate $z=x+\mathrm{i}y$. The inner product between two states $\psi_{1}(z)$ and $\psi_{2}(z)$ in the space is defined by $\braket{\psi_{1}|\psi_{2}}=\int\mathrm{d}\mu_{B}^{(0)}(\bm{z})\psi_{1}^{\ast}(z)\psi_{2}(z)$ with the integral measure
\begin{equation}
\mathrm{d}\mu_{B}^{(0)}(\bm{z})\equiv\frac{\mathrm{d}\bm{z}}{2\pi l_{B}^{2}}e^{-\left|z\right|^{2}/2l_{B}^{2}},
\end{equation}
where $l_{B}=\sqrt{eB/\hbar}$ is the magnetic length of $B$. A Bergman space with the Gaussian weight is also known as the Segal-Bargmann space~\citep{hall1999}.

The Hilbert space of a vortex is also a Segal-Bargmann space consisting of all anti-holomorphic polynomials in the complex conjugated vortex coordinate $\bar{\eta}=\eta_{x}-\mathrm{i}\eta_{y}$, where $\eta_{x}$ and $\eta_{y}$ are the Cartesian components of the vortex coordinate $\bm{\eta}\equiv(\eta_{x},\eta_{y})$. Note that because the direction of the $b$-field is opposite to that of the $B$-field, wave functions for the vortex are anti-holomorphic functions. The corresponding integral measure is
\begin{equation}
\mathrm{d}\mu_{b}^{(0)}(\bm{\eta})\equiv\frac{\mathrm{d}\bm{\eta}}{2\pi l_{b}^{2}}e^{-\left|\eta\right|^{2}/2l_{b}^{2}},
\end{equation}
where $l_{b}=\sqrt{eb/\hbar}$ is magnetic length of $b$.

The Hilbert space of a composite fermion is the tensor product of the two Segal-Bargmann spaces for the electron and the vortex, respectively. The state of a composite fermion in the dipole picture is thus naturally described by a bivariate function:
\begin{equation}
\psi(z,\bar{\eta}),\label{eq:bvhwf}
\end{equation}
that is holomorphic (anti-holomorphic) in the complex coordinate $z$ ($\bar{\eta}$) of the electron (vortex). Unlike a wave function $\psi(\bm{z})\equiv\psi(\bar{z},z)$ for an ordinary particle, the two coordinates of the wave function Eq.~(\ref{eq:bvhwf}) belong to different particles.

For a Bergman space, we can define a reproducing kernel, which is basically the coordinate representation of the identity operator of the space~\citep{hall1999}. For the spaces of the electron and the vortex, their reproducing kernels $K_{B}^{(0)}(z,\bar{z}^{\prime})$ and $K_{b}^{(0)}(\bar{\eta},\eta^{\prime})$ are
\begin{align}
K_{B}^{(0)}(z,\bar{z}^{\prime}) & =e^{z\bar{z}^{\prime}/2l_{B}^{2}},\label{eq:KB0}\\
K_{b}^{(0)}(\bar{\eta},\eta^{\prime}) & =e^{\bar{\eta}\eta^{\prime}/2l_{b}^{2}},\label{eq:Kb0}
\end{align}
respectively. As the identity operators of the respective Segal-Bargmann spaces, the kernels have the properties
\begin{align}
\psi(z) & =\int\mathrm{d}\mu_{B}^{(0)}(\bm{z}^{\prime})K_{B}^{(0)}(z,\bar{z}^{\prime})\psi(z^{\prime}),\label{eq:reproduceB}\\
\varphi(\bar{\eta}) & =\int\mathrm{d}\mu_{b}^{(0)}(\bm{\eta}^{\prime})K_{b}^{(0)}(\bar{\eta},\eta^{\prime})\varphi(\bar{\eta}^{\prime}),\label{eq:reproduceb}
\end{align}
for arbitrary holomorphic functions $\psi(z)$ and anti-holomorphic functions $\varphi(\bar{\eta})$. 

The kernels can also serve as projection operators for projecting non-holomorphic functions into the Segal-Bergmann spaces~\citep{hall1999}. Actually, $\hat{P}_{\mathrm{LLL}}$ in Eq.~(\ref{eq:Psistd}), the projection operator to the lowest Landau level, can be written as an integral form using the reproducing kernel:
\begin{equation}
\hat{P}_{\mathrm{LLL}}f\left(\bm{z}\right)\equiv\int\mathrm{d}\mu_{B}^{(0)}(\bm{z}^{\prime})K_{B}^{(0)}(z,\bar{z}^{\prime})f\left(\bm{z}^{\prime}\right),\label{eq:projection}
\end{equation}
where $f(\bm{z})$ is shorthand notation of a non-holomorphic function $f(\bar{z},z)$. We will use the notations interchangeably in this paper. The projection operator into the $\eta$-space can be defined similarly using the reproducing kernel $K_{b}^{(0)}(\bar{\eta},\eta^{\prime})$.

\subsection{Wave function ansatz \label{subsec:Wave-function-ansatz-1}}

The wave function ansatz Eq.~(\ref{eq:Psistd}) maps a many-body wave function in the fictitious world of composite fermions to a physical wave function of interacting electrons in the real world. Although the ansatz is customarily expressed in a form that suggests its connection with the singular CS transformation Eq.~(\ref{eq:CFCS}), it can actually be more naturally linked to the dipole picture, as we will demonstrate in this subsection. 

Pasquier and Haldane presented an alternative approach of constructing the many-body wave functions of fractional quantum Hall states~\citep{pasquier1998}. The approach was further developed by Read~\citep{read1998} and Dong and Senthil~\citep{dong2020}. They investigate a system of bosons at filling factor one. Vortices of one flux quantum, which are fermions, are introduced as auxiliary degrees of freedom for extending the physical Hilbert space of bosons to a Hilbert space of composite fermions. It is envisioned that in the enlarged Hilbert space, it may become feasible to apply the mean-field approximations for the composite fermions. To obtain physical wave functions, on the other hand, one needs to eliminate auxiliary degrees of freedom by projecting states of composite fermions into a physical subspace. This leads to a relation between a wave function of composite fermions $\Psi_{\mathrm{CF}}(\{z_{i},\bar{\eta}_{i}\})$ and its physical counterpart $\Psi(\{z_{i}\})$~\citep{read1998}:
\begin{align}
\Psi(\{z_{i}\}) & =\hat{P}_{\mathrm{v}}\Psi_{\mathrm{CF}}(\{z_{i},\bar{\eta}_{i}\})\label{eq:PsiCFtoPsi-0}\\
 & \equiv\int\prod_{i}\mathrm{d}\mu_{b}^{(0)}(\bm{\eta}_{i})\Psi_{\mathrm{v}}^{\ast}(\{\bar{\eta}_{i}\})\Psi_{\mathrm{CF}}(\{z_{i},\bar{\eta}_{i}\}),\label{eq:PsiCFtoPsi}
\end{align}
where $\Psi_{\mathrm{v}}(\{\bar{\eta}_{i}\})$ is the wave function of a vortex state that defines the physical subspace in the enlarged Hilbert space, and $\hat{P}_{\mathrm{v}}$ denotes the projection into the subspace. For a system of bosons, the vortex state is assumed to be a $\nu=1$ incompressible state of fermions with $\Psi_{\mathrm{v}}(\{\bar{\eta}_{i}\})=\prod_{i<j}(\bar{\eta}_{i}-\bar{\eta}_{j})$. The corresponding physical wave function describes a Fermi-liquid like state of bosons.

The general idea of Pasquier-Haldane-Read's approach can be adapted for a system of electrons. We can introduce vortices of two flux quanta, which are bosons, as the auxiliary degrees of freedom. We assume that the vortices form a $\nu=1/2$ bosonic Laughlin state with the wave function
\begin{equation}
\Psi_{\mathrm{v}}\left(\left\{ \bar{\eta}_{i}\right\} \right)=J^{\ast}\left(\left\{ \eta_{i}\right\} \right).\label{eq:PsiB}
\end{equation}
By substituting the vortex wave function into Eq.~(\ref{eq:PsiCFtoPsi}), we obtain an ansatz for constructing physical wave functions of electrons:
\begin{equation}
\Psi\left(\left\{ z_{i}\right\} \right)=\int\prod_{i}\mathrm{d}\mu_{b}^{(0)}(\bm{\eta}_{i})J\left(\left\{ \eta_{i}\right\} \right)\Psi_{\mathrm{CF}}\left(\left\{ z_{i},\bar{\eta}_{i}\right\} \right).\label{eq:wfansatzdp}
\end{equation}

Remarkably, the standard (Jain's) ansatz Eq.~(\ref{eq:Psistd}) can be recast to the form of the new ansatz. To see this, we express Eq.~(\ref{eq:Psistd}) in an integral form by using Eq.~(\ref{eq:projection}):
\begin{align}
\Psi(\{z_{i}\})= & \int\prod_{i}\mathrm{d}\mu_{B}^{(0)}(\bm{\xi}_{i})e^{\sum_{i}z_{i}\bar{\xi}_{i}/2l_{B}^{2}}J(\{\xi_{i}\})\tilde{\Psi}_{\mathrm{CF}}(\{\bm{\xi}_{i}\})\nonumber \\
= & \int\prod_{i}\mathrm{d}\mu_{b}^{(0)}(\bm{\eta}_{i})J(\{\eta_{i}\})\int\prod_{i}\mathrm{d}\mu_{B}^{(0)}(\bm{\xi}_{i})\nonumber \\
 & \times e^{\sum_{i}(z_{i}\bar{\xi}_{i}/2l_{B}^{2}+\bar{\eta}_{i}\xi_{i}/2l_{b}^{2})}\tilde{\Psi}_{\mathrm{CF}}(\{\bm{\xi}_{i}\}).\label{eq:ansatzderiv}
\end{align}
where we insert the reproducing kernel Eq.~(\ref{eq:Kb0}) for each of the composite fermions. Comparing it with the new ansatz Eq.~(\ref{eq:wfansatzdp}), we have
\begin{multline}
\Psi_{\mathrm{CF}}\left(\left\{ z_{i},\bar{\eta}_{i}\right\} \right)=\int\prod_{i}\mathrm{d}\mu_{B}^{(0)}\left(\bm{\xi}_{i}\right)\\
\times e^{\sum_{i}\left(z_{i}\bar{\xi}_{i}/2l_{B}^{2}+\xi_{i}\bar{\eta}_{i}/2l_{b}^{2}\right)}\tilde{\Psi}_{\mathrm{CF}}\left(\left\{ \bm{\xi}_{i}\right\} \right).\label{eq:transformPsiCF}
\end{multline}
We see that the two ansatze are equivalent but use different wave-function representations for a state of composite fermions. In the following, we will call $\Psi_{\mathrm{CF}}$ and $\tilde{\Psi}_{\mathrm{CF}}$ as wave functions in the dipole representation and the standard representation, respectively. 

\subsection{Wave equation: the dipole representation \label{subsec:Wave-equation}}

The theory of composite fermions usually relies on intuitions or educated guesses when constructing wave functions. For examples, one assumes $\tilde{\Psi}_{\mathrm{CF}}$ to be a Slater determinant of the single-particle orbits of one or more fully occupied Landau ($\Lambda$) for a fractional quantum Hall state~\citep{jain2007}, or a Slater determinant of plane-wave states occupying a Fermi sea for a composite Fermi liquid state at half-filling~\citep{rezayi1994}. While these choices can be justified a posteriori by high overlaps between ansatz wave functions and wave functions obtained from exact diagonalizations~\citep{jain1997}, it is desirable to determine and justify a priori appropriate wave functions of composite fermions for given physical conditions, as one always does for ordinary electron systems when solving the Schr\"{o}dinger equation. In this subsection, we take a first step to achieve this by developing a wave equation for composite fermions in an ideal system. 

Our development is based on the semi-classical phenomenological model of composite fermions introduced in Ref.~\onlinecite{ji2021}. As illustrated in Fig.~\ref{fig:CFdipolemodel_FQH}, a composite fermion is assumed to be a bound state of an electron and a $2h/e$ double quantum vortex confined in two separated Landau levels. They are bounded by a binding potential which is assumed to be a harmonic one:
\begin{equation}
T=\frac{\hbar^{2}}{2m^{\ast}l_{B}^{2}l_{b}^{2}}\left|\bm{z}-\bm{\eta}\right|^{2},\label{eq:Vbound}
\end{equation}
where $\bm{z}$ and $\bm{\eta}$ are the coordinates of the electron and the vortex, respectively, and $l_{B}$ and $l_{b}$ are the magnetic lengths of the physical and the CS magnetic fields, respectively. By interpreting the momentum of a composite fermion to be $\bm{p}=\hbar\bm{n}\times(\bm{z}-\bm{\eta})/l_{B}^{2}$~\citep{read1994}, the binding potential becomes the kinetic energy of the composite fermion: $T=(l_{B}^{2}/l_{b}^{2})\left|\bm{p}\right|^{2}/2m^{\ast}$, where the effective mass of the composite fermion $m^{\ast}\equiv m^{\ast}(\nu,B)$ is a function of the filling factor $\nu$ and $B$. The $l_{B}^{2}/l_{b}^{2}$ factor in the kinetic energy is a peculiarity of the model. It is a result of the density-of-states correction~\citep{xiao2005} for a composite fermion which is subject to a uniform Berry curvature in its momentum space~\citep{shi2017,shi2018,ji2020b}. It is found in Ref.~\onlinecite{ji2021} that to satisfy the requirement of the particle-hole symmetry in a Landau level, one needs to introduce such a factor when the $\nu$-dependence of the effective mass is assumed to be symmetric about $\nu=1/2$. The presence of such a factor will become evident in Sec.~\ref{subsec:Energy} when the phenomenological model is derived from an underlying microscopic model.

By quantizing the semi-classical model, we can establish a wave equation for the composite fermion. For a free composite fermion, its Hamiltonian is just the binding potential Eq.~(\ref{eq:Vbound}). Acting on a wave function $\psi(z,\bar{\eta})$ is defined by,
\begin{equation}
\left[\hat{H}\psi\right]\left(z,\bar{\eta}\right)\equiv\hat{P}H\left(\bm{z},\bm{\eta}\right)\psi\left(z,\bar{\eta}\right),\label{eq:Hpsi}
\end{equation}
with $H(\bm{z},\bm{\eta})\equiv T(\bm{z},\bm{\eta})$ and $\hat{P}$ denoting the projection into the Hilbert space of the composite fermion defined in Sec.~\ref{subsec:Segal-Bargmann-space}. According to the rule of the projection into Landau levels, $\bar{z}$ and $\eta$ should be interpreted as operators $\hat{\bar{z}}\equiv2l_{B}^{2}\partial_{z}$ and $\hat{\eta}\equiv2l_{b}^{2}\partial_{\bar{\eta}}$, respectively~\citep{jain2007}. The stationary-state wave equation of the composite fermion can then be written as:
\begin{equation}
\epsilon\psi(z,\bar{\eta})=-\frac{\hbar^{2}}{2m^{\ast}}\left(2\partial_{z}-\frac{\bar{\eta}}{l_{B}^{2}}\right)\left(2\partial_{\bar{\eta}}-\frac{z}{l_{b}^{2}}\right)\psi(z,\bar{\eta}),\label{eq:cfweq}
\end{equation}
where an unimportant constant term in the Hamiltonian due to the order of operators is ignored, and $\epsilon$ is the eigen-energy.

The wave equation can also be derived from the variational principle $\delta L=0$ with the Lagrangian defined by
\begin{equation}
L=\int\mathrm{d}\mu_{B}^{(0)}(\bm{z})\mathrm{d}\mu_{b}^{(0)}(\bm{\eta})\left[\epsilon-T(\bm{z},\bm{\eta})\right]\left|\psi(z,\bar{\eta})\right|^{2},
\end{equation}
where $\epsilon$ serves as the Lagrange multiplier for the normalization constraint of the wave function
\begin{equation}
\int\mathrm{d}\mu_{B}^{(0)}(\bm{z})\int\mathrm{d}\mu_{b}^{(0)}(\bm{\eta})\left|\psi\left(z,\bar{\eta}\right)\right|^{2}=1.\label{eq:normalization}
\end{equation}
Differentiating the Lagrangian with respect to $\psi^{\ast}(z,\bar{\eta})$ gives rise to the wave equation. Note that $\int\mathrm{d}\mu_{B}^{(0)}(\bm{z})\mathrm{d}\mu_{b}^{(0)}(\bm{\eta})\delta\psi^{\ast}(z,\bar{\eta})F(\bm{\xi},\bm{\eta})=0$ for $\delta\psi^{\ast}(z,\bar{\eta})$ varying in the Segal-Bargmann space implies $\hat{P}F(\bm{\xi},\bm{\eta})=0$. 

By applying the transformation 
\begin{equation}
\psi(z,\bar{\eta})=\sqrt{2\pi}l_{B}\exp\left[\frac{1}{4}\left(\frac{1}{l_{B}^{2}}+\frac{1}{l_{b}^{2}}\right)z\bar{\eta}\right]\varphi(z,\bar{\eta}),\label{eq:psivarphi}
\end{equation}
we can transform the wave equation to a form resembling the ordinary Schrödinger equation for a charged particle in a uniform magnetic field. The wave equation for $\varphi(\bm{\xi})=\varphi(z,\bar{\eta})|_{z\rightarrow\xi,\bar{\eta}\rightarrow\bar{\xi}}$ takes the form: 
\begin{equation}
\epsilon\varphi(\bm{\xi})=-\frac{\hbar^{2}}{2m^{\ast}}\left(2\partial_{\xi}-\frac{\sigma\bar{\xi}}{2l^{2}}\right)\left(2\partial_{\bar{\xi}}+\frac{\sigma\xi}{2l^{2}}\right)\varphi(\bm{\xi}),\label{eq:cfweq1}
\end{equation}
with $l=\sqrt{\hbar/e|\mathcal{B}|}$ being the magnetic length of the effective magnetic field $\mathcal{B}=B-b$, and $\sigma=\mathrm{sgn}(\mathcal{B})$ indicating the direction of the effective magnetic field $\bm{\bm{\mathcal{B}}}=-\mathcal{B}\bm{n}$.

\subsection{Wave equation: the standard representation \label{subsec:Wave-equation:-the-1}}

We can also have a wave equation for wave functions in the standard representation. In the case of non-interacting composite fermions, both $\Psi_{\mathrm{CF}}$ and $\tilde{\Psi}_{\mathrm{CF}}$ are Slater determinants of single-particle wave functions. To fulfill the relation Eq.~(\ref{eq:transformPsiCF}), the single-particle wave functions in the two representations should be related by:
\begin{equation}
\psi\left(z,\bar{\eta}\right)=\int\mathrm{d}\mu_{B}^{(0)}\left(\bm{\xi}\right)e^{z\bar{\xi}/2l_{B}^{2}+\xi\bar{\eta}/2l_{b}^{2}}\tilde{\psi}\left(\bm{\xi}\right),\label{eq:transformpsiCF}
\end{equation}
where $\tilde{\psi}(\bm{\xi})$ denotes a single-particle wave function in the standard representation. Substituting it into Eq.~(\ref{eq:cfweq}), we obtain the wave equation (see Appendix \ref{subsec:Ideal-systems-operators})

\begin{equation}
\epsilon\tilde{\varphi}(\bm{\xi})=-\frac{\hbar^{2}}{2m^{\ast}}\left(2\partial_{\xi}-\frac{\sigma\bar{\xi}}{2l^{2}}\right)\left(2\partial_{\bar{\xi}}+\frac{\sigma\xi}{2l^{2}}\right)\tilde{\varphi}(\bm{\xi}),\label{eq:cfweqstd}
\end{equation}
and 
\begin{equation}
\tilde{\psi}(\bm{\xi})=\sqrt{2\pi}l_{B}\exp\left(\sigma\frac{\left|\xi\right|^{2}}{2l^{2}}\right)\tilde{\varphi}(\bm{\xi}).\label{eq:psitildevarphitilde}
\end{equation}
We see that the wave equation for $\tilde{\varphi}(\bm{\xi})$ is just the ordinary Schrödinger equation for a charge particle in a uniform effective magnetic field. The solutions of the equation, i.e., Landau ($\Lambda$) orbits in the effective magnetic field, are exactly the composite fermion wave functions adopted by the standard ansatz for constructing the wave functions of the ideal FQH states (see Appendix \ref{appendix:-levels-of-the}).

Using Eq.~(\ref{eq:transformpsiCF}), we can write the orthonormal condition $\int\mathrm{d}\mu_{B}^{(0)}(\bm{z})\int\mathrm{d}\mu_{b}^{(0)}(\bm{\eta})\psi_{i}^{\ast}(z,\bar{\eta})\psi_{j}(z,\bar{\eta})=\delta_{ij}$ as:
\begin{equation}
\int\mathrm{d}\bm{\xi}~\tilde{\varphi}_{i}^{\ast}(\bm{\xi})\varphi_{j}(\bm{\xi})=\delta_{ij}.
\end{equation}
It indicates that eigen-states in the dipole representation and the standard representation are dual to each other, and form a biorthogonal system.

We can see that the dipole picture is indeed a suitable basis for the theory of composite fermions. The picture yields a new wave function ansatz and a set of wave equations, which do lead to the many-body wave functions that are prescribed and thoroughly tested by the standard theory of composite fermions. It is remarkable that we can now determine the wave functions by solving a wave equation rather than relying on hypotheses. 

To have a theory that can predict not only wave functions of ideal states but also their responses to external perturbations, we still need to incorporate external potentials. In the HLR theory, this can be done trivially by interpreting a composite fermion as an ordinary particle following the ordinary Schrödinger equation. However, as shown in this section, one has to follow a different set of rules to quantize a classical model of composite fermions. Developing a general quantum theory of composite fermions is the subject of the next section.

\section{General theory \label{sec:General-theory}}

In this section, we extend our theory for systems that are subject to not only strong uniform magnetic fields but also spatial and temporal fluctuations of electromagnetic fields, and have generally inhomogeneous densities. To apply the principles developed in the last section, we first need to identify the Hilbert space of a composite fermion in a non-uniform magnetic field. To this end, we find that the non-uniformity of the magnetic field only modifies the weight of the Bergman space. With the modification, our theory can be generalized straightforwardly.

\subsection{Bergman space \label{subsec:Bergman_space_generalized}}

In this subsection, we show that the Hilbert space of a particle confined in a Landau level by a non-uniform magnetic field is generally a Bergman space with its weight determined by the spatial profile of the magnetic field. The Hilbert space of a composite fermion is then the tensor product of two Bergman spaces with their weights determined by the spatial profiles of the physical and the CS magnetic fields, respectively.

We consider a non-relativistic electron confined in the lowest Landau-level by a non-uniform magnetic field $\bm{B}(\bm{z})=-B(\bm{z})\bm{n}$, $B(\bm{z})=B_{0}+B(\bm{z})>0$, and $|B_{1}(\bm{z})|/B_{0}\ll1$. The Hamiltonian of the system, in complex coordinates, is given by~\citep{jain2007}
\begin{equation}
\hat{H}=-\frac{\hbar^{2}}{2m_{\mathrm{e}}}\left(2\partial_{z}+\mathrm{i}\frac{e}{\hbar}\bar{A}\right)\left(2\partial_{\bar{z}}+\mathrm{i}\frac{e}{\hbar}A\right)+\frac{e\hbar B(\bm{z})}{2m_{\mathrm{e}}},
\end{equation}
with $A\equiv A_{x}(\bm{z})+\mathrm{i}A_{y}(\bm{z})$ and $\bar{A}\equiv A^{\ast}$ being the complex components of the vector potential of the magnetic field. The first term of the Hamiltonian yields zero-energy for a state with the wave function $\varphi(\bm{z})$ satisfying the constraint
\begin{equation}
\left[2\partial_{\bar{z}}+\mathrm{i}\frac{e}{\hbar}A(\bm{z})\right]\varphi\left(\bm{z}\right)=0.\label{eq:LL-constraint}
\end{equation}
All such states form the lowest Landau level in a non-uniform magnetic field~\citep{spodyneiko2023}, and define the physical Hilbert space of the electron in the zero-electron-mass limit $m_{\mathrm{e}}\rightarrow0$. The second term of the Hamiltonian, on the other hand, can be interpreted as the orbital magnetization energy of the electron, and will become a part of the scalar potential experienced by composite fermions~\citep{simon1996}. We note that for a two-dimensional massless Dirac particle, Eq.~(\ref{eq:LL-constraint}) is an exact constraint for its zero-energy Landau level, and there is no orbital magnetization energy.

To fulfill the constraint, a wave function in the Hilbert space must take the form
\begin{equation}
\varphi(\bm{z})=\psi(z)\exp\left[-\frac{1}{2}f_{B}(\bar{z},z)\right],\label{eq:phicomplete}
\end{equation}
where $\psi(z)$ is a holomorphic function in $z$, and $f_{B}(\bar{z},z)$ is determined by the equation
\begin{equation}
\partial_{\bar{z}}f_{B}(\bar{z},z)=\mathrm{i}\frac{e}{\hbar}A(\bar{z},z).\label{eq:pzfb}
\end{equation}
Fixing the vector potential in the Coulomb gauge, we have $\partial_{z}A=-\partial_{\bar{z}}\bar{A}=-\mathrm{i}B(\bm{z})/2,$ and
\begin{equation}
\partial_{z}\partial_{\bar{z}}f_{B}(\bar{z},z)=\frac{e}{2\hbar}B(\bm{z}).\label{eq:feq}
\end{equation}
We can then choose $f_{B}(\bar{z},z)$ to be a real solution of the equation. 

The Hilbert space of the electron is therefore a weighted Bergman space consisting all holomorphic polynomials that are normalized by the condition $\int\mathrm{d}\mu_{B}(z)|\psi(z)|^{2}=1$, where the integral measure is modified from that of a Segal-Bargmann space to
\begin{equation}
\mathrm{d}\mu_{B}(\bm{z})=w_{B}\left(\bm{z}\right)\mathrm{d}\bm{z}\equiv\frac{\mathrm{d}\bm{z}}{2\pi l_{B}^{2}}\exp\left[-f_{B}(\bar{z},z)\right],
\end{equation}
with $w_{B}(\bm{z})$ being the weight of the Bergman space, and $l_{B}\equiv\sqrt{\hbar/eB_{0}}$. We can choose the constant of integration for $f_{B}$ to normalize the measure: $\int\mathrm{d}\mu_{B}(\bm{z})=1$.

Similarly, for a vortex in a non-uniform CS magnetic field $\bm{b}(\bm{\eta})=b(\bm{\eta})\bm{n}$, $b(\bm{\eta})>0$, its Hilbert space is a Bergman space consisting all anti-holomorphic polynomials in $\bar{\eta}$ with the modified integral measure
\begin{equation}
\mathrm{d}\mu_{b}(\bm{\eta})=w_{b}\left(\bm{\eta}\right)\mathrm{d}\bm{\eta}=\frac{\mathrm{d}\bm{\eta}}{2\pi l_{b}^{2}}\exp\left[-f_{b}(\bar{\eta},\eta)\right],\label{eq:dmub}
\end{equation}
where $f_{b}(\bar{\eta},\eta)$ is a real solution of the equation
\begin{equation}
\partial_{\bar{\eta}}\partial_{\eta}f_{b}(\bar{\eta},\eta)=\frac{e}{2\hbar}b(\bm{\eta}).\label{eq:ppfb}
\end{equation}
The counterpart of Eq.~(\ref{eq:pzfb}) for the vortex is
\begin{equation}
\partial_{\eta}f_{b}(\bar{\eta},\eta)=\mathrm{i}\frac{e}{\hbar}\bar{a}(\bar{\eta},\eta).\label{eq:pfb}
\end{equation}
where $\bar{a}\equiv a_{x}-\mathrm{i}a_{y}$ denotes the complex-conjugated component of the vector potential $(a_{x},a_{y})$ of the CS magnetic field. 

As in the ideal case, wave functions of a composite fermion are bi-variate functions which are holomorphic in the coordinate of the electron and anti-holomorphic in the coordinate of the vortex.

\subsection{Quantization in a Bergman space \label{subsec:Quantization-in-the}}

In this subsection, we discuss the quantization in a weighted Bergman space. 

We first define the reproducing kernel for the weighted Bergman space of an electron. It is the coordinate representation of the identity operator which transforms an arbitrary holomorphic function $\psi(z)$ to itself:
\begin{equation}
\psi(z)=\int\mathrm{d}\mu_{B}(\bm{\xi})K_{B}(z,\bar{\xi})\psi(\xi).\label{eq:reprodkern}
\end{equation}
The relation is basically a generalization of Eq.~(\ref{eq:reproduceB}) with the modified integral measure. The reproducing kernel can generally be constructed using a complete orthonormal basis set $\{\phi_{n}(z)\}$ of the space with $\int\mathrm{d}\mu_{B}(\bm{z})\phi_{m}^{\ast}(z)\phi_{n}(z)=\delta_{mn}$: $K_{B}(z,\bar{\xi})=\sum_{n}\phi_{n}(z)\phi_{n}^{\ast}(\xi)$~\citep{hall1999}. We can express the reproducing kernel as the exponential form
\begin{equation}
K_{B}(z,\bar{\xi})\equiv e^{F_{B}(\bar{\xi},z)}\label{eq:KBFB}
\end{equation}
by introducing the function $F_{B}(\bar{\xi},z)$. In analogy to Eq.~(\ref{eq:pzfb}), we define a starred vector potential which is related to $F_{B}(\bar{\xi},z)$ by
\begin{equation}
\partial_{z}F_{B}(\bar{\xi},z)=-\mathrm{i}\frac{e}{\hbar}\bar{A}^{\bigstar}(\bar{\xi},z).\label{eq:Abarstar}
\end{equation}
The starred vector potential $\bar{A}^{\bigstar}$ can be related to the physical vector potential $\bar{A}$, see Appendix \ref{sec:star-transformation}.

We can quantize an arbitrary function $H(\bar{z},z)$ to an operator $\hat{H}$. In analogy to Eq.~(\ref{eq:Hpsi}), the action of $\hat{H}$ to a wave function $\psi(z)$ is defined by: 
\begin{equation}
\left[\hat{H}\psi\right]\left(z\right)=\int\mathrm{d}\mu_{B}(\bm{\xi})K_{B}(z,\bar{\xi})H(\bar{\xi},\xi)\psi(\xi),\label{eq:Hhatpsi}
\end{equation}
where we use the reproducing kernel to project a non-holomorphic function into the Bergman space.

With the modified integral measure in the definition, the simple quantization rule of substituting $\bar{z}$ with $2l_{B}^{2}\partial_{z}$ for a Segal-Bargmann space is not valid anymore. Instead, the operator $\hat{\bar{z}}$ is in general a function of $\partial_{z}$ and $z$ satisfying
\begin{equation}
\hat{\bar{z}}\left(\partial_{z},z\right)K_{B}\left(z,\bar{\xi}\right)=\bar{\xi}K_{B}\left(z,\bar{\xi}\right).\label{eq:zhat}
\end{equation}
With the operator $\hat{\bar{z}}$, the arbitrary function $H(\bar{z},z)$ can be quantized as
\begin{equation}
\hat{H}=N_{+}\left[H\left(\hat{\bar{z}},z\right)\right],
\end{equation}
where $N_{+}[\dots]$ denotes the normal ordering that places $\hat{\bar{z}}$ on the left of all $z$'s in $H(\bar{z},z)$. We can also define an alternative form of the quantization which expresses $\hat{H}$ as the anti-normal ordering of a function $H^{\bigstar}(\hat{\bar{z}},z)$ that is related to $H(\bar{z},z)$ via a transformation, see Appendix \ref{sec:star-transformation}.

To obtain an explicit form of the $\hat{\bar{z}}$ operator, we need to solve Eq.~(\ref{eq:zhat}). For the case of a uniform magnetic field with the reproducing kernel Eq.~(\ref{eq:KB0}), it is easy to see that $\hat{\bar{z}}=2l_{B}^{2}\partial_{z}$ does satisfy Eq.~(\ref{eq:zhat}). For general systems, we substitute Eq.~(\ref{eq:KBFB}) into Eq.~(\ref{eq:zhat}), apply Eq.~(\ref{eq:Abarstar}), and obtain
\begin{equation}
\hat{\bar{z}}=2l_{B}^{2}\left(\partial_{z}+\frac{\mathrm{i}e}{\hbar}N_{-}\left[\bar{A}_{1}^{\bigstar}\left(\hat{\bar{z}},z\right)\right]\right),\label{eq:zbarhat}
\end{equation}
where we decompose the starred vector potential into $\bar{A}^{\bigstar}(\bar{\xi},z)=\mathrm{i}B_{0}\bar{\xi}/2+\bar{A}_{1}^{\bigstar}(\bar{\xi},z)$, and $N_{-}[\dots]$ denotes the anti-normal ordering that places $\hat{\bar{z}}$'s on the right of all $z$'s. Alternatively, the equation can be written as
\begin{equation}
\hat{\bar{z}}=2l_{B}^{2}\left(\partial_{z}+\frac{\mathrm{i}e}{\hbar}N_{+}\left[\bar{A}_{1}\left(\hat{\bar{z}},z\right)\right]\right)\label{eq:zbarhat-1}
\end{equation}
because $\bar{A}_{1}$ and $\bar{A}_{1}^{\bigstar}$ are related. These equations can be solved iteratively.

The vortex degree of freedom can be quantized similarly. We define the reproducing kernel $K_{b}(\bar{\eta},\eta^{\prime})\equiv\exp[F_{b}(\bar{\eta},\eta^{\prime})]$ and the corresponding starred vector potential: $\partial_{\bar{\eta}}F_{b}(\bar{\eta},\eta^{\prime})=-\mathrm{i}ea^{\bigstar}(\bar{\eta},\eta^{\prime})/\hbar$. Making substitutions $z\rightarrow\bar{\eta}$, $\hat{\bar{z}}\rightarrow\hat{\eta}$, $B\rightarrow b$ and $\bar{A}^{\bigstar}\rightarrow a^{\bigstar}$, we can obtain a similar set of relations for quantizing the vortex degree of freedom. We have
\begin{align}
\hat{\eta} & =2l_{b}^{2}\left(\partial_{\bar{\eta}}+\frac{\mathrm{i}e}{\hbar}N_{-}\left[a_{1}^{\bigstar}\left(\bar{\eta},\hat{\eta}\right)\right]\right)\label{eq:etahat1}\\
 & =2l_{b}^{2}\left(\partial_{\bar{\eta}}+\frac{\mathrm{i}e}{\hbar}N_{+}\left[a_{1}\left(\bar{\eta},\hat{\eta}\right)\right]\right).\label{eq:etahat}
\end{align}
The normal (anti-normal) ordering should be re-interpreted accordingly to place $\hat{\eta}$'s on the left (right) of all $\bar{\eta}$'s.

\subsection{Wave function ansatz \label{subsec:Wave-function-ansatz}}

Using the modified integral measure Eq.~(\ref{eq:dmub}), the wave function ansatz Eq.~(\ref{eq:PsiCFtoPsi}) can be generalized straightforwardly:
\begin{equation}
\Psi\left(\left\{ z_{i}\right\} \right)=\int\prod_{i}\mathrm{d}\mu_{b}\left(\bm{\eta}_{i}\right)J\left(\left\{ \eta_{i}\right\} \right)\Psi_{\mathrm{CF}}\left(\left\{ z_{i},\bar{\eta}_{i}\right\} \right),\label{eq:PsiCFtoPsiGen}
\end{equation}
where we only change the integral measures for $\{\bm{\eta}_{i}\}$, and assume that the wave function of vortices defining the physical subspace is still $J^{\ast}(\{\eta_{i}\})$. As in the ideal case, the physical wave function is obtained by projecting the composite fermion wave function into the physical subspace defined by the vortex state: $\Psi=\hat{P}_{\mathrm{v}}\Psi_{\mathrm{CF}}$. 

Due to the change of the weight of the $\bm{\eta}$\textendash Bergman space, vortices are actually in a deformed bosonic Laughlin state with an inhomogeneous density. The joint density distribution of vortices is proportional to
\begin{equation}
e^{\sum_{i<j}4\ln\left|\eta_{i}-\eta_{j}\right|-\sum_{i}f_{b}\left(\bar{\eta}_{i},\eta_{i}\right)}.
\end{equation}
Using Laughlin's plasma analogy~\citep{laughlin1983a}, we can interpret it as the distribution function of a set of classical particles, each of which carries two unit ``charges'', on a non-uniform neutralizing background with the ``charge'' density $\partial_{\eta}\partial_{\bar{\eta}}f_{b}(\bar{\eta},\eta)/\pi$. Such a system is expected to be nearly ``charge-neutral'' everywhere. It implies that the single-particle density of vortices should be
\begin{equation}
2\rho_{\mathrm{v}}\left(\bm{\eta}\right)\simeq\frac{1}{\pi}\partial_{\eta}\partial_{\bar{\eta}}f_{b}\left(\bar{\eta},\eta\right)=\frac{e}{h}b\left(\bm{\eta}\right),
\end{equation}
where we make use of Eq.~(\ref{eq:ppfb}). We see that the CS self-consistent condition, which relates the vortex density to the strength of the CS magnetic field, arises as a result of the constraint of the physical subspace.

The standard ansatz can be generalized and shown to be equivalent to the new anszta. By using the reproducing kernel of the electron Bergman space, the standard ansatz Eq.~(\ref{eq:Psistd}) can be generally written as
\begin{multline}
\Psi\left(\left\{ z_{i}\right\} \right)=\int\prod_{i}\mathrm{d}\mu_{B}\left(\bm{\xi}_{i}\right)\prod_{i}K_{B}\left(z_{i},\bar{\xi}_{i}\right)\\
\times J\left(\left\{ \xi_{i}\right\} \right)\tilde{\Psi}_{\mathrm{CF}}\left(\left\{ \bm{\xi}_{i}\right\} \right).\label{eq:wfansatzstdgen}
\end{multline}
By generalizing the derivation shown in Eq.~(\ref{eq:ansatzderiv}), it is easy to show that $\tilde{\Psi}_{\mathrm{CF}}$ is related to $\Psi_{\mathrm{CF}}$ by the transformation
\begin{multline}
\Psi_{\mathrm{CF}}\left(\left\{ z_{i},\bar{\eta}_{i}\right\} \right)=\int\prod_{i}\mathrm{d}\mu_{B}\left(\bm{\xi}_{i}\right)\\
\times\left[\prod_{i}K_{B}\left(z_{i},\bar{\xi}_{i}\right)K_{b}\left(\bar{\eta}_{i},\xi_{i}\right)\right]\tilde{\Psi}_{\mathrm{CF}}\left(\left\{ \bm{\xi}_{i}\right\} \right).\label{eq:CFtransform}
\end{multline}
This is the general relation between the dipole representation and the standard representation.

\subsection{Wave equation: the dipole representation \label{subsec:General-wave-equation} }

In this subsection, we generalize the wave equation Eq.~(\ref{eq:cfweq}) for systems that are subject to external perturbations. We assume that the external magnetic field is nearly uniform and varies slowly over space with $|B_{1}(\bm{z})|/B_{0}\ll1$, $|\nabla B(\bm{z})|l_{B}/B_{0}\ll1$, and the strength of the external electric field is weak and does not induce inter-Landau-level transitions. In the derivation, we will ignore all corrections proportional to the gradients of the strengths of the magnetic and electric fields as well as contributions beyond the linear order of $B_{1}(\bm{z})$ and the external electric field. The resulting theory will be adequate for predicting long-wavelength responses to electromagnetic fields with $ql_{B}\ll1$, where $q$ is the wave-number of the electromagnetic fields~\citep{ji2021}. In this limit, we can establish a wave equation while not obscured by excessive microscopic details. A more general theory would require taking into account microscopic details which will be elucidated in Sec.~\ref{sec:Derivation-of-the}.

Our derivation is based on a straightforward generalization of the semi-classical phenomenological model adopted in Sec.~\ref{subsec:Wave-equation}. The Lagrangian of the model for a set of composite fermions, in terms of single-particle wave-functions $\{\psi_{i}(z,\bar{\eta})\}$, can be written as:
\begin{multline}
L=\sum_{i}\int\mathrm{d}\mu_{B}\left(\bm{z}\right)\mathrm{d}\mu_{b}(\bm{\eta})\biggr\{\epsilon_{i}\left|\psi_{i}\left(z,\bar{\eta}\right)\right|^{2}-\frac{\hbar^{2}}{2m^{\ast}}\\
\times\int\mathrm{d}\mu_{b}(\bm{\eta}^{\prime})\psi_{i}^{\ast}(z,\bar{\eta})\frac{\left(\bar{z}-\bar{\eta}\right)\left(z-\eta^{\prime}\right)}{l_{b}^{2}(\bm{z})l_{B}^{2}(\bm{z})}K_{b}(\bar{\eta},\eta^{\prime})\psi_{i}(z,\bar{\eta}^{\prime})\biggr\}\\
-\int\mathrm{d}\bm{z}~\Phi\left(\bm{z}\right)\rho_{\mathrm{e}}(\bm{z})-E_{\mathrm{xc}}\left[\rho_{\mathrm{e}}\right]\\
-\frac{e^{2}}{8\pi\varepsilon}\int\mathrm{d}\bm{z}\mathrm{d}\bm{z}^{\prime}\frac{\left[\rho_{\mathrm{e}}(\bm{z})-\rho_{0}\right]\left[\rho_{\mathrm{e}}(\bm{z}^{\prime})-\rho_{0}\right]}{\left|\bm{z}-\bm{z}^{\prime}\right|}\\
-\int\mathrm{d}\bm{\eta}\phi\left(\bm{\eta}\right)\left[\rho_{\mathrm{v}}\left(\bm{\eta}\right)-\frac{e}{2h}b\left(\bm{\eta}\right)\right],\label{eq:Lagrangian}
\end{multline}
where the summation is over occupied states of composite fermions, and $\epsilon_{i}$ is the Lagrange multiplier for the normalization constraint of the wave functions. The second term is the kinetic energy, which is basically the harmonic binding potential Eq.~(\ref{eq:Vbound}) written in a star-transformed form (see Appendix \ref{sec:star-transformation}) with a space-dependent coefficient parametrized in the space-dependent magnetic lengths of the external field $l_{B}(\bm{z})\equiv\sqrt{\hbar/eB(\bm{z})}$ and the CS field $l_{b}(\bm{z})\equiv\sqrt{\hbar/eb(\bm{z})}$. The third term is the energy due to the single-body scalar potential experienced by electrons $\Phi(\bm{z})$, which includes the scalar potential of the external electromagnetic field as well as the orbital magnetization energy discussed in Sec.~\ref{subsec:Bergman_space_generalized}, and
\begin{equation}
\rho_{\mathrm{e}}(\bm{z})=w_{B}\left(\bm{z}\right)\sum_{i}\int\mathrm{d}\mu_{b}\left(\bm{\eta}\right)\left|\psi_{i}\left(z,\bar{\eta}\right)\right|^{2}\label{eq:rhoe}
\end{equation}
is the local density of electrons. The next two terms are the Coulomb energy and an exchange-correlation energy functional $E_{\mathrm{xc}}[\rho_{\mathrm{e}}]$ which accounts for the remaining contributions of exchange and correlation effects. The last term imposes the CS constraint which relates the local density of vortices
\begin{equation}
\rho_{\mathrm{v}}(\bm{\eta})=w_{b}\left(\bm{\eta}\right)\sum_{i}\int\mathrm{d}\mu_{B}\left(\bm{z}\right)\left|\psi_{i}\left(z,\bar{\eta}\right)\right|^{2}\label{eq:rhov}
\end{equation}
to the local strength of the CS magnetic field $b(\bm{\eta})$, with $\phi(\bm{\eta})$ serving as a Lagrange multiplier. The effects of the non-uniform physical and CS magnetic fields are included implicitly in the integral measures $\mathrm{d}\mu_{B}$ and $\mathrm{d}\mu_{b}$, respectively. The Lagrangian can be derived from first principles in a microscopic theory, see Sec.~\ref{sec:Derivation-of-the}. For the moment, we consider only time-independent systems. The generalization for time-dependent systems will be discussed in Sec.~\ref{subsec:Time-dependent-systems}.

Differentiating the Lagrangian with respect to $\psi_{i}^{\ast}$, we obtain a generalized wave equation for the stationary state of a composite fermion:
\begin{equation}
\epsilon\psi\left(z,\bar{\eta}\right)=\hat{H}_{\psi}\psi\left(z,\bar{\eta}\right),\label{eq:weqdipole}
\end{equation}
where we drop the state index subscripts for brevity, and the Hamiltonian is
\begin{multline}
\hat{H}_{\psi}=\frac{\hbar^{2}}{2m^{\ast}}\frac{1}{l_{b}^{2}(\bm{z})l_{B}^{2}(\bm{z})}\left(\hat{\bar{z}}-\bar{\eta}\right)\left(z-\hat{\eta}\right)\\
+N_{+}\left[\Phi_{\mathrm{eff}}\left(\hat{\bar{z}},z\right)+\phi\left(\bar{\eta},\hat{\eta}\right)\right].\label{eq:Hpsi-1}
\end{multline}
Here, we use the $\hat{\bar{z}}$ and $\hat{\eta}$ operators defined in Sec.~\ref{subsec:Quantization-in-the}. The star-transformed form of the kinetic (binding) energy in Eq.~(\ref{eq:Lagrangian}) corresponds to the anti-normal ordering of $\bar{\eta}$ and $\hat{\eta}$ as shown in the first term of the Hamiltonian (see Appendix~\ref{sec:star-transformation}). The effective scalar potential for electrons is
\begin{equation}
\Phi_{\mathrm{eff}}(\bm{z})=\Phi(\bm{z})+\frac{e^{2}}{4\pi\varepsilon}\int\mathrm{d}\bm{z}^{\prime}\frac{\rho_{\mathrm{e}}(\bm{z}^{\prime})-\rho_{0}}{\left|\bm{z}-\bm{z}^{\prime}\right|}+v_{\mathrm{xc}}[\rho_{\mathrm{e}}](\bm{z}),
\end{equation}
with the exchange-correlation potential $v_{\mathrm{xc}}[\rho_{\mathrm{e}}]\equiv\delta E_{\mathrm{xc}}[\rho_{\mathrm{e}}]/\delta\rho_{\mathrm{e}}+\tau_{\mathrm{xc}}(\bm{z})$, where $\tau_{\mathrm{xc}}(\bm{z})$ is a contribution from the kinetic energy which is also a functional of $\rho_{\mathrm{e}}$ as $1/l_{b}^{2}(\bm{z})=4\pi\rho_{\mathrm{v}}(\bm{z})\approx4\pi\rho_{\mathrm{e}}(\bm{z})$. By differentiating the kinetic energy with respect to $\rho_{\mathrm{e}}$, we have: 
\begin{equation}
\tau_{\mathrm{xc}}(\bm{z})=\frac{2\pi\hbar^{2}}{m^{\ast}}\int\mathrm{d}\mu_{b}(\bm{\eta})\sum_{i}\left|\frac{z-\hat{\eta}}{l_{B}(\bm{z})}\psi_{i}(z,\bar{\eta})\right|^{2}.\label{eq:tauxc}
\end{equation}
$\phi(\bm{\eta})$ can be interpreted as the scalar potential for vortices. The orthonormal condition between the wave functions reads:
\begin{equation}
\int\mathrm{d}\mu_{B}(\bm{z})\int\mathrm{d}\mu_{b}(\bm{\eta})\psi_{i}^{\ast}\left(z,\bar{\eta}\right)\psi_{j}\left(z,\bar{\eta}\right)=\delta_{ij}.\label{eq:orthonormal-1}
\end{equation}

The wave equation is complemented by a set of CS self-consistent conditions, which are obtained by differentiating the Lagrangian Eq.~(\ref{eq:Lagrangian}) with respect to $\bm{a}$ and $\phi$. We have
\begin{align}
b(\bm{\eta}) & =\frac{2h}{e}\rho_{\mathrm{v}}(\bm{\eta}),\label{eq:csb-1}\\
\bm{E}_{\mathrm{v}}(\bm{\eta}) & =\frac{2h}{e}\bm{n}\times\bm{j}_{\mathrm{v}}(\bm{\eta}),\label{eq:cse-1}
\end{align}
where $\bm{j}_{\mathrm{v}}(\bm{\eta})\equiv(-e)^{-1}\delta L_{\mathrm{CF}}/\delta\bm{a}(\bm{\eta})$ denotes the current density of vortices, and $L_{\mathrm{CF}}$ is Eq.~(\ref{eq:Lagrangian}) apart from the CS constraint term. The current density of vortices can be written as (see Appendix \ref{sec:Current-densities})
\begin{multline}
\bm{j}_{\mathrm{v}}(\bm{\eta})=\frac{\rho_{\mathrm{v}}(\bm{\eta})}{b(\bm{\eta})}\bm{E}_{\mathrm{v}}(\bm{\eta})\times\bm{n}+\frac{\hbar}{m^{\ast}}w_{b}(\bm{\eta})\sum_{i}\\
\times\int\mathrm{d}\mu_{B}\left(\bm{z}\right)\psi_{i}^{\ast}\left(z,\bar{\eta}\right)\frac{\bm{n}\times(\bm{z}-\bm{\eta})}{l_{B}^{2}(\bm{z})}\psi_{i}\left(z,\bar{\eta}\right).\label{eq:jv}
\end{multline}


\subsection{Long-wavelength approximation}

In the long-wavelength limit, we can determine approximate forms of the $\hat{\bar{z}}$ and $\hat{\eta}$ operators. Since the bound state of the vortex and electron has a length scale of the magnetic length (see Appendix~\ref{appendix:-levels-of-the}), which is much smaller than the wavelength of the fluctuating electromagnetic fields, we can expand the vector potential as: $N_{+}[\bar{A}_{1}(\hat{\bar{z}},z)]\approx\bar{A}_{1}(\bar{\eta},z)+(\hat{\bar{z}}-\bar{\eta})[\partial_{\bar{\eta}}\bar{A}_{1}(\bar{\eta},z)]$. Substituting it into Eq.~(\ref{eq:zbarhat-1}), we have
\begin{equation}
\hat{\bar{z}}-\bar{\eta}\approx2\left[\partial_{z}+\mathrm{i}\frac{e}{\hbar}\bar{A}\left(\bar{\eta},z\right)\right]l_{B}^{2}(\bar{\eta},z).\label{eq:deltazbar}
\end{equation}
Similarly, we can approximate the $\hat{\eta}$ operator as
\begin{equation}
\hat{\eta}-z\approx2\left[\partial_{\bar{\eta}}+\mathrm{i}\frac{e}{\hbar}a\left(\bar{\eta},z\right)\right]l_{b}^{2}\left(\bar{\eta},z\right).\label{eq:deltaeta}
\end{equation}

Accordingly, the scalar potentials are approximated as

\begin{align}
N_{+}[\Phi_{\mathrm{eff}}] & \approx\Phi_{\mathrm{eff}}(\bar{\eta},z)-V(\bar{\eta},z)\left[\mathrm{i}\hbar\partial_{z}-e\bar{A}(\bar{\eta},z)\right],\\
N_{+}[\phi] & \approx\phi(\bar{\eta},z)-\bar{v}(\bar{\eta},z)\left[-\mathrm{i}\hbar\partial_{\bar{\eta}}-ea(\bar{\eta},z)\right],
\end{align}
where $V(\bar{\eta},z)\equiv2\mathrm{i}\partial_{\bar{\eta}}\Phi_{\mathrm{eff}}(\bar{\eta},z)/eB(\bar{\eta},z)$ and $\bar{v}(\bar{\eta},z)\equiv2\mathrm{i}\partial_{z}\phi(\bar{\eta},z)/eb(\bar{\eta},z)$ are the complex components of the drift velocities $\bm{V}=\bm{E}\times\bm{B}/B^{2}$ and $\bm{v}=\bm{E}_{\mathrm{v}}\bm{\times\bm{b}}/b^{2}$ in the presence of the electric fields $\bm{E}\equiv e^{-1}\bm{\nabla}\Phi_{\mathrm{eff}}$ and $\bm{E}_{\mathrm{v}}\equiv e^{-1}\bm{\nabla}\phi$ for electrons and vortices, respectively. 

Combining all, and introducing the transformation
\begin{equation}
\psi\left(z,\bar{\eta}\right)=\sqrt{2\pi}l_{B}\exp\left[\frac{f_{B}(\bar{\eta},z)+f_{b}(\bar{\eta},z)}{2}\right]\varphi\left(z,\bar{\eta}\right),\label{eq:psipsi1}
\end{equation}
we obtain the wave equation for $\varphi(\bm{\xi})\equiv\varphi(z,\bar{\eta})|_{z\rightarrow\xi,\bar{\eta}\rightarrow\bar{\xi}}$: 
\begin{equation}
\epsilon\varphi(\bm{\xi})=\hat{H}\varphi(\bm{\xi}),\label{eq:weqdipole-1}
\end{equation}
with the effective Hamiltonian for a composite fermion 
\begin{multline}
\hat{H}=-\frac{\hbar^{2}}{2m^{\ast}}\left[2\partial_{\xi}+\mathrm{i}\frac{e}{\hbar}\bar{\mathcal{A}}\left(\bm{\xi}\right)+\mathrm{i}\frac{m^{\ast}}{\hbar}\bar{v}(\bm{\xi})\right]\\
\times\left[2\partial_{\bar{\xi}}+\mathrm{i}\frac{e}{\hbar}\mathcal{A}\left(\bm{\xi}\right)+\mathrm{i}\frac{m^{\ast}}{\hbar}V(\bm{\xi})\right]+\Phi_{\mathrm{eff}}\left(\bm{\xi}\right)+\phi\left(\bm{\xi}\right),\label{eq:Hdipole}
\end{multline}
where $(\bar{\mathcal{A}},\mathcal{A})$ denotes the effective vector potential experienced by composite fermions:
\begin{equation}
\bm{\mathcal{A}}=\bm{a}+\bm{A}.
\end{equation}
We see that the wave equation resembles the ordinary Schrödinger equation for an charge particle but has corrections from the drift velocities $V$ and $\bar{v}$. The corrections are the manifestation of the dipole nature of the composite fermion~\citep{ji2021}, and not present in the HLR theory.

The wave equations (\ref{eq:psipsi1}) with the effective Hamiltonian Eq.~(\ref{eq:Hdipole}) generalizes the ideal state wave equation (\ref{eq:cfweq1}). Combining with the CS self-consistent conditions Eqs.~(\ref{eq:csb-1},~\ref{eq:cse-1}), we can determine the responses of composite fermions to external long-wavelength perturbations, as the HLR theory does in the standard theory. It is notable that the wave equation is different from that conjectured by the HLR theory. The drift velocity corrections are actually the quantum correspondence of the anomalous velocity correction~\citep{ji2021} or the side-jump correction~\citep{wang2017} discussed in the context of the semi-classical dynamics of composite fermions.

\subsection{Wave equation: the standard representation \label{subsec:Wave-equation:-the}}

For Slater determinant wave functions $\Psi_{\mathrm{CF}}$ and $\tilde{\Psi}_{\mathrm{CF}}$ related by Eq.~(\ref{eq:CFtransform}), single-particle wave functions in the two representations are related by the transformation

\begin{equation}
\psi\left(z,\bar{\eta}\right)=\int\mathrm{d}\mu_{B}\left(\bm{\xi}\right)K_{B}\left(z,\bar{\xi}\right)K_{b}\left(\bar{\eta},\xi\right)\tilde{\psi}\left(\bm{\xi}\right).\label{eq:transforCFgeneral}
\end{equation}
We can map operators in the dipole representation to their counterparts in the standard representation. See Appendix~\ref{subsec:General-systems-operators} for the rules of mapping.

Applying the mapping rules and the approximate forms of operators Eqs.~(\ref{eq:deltazbar}, \ref{eq:deltaeta}), we can obtain a wave equation in the standard representation (see Appendix \ref{subsec:Hamiltonian-in-the}):
\begin{equation}
\epsilon\tilde{\varphi}\left(\bm{\xi}\right)=\hat{H}^{\dagger}\tilde{\varphi}\left(\bm{\xi}\right),\label{eq:weqstd}
\end{equation}
with
\begin{equation}
\tilde{\psi}(\bm{\xi})=\sqrt{2\pi}l_{B}\exp\left[\frac{f_{B}(\bm{\xi})-f_{b}(\bm{\xi})}{2}\right]\tilde{\varphi}\left(\bm{\xi}\right).\label{eq:cftransform}
\end{equation}
Note that the Hamiltonian for $\tilde{\varphi}(\bm{\xi})$ is the complex conjugate of that for $\varphi(\bm{\xi})$. It is non-hermitian due to the drift velocity corrections.

As in ideal systems, $\{\varphi_{i}\}$ and $\{\tilde{\varphi}_{i}\}$ are dual to each other and form a biorthogonal system. By applying Eqs.~(\ref{eq:psipsi1}, \ref{eq:transforCFgeneral}, \ref{eq:cftransform}), the orthonormal condition Eq.~(\ref{eq:orthonormal-1}) can be rewritten as
\begin{equation}
\int\mathrm{d}\bm{\xi}\tilde{\varphi}_{i}^{\ast}(\bm{\xi})\varphi_{j}(\bm{\xi})=\delta_{ij}.\label{eq:orthonormal-2}
\end{equation}

The set of wave equations can also be derived from the variational principles $\delta L_{\mathrm{CF}}=0$, where $L_{\mathrm{CF}}$ is the effective Lagrangian for composite fermions: $L_{\mathrm{CF}}\equiv\sum_{i}\int\mathrm{d}\mu_{B}(\bm{z})\mathrm{d}\mu_{b}(\bm{\eta})\psi_{i}^{\ast}(z,\bar{\eta})(\epsilon_{i}-\hat{H}_{\psi})\psi_{i}(z,\bar{\eta})$. The effective Lagrangian can be rewritten as:
\begin{equation}
L_{\mathrm{CF}}=\sum_{i}\int\mathrm{d}\bm{\xi}\tilde{\varphi}_{i}^{\ast}(\bm{\xi})\left(\epsilon_{i}-\hat{H}\right)\varphi_{i}(\bm{\xi}).
\end{equation}
Differentiating it with respect to $\tilde{\varphi}_{i}^{\ast}$ and $\varphi_{i}$ gives rise to the wave equations Eq.~(\ref{eq:weqdipole-1}) and (\ref{eq:weqstd}), respectively.

\subsection{Time-dependent systems \label{subsec:Time-dependent-systems}}

For time-dependent systems, the term proportional to $\epsilon_{i}$ in the Lagrangian Eq.~(\ref{eq:Lagrangian}) should be replaced with
\begin{multline}
\sum_{i}\int\mathrm{d}\mu_{B}(\bm{z})\mathrm{d}\mu_{b}(\bm{\eta})\psi_{i}^{\ast}(z,\bar{\eta};t)\\
\times\left\{ \mathrm{i}\hbar\frac{\partial}{\partial t}-\frac{\mathrm{i}\hbar}{2}\left[\frac{\partial f_{B}(\bm{z},t)}{\partial t}+\frac{\partial f_{b}(\bm{\eta},t)}{\partial t}\right]\right\} \psi_{i}(z,\bar{\eta};t),
\end{multline}
where the second term in the braces originates from the exponential factor in Eq.~(\ref{eq:phicomplete}) and its counterpart for vortices. The effective action of composite fermions can be written as
\begin{multline}
S_{\mathrm{CF}}=\sum_{i}\int\mathrm{d}t\int\mathrm{d}\mu_{B}(\bm{z})\mathrm{d}\mu_{b}(\bm{\eta})\psi_{i}^{\ast}(z,\bar{\eta};t)\\
\times\left(\mathrm{i}\hbar\frac{\partial}{\partial t}-\hat{H}_{\psi}\right)\psi_{i}(z,\bar{\eta};t),
\end{multline}
where $\hat{H}_{\psi}$ is Eq.~(\ref{eq:Hpsi-1}) with the substitutions
\begin{align}
\Phi(\bm{z}) & \rightarrow\Phi(\bm{z},t)+\frac{\mathrm{i}\hbar}{2}\partial_{t}f_{B}(\bm{z},t),\label{eq:Phisub}\\
\phi(\bm{\eta}) & \rightarrow\phi(\bm{\eta},t)+\frac{\mathrm{i}\hbar}{2}\partial_{t}f_{b}(\bm{\eta},t).\label{eq:phisub}
\end{align}
For the long-wavelength limit, we repeat the derivation leading to Eq.~(\ref{eq:weqdipole-1}), and make use of Eqs.~(\ref{eq:psipsi1}, \ref{eq:transforCFgeneral}, \ref{eq:cftransform}). We find that the action can be written as
\begin{equation}
S_{\mathrm{CF}}=\int\mathrm{d}t\int\mathrm{d}\bm{\xi}\tilde{\varphi}^{\ast}(\bm{\xi},t)\left(\mathrm{i}\hbar\frac{\partial}{\partial t}-\hat{H}\right)\varphi(\bm{\xi},t),\label{eq:SCF}
\end{equation}
where $\hat{H}$ is formally identical to the stationary state Hamiltonian Eq.~(\ref{eq:Hdipole}), but the electric fields $\bm{E}$ and $\bm{E}_{\mathrm{v}}$, which determine the drift velocities, are replaced by their gauge-invariant forms $\bm{E}=e^{-1}\bm{\nabla}\Phi_{\mathrm{eff}}-\partial_{t}\bm{A}$ and $\bm{E}_{\mathrm{v}}=e^{-1}\bm{\nabla}\phi-\partial_{t}\bm{a}$. Note that the substitutions Eqs.~(\ref{eq:Phisub}, \ref{eq:phisub}) do not apply to $\hat{H}$.

Differentiating the action with respect to $\tilde{\varphi}^{\ast}(\bm{\xi},t)$ and $\varphi(\bm{\xi},t)$, we obtain the set of time-dependent wave equations
\begin{align}
\mathrm{i}\hbar\frac{\partial\varphi(\bm{\xi},t)}{\partial t} & =\hat{H}\varphi(\bm{\xi},t),\label{eq:TDWEQ1}\\
\mathrm{i}\hbar\frac{\partial\tilde{\varphi}(\bm{\xi},t)}{\partial t} & =\hat{H}^{\dagger}\tilde{\varphi}(\bm{\xi},t).\label{eq:TDWEQ2}
\end{align}


\section{Microscopic underpinning \label{sec:Derivation-of-the}}

In this section, we derive the phenomenological dipole model underlying the quantum mechanics of composite fermions from the microscopic model of interacting electrons confined in a Landau level in the zero-electron-mass limit. The microscopic Lagrangian of such a system can be written as
\begin{equation}
L_{\mathrm{M}}=\Braket{\Psi|E-V_{\mathrm{ee}}-\Phi|\Psi},\label{eq:L}
\end{equation}
where $E$ is a Lagrange multiplier for the normalization constraint of the wave function $\braket{\Psi|\Psi}=1$, $V_{\mathrm{ee}}=(e^{2}/4\pi\varepsilon)\sum_{i<j}|z_{i}-z_{j}|^{-1}+V_{\mathrm{B}}$ denotes the Coulomb interaction between electrons with $V_{\mathrm{B}}$ being the potential from a uniform neutralizing positive charge background, and $\Phi\equiv\sum_{i}\Phi(\bm{z}_{i})$ denotes the externally applied scalar potential. The kinetic energy of electrons is ignored since it is completely quenched in a Landau level. 

We base our derivation on the general variational principle of quantum mechanics. Trial electron wave functions for $\ket{\Psi}$ are constructed using the ansatz form Eq.~(\ref{eq:PsiCFtoPsiGen}) with $\Psi_{\mathrm{CF}}$ being the Slater determinant of a set of single-body trial wave-functions $\{\psi_{i}\}$ of composite fermions. We shall show that the Lagrangian Eq.~(\ref{eq:Lagrangian}) in terms of $\{\psi_{i}\}$ can be derived from the microscopic Lagrangian Eq.~(\ref{eq:L}). The wave equations as well as the CS constraints then follow after applying the variational principle
\begin{equation}
\delta L=0.
\end{equation}


\subsection{Chern-Simons constraints}

A notable feature of the theory of composite fermions is the presence of the fictitious CS fields which are determined self-consistently by Eqs.~(\ref{eq:csb-1}, \ref{eq:cse-1}). In this subsection, we show how the CS fields and the self-consistent conditions emerge in a microscopic theory.

It is easy to see that for the Slater determinant wave function
\begin{equation}
\Psi_{\mathrm{CF}}\left(\left\{ z_{i},\bar{\eta}_{i}\right\} \right)=\frac{1}{\sqrt{N!}}\mathrm{det}\left[\psi_{j}(z_{i},\bar{\eta}_{i})\right],\label{eq:PsiCFDet}
\end{equation}
two sets of single particle trial wave functions which are related by a non-singular linear transformation yield the same physical wave function after applying Eq.~(\ref{eq:PsiCFtoPsi-0}) or Eq.~(\ref{eq:PsiCFtoPsiGen}). To eliminate the redundancy, it is necessary to impose the orthonormal condition:
\begin{equation}
\int\mathrm{d}\mu_{B}(\bm{\xi})\mathrm{d}\mu_{b}(\bm{\eta})\psi_{i}^{\ast}(\xi,\bar{\eta})\psi_{j}(\xi,\bar{\eta})=\delta_{ij}.\label{eq:orthonormal}
\end{equation}
We note that the orthonormality depends on the weight in $\mathrm{d}\mu_{b}$, which is not yet determined at this point.

To proceed, we adopt an approximation analogue to the Hartree approximation. Basically, we determine the state of a composite fermion in an effective medium formed by other composite fermions. In the spirit of the Hartree approximation~\citep{robertg.parr1994}, we introduce a test particle which is distinguishable from other composite fermions but interacts and correlates just like them. The physical wave function of a system with $N$ composite fermions plus a test particle can be written as
\begin{align}
\Psi^{\mathrm{t}}\left(z,\left\{ z_{i}\right\} \right)= & \int\mathrm{d}\mu_{b}\left(\bm{\eta}\right)\Psi_{\eta}^{\mathrm{v}}\left(\left\{ z_{i}\right\} \right)\psi\left(z,\bar{\eta}\right),\label{eq:wfCFtest}\\
\Psi_{\eta}^{\mathrm{v}}\left(\left\{ z_{i}\right\} \right)= & \int\prod_{i=1}^{N}\mathrm{d}\mu_{b}(\bm{\eta}_{i})\prod_{i=1}^{N}(\eta-\eta_{i})^{2}\nonumber \\
 & \times J\left(\left\{ \eta_{i}\right\} \right)\Psi_{\mathrm{CF}}\left(\left\{ z_{i},\bar{\eta}_{i}\right\} \right),\label{eq:Psiv}
\end{align}
where the test particle has the wave function $\psi(z,\bar{\eta}$), and correlates with other composite fermions via the Bijl-Jastrow factor. Because the test particle has no exchange symmetry with other composite fermions, it can occupy any state, including those already occupied in $\Psi_{\mathrm{CF}}$. Our approximation is to assume that the set of single particle trial wave functions for constructing $\Psi_{\mathrm{CF}}$ can be chosen from eigen-wave-functions of the test particle. 

With the approximation, we can determine the weight of $\mathrm{d}\mu_{b}$, self-consistently, by requiring that the orthonormality Eq.~(\ref{eq:orthonormal}) in the Hilbert space of composite fermions is consistent with that of the physical Hilbert space. This is to require
\begin{equation}
\Braket{\Psi_{i}^{\mathrm{t}}|\Psi_{j}^{\mathrm{t}}}=\delta_{ij},\label{eq:Psiortho}
\end{equation}
where $\ket{\Psi_{i}^{\mathrm{t}}}$ and $\ket{\Psi_{j}^{\mathrm{t}}}$ denote two physical states corresponding to $\psi=\psi_{i}$ and $\psi=\psi_{j}$ in Eq.~(\ref{eq:wfCFtest}), respectively, and $\psi_{i}$ and $\psi_{j}$ satisfy the orthonormal condition Eq.~(\ref{eq:orthonormal}). Equation (\ref{eq:Psiortho}) can be rewritten as
\begin{multline}
\int\mathrm{d}\mu_{B}(\bm{z})\mathrm{d}\mu_{b}(\bm{\eta})\mathrm{d}\mu_{b}(\bm{\eta}^{\prime})\psi_{i}^{\ast}(z,\bar{\eta})\\
\times K_{b}(\bar{\eta},\eta^{\prime})\psi_{j}(z,\bar{\eta}^{\prime})=\delta_{ij},\label{eq:orthK}
\end{multline}
with
\begin{equation}
K_{b}(\bar{\eta},\eta^{\prime})\equiv\Braket{\Psi_{\eta}^{\mathrm{v}}|\Psi_{\eta^{\prime}}^{\mathrm{v}}}.\label{eq:Kb}
\end{equation}
To make Eq.~(\ref{eq:orthK}) consistent with Eq.~(\ref{eq:orthonormal}), we can adjust the weight of $\mathrm{d}\mu_{b}$ so that $K_{b}(\bar{\eta},\eta^{\prime})$ is the corresponding reproducing kernel. Equation (\ref{eq:orthK}) can then be reduced to Eq.~(\ref{eq:orthonormal}) by integrating out $\bm{\eta}^{\prime}$.

The requirement that $K_{b}(\bar{\eta},\eta^{\prime})$ is the reproducing kernel of the $\bm{\eta}$\textendash space gives rise to the CS constraint Eq.~(\ref{eq:csb-1}) in the long-wavelength limit. To see this, we rewrite Eq~(\ref{eq:Kb}) as $K_{b}(\bar{\eta},\eta^{\prime})=\langle e^{\mathcal{F}}\rangle$, with
\begin{multline}
\langle e^{\mathcal{F}}\rangle\equiv\int\prod_{i=1}^{N}\mathrm{d}\mu_{B}(\bm{z}_{i})\mathrm{d}\mu_{b}(\bm{\eta}_{i})\mathrm{d}\mu_{b}(\bm{\eta}_{i}^{\prime})e^{\mathcal{F}(\bar{\eta},\eta^{\prime},\{\bar{\eta}_{i},\eta_{i}^{\prime}\})}\\
\times J^{\ast}(\{\eta_{i}\})J(\{\eta_{i}^{\prime}\})\Psi_{\mathrm{CF}}^{\ast}(\{z_{i},\bar{\eta}_{i}\})\Psi_{\mathrm{CF}}(\{z_{i},\bar{\eta}_{i}^{\prime}\})\label{eq:avgF}
\end{multline}
and $\mathcal{F}(\bar{\eta},\eta^{\prime},\{\bar{\eta}_{i},\eta_{i}^{\prime}\})\equiv2\sum_{i}\ln(\bar{\eta}-\bar{\eta}_{i})(\eta^{\prime}-\eta_{i}^{\prime})$. Using the cumulant expansion, we can approximate $F_{b}(\bar{\eta},\eta^{\prime})\equiv\ln K_{b}(\bar{\eta},\eta^{\prime})$ as:
\begin{equation}
F_{b}\left(\bar{\eta},\eta^{\prime}\right)\approx\left\langle \mathcal{F}\right\rangle +\frac{1}{2}\left\langle \left(\mathcal{F}-\left\langle \mathcal{F}\right\rangle \right)^{2}\right\rangle +\cdots,
\end{equation}
To the lowest order, we ignore the fluctuation and higher order corrections, and have $F_{b}\approx\langle\mathcal{F}\rangle=2\sum_{i}\langle\ln(\bar{\eta}-\bar{\eta}_{i})(\eta^{\prime}-\eta_{i}^{\prime})\rangle$. To evaluate the $i$-th term of the summation, we expand the Slater determinant Eq.~(\ref{eq:PsiCFDet}) along its $i$-th row, substitute the expansion into Eq.~(\ref{eq:avgF}), and ignore contributions involving particle exchanges. We obtain
\begin{multline}
F_{b}\left(\bar{\eta},\eta^{\prime}\right)\approx\sum_{i}\int\mathrm{d}\mu_{B}\left(\bm{z}_{i}\right)\mathrm{d}\mu_{b}\left(\bm{\eta}_{i}\right)\mathrm{d}\mu_{b}\left(\bm{\eta}_{i}^{\prime}\right)\\
\times2\left[\ln(\bar{\eta}-\bar{\eta}_{i})+\ln(\eta^{\prime}-\eta_{i}^{\prime})\right]\\
\times\frac{1}{N}\sum_{a}\psi_{a}^{\ast}\left(z_{i},\bar{\eta}_{i}\right)K_{b}^{(a)}\left(\bar{\eta}_{i},\eta_{i}^{\prime}\right)\psi_{a}\left(z_{i},\bar{\eta}_{i}^{\prime}\right),\label{eq:Fbapprox}
\end{multline}
where $K_{b}^{(a)}$ is defined by Eq.~(\ref{eq:Kb}) but with one composite fermion removed from the state $\psi_{a}$ in Eq.~(\ref{eq:PsiCFDet}). We assume that the effect of removing a composite fermion from the effective medium of $N$ composite fermions is negligible, thus have
\begin{equation}
K_{b}^{(a)}(\bar{\eta}_{i},\eta_{i}^{\prime})\approx K_{b}(\bar{\eta}_{i},\eta_{i}^{\prime}).\label{eq:Kbapprox}
\end{equation}
 After integrating out $\bm{\eta}_{i}^{\prime}$, we obtain
\begin{equation}
F_{b}\left(\bar{\eta},\eta\right)\approx2\int\mathrm{d}^{2}\bm{\eta}_{1}\ln\left(\left|\eta-\eta_{1}\right|^{2}\right)\rho_{\mathrm{v}}\left(\bm{\eta}_{1}\right).
\end{equation}
where $\rho_{\mathrm{v}}(\bm{\eta}_{1})$ is the vortex density defined in Eq.~(\ref{eq:rhov}). Applying the identity $\partial_{\eta}\partial_{\bar{\eta}}\ln(|\eta-\eta_{1}|^{2})=\pi\delta(\bm{\eta}-\bm{\eta}_{1})$, we have
\begin{equation}
\partial_{\eta}\partial_{\bar{\eta}}F_{b}\left(\bar{\eta},\eta\right)=2\pi\rho_{\mathrm{v}}\left(\bm{\eta}\right).\label{eq:Fbsc}
\end{equation}
In the long-wavelength limit, we have $F_{b}(\bar{\eta},\eta)\approx f_{b}(\bm{\eta})-\ln[l_{b}^{2}(\bm{\eta})/l_{b}^{2}]$ {[}see Eq.~(\ref{eq:FBappr}){]}. Substituting the relation into Eq.~(\ref{eq:Fbsc}), ignoring the spatial gradient of the magnetic length, and applying Eq.~(\ref{eq:ppfb}), we obtain the CS constraint Eq.~(\ref{eq:csb-1}).

We can then replace the normalization constraint $\braket{\Psi|\Psi}=1$ in Eq.~(\ref{eq:L}) with normalization constraints of the single-body wave-functions as well as the CS constraint Eq.~(\ref{eq:csb-1}), and introduce $\epsilon_{i}$ and $\phi(\bm{\eta})$ as respective Lagrange multipliers. The Lagrangian becomes
\begin{multline}
L=\int\mathrm{d}\mu_{B}(\bm{z})\mathrm{d}\mu_{b}(\bm{\eta})\sum_{i}\epsilon_{i}\left|\psi_{i}(z,\bar{\eta})\right|^{2}-\int\mathrm{d}\bm{\eta}\phi(\bm{\eta})\\
\times\left[\rho_{\mathrm{v}}\left(\bm{\eta}\right)-\frac{e}{2h}b\left(\bm{\eta}\right)\right]-\Braket{\Psi|V_{\mathrm{ee}}+\Phi|\Psi},
\end{multline}

We note that the requirement that $K_{b}(\bar{\eta},\eta^{\prime})$ is the reproducing kernel of the $\bm{\eta}$-space is a constraint more general than the CS constraint, since the latter is only valid in the long-wavelength limit. 

\subsection{Energy \label{subsec:Energy}}

In this subsection, we determine the expectation value $\Braket{\Psi|V_{\mathrm{ee}}+\Phi|\Psi}.$ We shall show how the kinetic energy of a composite fermion, i.e., the electron-vortex binding energy, would emerge out of the Coulomb interaction as a correlation effect.

We first determine the expectation value of the scalar potential $\braket{\Psi|\Phi|\Psi}$. Similar to Eq.~(\ref{eq:Fbapprox}), we have
\begin{multline}
\Braket{\Psi|\Phi|\Psi}\approx\sum_{i}\int\mathrm{d}\mu_{B}\left(\bm{z}_{i}\right)\mathrm{d}\mu_{b}\left(\bm{\eta}_{i}\right)\mathrm{d}\mu_{b}\left(\bm{\eta}_{i}^{\prime}\right)\Phi(\bm{z}_{i})\\
\times\frac{1}{N}\sum_{a}\psi_{a}^{\ast}\left(z_{i},\bar{\eta}_{i}\right)K_{b}^{(a)}\left(\bar{\eta}_{i},\eta_{i}^{\prime}\right)\psi_{a}\left(z_{i},\bar{\eta}_{i}^{\prime}\right).\label{eq:Phiapprox}
\end{multline}
Applying the approximation Eq.~(\ref{eq:Kbapprox}), we obtain
\begin{equation}
\Braket{\Psi|\Phi|\Psi}\approx\int\mathrm{d}\bm{z}\Phi(\bm{z})\rho_{\mathrm{e}}(\bm{z}).
\end{equation}

Next, we determine the expectation value of the Coulomb interaction energy. It can be written as
\begin{equation}
\left\langle V_{\mathrm{ee}}\right\rangle =\frac{e^{2}}{8\pi\varepsilon}\int\mathrm{d}\bm{z}\mathrm{d}\bm{z}^{\prime}\frac{\rho_{2}(\bm{z},\bm{z}^{\prime})-2\rho_{\mathrm{e}}(\bm{z})\rho_{0}+\rho_{0}^{2}}{\left|z-z^{\prime}\right|},
\end{equation}
where $\rho_{2}(\bm{z},\bm{z}^{\prime})=\braket{\Psi|\sum_{i\ne j}\delta(\bm{z}-\bm{z}_{i})\delta(\bm{z}^{\prime}-\bm{z}_{j})|\Psi}$ is the two-particle reduced density matrix of electrons. We decompose $\langle V_{\mathrm{ee}}\rangle$ into two parts. The first part is the mean-field contribution of the Coulomb interaction
\begin{equation}
\bar{V}_{\mathrm{ee}}=\frac{e^{2}}{8\pi\varepsilon}\int\mathrm{d}\bm{z}\mathrm{d}\bm{z}^{\prime}\frac{\left[\rho_{\mathrm{e}}(\bm{z})-\rho_{0}\right]\left[\rho_{\mathrm{e}}(\bm{z}^{\prime})-\rho_{0}\right]}{\left|\bm{z}-\bm{z}^{\prime}\right|},
\end{equation}
which gives rise to the Coulomb energy term of Eq.~(\ref{eq:Lagrangian}). The second part is the correlation contribution
\begin{equation}
T=\frac{e^{2}}{8\pi\varepsilon}\int\mathrm{d}\bm{z}\mathrm{d}\bm{z}^{\prime}\frac{\rho_{2}(\bm{z},\bm{z}^{\prime})-\rho_{\mathrm{e}}(\bm{z})\rho_{\mathrm{e}}(\bm{z}^{\prime})}{\left|\bm{z}-\bm{z}^{\prime}\right|},\label{eq:Vbdef}
\end{equation}
which gives rise to the binding energy between electrons and vortices.

We determine the two-particle reduced density matrix by applying the Hartree-like approximation introduced in the last subsection. We have $\rho_{2}(\bm{z},\bm{z}^{\prime})=N(N-1)w_{B}(\bm{z})w_{B}(\bm{z}^{\prime})\int\prod_{i=3}^{N}\mathrm{d}\mu_{B}(\bm{z}_{i})|\Psi(\{z_{i}\}|^{2}$ with $z_{1}=z$ and $z_{2}=z^{\prime}$. We treat the first particle ($\bm{z}_{1}$) as a test particle, and the ensemble of other $N-1$ particles as an effective medium. By expanding the Slater determinant Eq.~(\ref{eq:PsiCFDet}) along its first row, ignoring exchange terms in $|\Psi(\{z_{i}\})|^{2}$, and replacing the $N-1$ particle effective medium with the $N$-particle one as in Eq.~(\ref{eq:wfCFtest}), we can approximate $\rho_{2}$ as
\begin{align}
\rho_{2}(\bm{z},\bm{z}_{1})\approx & ~w_{B}(\bm{z})\int\mathrm{d}\mu_{b}(\bm{\eta})\mathrm{d}\mu_{b}(\bm{\eta}^{\prime})K_{b}(\bar{\eta},\eta^{\prime})\nonumber \\
 & \times\sum_{a}\psi_{a}^{\ast}(z,\bar{\eta})\psi_{a}(z,\bar{\eta}^{\prime})\rho_{\mathrm{c}}(\bm{z}_{1};\bar{\eta},\eta^{\prime}),\label{eq:rho2}\\
\rho_{\mathrm{c}}(\bm{z}_{1};\bm{\eta})= & w_{B}(\bm{z}_{1})N\int\prod_{i=2}^{N}\mathrm{d}\mu_{B}(\bm{z}_{i})\frac{\left|\Psi_{\eta}^{\mathrm{v}}\left(\left\{ z_{i}\right\} \right)\right|^{2}}{\Braket{\Psi_{\eta}^{\mathrm{v}}|\Psi_{\eta}^{\mathrm{v}}}},\label{eq:rhoc}
\end{align}
and $\rho_{\mathrm{c}}(\bm{z}_{1};\bar{\eta},\eta^{\prime})\equiv\rho_{\mathrm{c}}(\bm{z}_{1},\bm{\eta})|_{\eta\rightarrow\eta^{\prime}}$. $\rho_{\mathrm{c}}(\bm{z}_{1};\bm{\eta})$ is the density profile of electrons surrounding a vortex at $\bm{\eta}$, which would suppress the electron density in its proximity, creating a correlation hole.

The Coulomb attraction between the test (first) electron and the correlation hole gives rise to the binding energy of a composite fermion. Substituting Eq.~(\ref{eq:rho2}) and (\ref{eq:rhoe}) into Eq.~(\ref{eq:Vbdef}), we obtain

\begin{multline}
T\approx\int\mathrm{d}\mu_{B}(\bm{z})\mathrm{d}\mu_{b}(\eta)\mathrm{d}\mu_{b}(\eta^{\prime})K_{b}(\bar{\eta},\eta^{\prime})\\
\times\epsilon_{\mathrm{b}}^{\bigstar}(\bm{z};\bar{\eta},\eta^{\prime})\sum_{a}\psi_{a}^{\ast}(z,\bar{\eta})\psi_{a}(z\bar{\eta}^{\prime}),\label{eq:T}
\end{multline}
with $\epsilon_{\mathrm{b}}^{\bigstar}(\bm{z};\bar{\eta},\eta^{\prime})\equiv\epsilon_{\mathrm{b}}^{\bigstar}(\bm{z};\bm{\eta})|_{\eta\rightarrow\eta^{\prime}}$, and
\begin{equation}
\epsilon_{\mathrm{b}}^{\bigstar}(\bm{z};\bm{\eta})=\frac{e^{2}}{8\pi\varepsilon}\int\mathrm{d}\bm{z}_{1}\frac{\rho_{\mathrm{e}}(\bm{z}_{1})h(\bm{z}_{1};\bm{\eta})}{|z-z_{1}|},\label{eq:ebstar}
\end{equation}
where we define the electron-vortex pair correlation function
\begin{equation}
h(\bm{z}_{1};\bm{\bm{\eta}})=\frac{\rho_{\mathrm{c}}(\bm{z}_{1};\bm{\eta})}{\rho_{\mathrm{e}}(\bm{z}_{1})}-1.
\end{equation}
$\epsilon_{\mathrm{b}}^{\bigstar}(\bm{z};\bm{\eta})$ is the binding energy of a composite fermion. 

The electron-vortex correlation function describes the deviation of the electron density from its local average $\rho_{\mathrm{e}}(\bm{z}_{1})$ in the proximity of a vortex. We expect that the electron density is suppressed near the center of the vortex, and recovers in a length scale $\sim l_{B}$ (see the inset of Fig.~\ref{fig:Electron-vortex-binding-potentia}). We thus have $h(\bm{\bm{z}_{1}};\bm{\eta})<0$ for $\bm{z}_{1}\rightarrow\bm{\eta}$ and $h(\bm{z}_{1};\bm{\eta})\rightarrow0$ for $|\bm{z}_{1}-\bm{\eta}|\gg l_{B}$, where we assume that the void of electrons created by the vortex is centered at $\bm{\eta}$. This is true because the coordinate of an electron on average always coincide with the vortex that it binds to (see Appendix \ref{subsec:Vanishing-dipole-density}). Furthermore, we have the sum rule
\begin{equation}
\int h(\bm{z}_{1};\bm{\eta})\mathrm{d}\bm{z}_{1}=-4\pi l_{B}^{2}(\bm{\eta}).\label{eq:sumrule}
\end{equation}
This is because the insertion of a $2h/e$ vortex should induce a void of electrons with a total charge $2\nu e$, where $\nu\equiv2\pi l_{B}^{2}(\bm{\eta})\rho_{\mathrm{e}}(\bm{\eta})$ is the local filling factor. We assume that the density varies slowly over space, $h(\bm{z}_{1};\bm{\eta})$ can therefore be approximated as the pair correlation function of a homogeneous system: $h(\bm{z}_{1};\bm{\eta})\approx h_{0}(|\bm{z}_{1}-\bm{\eta}|/l_{B}(\bm{\eta}))$. For $h_{0}(r)$, the sum rule can be written as
\begin{equation}
\int_{0}^{\infty}\mathrm{d}rh_{0}(r)r=-2.
\end{equation}
It is notable that the sum rule is independent of the density. It is reasonable to expect that $h_{0}(r)$ only weakly depends on the density (or the filling fraction) since it has similar asymptotic behavior for different densities while constrained by a sum rule independent of the density.

The binding energy of a composite fermion can then be written as
\begin{align}
\epsilon_{\mathrm{b}}^{\bigstar}(\bm{z};\bm{\eta}) & \approx\frac{e^{2}l_{B}(\bm{z})}{8\pi\varepsilon}\rho_{\mathrm{e}}(\bm{z})u\left(\frac{|z-\eta|}{l_{B}(\bm{z})}\right),\label{eq:eb}\\
u(|x|) & =\int\mathrm{d}\bm{y}\frac{h_{0}(|\bm{y}|)}{|\bm{x+\bm{y}}|}.\label{eq:ur}
\end{align}
We see that the binding energy is proportional to the local electron density $\rho_{\mathrm{e}}(\bm{z})\approx\rho_{\mathrm{v}}(\bm{z})\equiv1/4\pi l_{b}^{2}(\bm{z})$. It gives rise to the density-of-sates correction of the kinetic energy (see Sec.~\ref{subsec:Wave-equation}). The peculiar feature of the phenomenological model turns out to a natural result of the interaction origin of the binding energy.

We expect that the function $u(r)$ is approximately a universal function, and only weakly depends on the filling factor or the density since it is determined by $h_{0}(r)$. We thus estimate $u(r)$ using the Laughlin state at $\nu=1/3$, for which we can complete the integrals with respect to $\{\bm{\eta}_{i}\}$ in Eq.~(\ref{eq:Psiv}), and have
\begin{equation}
\Psi_{\eta=0}^{\mathrm{v}}(\{z_{i}\})=\prod_{i}z_{i}^{2}\prod_{i<j}(z_{i}-z_{j})^{3},
\end{equation}
where we place the vortex at the origin of the space without loss of generality. The density profile of electrons surrounding the vortex can be determined numerically using the Monte-Carlo method. The result is shown in Fig.~\ref{fig:Electron-vortex-binding-potentia}. We find that $u(r)$ can be well fitted by the quadratic function $u(r)=c_{0}+c_{1}r^{2}$ in the region $r\in[0,2]$ with $c_{0}=-12.6$ and $c_{1}=1$~\footnote{Hao Jin, private communications.}.

\begin{figure}
\includegraphics{bindingenergy}

\caption{\label{fig:Electron-vortex-binding-potentia}Electron-vortex binding potential $u_{0}(r)$ for the $\nu=1/3$ Laughlin state. Dots are numerical results, and the solid line shows the fitting $u(r)=-12.6+r^{2}$. Inset: the electron-vortex pair correlation function $h_{0}(r)$. Calculated by Hao Jin. }
\end{figure}

\begin{comment}
for different densities shares is constrained by the sum rule Eq.~(\ref{eq:sumrule}), which can be written asFrom the definition of the pair correlation function and the wave function Eq.~(\ref{eq:Psiv}), it is easy to see $h_{0}(r)\propto r^{4}$ for $r\rightarrow0$. Using the arguments in Ref.~\onlinecite{girvin1984a}, one can show that for a homogeneous and isotropic system, the function can in general be written as
\begin{equation}
h_{0}(r)=-\left(1+\frac{r^{2}}{2}+\sum_{m\geq2}\frac{c_{m}}{2^{m}m!}r^{2m}\right)e^{-r^{2}/2},\label{eq:hexpand}
\end{equation}
where $\{c_{m}\}$ is a set of coefficients which may depends on the filling factor. The sum rule Eq.~(\ref{eq:sumrule}) leads to the constraint $\sum_{m\geq2}c_{m}=0$. The function in the region $r\lesssim1$, which is most relevant for a composite fermion, is mainly determined by the first two terms, while the non-universal terms involving $\{c_{m}\}$ only add small oscillatory contributions to $h_{0}(r)$ at $r\sim2$, and their contributions to $\epsilon_{\mathrm{b0}}$ tend to cancel each other due to the zero-sum constraint to the coefficients. Therefore, it is a good first approximation to keep only the first two terms of Eq.~(\ref{eq:hexpand}). We then have $\epsilon_{b0}(r)\approx(\pi/2)^{3/2}[r^{2}I_{1}(r^{2}/4)-(6+r^{2})I_{0}(r^{2}/4)]e^{-r^{2}/4}$, where $I_{n}$ denotes the modified Bessel function, and
\begin{align}
\epsilon_{b0}(r) & \approx-6\left(\frac{\pi}{2}\right)^{3/2}+\frac{1}{2}\left(\frac{\pi}{2}\right)^{3/2}r^{2}
\end{align}
for $r\lesssim1$. Since the electron and the vortex in a composite fermion are bounded in a length scale $\sim l_{B}$ (see Appendix \ref{appendix:-levels-of-the}), $\epsilon_{\mathrm{b}0}(r)$ can be well approximated by the quadratic form. The expansion coefficients turn out to be only a few percents off the values obtained from a more realistic calculation based on the $\nu=1/3$ Laughlin wave function using the Monte-Carlo method.
\end{comment}

The binding energy of a composite fermion can then be approximated as
\begin{equation}
\epsilon_{\mathrm{b}}^{\bigstar}(\bm{z};\bm{\eta})\approx-g_{0}\frac{e^{2}l_{B}(\bm{z})}{\varepsilon}\rho_{\mathrm{e}}(\bm{z})+\frac{\hbar^{2}}{2m^{\ast}}\frac{\left|\bm{z}-\bm{\eta}\right|^{2}}{l_{B}^{2}(\bm{z})l_{b}^{2}(\bm{z})},\label{eq:ebapprox}
\end{equation}
with the coefficients
\begin{align}
g_{0} & =-\frac{c_{0}}{8\pi},\\
\frac{\hbar^{2}}{m^{\ast}} & =\left(\frac{c_{1}}{4\pi}\right)\frac{e^{2}l_{B}(\bm{z})}{4\pi\varepsilon}.
\end{align}
We have $g_{0}\approx0.5$, and $c_{1}/4\pi\approx0.08$. The estimated effective mass is roughly four times larger than that commonly adopted in the literature ($\hbar^{2}/m^{\ast}\approx0.3e^{2}l_{B}/4\pi\varepsilon$)~\citep{halperin1993,hu2019}. On the other hand, effective masses determined in experiments vary with measurement methods~\citep{jain2007}. Our estimation is actually close to the cyclotron effective mass measured by Kukushkin et al.~\citep{kukushkin2002}. Ref.~\onlinecite{predin2023a} postulates an effective Hamiltonian consistent with the particle-hole symmetry, and also suggests that the effective mass should be four times larger.

We can collect the contribution of the first term of Eq.~(\ref{eq:ebapprox}), and define an exchange-correlation functional
\begin{equation}
E_{\mathrm{xc}}[\rho_{\mathrm{e}}]=g_{0}\frac{e^{2}}{\varepsilon}\int\mathrm{d}\bm{z}l_{B}(\bm{z})\rho_{\mathrm{e}}^{2}(\bm{z})+\dots~,
\end{equation}
where the ellipsis denotes all contributions to the energy which are ignored in our derivation, in particular the effect of particle exchanges. In the spirit of Kohn-Sham approach of the density functional theory, we could define $E_{\mathrm{xc}}[\rho_{\mathrm{e}}]$ as the difference between the exact ground state energy of a system with a uniform density $\rho_{\mathrm{e}}$ and the total kinetic energy of non-interacting composite fermions at the same density~\citep{zhang2015,hu2019}.

Combining all, we obtain the Lagrangian Eq.~(\ref{eq:Lagrangian}).

\section{Generalization for flat Chern bands \label{sec:Generalization-for-flat}}

The fractional quantum Hall effect is also predicted to emerge in systems containing flat Chern bands, i.e., Bloch bands which are nearly dispersion-less and have non-zero Chern numbers~\citep{parameswaran2013,bergholtz2013}. A flat Chern band is considered as a generalized ``Landau level'' which possesses essential properties for hosting the fractional quantum Hall effect. Conversely, a Landau level could be interpreted as an ideal flat Chern band with a Chern number $C=-1$ (for $B>0$)~\citep{zhang2016a}. One expects that interacting electrons confined in a flat Chern band behave similarly as in an ordinary Landau level. The expectation is recently confirmed in experiments~\citep{cai2023,zeng2023,park2023,xu2023}.

\begin{figure}
\includegraphics{CFdipolemodel_FCI}

\caption{\label{fig:CFdipolemodel-FCI}Dipole model of a composite fermion for a flat Chern band. Compared to the model presented in Fig.~\ref{fig:CFdipolemodel_FQH} for a Landau level, the electron is now confined in a Bloch band characterized by a Chern number $C$ and other parameters such as the Berry curvature $\Omega_{\bm{k}}$ and the quantum metric $\mathbb{G}_{\bm{k}}$. A Landau level can actually be interpreted as an ideal flat Chern band with $C=-1$, a constant Berry curvature, and vanishing $\mathrm{Tr}\mathbb{G}_{\bm{k}}-|\Omega_{\bm{k}}|$. The Landau level can be continuously evolved to a fractional Chern band with the same Chern number. One expects that the continuous evolution should not induce a topological phase transition to the state of vortices. The novel possibility that vortices adopt other topological states, in particular for flat Chern bands with $|C|\protect\ne1$, is possible but not considered in this work.}
\end{figure}

The generalization of our approach for flat Chern bands is straightforward. A dipole model is shown in Fig.~\ref{fig:CFdipolemodel-FCI}, where we replace the electron Landau level in Fig.~\ref{fig:CFdipolemodel_FQH} with a flat Chern band. The general idea presented in Sec.~\ref{subsec:Wave-function-ansatz-1} for constructing many-body wave-functions of electrons is still applicable. We still introduce vortices as auxiliary degrees of freedom which should be projected out in the end, and require that electrons always reside in their original and physical Hilbert space. We thus have the wave function ansatz for flat bands with $C<0$~\footnote{For $C>0$, the topological flat band could be continuously connected to Landau level(s) in a magnetic field with $B<0$. The definitions of the complex coordinates $\eta$ and $\bar{\eta}$ should be exchanged. }:
\begin{equation}
\Psi\left(\left\{ \bm{r}_{i}\right\} \right)=\int\prod_{i}\mathrm{d}\mu_{b}(\bm{\eta}_{i})J\left(\left\{ \eta_{i}\right\} \right)\Psi_{\mathrm{CF}}\left(\left\{ \bm{r}_{i},\bar{\eta}_{i}\right\} \right),\label{eq:wfansatzdp-1}
\end{equation}
where $\{\bm{r}_{i}\}$ denotes the set of coordinates of electrons. For a flat Chern band, unlike a Landau level, the wave functions $\Psi$ and $\Psi_{\mathrm{CF}}$ are generally not holomorphic in the coordinates of electrons. Instead, they should be expanded in the Bloch states of the flat band which span the physical Hilbert space. Thus, the single-body wave function of a composite fermion can generally be written as 
\begin{equation}
\psi(\bm{r},\bar{\eta})=\sum_{\bm{k}\in\mathrm{BZ}}\varphi_{\bm{k}}(\bar{\eta})e^{\mathrm{i}\bm{k}\cdot\bm{r}}u_{\bm{k}}(\bm{r}),\label{eq:psifcb}
\end{equation}
where $u_{\bm{k}}(\bm{r})$ denotes the periodic part of the Bloch wave function at the quasi-wave-vector $\bm{k}$ of the flat band, and the state of the composite fermion is represented by the wave function $\varphi_{\bm{k}}(\bar{\eta})$.

We can then introduce an effective Hamiltonian for composite fermions. In the enlarged Hilbert space of composite fermions, each electron in the flat band is bound to a vortex. While the binding potential could be derived microscopically as we have demonstrated for Landau levels in Sec.~\ref{subsec:Energy}, it is reasonable to assume that the harmonic form Eq.~(\ref{eq:Vbound}) is a good first approximation. Therefore, the effective Hamiltonian of a composite fermion can be written as
\begin{equation}
\hat{H}_{\mathrm{CF}}=\hat{T}_{\mathrm{e}}+\frac{\hbar^{2}}{2m^{\ast}l_{B}^{2}l_{b}^{2}}\left|\bm{r}-\hat{\bm{\eta}}\right|^{2},
\end{equation}
where $\hat{T}_{\mathrm{e}}$ is the electron kinetic energy, and we define the effective magnetic length
\begin{equation}
l_{B}^{2}\equiv\frac{|C|}{2\pi}V_{\mathrm{p}},
\end{equation}
with $V_{\mathrm{p}}$ being the area of the primitive cell of the system.

We can determine an effective Hamiltonian for $\varphi_{\bm{k}}(\bar{\eta})$. We need to determine the expectation value $\braket{\psi|\hat{H}_{\mathrm{CF}}|\psi}$ for $\psi$ defined by Eq.~(\ref{eq:psifcb}). It is easy to prove the identities:
\begin{align}
\Braket{\psi|\bm{r}|\psi} & =\sum_{\bm{k}}\varphi_{\bm{k}}^{\ast}(\bar{\eta})\left(\mathrm{i}\partial_{\bm{k}}+A_{\bm{k}}\right)\varphi_{\bm{k}}(\bar{\eta}),\\
\Braket{\psi|r^{2}|\psi} & =\sum_{\bm{k}}\varphi_{\bm{k}}^{\ast}(\bar{\eta})\left(\left|\mathrm{i}\partial_{\bm{k}}+A_{\bm{k}}\right|^{2}+\mathrm{Tr}\mathbb{G}_{\bm{k}}\right)\varphi_{\bm{k}}(\bar{\eta}),
\end{align}
where $\bm{A}_{\bm{k}}$ and $\mathbb{G}_{\bm{k}}$ are the Berry connection and quantum metric tensor of the flat band, respectively, defined by~\citep{roy2014}
\begin{align}
\bm{A}_{\bm{k}} & =\mathrm{i}\Braket{u_{\bm{k}}|\partial_{\bm{k}}u_{\bm{k}}},\\
\mathbb{G}_{\bm{k}}^{ab} & =\mathrm{Re}\Braket{\partial_{k_{a}}u_{\bm{k}}|\partial_{k_{b}}u_{\bm{k}}}-A_{\bm{k}}^{a}A_{\bm{k}}^{b}.
\end{align}
Applying the identities, we obtain (for $C<0$):
\begin{equation}
\Braket{\psi|\hat{H}_{\mathrm{CF}}|\psi}=\sum_{\bm{k}}\varphi_{\bm{k}}^{\ast}(\bar{\eta})\hat{H}\varphi_{\bm{k}}(\bar{\eta}),
\end{equation}
\begin{multline}
\hat{H}=\epsilon_{\bm{k}}+\frac{\hbar^{2}}{2m^{\ast}l_{B}^{2}l_{b}^{2}}\left(\mathrm{Tr}\mathbb{G}_{\bm{k}}+\Omega_{\bm{k}}\right)\\
+\frac{\hbar^{2}}{2m^{\ast}l_{B}^{2}l_{b}^{2}}\left(2\mathrm{i}\partial_{k}+\bar{A}_{\bm{k}}-\bar{\eta}\right)\left(2\mathrm{i}\partial_{\bar{k}}+A_{\bm{k}}-\hat{\eta}\right),\label{eq:Hfcb}
\end{multline}
where $\epsilon_{\bm{k}}$ and $\Omega_{\bm{k}}$ are the dispersion and Berry curvature of the flat band, respectively. The form of the $\hat{\eta}$ operator depends on the reproducing kernel of the Bergman space of vortices {[}see Eq.~(\ref{eq:etahat1}){]}, which should be self-consistently determined by the density profile of vortices using Eq.~(\ref{eq:Fbsc}). As a first approximation, one could assume that the vortex density is nearly homogeneous, thus $\hat{\eta}=2l_{b}^{2}\partial_{\bar{\eta}}$.

We could predict the stability of a fractional Chern insulator by determining the eigen-spectrum of the single-body effective Hamiltonian Eq.~(\ref{eq:Hfcb}). For an ideal flat band with a uniform Berry curvature, only the last term remains, and it is easy to show that the Hamiltonian gives rise to the ordinary $\Lambda$-levels (see Appendix \ref{appendix:-levels-of-the}). For the more general cases, the last term always yields zero-energy for the lowest $\Lambda$-level in the absence of the first two terms. However, we expect that the first two terms will make $\Lambda$-levels non-degenerate and suppress excitation gaps. When the gaps are closed, fractional Chern insulators will be destroyed. The application of the effective Hamiltonian to real materials is left for future investigation.

The form of the effective Hamiltonian seems to justify the heuristic trace condition which requires $\mathrm{Tr}\mathbb{G}_{\bm{k}}-|\Omega_{\bm{k}}|\approx0$ everywhere in the Brillouin zone for the emergence of a fractional Chern insulator~\citep{roy2014,wang2021a}. We see that the second term, which is proportional to $\mathrm{Tr}\mathbb{G}_{\bm{k}}+\Omega_{\bm{k}}=\mathrm{Tr}\mathbb{G}_{\bm{k}}-|\Omega_{\bm{k}}|$ for $\Omega_{\bm{k}}<0$~\footnote{For $C>0$ and $\Omega_{\bm{k}}>0$, the definitions of $\eta$ and $\bar{\eta}$, $k$ and $\bar{k}$ should be exchanged in Eq.~(\ref{eq:Hfcb}). The second term of $\hat{H}$ will be proportional to $\mathrm{Tr}\mathbb{G}_{\bm{k}}-\Omega_{\bm{k}}=\mathrm{Tr}\mathbb{G}_{\bm{k}}-|\Omega_{\bm{k}}|$ for $\Omega_{\bm{k}}>0$.}, renormalizes the dispersion $\epsilon_{\bm{k}}$ of electrons. As the renormalization tends to make a band less flat, it would destabilize a fractional Chern insulator. On the other hand, it could be possible to engineer the correction to compensate the electron dispersion and make a band flatter after the renormalization. The latter suggests a novel possibility that fractional Chern insulators could emerge even in dispersive topological bands.

\section{Summary and discussion \label{sec:Summary-and-discussion}}

In summary, we present a reformulation of the theory of composite fermions based on the dipole picture. Some new insights emerge.

Firstly, states of composite fermions can be determined by solving a wave equation, as demonstrated in Sec.~\ref{subsec:Wave-equation}. Moreover, the effective Hamiltonian of composite fermions can be derived from first principles, as demonstrated in Sec.~\ref{subsec:Energy}. While these are common practices for determining electron states in the real world, one usually relies on intuitions or educated guesses for composite fermions of the fictitious world. We basically show that the states of composite fermions can also be determined from first principles. In Sec.~\ref{subsec:Wave-equation:-the-1}, we show that such an approach indeed leads to the physical wave functions which were prescribed and thoroughly tested in the standard theory of composite fermions, specifically for ideal fractional quantum Hall states in the lowest Landau level. However, our approach does not always guarantee results that coincide with hypothetical ones, in particular for those puzzling states observed in higher Landau levels~\citep{baer2014}.

Secondly, the wave function ansatz can be reinterpreted as the projection of a state of composite fermions onto a state of vortices: $\Psi=\hat{P}_{\mathrm{v}}\Psi_{\mathrm{CF}}$. In this new interpretation, the Bijl-Jastrow factor becomes the complex conjugate of the wave function of the vortex state, rather than the numerator of the singular CS transformation. The reinterpreted ansatz is simpler: a physical wave function can be constructed by applying a single projection, whereas the standard ansatz requires two steps \textemdash{} attaching the flux tubes and projecting into the lowest Landau level. On the other hand, while the integral form of the ansatz Eq.~(\ref{eq:PsiCFtoPsi}) could be interpreted as a ``hierarchy'' wave function~\citep{wen2004,bonderson2008}, $\Psi_{\mathrm{CF}}(\{z_{i},\bar{\eta}_{i}\})$ in it is not obligated to assume a simplistic conjectured form. Constructing $\Psi_{\mathrm{CF}}(\{z_{i},\bar{\eta}_{i}\})$ for a general fraction is hence greatly simplified since it is determined by a wave equation instead of an intricate hierarchical scheme. 

Thirdly, the responses of composite fermions to the low-energy and long-wavelength external electromagnetic perturbations can be determined by solving the wave-equations Eqs.~(\ref{eq:TDWEQ1}, \ref{eq:TDWEQ2}). The effective Hamiltonian Eq.~(\ref{eq:Hdipole}) that governs the evolution of the wave functions has drift velocity corrections which are not present in the HLR theory. Consequently, the responses will be different from those predicted by the HLR theory, as already demonstrated in previous studies using the semi-classical phenomenological model~\citep{ji2020a,ji2021}.

Fourthly, the wave function ansatz and the effective theory can be unified on a common basis using the dipole picture. On the one hand, the picture motivates the development of the new wave function ansatz. On the other hand, using the ansatz and the microscopic Lagrangian of interacting electrons confined in a Landau level, the Lagrangian Eq.~(\ref{eq:Lagrangian}), which underlies the effective theory of the dipole picture, can be derived from first principles. The logical connection between the two complimentary components of the composite fermion theory can then be established.

Finally, the simple structure of the new wave function ansatz makes it much easier to generalize and apply the theory of composite fermions for more general systems such as flat Chern bands. In the new ansatz, electrons always reside in their original and physical Hilbert space. To generalize the theory, as demonstrated in Sec.~\ref{sec:Generalization-for-flat}, one can simply substitute the Hilbert space of electrons. Moreover, by substituting the state of vortices, the theory could describe and classify more exotic topological states of electrons. The latter could be a subject of future investigations.
\begin{acknowledgments}
I acknowledges Hao Jin for the assistance of determining the binding energy of composite fermion in $\nu=1/3$, Di Xiao for bringing to my attention the recent developments of fractional Chern insulators and sharing the manuscript of Ref.~\onlinecite{wang2023}, and Yinhan Zhang, Guangyue Ji, Bo Yang, Yue Yu and Xi Lin for useful discussions. I thank Osamu Sugino and Ryosuke Akashi for their hospitality during the HISML workshop, during which some of the ideas for this work were developed. The work is supported by the National Key R\&D Program of China under Grand Nos.~ 2021YFA1401900 and 2018YFA0305603, and the National Science Foundation of China under Grant No.~12174005. 
\end{acknowledgments}


\appendix

\section{$\bm{\Lambda}$-levels of the fractional quantum Hall states \label{appendix:-levels-of-the}}

The wave equation (\ref{eq:cfweq1}) is the same as that for an ordinary charge particle in an effective magnetic field $\bm{\mathcal{B}}$ except for an unimportant constant. Therefore, the wave functions of $\Lambda$-levels are just those for ordinary Landau levels, which can be written as~\citep{jain2007}
\begin{equation}
\varphi_{n,m}(\bm{\xi})\propto\frac{e^{-|\xi|^{2}/4l^{2}}}{\sqrt{2\pi}l}f_{n,m}(\bm{\xi}),
\end{equation}
with
\begin{multline}
f_{n,m}(\bm{\xi})=c_{nm}l^{2n+m}e^{|\xi|^{2}/2l^{2}}\\
\times\begin{cases}
\partial_{\xi}^{n}\partial_{\bar{\xi}}^{m+n}e^{-|\xi|^{2}/2l^{2}} & \nu<\frac{1}{2}\\
\partial_{\bar{\xi}}^{n}\partial_{\xi}^{m+n}e^{-|\xi|^{2}/2l^{2}} & \nu>\frac{1}{2}
\end{cases}\label{eq:CFwf1}
\end{multline}
and $c_{nm}\equiv\sqrt{2^{2n+m}/n!(m+n)!}$, $m\ge-n$. $\psi_{mn}(z,\bar{\eta})$ is related to $\varphi_{n,m}(z,\bar{\eta})\equiv\varphi_{n,m}(\bm{\xi})|_{\xi\rightarrow z,\bar{\xi}\rightarrow\bar{\eta}}$ by Eq.~(\ref{eq:psivarphi}), and normalized by Eq.~(\ref{eq:normalization}). We have

\begin{equation}
\psi_{n,m}(z,\bar{\eta})=f_{n,m}(z,\bar{\eta})\begin{cases}
\frac{l_{B}}{l}\left(\frac{l_{B}}{l_{b}}\right)^{n}e^{z\bar{\eta}/2l_{b}^{2}} & \nu<\frac{1}{2}\\
\frac{l_{b}}{l}\left(\frac{l_{b}}{l_{B}}\right)^{n}e^{z\bar{\eta}/2l_{B}^{2}} & \nu>\frac{1}{2}
\end{cases},\label{eq:CFwf}
\end{equation}
The corresponding eigen-energies are
\begin{equation}
\epsilon_{n,m}=\hbar\omega_{c}^{\ast}\begin{cases}
n & \nu<1/2\\
n+1 & \nu>1/2
\end{cases},
\end{equation}
with $\omega_{c}^{\ast}\equiv e|\mathcal{B}|/m^{\ast}$.

For the special case $\nu=1/2$, $B=b$, we have $\mathcal{B}=0$. The wave function is plane-wave like:
\begin{equation}
\psi_{\bm{k}}(z,\bar{\eta})=\frac{l_{B}}{\sqrt{2\pi}}e^{\mathrm{i}\frac{\bar{k}z+k\bar{\eta}}{2}+\frac{z\bar{\eta}}{2l_{B}^{2}}-\frac{\left|k\right|^{2}l_{B}^{2}}{4}},\label{eq:psik}
\end{equation}
where $\bm{k}\equiv(k_{x},k_{y})$ denotes the wave-vector of the state, and $k\equiv k_{x}+\mathrm{i}k_{y}$, $\bar{k}=k^{\ast}$. The wave function is normalized by $\int\mathrm{d}\mu_{B}(\bm{z})\mathrm{d}\mu_{b}(\bm{\eta})\psi_{\bm{k}}^{\ast}(z,\bar{\eta})\psi_{\bm{k}^{\prime}}(z,\bar{\eta})=\delta(\bm{k}-\bm{k}^{\prime})$.

It is easy to show that the wave function does describe a bound state of an electron and a vortex. Its spatial distribution can be written as
\begin{multline}
\left|\psi_{n,m}\left(z,\bar{\eta}\right)\right|^{2}e^{-\left|z\right|^{2}/2l_{B}^{2}-\left|\eta\right|^{2}/2l_{b}^{2}}\\
\propto\begin{cases}
e^{-\left|z\right|^{2}/2l^{2}-\left|z-\eta\right|^{2}/2l_{b}^{2}} & \nu<1/2\\
e^{-\left|\eta\right|^{2}/2l^{2}-\left|z-\eta\right|^{2}/2l_{B}^{2}} & \nu>1/2
\end{cases}.
\end{multline}
We see that the electron and the vortex are bound by a Gaussian factor with a length scale $l_{b}$ ($l_{B}$) for $\nu<1/2$ ($\nu>1/2$).

We can also directly solve Eq.~(\ref{eq:cfweqstd}), and obtain wave functions in the standard representation:
\begin{equation}
\tilde{\varphi}_{n,m}\left(\bm{\xi}\right)=\frac{e^{-\frac{\left|\xi\right|^{2}}{4l^{2}}}}{\sqrt{2\pi}l}f_{n,m}\left(\bm{\xi}\right)\begin{cases}
\left(\frac{l_{b}}{l_{B}}\right)^{n} & \nu<\frac{1}{2}\\
\left(\frac{l_{B}}{l_{b}}\right)^{n+1} & \nu>\frac{1}{2}
\end{cases}.\label{eq:varphiprime}
\end{equation}
where the normalization constants are fixed using Eq.~(\ref{eq:orthonormal-2}). $\tilde{\psi}_{n,m}(\bm{\xi})$ is related to $\tilde{\varphi}_{n,m}$ via Eq.~(\ref{eq:psitildevarphitilde}). It is straightforward to verify that $\psi_{n,m}(z,\bar{\eta})$ and $\tilde{\psi}_{n,m}(\bm{\xi})$ are related by Eq.~(\ref{eq:transformpsiCF}).

An alternative way of solving the wave equation Eq.~(\ref{eq:cfweq}) is to define a set of ladder operators~\citep{jain2007}. For the filing factor $\nu<1/2$, the ladder operators are
\begin{align}
\hat{a} & =\frac{1}{\sqrt{2}}\frac{l}{l_{B}l_{b}}\left(z-\hat{\eta}\right)\label{eq:a}\\
\hat{a}^{\dagger} & =\frac{1}{\sqrt{2}}\frac{l}{l_{B}l_{b}}\left(\hat{\bar{z}}-\bar{\eta}\right),\\
\hat{b} & =\frac{l}{\sqrt{2}}\left(\frac{\hat{\bar{z}}}{l_{B}^{2}}-\frac{\bar{\eta}}{l_{b}^{2}}\right),\\
\hat{b}^{\dagger} & =\frac{l}{\sqrt{2}}\left(\frac{z}{l_{B}^{2}}-\frac{\hat{\eta}}{l_{b}^{2}}\right).\label{eq:b+}
\end{align}
It is easy to verify the commutation relations $[\hat{a},\hat{a}^{\dagger}]=1$ and $[\hat{b},\hat{b}^{\dagger}]=1$. For $\nu>1/2$, the ladder operators can be obtained by exchanging $l_{b}\leftrightarrow l_{B}$ and $z\leftrightarrow\bar{\eta}$ in the definitions. Such an approach would be more easily generalized for determining the spectrum of Eq.~(\ref{eq:Hfcb}). 

\section{Alternative form of the quantization \label{sec:star-transformation}}

There are two alternative ways of defining the quantization. The first one is defined by Eq.~(\ref{eq:Hhatpsi}). With the $\hat{\bar{z}}$ operator defined by Eq.~(\ref{eq:zhat}), the $\hat{H}$ operator can be written as $\hat{H}=N_{+}[H(\hat{\bar{z}},z)]$, where $N_{+}$ denotes the normal ordering that places $\hat{\bar{z}}$ to the left of all $z$'s. Alternatively, we can define
\begin{equation}
\left[\hat{H}\psi\right]\left(z\right)=\int\mathrm{d}\mu_{B}(\bm{\xi})K_{B}\left(z,\bar{\xi}\right)H^{\bigstar}\left(z,\bar{\xi}\right)\psi\left(\xi\right),\label{eq:Hpsi1}
\end{equation}
which corresponds $\hat{H}=N_{-}\left[H^{\bigstar}(z,\hat{\bar{z}})\right]$ with the anti-normal ordering $N_{-}$ that places $\hat{\bar{z}}$ to the right of all $z$'s. For a given $\hat{H}$ operator, the $H$ and $H^{\bigstar}$ functions is related by the transformation
\begin{multline}
H^{\bigstar}\left(z,\bar{\xi}\right)=\frac{1}{K_{B}\left(z,\bar{\xi}\right)}\\
\times\int\mathrm{d}\mu_{B}\left(\bm{\zeta}\right)K_{B}\left(z,\bar{\zeta}\right)H\left(\bar{\zeta},\zeta\right)K_{B}\left(\zeta,\bar{\xi}\right).\label{eq:Hstar}
\end{multline}
It is easy to verify that Eq.~(\ref{eq:Hpsi1}) reduces to Eq.~(\ref{eq:Hhatpsi}) after substituting Eq.~(\ref{eq:Hstar}).

For an ideal system with the reproducing kernel Eq.~(\ref{eq:KB0}), the transformation is just a Gaussian convolution:
\begin{equation}
H^{\bigstar}\left(z,\bar{z}\right)=\int\frac{\mathrm{d}^{2}\bm{\xi}}{2\pi l_{B}^{2}}e^{-\left|z-\xi\right|^{2}/2l_{B}^{2}}H\left(\bar{\xi},\xi\right),\label{eq:gm}
\end{equation}
and $H^{\bigstar}(z,\bar{\xi})=H^{\bigstar}(z,\bar{z})|_{\bar{z}\rightarrow\bar{\xi}}$. For a function $H(\bar{\xi},\xi)$ which varies slowly over space in a length scale much larger than $l_{B}$, we have
\begin{equation}
H^{\bigstar}(z,\bar{\xi})=\left.H(\bar{z},z)\right|_{\bar{z}\rightarrow\bar{\xi}}+\mathcal{O}\left(l_{B}^{2}\nabla^{2}H\right).\label{eq:starapprox}
\end{equation}

The vector potential $\bar{A}$ and its starred counterpart $\bar{A}^{\bigstar}$ are also related by the transformation. To see that, we note that $\partial_{z}\psi(z)$ can be written in the two alternative forms:
\begin{align}
\partial_{z}\psi(z) & =\int\mathrm{d}\tilde{\mu}_{B}\left(\xi\right)K_{B}\left(z,\bar{\xi}\right)\partial_{\xi}\psi\left(\xi\right)\label{eq:ppsi1}\\
 & =\int\mathrm{d}\tilde{\mu}_{B}\left(\xi\right)\left[\partial_{z}K_{B}\left(z,\bar{\xi}\right)\right]\psi\left(\xi\right).
\end{align}
Applying integral by parts to the first form, we have
\begin{multline}
\int\mathrm{d}\tilde{\mu}_{B}\left(\xi\right)K_{B}\left(z,\bar{\xi}\right)\bar{A}\left(\bar{\xi},\xi\right)\psi\left(\xi\right)\\
=\int\mathrm{d}\tilde{\mu}_{B}\left(\xi\right)K_{B}\left(z,\bar{\xi}\right)\bar{A}^{\bigstar}\left(\bar{\xi},z\right)\psi\left(\xi\right).
\end{multline}
The two sides of the equation correspond to the two alternative quantization forms of the vector potential. Therefore, $\bar{A}$ and $\bar{A}^{\bigstar}$ are related by the transformation Eq.~(\ref{eq:Hstar}). 

From Eq.~(\ref{eq:starapprox}), it is easy to show 
\begin{equation}
\bar{A}^{\bigstar}(\bar{\xi},z)\approx\left.\bar{A}(\bar{z},z)\right|{}_{\bar{z}\rightarrow\bar{\xi}}
\end{equation}
for a nearly uniform magnetic field in the long-wavelength limit. The lowest-order correction to the approximation is proportional to the first gradient of the magnetic field. To see that, we decompose the vector potentials as $\bar{A}(\bar{z},z)=\mathrm{i}B_{0}\bar{z}/2+\bar{A}_{1}(\bar{z},z)$ and $\bar{A}^{\bigstar}(z,\bar{\xi})=\mathrm{i}B_{0}\bar{\xi}/2+\bar{A}_{1}^{\bigstar}(z,\bar{\xi)}$. The first parts can be related exactly by the transformation Eq.~(\ref{eq:Hstar}). The second parts, which are assumed to be small compared to the uniform (first) parts, can be related approximately by Eq.~(\ref{eq:gm}) and (\ref{eq:starapprox}). Combining the two parts, we get the approximate relation.

We can also related $f_{B}$ with $F_{B}$. In the long-wavelength limit, Eq.~(\ref{eq:reprodkern}) can be approximated as
\begin{multline}
\psi(z)\approx\int\mathrm{d}\mu^{(0)}(\bm{z})K_{B}^{(0)}(z,\bar{\xi})\\
\times\left[1-f_{B}^{(1)}(\bm{\xi})+F_{B}^{(1)}(\bar{\xi},z)\right]\psi(\xi),
\end{multline}
where $f_{B}^{(1)}$ and $F_{B}^{(1)}$ denote the corrections to the exponential factors of the weight and the reproducing kernel from the non-uniform part of the magnetic field, respectively. We expand $f_{B}^{(1)}$ and $F_{B}^{(1)}$ to the linear order of $\bar{\xi}$ around a point $\bar{\eta}\approx\bar{z}$, and complete the integral. We have
\begin{multline}
\psi(z)\approx\biggr[1-f_{B}^{(1)}(\bar{\eta},z)+F_{B}^{(1)}(\bar{\eta},z)\\
-2l_{B}^{2}\partial_{z}\partial_{\bar{\eta}}f_{B}^{(1)}(\bar{\eta},z)\biggr]\psi(z).
\end{multline}
To satisfy the relation, we have
\begin{equation}
F_{B}(z,\bar{\eta})\approx\left.\left[f_{B}(\bm{z})-\ln\frac{l_{B}^{2}(\bm{z})}{l_{B}^{2}}\right]\right|_{\bar{z}\rightarrow\bar{\eta}}.\label{eq:FBappr}
\end{equation}

The quantization of the vortex degree of freedom and its alternative form can be defined similarly.

\section{Operators in the standard representation}

\subsection{Ideal systems \label{subsec:Ideal-systems-operators}}

In ideal systems, wave functions of composite fermions in the dipole representation and the standard representation are related by Eq.~(\ref{eq:transformpsiCF}). Transforming to the standard representation, we have
\begin{align}
\bar{z}\psi\left(z,\bar{\eta}\right)\rightarrow & 2l_{B}^{2}\partial_{z}\psi\left(z,\bar{\eta}\right)\nonumber \\
= & \int\mathrm{d}\mu_{B}^{(0)}\left(\bm{\xi}\right)e^{z\bar{\xi}/2l_{B}^{2}+\xi\bar{\eta}/2l_{b}^{2}}\bar{\xi}\tilde{\psi}\left(\bm{\xi}\right),\\
z\psi\left(z,\bar{\eta}\right)= & \int\mathrm{d}\mu_{B}^{(0)}\left(\bm{\xi}\right)\left[2l_{B}^{2}\partial_{\bar{\xi}}e^{z\bar{\xi}/2l_{B}^{2}+\xi\bar{\eta}/2l_{b}^{2}}\right]\tilde{\psi}\left(\bm{\xi}\right)\nonumber \\
= & \int\mathrm{d}\mu_{B}^{(0)}\left(\bm{\xi}\right)e^{z\bar{\xi}/2l_{B}^{2}+\xi\bar{\eta}/2l_{b}^{2}}\nonumber \\
 & \times\left(-2l_{B}^{2}\partial_{\bar{\xi}}+\xi\right)\tilde{\psi}\left(\bm{\xi}\right),
\end{align}
and similar expressions for $\eta$ and $\bar{\eta}$. Therefore, in the standard representation, the operators should be mapped to:
\begin{align}
z & \rightarrow-2l_{B}^{2}\partial_{\bar{\xi}}+\xi,\\
\bar{z} & \rightarrow\bar{\xi},\\
\eta & \rightarrow\xi,\\
\bar{\eta} & \rightarrow-2l_{b}^{2}\partial_{\xi}+\left(l_{b}^{2}/l_{B}^{2}\right)\bar{\xi}.
\end{align}

We can apply the mappings to Eq.~(\ref{eq:Vbound}) and obtain a wave equation for $\tilde{\psi}(\bm{\xi})$. After applying the transformation Eq.~(\ref{eq:psitildevarphitilde}), we obtain Eq.~(\ref{eq:cfweqstd}).

\subsection{General systems \label{subsec:General-systems-operators}}

For general systems, wave functions in the dipole representation and the standard representation are related by Eq.~(\ref{eq:transforCFgeneral}). For the $\hat{\bar{z}}$ operator defined in Eq.~(\ref{eq:zhat}), we have 
\begin{equation}
\hat{\bar{z}}\psi\left(z,\bar{\eta}\right)=\int\mathrm{d}\mu_{B}\left(\bm{\xi}\right)K_{B}\left(z,\bar{\xi}\right)K_{b}\left(\bar{\eta},\xi\right)\bar{\xi}\tilde{\psi}\left(\bm{\xi}\right).
\end{equation}

On the other hand, applying complex conjugation to Eq.~(\ref{eq:zhat}) and exchanging $\bm{z}$ and $\bm{\xi}$, we obtain 
\begin{equation}
\hat{\bar{z}}^{\ast}\left(\partial_{\xi},\xi\right)K_{B}\left(z,\bar{\xi}\right)=zK_{B}\left(z,\bar{\xi}\right).
\end{equation}
Here, we make use of the relation $[K_{B}(z,\bar{\xi})]^{\ast}=K_{B}(\xi,\bar{z})$. We thus have
\begin{align}
z\psi\left(z,\bar{\eta}\right)= & \int\mathrm{d}\mu_{B}\left(\xi\right)\left[\hat{\bar{z}}^{\ast}\left(\partial_{\xi},\xi\right)K_{B}\left(z,\bar{\xi}\right)\right]\nonumber \\
 & \times K_{b}\left(\bar{\eta},\xi\right)\tilde{\psi}\left(\bm{\xi}\right)\\
= & \int\mathrm{d}\mu_{B}\left(\xi\right)K_{B}\left(z,\bar{\xi}\right)K_{b}\left(\bar{\eta},\xi\right)\nonumber \\
 & \times\hat{\bar{z}}^{\dagger}\left(\partial_{\xi}-\frac{\mathrm{i}e}{\hbar}\bar{A}\left(\bm{\xi}\right),\xi\right)\tilde{\psi}\left(\bm{\xi}\right)
\end{align}
Here we apply integral by parts and make use of Eq.~(\ref{eq:pzfb}). Note $(\partial_{\xi})^{\dagger}=-\partial_{\bar{\xi}}$. The mappings of $\eta$ and $\bar{\eta}$ can be obtained similarly.

All summarized, we have the following mapping rules in the standard representation:
\begin{align}
\bar{z} & \rightarrow\bar{\xi},\label{eq:mapzbar}\\
\eta & \rightarrow\xi,\\
z & \rightarrow\hat{\bar{z}}^{\dagger}\left(\partial_{\xi}-\frac{\mathrm{i}e}{\hbar}\bar{A}(\bm{\xi}),\xi\right),\\
\bar{\eta} & \rightarrow\hat{\eta}^{\dagger}\left(\partial_{\bar{\xi}}+\frac{\mathrm{i}e}{\hbar}A(\bm{\xi}),\xi\right).\label{eq:mapetabar}
\end{align}


\subsection{Hamiltonian in the standard representation \label{subsec:Hamiltonian-in-the}}

Using Eq.~(\ref{eq:deltazbar}) and (\ref{eq:deltaeta}), we can determine approximate forms of $\hat{\bar{z}}^{\dagger}$ and $\hat{\eta}^{\dagger}$: 
\begin{align}
\hat{\bar{z}}^{\dagger}\left(\partial_{\xi}-\frac{\mathrm{i}e}{\hbar}\bar{A},\xi\right)-\xi & \approx-2l_{B}^{2}(\bm{\xi})\partial_{\bar{\xi}},\\
\hat{\eta}^{\dagger}\left(\partial_{\xi}+\frac{\mathrm{i}e}{\hbar}A,\xi\right)-\bar{\xi} & \approx-2l_{b}^{2}(\bm{\xi})\left[\partial_{\xi}+\mathrm{i}\frac{e}{\hbar}\bar{\mathcal{A}}\right].
\end{align}

Applying Eqs.~(\ref{eq:mapzbar}\textendash \ref{eq:mapetabar}), we map the kinetic energy to 
\begin{multline}
\frac{\hbar^{2}}{2m^{\ast}}\frac{1}{l_{b}^{2}(\bm{\eta})l_{B}^{2}(\bm{z})}\left(\hat{\bar{z}}-\bar{\eta}\right)\left(z-\hat{\eta}\right)\\
\rightarrow-\frac{\hbar^{2}}{2m^{\ast}}\left(2\partial_{\xi}+\frac{2\mathrm{i}e}{\hbar}\bar{\mathcal{A}}\right)2\partial_{\bar{\xi}}.
\end{multline}
 The potentials are mapped to 
\begin{multline}
N_{+}\left[\Phi_{\mathrm{eff}}\left(\hat{\bar{z}},z\right)\right]\rightarrow N_{+}\left[\Phi_{\mathrm{eff}}\left(\bar{\xi},\xi-2l_{B}^{2}(\bm{\xi})\partial_{\bar{\xi}}\right)\right]\\
\approx\Phi_{\mathrm{eff}}\left(\bm{\xi}\right)-2l_{B}^{2}(\bm{\xi})\partial_{\xi}\Phi_{\mathrm{eff}}\left(\bm{\xi}\right)\partial_{\bar{\xi}},
\end{multline}
\begin{multline}
N_{+}\left[\phi\left(\bar{\eta},\hat{\eta}\right)\right]\rightarrow N_{+}\left[\phi\left(\bar{\xi}-2l_{b}^{2}(\bm{\xi})\left(\partial_{\xi}+\mathrm{i}\frac{e}{\hbar}\bar{\mathcal{A}}\right),\xi\right)\right]\\
\approx\phi\left(\bm{\xi}\right)-2l_{b}^{2}(\bm{\xi})\partial_{\bar{\xi}}\phi\left(\bm{\xi}\right)\left(\partial_{\xi}+\frac{\mathrm{i}e}{\hbar}\bar{\mathcal{A}}\right).
\end{multline}

We can then have the wave equation $\epsilon\tilde{\psi}(\bm{\xi})=\hat{\tilde{H}}_{\psi}\tilde{\psi}(\bm{\xi})$ for $\tilde{\psi}(\bm{\xi})$, with the Hamiltonian:
\begin{multline}
\hat{\tilde{H}}_{\psi}\approx-\frac{\hbar^{2}}{2m^{\ast}}\left(2\partial_{\xi}+\frac{2\mathrm{i}e}{\hbar}\bar{\mathcal{A}}+\frac{2m^{\ast}l_{B}^{2}}{\hbar^{2}}\partial_{\xi}\Phi_{\mathrm{eff}}\right)\\
\times\left(2\partial_{\bar{\xi}}+\frac{2m^{\ast}l_{b}^{2}}{\hbar^{2}}\partial_{\bar{\xi}}\phi\right)+\Phi_{\mathrm{eff}}+\phi,
\end{multline}
where we ignore all terms proportional to the gradients of the strengths of the electric and magnetic fields.

Applying the transformation Eq.~(\ref{eq:cftransform}), we obtain the wave equation Eq.~(\ref{eq:weqstd}).

\section{Current densities \label{sec:Current-densities}}

\subsection{Current density in a Landau level}

In a Landau level, the particle density of a state $\psi$ can be defined as
\begin{equation}
\rho(\bm{z},t)=w(\bm{z},t)\left|\psi(z,t)\right|^{2},
\end{equation}
where $w(\bm{z})$ denotes the weight of the Bergman space. The wave-equation in the space can be generally written as
\begin{equation}
\mathrm{i}\hbar\frac{\partial\psi}{\partial t}=\int\mathrm{d}\mu(\bm{\xi})K(z,\bar{\xi})H^{\bigstar}(\bar{\xi},z)\psi(\xi,t).
\end{equation}

We can determine the current density by establishing a continuity equation for $\rho(\bm{z})$. We have
\begin{multline}
\frac{\partial\rho(\bm{z},t)}{\partial t}=\frac{1}{\mathrm{i}\hbar}\int\mathrm{d}\mu(\bm{\xi}_{1})\mathrm{d}\mu(\bm{\xi}_{2})\psi^{\ast}(\xi_{1},t)K(\xi_{1},\bar{\xi}_{2})\\
\times H^{\bigstar}(\bar{\xi}_{2},\xi_{1})\psi(\xi_{2},t)\left[\delta\left(\bm{z}-\bm{\xi}_{1}\right)-\delta\left(\bm{z}-\bm{\xi}_{2}\right)\right].
\end{multline}
We then substitute the expansion 
\begin{multline}
\delta(\bm{z}-\bm{\xi}_{1})-\delta(\bm{z}-\bm{\xi_{2}})=-\frac{1}{2}\sideset{}{^{\prime}}\sum_{n,m=0}^{\infty}\biggr[\frac{1}{m!n!}(\xi_{1}-\xi_{2})^{m}\\
\times(\bar{\xi}_{1}-\bar{\xi}_{2})^{n}\partial_{z}^{m}\partial_{\bar{z}}^{n}\delta(\bm{z}-\bm{\xi}_{1})-\mathrm{(1\leftrightarrow2)}\biggr],
\end{multline}
where the summation excludes $(m,n)=(0,0)$. We obtain the continuity equation
\begin{equation}
\frac{\partial\rho(\bm{z},t)}{\partial t}+\bm{\nabla}\cdot\bm{j}(\bm{z},t)=0,
\end{equation}
with the current density $j\equiv j_{x}+\mathrm{i}j_{y}$:
\begin{align}
j(\bm{z},t)= & ~j_{0}(\bm{z},t)-2\mathrm{i}\partial_{\bar{z}}m(\bm{z},t),\\
j_{0}(\bm{z},t)= & ~\frac{\mathrm{1}}{\hbar}w(\bm{z},t)\int\mathrm{d}\mu(\bm{\xi})(z-\xi)\nonumber \\
 & \times\mathrm{Im}\left[\psi^{\ast}(z,t)K(z,\bar{\xi})H^{\bigstar}(\bar{\xi},z)\psi(\xi,t)\right],\\
m(\bm{z},t)= & ~\frac{1}{4\hbar}\mathrm{Re}\sum_{m,n=1}^{\infty}\frac{\partial_{z}^{m-1}\partial_{\bar{z}}^{n-1}}{m!n!}w(\bm{z},t)\int\mathrm{d}\mu(\xi)\nonumber \\
 & \times\psi^{\ast}(z,t)K(z,\bar{\xi})H^{\bigstar}(\bar{\xi},z)\psi(\xi,t)\nonumber \\
 & \times(z-\xi)^{m}(\bar{z}-\bar{\xi})^{n}.
\end{align}
where $m(\bm{z},t)$ is the orbital magnetization density.

Applying the quantization rules shown in Sec.~\ref{subsec:Quantization-in-the} and Appendix \ref{sec:star-transformation}, we can rewrite the equations in operator forms
\begin{align}
\bm{j}_{0}(\bm{z},t)= & ~w(\bm{z},t)\mathrm{Re}\left\{ \psi^{\ast}(z,t)\left[\hat{\bm{v}}\psi\right](z,t)\right\} ,\\
m(\bm{z},t)= & ~\mathrm{Re}\sum_{m,n=1}^{\infty}\frac{\partial_{z}^{m-1}\partial_{\bar{z}}^{n-1}}{m!n!}w(\bm{z},t)\psi^{\ast}(z,t)\nonumber \\
 & \times\left[\hat{m}_{mn}\psi\right](z,t),
\end{align}
with
\begin{align}
\hat{\bm{v}} & \equiv\frac{1}{\mathrm{i}\hbar}\left[\hat{\bm{z}},\hat{H}\right],\\
\hat{m}_{mn} & \equiv\frac{1}{4\hbar}[\underset{n}{\underbrace{\hat{\bar{z}}\dots,[\hat{\bar{z}}}},[\underset{m}{\underbrace{\hat{z},\dots[\hat{z}}},\hat{H}]\dots]]\dots].
\end{align}

In the long-wavelength limit, we can keep only $j_{0}(\bm{z},t)$, and ignore the magnetization current.

\subsection{Current densities of a composite fermion system}

The result derived in the last subsection can be applied to composite fermions with straightforward generalization. The electron and vortex current densities for a state $\psi(z,\bar{\eta})$ can be written as
\begin{align}
\bm{j}_{\mathrm{e}}(\bm{z}) & \approx w_{B}(\bm{z})\mathrm{Re}\int\mathrm{d}\mu_{b}(\bm{\eta})\psi^{\ast}(z,\bar{\eta})\left[\hat{\bm{U}}\psi\right](z,\bar{\eta}),\label{eq:je}\\
\bm{j}_{\mathrm{v}}(\bm{\eta}) & \approx w_{b}(\bm{z})\mathrm{Re}\int\mathrm{d}\mu_{B}(\bm{z})\psi^{\ast}(z,\bar{\eta})\left[\hat{\bm{u}}\psi\right](z,\bar{\eta}),\label{eq:jv-1}
\end{align}
where $\hat{\bm{U}}\equiv[\hat{\bm{z}},\hat{H}_{\psi}]/\mathrm{i}\hbar$ and $\hat{\bm{u}}\equiv[\hat{\bm{\eta}},\hat{H_{\psi}}]/\mathrm{i}\hbar$ are the electron and vortex velocity operators, respectively, $\hat{H}_{\psi}$ is the effective Hamiltonian shown in Eq.~(\ref{eq:Hpsi-1}), and we ignore the orbital magnetization contribution. 

In the long-wavelength limit, we can apply the approximate commutators $\left[\hat{\bar{z}},\hat{z}\right]\approx2l_{B}^{2}(\bm{z})$, $\left[\hat{\eta},\hat{\bar{\eta}}\right]\approx2l_{b}^{2}(\bm{z})$. The velocity operators are then approximated as
\begin{align}
\hat{\bm{U}} & \approx\frac{\hbar}{m^{\ast}}\frac{\bm{n}\times\left(\hat{\bm{z}}-\hat{\bm{\eta}}\right)}{l_{b}^{2}(\bm{z})}+\bm{V},\label{eq:U}\\
\hat{\bm{u}} & \approx\frac{\hbar}{m^{\ast}}\frac{\bm{n}\times\left(\hat{\bm{z}}-\hat{\bm{\eta}}\right)}{l_{B}^{2}(\bm{z})}+\bm{v}.\label{eq:ubar}
\end{align}
Substituting Eq.~(\ref{eq:ubar}) into Eq.~(\ref{eq:jv-1}) and summing over occupied states of composite fermions, we obtain the current density of vortices Eq.~(\ref{eq:jv}). The current density of electrons can be obtained similarly using Eq.~(\ref{eq:U}).

\subsection{Dipole approximation}

We can also obtain approximate expressions for the particle and current densities of electrons and vortices by differentiating the action Eq.~(\ref{eq:SCF}) with respect to $\left(\Phi_{\mathrm{eff}},\bm{A}\right)$ and $(\phi,\bm{a})$, respectively. Resulting number and current densities correspond to their multipole expansion forms discussed in Ref.~\onlinecite{ji2021}, up to the dipole order. We have: 
\begin{align}
\rho_{\mathrm{e}}(\bm{\xi},t)\approx & \sum_{i}\tilde{\varphi}_{i}^{\ast}(\bm{\xi},t)\varphi_{i}(\bm{\xi},t)-\partial_{\bar{\xi}}\bar{P}(\bm{\xi},t),\\
\rho_{\mathrm{v}}(\bm{\xi},t)\approx & \sum_{i}\tilde{\varphi}_{i}^{\ast}(\bm{\xi},t)\varphi_{i}(\bm{\xi},t)+\partial_{\xi}P(\bm{\xi},t),
\end{align}
\begin{align}
\bar{j}_{\mathrm{e}}(\bm{\xi},t)\approx & \sum_{i}\left[\frac{-2\mathrm{i}\hbar\partial_{\bar{\xi}}+e\mathcal{A}+m^{\ast}v}{m^{\ast}}\tilde{\varphi}_{i}\right]^{\ast}\varphi_{i}\nonumber \\
 & +\partial_{t}\bar{P}(\bm{\xi},t),\\
j(\bm{\xi},t)\approx & \sum_{i}\tilde{\varphi}_{i}^{\ast}\left[\frac{-2\mathrm{i}\hbar\partial_{\bar{\xi}}+e\mathcal{A}+m^{\ast}V}{m^{\ast}}\varphi_{i}\right]\nonumber \\
 & -\partial_{t}P(\bm{\xi},t),
\end{align}
where $P$ and $\bar{P}$ are the complex components of the dipole density, approximated as 
\begin{align}
P(\bm{\xi},t) & \approx-l_{b}^{2}(\bm{\xi})\sum_{i}\tilde{\varphi}_{i}^{\ast}\left(2\partial_{\bar{\xi}}+\mathrm{i}\frac{e}{\hbar}\mathcal{A}\right)\varphi_{i}.
\end{align}


\subsection{Vanishing dipole density \label{subsec:Vanishing-dipole-density}}

We can show that a system of composite fermions always has vanishing dipole density. To see that, we apply the self-consistent condition Eq.~(\ref{eq:csb-1}), and find that the first term of the current density becomes an anomalous Hall current with a half-quantized Hall conductance $\sigma_{xy}^{(\mathrm{v})}=-e^{2}/2h$~\citep{ji2021}. Comparing it to the second CS constraint Eq.~(\ref{eq:cse-1}), we have
\begin{equation}
\bm{P}(\bm{\eta})\equiv w_{b}(\bm{\eta})\sum_{i}\int\mathrm{d}\mu_{B}(\bm{z})(\bm{z}-\bm{\eta})\left|\psi_{i}\left(z,\bar{\eta}\right)\right|^{2}\approx0.\label{eq:dpden}
\end{equation}

The vanishing dipole density suggests that the coordinate of an electron, on average, always coincides with the coordinate of the vortex that it binds to. The same identity was also found in Ref.~\onlinecite{ji2021}. In Ref.~\onlinecite{read1998}, Read actually contemplated that the condition could serve as the basis for a composite fermion theory without the CS constraints.

\bibliographystyle{apsrev4-2}
\bibliography{References,../physicsbooks}

\end{document}
