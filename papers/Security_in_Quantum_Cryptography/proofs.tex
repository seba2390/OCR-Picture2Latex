\section{Proofs from \secref{sec:qkd}}
\label{app:proofs}

In \secref{sec:qkd} we show how to define the security of QKD in a
composable framework and relate this to the trace distance security
criterion introduced in \textcite{Ren05}. This composable treatment of
the security of QKD follows the literature \cite{BHLMO05,MR09}, and
the results presented in \secref{sec:qkd} may be found in
\textcite{BHLMO05,MR09} as well. The formulation of the statements
differs however from those works, since we use here the Abstract
Cryptography framework of \textcite{MR11}. So for completeness, we
provide here proofs of the main results from \secref{sec:qkd}.

\begin{proof}[Proof of \thmref{thm:qkd}]
  Recall that in \secref{sec:security.simulator} we fixed the
  simulator and show that to satisfy \eqnref{eq:qkd.security} it is
  sufficient for \eqnref{eq:qkd.security.2} to hold. Here, we will
  break \eqnref{eq:qkd.security.2} into security [\eqnref{eq:qkd.cor}]
  and correctness [\eqnref{eq:qkd.sec}], thus proving the theorem.

  Let us define $\gamma_{ABE}$ to be a state obtained from
  $\rho^{\top}_{ABE}$ [\eqnref{eq:qkd.security.tmp}] by throwing away
  the $B$ system and replacing it with a copy of $A$, i.e., \[
  \gamma_{ABE} = \frac{1}{1-p^\bot} \sum_{k_A,k_B \in \cK} p_{k_A,k_B}
  \proj{k_A,k_A} \otimes \rho^{k_A,k_B}_E.\] From the triangle
  inequality we get \begin{multline*} D(\rho^\top_{ABE},\tau_{AB} \otimes
  \rho^\top_{E}) \leq \\ D(\rho^\top_{ABE},\gamma_{ABE}) +
  D(\gamma_{ABE},\tau_{AB} \otimes \rho^\top_{E}) .\end{multline*}

Since in the states $\gamma_{ABE}$ and
$\tau_{AB} \otimes \rho^\top_{E}$ the $B$ system is a copy of the $A$
system, it does not modify the distance. Furthermore,
$\trace[B]{\gamma_{ABE}} =
\trace[B]{\rho^{\top}_{ABE}}$. Hence
\[D(\gamma_{ABE},\tau_{AB} \otimes \rho^\top_{E}) =
  D(\gamma_{AE},\tau_{A} \otimes \rho^\top_{E}) =
  D(\rho^\top_{AE},\tau_{A} \otimes \rho^\top_{E}).\]

For the other term note that
\begin{align*}
  & D(\rho^\top_{ABE},\gamma_{ABE}) \\
  & \qquad \leq \sum_{k_A,k_B} \frac{p_{k_A,k_B}}{1-p^{\bot}}
    D\left(\proj{k_A,k_B} \otimes \rho^{k_A,k_B}_E,\right. \\
  & \qquad \qquad \qquad \qquad \qquad \qquad \left.\proj{k_A,k_A} \otimes \rho^{k_A,k_B}_E \right)\\
  & \qquad = \sum_{k_A \neq k_B} \frac{p_{k_A,k_B}}{1-p^{\bot}} = \frac{1}{1-p^{\bot}}\Pr
  \left[ K_A \neq K_B \right].
\end{align*}
Putting the above together with \eqnref{eq:qkd.security.2}, we get
\begin{align*} & D(\rho_{ABE},\tilde{\rho}_{ABE}) \\
  & \qquad = (1-p^\bot)
  D(\rho^\top_{ABE},\tau_{AB} \otimes \rho^\bot_{E}) \\ & \qquad \leq \Pr
  \left[ K_A \neq K_B \right] + (1-p^\bot) D(\rho^\top_{AE},\tau_{A}
  \otimes \rho^\top_{E}). \qedhere \end{align*}
\end{proof}

\begin{proof}[Proof of \lemref{lem:robustness}]
  By construction, $\aK_\delta$ aborts with exactly the same
  probability as the real system. And because $\sigma^{\qkd}_E$
  simulates the real protocols, if we plug a converter $\pi_E$ in
  $\aK\sigma^{\qkd}_E$ which emulates the noisy channel $\aQ_q$ and
  blogs the output of the simulated authentic channel, then
  $\aK_\delta = \aK\sigma^{\qkd}_E\pi_E$. Also note that by
  construction we have
  $\aQ_q \| \aA' = \left(\aQ \| \aA\right) \pi_E$. Thus
  \begin{multline*} d\left( \pi_A^{\qkd}\pi_B^{\qkd}(\aQ_q \| \aA')
      ,\aK_\delta\right) \\ = d\left( \pi_A^{\qkd}\pi_B^{\qkd}\left(\aQ
        \| \aA\right) \pi_E , \aK\sigma^{\qkd}_E\pi_E\right). \end{multline*}

  Finally, because the converter $\pi_E$ on both the real and ideal
  systems can only decrease their distance (see
  \secref{sec:ac.systems}), the result follows.
\end{proof}


%%% Local Variables:
%%% TeX-master: "main.tex"
%%% End:
