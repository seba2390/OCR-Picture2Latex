\begin{figure*}[!htbp]
\begin{displaymath}
  \begin{array}{lll}
    \Ulrv {\tbase} & \triangleq & \{(\uWorld, m, \val) ~|~ \val \in \llbracket \tbase \rrbracket \} \\

    \Ulrv {\tunit} & \triangleq & \{(\uWorld, m,  \val) ~|~ \val \in \llbracket \tunit \rrbracket \} \\

    \Ulrv {\tau_1 \times \tau_2} & \triangleq & \{(\uWorld, m, (\val_1, \val_2)) ~|~
                                       (\uWorld, m, \val_1) \in \Ulrv {\tau_1} \wedge
                                       (\uWorld, m, \val_2) \in \Ulrv {\tau_2}
                                       \}\\

    \Ulrv {\tau_1 + \tau_2} & \triangleq & \{(\uWorld, m, \einl ~  \val) ~|~
                                           (\uWorld, m, \val) \in \Ulrv {\tau_1} \} \union
                                           \{(\uWorld, m, \einr ~  \val) ~|~
                                           (\uWorld, m, \val) \in \Ulrv {\tau_2} \} \\

    \Ulrv {\tau_1 \fto \tau_2} & \triangleq & \{(\uWorld, m, \lambda x. e) ~|~
                                              \forall \uWorld'. \uWorld \wExtends \uWorld' \wedge \forall j < m.
                                              \forall \val. ((\uWorld', j, \val) \in \Ulrv {\tau_1} \implies
                          (\uWorld', j, e[\val/x]) \in \lreu {\tau_2} {\llabel_e}) \} \\

    \Ulrv {\tref ~ \tau} & \triangleq & \{(\uWorld, m, \loc) ~|~  \uWorld (\loc) = \tau
                                        \} \\ \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \Ulrv {\utype^{\llabel}} & \triangleq & \Ulrv {\utype}
    \\ \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hline \\
    \Ulre {\tau} & \triangleq & \{(\uWorld, n, e) ~|~
                                \forall \heap. (n, \heap) \wDefined {} \uWorld \wedge
                                \forall j < n. (\heap, e) \ReducesTo{j} (\heap', \val') \implies \\

                 &    & ~~\exists \uWorld'. \uWorld \wExtends \uWorld' \wedge
                        (n-j, \heap') \wDefined{} \uWorld' \wedge
                        (\uWorld', n-j, \val') \in \Ulrv {\tau} \wedge \\
                 &   &  ~~~~~~(\forall \loc. \heap(\loc) \neq \heap'(\loc) \implies
                        \exists \llabel'. \uWorld(\loc) = \utype^{\llabel'} \wedge \pc \lbelow \llabel'
                        ) \wedge\\
                 &    &  ~~~~~~ (\forall \loc \in \dom(\uWorld') \backslash \dom(\uWorld). \uWorld'(\loc) \searrow \pc)
                        \}\\ \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hline \\
    (n,\heap) \wDefined{} \uWorld & \triangleq & \dom(\uWorld) \subseteq \dom(\heap) \wedge
                                            \forall \loc \in \dom(\uWorld). (\uWorld, n-1, \heap(\loc)) \in
                                            \Ulrv {\uWorld(\loc)}
  \end{array}
\end{displaymath}
\caption{Unary value, expression, and heap conformance relations for {\fg}}
\label{fig:ulr-fg}
\end{figure*}


\begin{figure*}[!htbp]
\begin{displaymath}
  \begin{array}{lll}
    \Blrv {\tbase} & \triangleq & \{(\world, n, \val_1, \val_2) ~|~ \val_1 = \val_2 \wedge \{\val_1,\val_2\}
                                  \in \llbracket \tbase \rrbracket \} \\

    \Blrv {\tunit} & \triangleq & \{(\world, n, (), ()) ~|~  () \in \llbracket \tunit \rrbracket \} \\

    \Blrv {\tau_1 \times \tau_2} & \triangleq & \{(\world, n, (\val_1, \val_2), (\val_1', \val_2')) ~|~
                                                (\world, n, \val_1, \val_1') \in \Blrv {\tau_1} \wedge
                                                (\world, n, \val_2, \val_2') \in \Blrv {\tau_2}
                                                \} \\

    \Blrv {\tau_1 + \tau_2} & \triangleq & \{(\world, n, \einl ~  \val, \einl ~  \val') ~|~
                                           (\world, n, \val, \val') \in \Blrv {\tau_1}
                                           \} \union\\
                   & & \{(\world, n, \einr ~  \val, \einr ~  \val') ~|~
                       (\world, n, \val, \val') \in \Blrv {\tau_2}
                       \} \\

    \Blrv {\tau_1 \fto \tau_2} & \triangleq & \{(\world, n, \lambda x. e_1, \lambda x. e_2) ~|~\\
                   & & ~~\forall \world' \wExtendsR \world, j < n, \val_1, \val_2.\\
                   & & ~~~~~~~~~((\world', j, \val_1, \val_2) \in \Blrv {\tau_1}
                       \implies (\world', j, e_1[\val_1/x], e_2[\val_2/x]) \in \Blre {\tau_2} ) \wedge \\
                   & & ~~\forall \uWorld_l \wExtendsR \world.\uWorld_1, j, \val_c.
                   \, ((\uWorld_l, j, \val_c) \in \Ulrv {\tau_1} \implies
                       (\uWorld_l, j, e_1[\val_c/x]) \in \lreu {\tau_2} {\llabel_e}) \wedge  \\
                   & & ~~\forall \uWorld_l \wExtendsR \world.\uWorld_2, j, \val_c.
                   \, ((\uWorld_l, j, \val_c) \in \Ulrv {\tau_1} \implies
                       (\uWorld_l, j, e_2[\val_c/x]) \in \lreu {\tau_2} {\llabel_e}) \} \\

    \Blrv {\tref ~ \tau} & \triangleq & \{(\world, n, \loc_1,  \loc_2) ~|~
                     (\loc_1 , \loc_2) \in \world.\pb
                       \wedge \world.\uWorld_1(\loc_1) = \world.\uWorld_2(\loc_2) = \tau \}\\ \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\Blrv {\utype^{\llabel}} & \triangleq &
\left\lbrace
  \begin{array}{l r r}
    \{(\world, n, \val_1,  \val_2) ~|~
    (\world, n, \val_1, \val_2) \in \Blrv {\utype} \} & & \llabel \lbelow \attacker \\

    \{(\world, n, \val_1,  \val_2) ~|~
    \forall i\in \{1,2\}. \forall m. (\world.\uWorld_i, m, \val_i) \in \Ulrv {\utype} \} & & \llabel \not\lbelow \attacker
  \end{array}
\right. \\ \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hline \\
    \Blre {\tau} & \triangleq & \{(\world, n, e_1, e_2) ~|~\\
                   &   & ~~\forall \heap_1, \heap_2, j<n. (n, \heap_1, \heap_2) \wDefined {\attacker} \world \wedge
                   (\heap_1, e_1) \ReducesTo{j} (\heap_1', \val_1') \wedge
                         (\heap_2, e_2) \ReducesTo{} (\heap_2', \val_2') \implies \\

                   &   & ~~~~~~~\exists \world' \wExtendsR \world. (n - j, \heap_1', \heap_2') \wDefined {\attacker} \world' \wedge
                         (\world', n - j, \val_1', \val_2') \in \Blrv {\tau} \}
    \\ \\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \hline \\
    (n, \heap_1, \heap_2) \wDefined{\attacker} \world & \triangleq & \dom(\world.\uWorld_1) \subseteq \dom(\heap_1) \wedge
                                                                   \dom(\world.\uWorld_2) \subseteq \dom(\heap_2) \wedge
                                                     (\world.\pb) \subseteq (\dom(\world.\uWorld_1) \times \dom(\world.\uWorld_2))
                                                           \wedge \\
                                                    &    & \forall (\loc_1,\loc_2) \in (\world.\pb).
                                                           (\world.\uWorld_1(\loc_1) = \world.\uWorld_2(\loc_2) \wedge
                                                     (\world, n-1, \heap_1(\loc_1),\heap_2(\loc_2)) \in
                                                           \Blrv {\world.\uWorld_1(\loc_1)})
                                                           \wedge \\
                                                    &   & \forall i \in \{1,2\}. \forall m. \forall \loc_i \in \dom(\world.\uWorld_i).
                                                          (\world.\uWorld_i, m, \heap_i(\loc_i)) \in \Ulrv {\world.\uWorld_i(\loc_i)}
  \end{array}
\end{displaymath}

\caption{Binary value, expression and heap conformance relations for {\fg}}
\label{fig:blr-fg}
\end{figure*}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
