\begin{figure*}[!htbp]
  % \textbf{Term, type, constraint syntax:}\\[-6pt]

\newcolumntype{L}{>{$}l<{$}}
\newcolumntype{P}{>{$}X<{$}}

\begin{tabularx}{\textwidth}{lLLP}
  Expressions & e & ::= & x \mid \lambda x.e \mid e \; e \mid (e, e) \mid %
	\efst(e) \mid \esnd(e) \mid \einl(e) \mid \einr(e) \mid %
	\ecase(e, x.e, y.e) \mid \enew e \mid {!e} \mid e := e \mid %
	() \mid %
	\elabel{}(e) \mid \eunlabel(e) \mid %
	\etolabeled(e) \mid \eret(e) \mid \ebind(e, x.e) %
	\\

  %% Labels & \llabel & ::= & \bot \mid \top \mid \lelement \mid \llabel \ljoin \llabel \mid
  %%       \llabel \lmeet \llabel\\

  Types & \tau & ::= & \tbase \mid \tunit \mid \tau \to \tau \mid \tau \times \tau \mid \tau + \tau
  \mid \tref~\llabel~\tau \mid \tlabeled{\llabel}{\tau} \mid
	\tslio {\llabel_1}{\llabel_2}{\tau} \\
\end{tabularx} \\ \\

\textbf{Typing judgment:}
\framebox{$\Gamma \vdash e: \tau$}\\

(All rules of the simply typed lambda-calculus pertaining to the types
$\tbase, \tau \to \tau, \tau \times \tau, \tau + \tau$, and $\tunit$
are included.)

\begin{mathpar}
   \inferrule
   { \Gamma \vdash e_1: \tslio{\llabel_1}{\llabel_2}{\tau}
     \\ \Gamma, x: \tau \vdash e_2 : \tslio {\llabel_3}{\llabel_4}{\tau'}
     \\ \llabel \lbelow \llabel_1
     \\ \llabel \lbelow \llabel_3
     \\ \llabel_2 \lbelow \llabel_3
     \\ \llabel_2 \lbelow \llabel_4 
%     \\ \llabel_4 \lbelow \llabel_4
   }
   {
    \Gamma \vdash \ebind(e_1, x.e_2)
   		: \tslio {\llabel} {\llabel_4} {\tau'}
   }
   \rname{{\cg}-bind}

   \inferrule
   { \Gamma \vdash e: \tau }
   { \Gamma \vdash \eret(e): \tslio {\top} {\bot} {\tau} }
   \rname{{\cg}-ret}

   \inferrule
   { \Gamma \vdash e: \tau'
   	\\ \lattice \vdash \tau' \subtype \tau
   }
   { \Gamma \vdash e: \tau }
   \rname{{\cg}-sub}

   \inferrule
   { \Gamma \vdash e: \tau
   	% \\ \lattice \vdash \llabel_i \lbelow \llabel
   }
   {
    \Gamma \vdash \elabel{}(e)
    : {\tlabeled{\llabel}{\tau}}
   }
   \rname{{\cg}-label}

   \inferrule
   { \Gamma \vdash e: \tlabeled{\llabel}{\tau} }
   {
    \Gamma \vdash \eunlabel(e)
   	: \tslio{\top}{\llabel}{\tau}
   }
   \rname{{\cg}-unlabel}

   \inferrule
   { \Gamma \vdash e : \tlabeled{\llabel}{\tau}
   }
   {
    \Gamma \vdash \enew e
    		: \tslio{\llabel}{\bot}{(\tref ~ {\llabel} ~ {\tau})}
   }
   \rname{{\cg}-ref}

   \inferrule
   { \Gamma \vdash e : \tref ~ \llabel' ~ \tau }
   {
    \Gamma \vdash {!e}
    		: \tslio{\top}{\bot}{(\tlabeled \llabel' \tau)}
   }
   \rname{{\cg}-deref}

   \inferrule
   { \Gamma \vdash e_1 : \tref ~{\llabel}~ \tau
   	\\ \Gamma \vdash e_2 : \tlabeled {\llabel}{\tau}
   }
   {
     \Gamma \vdash e_1 := e_2
     : \tslio{\llabel}{\bot}{\tunit}
   }
   \rname{{\cg}-assign}

   \inferrule
   { \Gamma \vdash e: \tslio{\llabel}{\llabel'}{\tau} }
   {
    \Gamma \vdash \etolabeled(e)
   		: \tslio{\llabel}{\bot}{(\tlabeled{\llabel'}{\tau})}
   }
   \rname{{\cg}-toLabeled}

  \end{mathpar}

  \textbf{Subtyping judgment:}
  \framebox{$\lattice \vdash \tau \subtype \tau'$}

  \begin{mathpar}
   \inferrule
   { \lattice \vdash \tau \subtype \tau'
   	\\ \lattice \vdash \llabel \lbelow \llabel'
   }
   {
    \lattice \vdash \tlabeled \llabel \tau \subtype \tlabeled {\llabel'} \tau'
   }
  \rname{{\cg}sub-labeled}

   \inferrule
   { \lattice \vdash \tau \subtype \tau'
   	\\ \lattice \vdash \llabel_1' \lbelow \llabel_1
   	\\ \lattice \vdash \llabel_2 \lbelow \llabel_2'
   }
   {
    \lattice \vdash \tslio{\llabel_1}{\llabel_2}{\tau}
   		\subtype \tslio{\llabel_1'}{\llabel_2'} {\tau'}
   }
   \rname{{\cg}sub-monad}
   \end{mathpar}
  %% \inferrule
  %% { }
  %% {
  %%   \lattice \vdash \tau \subtype \tau
  %% }\rname{{\cg}sub-refl}

  %%  \inferrule
  %%  { \lattice \vdash \tau_1' \subtype \tau_1
  %%  	\\ \lattice \vdash \tau_2 \subtype \tau_2' \
  %%  }
  %%  { \lattice \vdash \tau_1 \to \tau_2 \subtype \tau_1' \to \tau_2' }
  %% \rname{{\cg}sub-arrow}

  %%  \inferrule
  %%  { \lattice \vdash \tau_1 \subtype \tau_1'
  %%  	\\ \lattice \vdash \tau_2 \subtype \tau_2'
  %%  }
  %%  { \lattice \vdash \tau_1 \times \tau_2 \subtype \tau_1' \times \tau_2' }
  %% \rname{{\cg}sub-prod}

  %%  \inferrule
  %%  { \lattice \vdash \tau_1 \subtype \tau_1'
  %%  	\\ \lattice \vdash \tau_2 \subtype \tau_2'
  %%  }
  %%  { \lattice \vdash \tau_1 + \tau_2 \subtype \tau_1' + \tau_2' }
  %% \rname{{\cg}sub-sum}
  \caption{{\cg}'s language syntax and type system (selected rules)}
  \label{fig:cg-ts}
\end{figure*}

%% \begin{figure*}[!htbp]
%% \caption{{\cg} subtyping}
%% \label{fig:cg-subtyping}
%% \end{figure*}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
