\section{The Two Type Systems}
\label{sec:ts}

In this section, we describe the fine-grained and coarse-grained type
systems we work with. Both type systems are set up for higher-order
stateful languages, but differ considerably in how they enforce
IFC. The fine-grained type system, called {\fg}, works on a language
with pervasive side-effects like ML, and associates a security label
with every expression in the language. The coarse-grained type system,
{\cg}, works on a language that isolates state in a monad (like
Haskell's IO monad) and tracks flows coarsely at the granularity of a
monadic computation, not on pure values within a monadic computation.

%% In this section we describe the two type systems that we work with, namely {\fg} and {\cg}. Both the
%% type systems are setup for higher order stateful languages, but they differ considerably in the way
%% they enforce IFC. {\fg} is for a language with pervasive side effects, like ML, and tracks security
%% labels with every value in the language. In contrast, {\cg} is for a language that isolates the
%% side-effects in a monad, like Haskell, and tracks flows only within a monad and not across pure
%% expressions.

Both {\fg} and {\cg} use security labels (denoted by $\llabel$) drawn
from an arbitrary security lattice ($\lattice, \lbelow$). We denote
the least and top element of the lattice by $\bot$ and $\top$
respectively. As usual, the goal of the type systems is to ensure that
outputs labeled $\llabel$ depend only on inputs with security labels
$\llabel$ or lower. \update{For drawing intuitions, we find it
  convenient to think of a confidentiality lattice (labels higher in
  the lattice represent higher confidentiality). However, nothing in
  our technical development is specific to a confidentiality
  lattice---the development works for any security lattice including
  an integrity lattice and a product lattice for confidentiality and
  integrity.}

\input{fg}

\input{cg}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
