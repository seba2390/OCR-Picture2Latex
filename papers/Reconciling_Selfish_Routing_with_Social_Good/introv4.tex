\section{Introduction}\label{sec:intro}

\subsection{Two sides of the coin: Social Welfare vs Selfishness} \label{subSect:SOFandFairF}
A fundamental problem arising in the management of road-traffic and communication networks is routing traffic to optimize network performance. In the setting of road-traffic networks the average delay incurred by a unit of flow quantifies the cost of a routing assignment.  From a collective perspective minimizing the average cost translates to maximizing the welfare obtained by society.  
%With complete knowledge of the network, we can efficiently describe any socially optimal (SO) flow, namely a flow that minimizes the average social cost, by quantifying the flow passing through each edge \cite{}. 
Starting from the seminal works of Wardrop \cite{wardrop1952some} and Beckman et al. \cite{beckmann1956studies}, the literature on network games has differentiated between 1) the objective of a central planner to minimize average cost and thus find a socially optimal (SO) flow, and 2) the selfish objectives of users minimizing their respective costs.  In the latter case,  
the network users acting in their own interest are assumed to converge to a Nash Equilibrium (NE) flow as further rerouting fails to improve their own objective.  

The tension between the central planner and individual objectives has been an object of intense study in the 
algorithmic game theory literature on congestion games. A central question arising in congestion games, ``how much does network performance suffer from selfish behavior?'', has been investigated extensively through the notions of Price of Anarchy (PoA) and Price of Stability (PoS), namely the ratio of the maximum cost among all Nash equilibria over the social optimum and the ratio of the minimum cost among all  Nash equilibria over the social optimum, respectively. Prior research shows that the Nash equilibrium flow may attain very poor social welfare compared to social optimum, i.e. we may get only poor bounds on the PoA or the PoS, with these bounds being tight for some classes of instances.  For an overview we refer the reader to the survey~\cite{roughgarden2002selfish}. %We note here that the PoA and the PoS coincide in nonatomic selfish routing instances (the case where users  are infinite yet infinitesimally small), but if we define the PoA and the PoS for other possible outcomes such as approximate Nash equilibria or the ones that will appear in the next paragraphs, then the PoA and the PoS may get different values.

This discrepancy between selfishness and social good calls for finding a middle ground between the two ends of the spectrum---the Nash flow and the socially optimal flow.  
To that end, previous research on mechanism design
has lead to theoretically appealing solutions such as 
toll placement and Stackelberg routing~\cite{swamy2012effectiveness}. Placing tolls on edges has been shown to improve the network performance up to the point of completely optimizing it when there are no restrictions on the tolls' values. Using Stackelberg strategies, where one assumes that a fraction of users is willing to cooperate and follow the routes dictated by the central planner, has also been theoretically shown to improve the network performance. In spite of the nice properties of these solutions that induce selfish users to act in a socially friendly way, these mechanisms have faced criticism in the real world in terms of their implementation and their fairness towards various users. 
 
To mitigate the tension between selfishness and social good in a way that is more fair to the users, we set out to explore the properties of alternative solution concepts 
where users under some reasonable incentive condition 
adopt a ``socially desirable" routing of traffic in between the Nash equilibrium (which has high social cost) and the social optimum (which may be undesirable/unfair to users on the longer paths) \cite{roughgarden2002unfair}.  
%Consider the scenario where some routing application gives route choices to the users instead of showing users the congestion state of the network and let users choose a route by themselves. Users may be incentivized to use this application under the condition that they are not forced to take ``relatively long routes''. Apparently, this scenario is close to reality, since  users are uninformed about the network's congestion and more often use their routing devices to travel to their destinations. 
The advent of routing applications and the growing dependence of users on these applications 
places us at an epoch when such new ideas in mechanism design may be more relevant and also more readily integrated to practice. 
Consider the scenario where some routing application presents the uninformed users with routes alongside the guarantees of ``relative fairness'' and ``reasonable delay'' and the users adopt the paths. This scenario is close to reality, since users unaware of the network congestion often use their routing devices to travel to their destinations or pick a path that has been presented to them before. 

This naturally brings forth the questions of whether there exist solutions (flows) where good social welfare is achieved under an appropriate incentive condition for the users %(e.g. guarantees for ``reasonable delay"), 
and if such solutions can be efficiently computed. 
%A crucial fact  is that users, when asking  routing applications, request for paths to their destinations and  a returned solution can be assumed to be a path flow decomposition  that provides guarantee only for the entire paths' costs. This differentiates from the standard Nash Equilibrium approach where local conditions for subpaths  should also be present. 
An example of such a solution could be enforcing a $\theta$-approximate Nash equilibrium of low social cost,  where users are guaranteed to get assigned a path of cost no greater than $\theta$ times the cost of the shortest path and as such, the solution is ``relatively fair".\evn{\footnote{We note that the concept of fairness has been considered in the literature of routing games in more than one ways. The two main approaches define fairness as: 1) the ratio of the maximum path delay in a given flow to the average delay under Nash equilibrium~\cite{roughgarden2002unfair} and 2) the ratio of the maximum path delay to the minimum path delay in a given flow~\cite{correa2007fast}.}} 
Yet, other solution concepts seem to arise naturally and are introduced below.%\footnotemark 

 
%A candidate solution concept is the $\theta$-approximate Nash equilibrium ($\theta$-NE) which admits diverse flows and specially flows with low social cost compared to Nash equilibrium or equivalently $1$-NE~\cite{}. Inducing a $\theta$-NE readily guarantees users ``relative fairness'' as by definition of $\theta$-NE the assigned path is no more than $\theta$ times the shortest path. Additionally, as the average social cost is low the users also have guarantees of ``reasonable delay''. Building on this idea we proceed to further generalize the Nash equilibrium concepts while keeping the above ``guarantees'' preserved.


% DO WE NEED THIS FOOTNOTE?
%\footnotetext{In the remaining part of the Section~\ref{sec:intro} for the ease of presentation we will contain ourselves to networks with a single commodity. All of the concepts discussed will be extended to the multi-commodity networks later.
%}       

\subsection{Selfishness and Envy}
In our quest to achieve the coveted middle ground between the social optimum and Nash equilibrium, by combining good social welfare with satisfied users, we present two notions related to: 1) Selfishness and 2) Envy. 
%We elaborate on these notions in an example single commodity network to convey the motivation and meaning to the reader. The ideas will be formalized in Section~\ref{sec:prelim} where we generalize them to the multi-commodity case. 

Firstly, we consider selfishness where users tend to selfishly improve their own cost whenever there exists some scope of improvement.  This conforms to the notion of Nash Equilibrium and a slight relaxation of  absolute selfishness leads us to the approximate Nash Equilibrium concept.  Specifically, we consider a multiplicative approximation consistent with the tradition in approximation algorithms: we refer to a $\theta$-Nash equilibrium flow as a flow in which the length of any {\em used} path in the network is less than or equal to $\theta$ times the length of any other path in the network, with $\theta \geq1$.   Note that for $\theta=1$ we have the Nash Equilibrium flow.

The existing literature in congestion games mainly regards a used path as a path that has positive flow in all of its edges, independent of the path flow decomposition that induces the edge flow. Here we make the distinction between \emph{positive} paths, i.e. paths that have positive flow in all of their edges, (note, this is independent of the path flow decomposition) %under the edge flow decomposition, 
 and \emph{used} paths, i.e. paths that appear in the path flow decomposition with positive flow. With these definitions we define a $\theta$-Positive Nash Equilibrium ($\theta$-PNE)\footnote{We remark that in the literature, PNE is typically used for abbreviating Pure Nash Equilibrium.  In this paper, we always use it to mean Positive Nash Equilibrium as we define it here.} 
 to be a flow in which the length of any {\em positive} path in the network is less than or equal to $\theta$ times the length of any other path, and  a $\theta$-Used Nash Equilibrium ($\theta$-UNE) to be a flow in which the length of any {\em used} path in the network is less than or equal to $\theta$ times the length of any other path. 
Specifically, the concept of UNE deals directly with the paths assigned to users whereas PNE deals with positive paths which may remain unused.  
 As we shall see, the set of $\theta$-PNE flows is a subset of the set of $\theta$-UNE flows and this inclusion might be strict, though for $\theta=1$ these sets coincide. The definition of $\theta$-approximate Nash equilibrium in the literature~\cite{christodoulou2011performance} corresponds to that of $\theta$-UNE. However, to the best of our knowledge, the significance of path flows in the definition of $\theta$-UNE has not been made explicit in any prior work.
 
Next, consider the notion of envy where for the same source and destination a user experiences envy against another user if the latter incurs smaller delay compared to the former under a given path flow. Similarly to the approximate Nash equilibrium flow we can consider a notion of approximately envy free flows where in a $\theta$-Envy Free ($\theta$-EF) flow, the ratio of any two {\em used} paths in the network is upper bounded by $\theta$, for some $\theta\geq 1$.  Note, the difference from the $\theta$-UNE definition is that a used path's cost is compared only to other used paths' costs. 
Envy free flows arise naturally as we consider the routing applications setup where users only collect information about the routes provided by the application. Thus, on the one hand, the possible costs for the current users in some sense compare to the costs of the users that have already used the network. On the other hand, routes for which there is no (sufficient) information potentially may never appear as an option. In other words, routes that have not been chosen in the past (sufficiently many times), i.e. ``unused routes'', do not arise in the comparison of the paths' costs. 

An example of how the concepts of $\theta$-PNE, $\theta$-UNE, and $\theta$-EF may differ from each other is illustrated in Figure~\ref{fig:ex_flows}. There, the optimal edge flow of the network is a $2$-PNE due to the presence of `positive' paths of length $2$ and $1$. However, considering path flows there exists a $1$-EF flow that induces  the optimal edge flow.  Also, the example has a path flow that is a $1.5$-UNE but it does not admit a path flow that is a $1$-UNE. More details  are discussed in Section~\ref{sec:satisfaction}, where these notions are formally introduced. 



% RELATED WORK
\input{related.tex}


% CONTRIBUTION
\subsection{Contribution}
The recent influx of technology in traffic routing, the scale of traffic networks and globalization bring about a definite shift in the well studied routing games. The incomplete knowledge of users creates a dependence on routing technologies, giving more freedom to a central planner to mitigate the inefficiency originating from the selfish routing of users in the full information setting. In this work, we show that the path flows in the network may play a key role in achieving the full potential of such route planning mechanisms.  In particular, we clearly differentiate path flows from edge flows through the introduction of `positive' paths and `used' paths. Recall, a `positive' path is a path with all edges carrying nonzero flows under a given edge flow. Whereas a `used' path is a path with nonzero flow under a specific path flow. From the inherent differences of `positive' and `used' paths,  two new concepts, used Nash equilibrium (UNE) and envy free (EF) flow, naturally emerge as generalizations of the Wardrop equilibrium. We call the classical Wardrop equilibrium positive Nash equilibrium (PNE) because it essentially deals with `positive' paths. To the best of our knowledge, this distinction between positive and used paths has not been made explicit despite the rich literature developed on this topic for over half a decade. We also define the respective approximate versions of all the three solution concepts, i.e. $\theta$-PNE, $\theta$-UNE and $\theta$-EF for $\theta> 1$, where the distinction plays a critical role. 


With the introduction of these three related concepts and their approximate versions, the first step in understanding them is to compare the flows against each other. We show that the $1$-UNE and the $1$-PNE are indeed identical and this helps in understanding why the `used' and the `positive' paths have not been explicitly differentiated before this work. But beyond this case the new concepts impose a hierarchical structure on the space of feasible flows. Specifically, we notice that $\theta$-PNE, $\theta$-UNE and $\theta$-EF flows are progressively larger sets, each containing the previous one, with promise of better tradeoff between the social welfare and fairness. In order to grasp the large separation between these concepts note that for some networks the $\theta$-UNE  is not contained in $\Omega(n\theta)$-PNE, where $n$ is the number of nodes in the network (Lemma~\ref{lemm:UNEvPNE} in Section~\ref{sec:hier}). 

Motivated from the classical study of the price of anarchy (PoA) of equilibrium flows we investigate the PoA of $\theta$-UNE and $\theta$-EF. In general we expect that as we move from the $\theta$-PNE to $\theta$-EF flows from a worst case perspective we will encounter flows with larger social cost. As a worst case example we show that the PoA can be unbounded for $1$-EF flows. However, we see that under the well used framework of variational inequality based PoA upper bounds~\cite{roughgarden2004bounding} both $\theta$-PNE and $\theta$-UNE admit the same bound on the PoA (Lemma~\ref{lemm:UNEvVI} in Section~\ref{sec:social}). Through a similar reasoning we show that the price of stability is non increasing from $\theta$-PNE to $\theta$-EF flows. 

%The implication of `used' and `positive' paths in a network brings about finer details in the \evn{definition of fairness}. We define edge flow fairness, which compares the `positive' paths in a network, and path flow fairness, which compares the `used' paths in the network. The importance of this differentiation becomes clear as one realizes that a path flow having a large `positive' path yet balanced `used' \evn{paths} should not be deemed unfair. 

Focusing on cost-efficient and fair flow design, the question of computing a $\theta$-PNE, a $\theta$-UNE or a $\theta$-EF flow with low social cost becomes one of the fundamental questions. We experience a temporary setback as the traditional convex optimization framework for computing the equilibrium and socially optimal flows fails here due to the non-convexity of the sets of $\theta$-PNE, $\theta$-UNE and $\theta$-EF flows for $\theta>1$. Formally, we prove (Theorem~\ref{thm:main_hardness} in Section~\ref{sec:complex}) that obtaining the best $\theta$-UNE or the best $\theta$-EF flow is NP-hard. Indeed given a socially optimal flow it is NP-hard to decide whether it admits a path flow decomposition which is $\theta$-UNE ($\theta$-EF). In a positive direction we show (Lemma~\ref{lemma:3Easy} in Section~\ref{sec:complex}) that for any `acylic' flow we can decide whether it is a $\theta$-PNE or not. As any `cyclic' flow can be made `acyclic' without increasing its social cost, the above result is sufficient for our design goal, i.e. balance social cost and fairness. However, we leave open the question of finding the best $\theta$-PNE flow ($\theta>1$). 

We further discuss how, at a conceptual level, the new ideas could be integrated with routing technologies (in Section~\ref{sec:design}). Drawing elements from different but related areas, we observe that minimization of modified latency functions can facilitate the calculation of a $\theta$-PNE flow with social cost guarantees. In particular, we use two techniques for bounding the social cost: 1) modified potential functions and 2) bounded tolls.  As a side note, following the ideas presented by Christodoulou et al.~\cite{christodoulou2011performance}, we explicitly articulate a technique to upper bound the price of stability for general functions and use it to extend the analysis of PoS for M/M/1 delay functions (Lemma~\ref{lemm:MM1} in Section~\ref{sec:design}).

In another direction, we deviate from the norm of deterministic flow design, and formalize the concept of randomization in flow design. We present (Theorem~\ref{thm:RR} in Section~\ref{sec:design}) an expression for the mean and a bound for the standard deviation of a path `used' by a typical user under this strategy.  The newly introduced concepts of $\theta$-UNE and $\theta$-EF flows play a crucial role in the variance reduction of this strategy.  The introduction of randomized routing in flow design may be of independent interest and we believe it can play an important role in emerging routing technologies. 



