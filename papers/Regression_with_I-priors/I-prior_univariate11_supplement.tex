%% 
%% Copyright 2007-2019 Elsevier Ltd
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for Elsevier's document class `elsarticle'
%% with harvard style bibliographic references

\documentclass[preprint,12pt,authoryear]{elsarticle}

\usepackage[english]{babel}
%\usepackage{apacite}
\usepackage{latexsym,graphics,epsfig,subfigure,color,lineno}
\usepackage{amsfonts,amsmath,amssymb,amsthm}
\usepackage{mathtools,xparse}
\usepackage{upgreek}
\usepackage[normalem]{ulem}
\usepackage{pifont}% http://ctan.org/pkg/pifont
%\RequirePackage{lineno}
%\usepackage{hyperref}
%\usepackage[left=3.25cm,right=3.25cm]{geometry}
\usepackage[margin=3.5cm]{geometry}

%\usepackage{mathptmx}
%\usepackage{moresize}

\input{defs.inp}


\def\lambdaexp{\frac{1}{2\lambda}} %lambda in the exponent, should it be \lambda or 1/(2\lambda)???
\def\lambdavar{\lambda}           %lambda in the variance, half the reciprocal of above

\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}



\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%

%\def\argmax{\mathop{{$\arg\max$}}\nolimits}
\def\id{\mathop{\rm id}\nolimits}
\def\cor{\mathop{\rm cor}\nolimits}
\def\sq{\mathop{\rm sq}\nolimits}
\def\sign{\mathop{\rm sign}\nolimits}
\def\half{{\scriptstyle\frac{1}{2}}}
\def\fourth{{\scriptstyle\frac{1}{4}}}
\def\threefourth{{\scriptstyle\frac{3}{4}}}
\def\Pr{\mathop{\rm Pr}\nolimits}

\def\logit{\mathop{\rm logit}\nolimits}
\def\pc{\mathop{\rm p\hspace{-.5pt}c}\nolimits}
\def\id{\mathop{\rm id}\nolimits}
%\def\KL{\mbox{Karhunen-Lo{\`eve}\,\! }}
\def\KL{\text{KL}}
\def\iprior{\mbox{I-prior\,\!}}
\def\GP{\mbox{\rm GP}}
\DeclareMathOperator{\MVN}{MVN}
\def\ve{\varepsilon}


\newcommand{\TV}{\mathop{\rm TV}\nolimits}
\newcommand{\tr}{\mbox{\rm tr}}
\newcommand{\erf}{\mbox{\rm erf}}
\newcommand{\erfi}{\mbox{\rm erfi}}
\newcommand{\inpr}[2]{\langle #1 , #2 \rangle}
\newcommand{\xf}{X_{\mbox{\scriptsize future}}}
\newcommand{\spa}{\mbox{\rm span}}
\newcommand{\fbm}{{FBM}}
\newcommand{\LL}{L} %for L^2 and L^1
\newcommand*\diff{\mathop{}\!\mathrm{d}}

\newcommand{\inn}{\langle\cdot ,\cdot\rangle}




%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times,authoryear]{elsarticle}
%% \documentclass[final,1p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,3p,times,authoryear]{elsarticle}
%% \documentclass[final,3p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,5p,times,authoryear]{elsarticle}
%% \documentclass[final,5p,times,twocolumn,authoryear]{elsarticle}

%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}

\journal{Econometrics and Statistics}

\begin{document}
	
	\begin{frontmatter}
		
		%% Title, authors and addresses
		
		%% use the tnoteref command within \title for footnotes;
		%% use the tnotetext command for theassociated footnote;
		%% use the fnref command within \author or \address for footnotes;
		%% use the fntext command for theassociated footnote;
		%% use the corref command within \author for corresponding author footnotes;
		%% use the cortext command for theassociated footnote;
		%% use the ead command for the email address,
		%% and the form \ead[url] for the home page:
		%% \title{Title\tnoteref{label1}}
		%% \tnotetext[label1]{}
		%% \author{Name\corref{cor1}\fnref{label2}}
		%% \ead{email address}
		%% \ead[url]{home page}
		%% \fntext[label2]{}
		%% \cortext[cor1]{}
		%% \address{Address\fnref{label3}}
		%% \fntext[label3]{}
		
		\title{Supplementary material for the article ``Regression with I-priors''}
		
		%% use optional labels to link authors explicitly to addresses:
		%% \author[label1,label2]{}
		%% \address[label1]{}
		%% \address[label2]{}
		
		%\author{Wicher P.\ Bergsma}
		%\address{London School of Economics, Houghton Street, London, WC2A 2AE, United Kingdom}
		
		\begin{abstract}
Simulations complementing the ones in Section~7 in the main article are presented. 
		
		%%Graphical abstract
%		\begin{graphicalabstract}
			%\includegraphics{grabs}
%		\end{graphicalabstract}
		\end{abstract}

		
	\end{frontmatter}
	
	%% \linenumbers
	
	%% main text


\section{Further simulations}\label{app-sim}

In the main article, we considered median absolute errors (MAEs) based on $L_2$ loss, summarized in Figure 5 there. Here we report to additional figures, visualizing the MAE based on two other norms, namely
\begin{itemize}
	\item $\text{MAE}(\cF_n):=\text{median}(\norm{\hat f-f}_{\cF_n})$
	\item $\text{MAE}(\cF):=\text{median}(\norm{\hat f-f}_{\cF})$
\end{itemize}
The simulation results are displayed in Figures~\ref{fig-sim1} and \ref{fig-sim2} using log-log plots of the MAE as a function of the error standard deviation.
As before, it is seen that the I-prior method always outperforms regularization, though the advantage of the former is small for the roughest functions in the RKHS (see the subfigures (a)).
Note that with respect to MAE($\cF_n$) (Figure~\ref{fig-sim1}) and not too small errors, regularization performs worse that a global constant fit (the horizontal `Baseline'). 
For rougher true regression functions in the RKHS, the I-prior estimator outperforms the SE estimator (the posterior mean under a square exponential process prior), which breaks down numerically for small errors. For analytic truths, the SE estimator outperforms the I-prior, as was to be expected. 



\begin{figure}[tbp]
	\centering
	\subfigure[True regression function has regularity 1]
	{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_bound3.pdf}\hspace*{5mm}
		% \hspace{2mm}
		% \subfigure[Random walk prior]
		{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_bound6.pdf}%\hspace*{5mm}
	}}
	\\
	\subfigure[True regression function has regularity 3/2]
	{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_sm3.pdf}\hspace*{5mm}
		% \hspace{2mm}
		% \subfigure[Summed random walk prior]
		{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_sm6.pdf}}}
	\\
	\subfigure[True regression function is a squared exponential Gaussian process path]
	{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_exp3.pdf}\hspace*{5mm}
		% \hspace{2mm}
		% \subfigure[Exponential prior]
		{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_exp6.pdf}}}
	\\
	\caption{Panels on left: simulated MAE($\cF_n$) for Tikhonov regularizer (`Reg'), I-prior estimator (`I-prior'), and SE estimator (`SE'). The baseline level is the MAE if the zero function is fitted.  
		Panels on right: ratio of MAE($\cF_n$) for regularizer and SE estimator compared to I-prior.
		Model~(1) in the main article is assumed with $\cF$ the FBM-1/2 RKHS and i.i.d.\  normal errors. }
	\label{fig-sim1}
\end{figure}


\begin{figure}[tbp]
	\centering
	\subfigure[True regression function has regularity 1]
	{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_bound1.pdf}\hspace*{5mm}
		% \hspace{2mm}
		% \subfigure[Random walk prior]
		{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_bound4.pdf}%\hspace*{5mm}
	}}
	\\
	\subfigure[True regression function has regularity 3/2]
	{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_sm1.pdf}\hspace*{5mm}
		% \hspace{2mm}
		% \subfigure[Summed random walk prior]
		{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_sm4.pdf}}}
	\\
	\subfigure[True regression function is a squared exponential Gaussian process path]
	{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_exp1.pdf}\hspace*{5mm}
		% \hspace{2mm}
		% \subfigure[Exponential prior]
		{\hspace*{0mm}\includegraphics[width=70mm]{sim_3priors_exp4.pdf}}}
	\\
	\caption{Panels on left: simulated MAE($\cF$) for Tikhonov regularizer (`Reg'), I-prior estimator (`I-prior'), and SE estimator (`SE'). The baseline level is the MAE if the zero function is fitted.  
		Panels on right: ratio of MAE($\cF$) for regularizer and SE estimator compared to I-prior.
		Model~~(1) in the main article is assumed with $\cF$ the FBM-1/2 RKHS and i.i.d.\  normal errors. }
	\label{fig-sim2}
\end{figure}


%\bibliographystyle{elsarticle-harv}
%\bibliography{stats}


%\footnotesize
%\bibliographystyle{apacite}
%\bibliography{stats}

\end{document}
